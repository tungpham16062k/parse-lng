{"version":3,"file":"index.js","sources":["../node_modules/svelte/src/runtime/internal/utils.js","../node_modules/svelte/src/runtime/internal/environment.js","../node_modules/svelte/src/runtime/internal/loop.js","../node_modules/svelte/src/runtime/internal/globals.js","../node_modules/svelte/src/runtime/internal/dom.js","../node_modules/svelte/src/runtime/internal/style_manager.js","../node_modules/svelte/src/runtime/internal/lifecycle.js","../node_modules/svelte/src/runtime/internal/scheduler.js","../node_modules/svelte/src/runtime/internal/transitions.js","../node_modules/svelte/src/runtime/internal/each.js","../node_modules/svelte/src/runtime/internal/spread.js","../node_modules/svelte/src/runtime/internal/Component.js","../src/lib/utils/debug.ts","../node_modules/svelte/src/runtime/internal/disclose-version/index.js","../node_modules/svelte/src/shared/version.js","../node_modules/svelte/src/runtime/transition/index.js","../node_modules/svelte-simple-modal/src/Modal.svelte","../src/lib/types.ts","../src/lib/constants.ts","../src/lib/utils/uniqueId.ts","../src/lib/utils/numberUtils.ts","../src/lib/utils/typeUtils.ts","../src/lib/utils/arrayUtils.ts","../src/lib/utils/jsonUtils.ts","../src/lib/utils/domUtils.ts","../src/lib/utils/keyBindings.ts","../src/lib/components/modals/popup/AbsolutePopupEntry.svelte","../src/lib/components/modals/popup/AbsolutePopup.svelte","../src/lib/utils/pathUtils.ts","../src/lib/utils/stringUtils.ts","../src/lib/plugins/query/javascriptQueryLanguage.ts","../node_modules/svelte-awesome/package/components/svg/Raw.svelte","../node_modules/svelte-awesome/package/components/svg/Svg.svelte","../node_modules/svelte-awesome/package/components/Icon.svelte","../src/lib/plugins/value/components/BooleanToggle.svelte","../src/lib/components/controls/ColorPickerPopup.svelte","../src/lib/plugins/value/components/ColorPicker.svelte","../src/lib/logic/expandItemsSections.ts","../src/lib/logic/documentState.ts","../src/lib/logic/selection.ts","../src/lib/utils/cssUtils.ts","../src/lib/plugins/value/components/utils/getValueClass.ts","../src/lib/components/controls/EditableDiv.svelte","../src/lib/plugins/value/components/EditableValue.svelte","../src/lib/logic/operations.ts","../src/lib/logic/search.ts","../src/lib/components/modes/treemode/highlight/SearchResultHighlighter.svelte","../src/lib/plugins/value/components/ReadonlyValue.svelte","../src/lib/components/controls/tooltip/Tooltip.svelte","../src/lib/components/controls/tooltip/tooltip.ts","../src/lib/plugins/value/components/TimestampTag.svelte","../src/lib/plugins/value/renderValue.ts","../src/lib/components/modals/transformModalStates.ts","../node_modules/@floating-ui/utils/dist/floating-ui.utils.mjs","../node_modules/@floating-ui/core/dist/floating-ui.core.mjs","../node_modules/@floating-ui/utils/dist/floating-ui.utils.dom.mjs","../node_modules/@floating-ui/dom/dist/floating-ui.dom.mjs","../node_modules/svelte-select/filter.js","../node_modules/svelte-select/get-items.js","../node_modules/svelte-select/ChevronIcon.svelte","../node_modules/svelte-select/ClearIcon.svelte","../node_modules/svelte-select/LoadingIcon.svelte","../node_modules/svelte-select/Select.svelte","../node_modules/svelte-floating-ui/index.js","../src/lib/components/modals/TransformWizard.svelte","../src/lib/components/controls/selectQueryLanguage/SelectQueryLanguage.svelte","../src/lib/components/modals/Header.svelte","../src/lib/components/modals/TransformModalHeader.svelte","../src/lib/components/controls/createAutoScrollHandler.ts","../src/lib/assets/jump.js/src/easing.ts","../src/lib/assets/jump.js/src/jump.ts","../src/lib/logic/history.ts","../src/lib/utils/timeUtils.ts","../src/lib/logic/validation.ts","../src/lib/components/controls/createFocusTracker.ts","../src/lib/components/controls/Message.svelte","../src/lib/components/controls/ValidationErrorsOverview.svelte","../src/lib/utils/navigatorUtils.ts","../src/lib/actions/onEscape.ts","../src/lib/components/modals/CopyPasteModal.svelte","../src/lib/typeguards.ts","../src/lib/components/controls/Menu.svelte","../src/lib/components/modals/repair/JSONRepairComponent.svelte","../src/lib/components/modals/JSONRepairModal.svelte","../src/lib/components/modes/treemode/CollapsedItems.svelte","../src/lib/components/controls/contextmenu/ContextMenuPointer.svelte","../src/lib/components/modes/treemode/JSONKey.svelte","../src/lib/components/modes/treemode/JSONValue.svelte","../src/lib/components/modes/treemode/singleton.ts","../src/lib/logic/dragging.ts","../src/lib/utils/jsonPointer.ts","../src/lib/components/modes/treemode/ValidationErrorIcon.svelte","../src/lib/components/modes/treemode/JSONNode.svelte","../src/lib/img/customFontawesomeIcons.ts","../src/lib/components/modes/treemode/menu/TreeMenu.svelte","../src/lib/components/modes/treemode/Welcome.svelte","../src/lib/logic/sort.ts","../src/lib/components/controls/navigationBar/NavigationBarDropdown.svelte","../src/lib/components/controls/navigationBar/NavigationBarItem.svelte","../src/lib/utils/copyToClipboard.ts","../src/lib/components/controls/navigationBar/NavigationBarPathEditor.svelte","../src/lib/components/controls/navigationBar/NavigationBar.svelte","../src/lib/components/controls/SearchBox.svelte","../src/lib/logic/table.ts","../src/lib/logic/actions.ts","../src/lib/components/controls/JSONPreview.svelte","../src/lib/components/controls/contextmenu/ContextMenuButton.svelte","../src/lib/components/controls/DropdownButton.svelte","../src/lib/components/controls/contextmenu/ContextMenuDropDownButton.svelte","../src/lib/components/controls/contextmenu/ContextMenu.svelte","../src/lib/components/modes/treemode/TreeMode.svelte","../src/lib/components/modes/treemode/contextmenu/createTreeContextMenuItems.ts","../src/lib/utils/readonlyProxy.ts","../src/lib/components/modals/TransformModal.svelte","../src/lib/components/modals/sortModalStates.ts","../src/lib/components/modals/SortModal.svelte","../src/lib/utils/noop.ts","../src/lib/utils/fileUtils.ts","../src/lib/components/modes/textmode/menu/TextMenu.svelte","../src/lib/components/modes/textmode/StatusBar.svelte","../src/lib/components/modes/textmode/codemirror/codemirror-theme.ts","../src/lib/components/modes/textmode/TextMode.svelte","../src/lib/components/modes/tablemode/menu/TableMenu.svelte","../src/lib/components/modes/tablemode/JSONValue.svelte","../src/lib/components/modes/tablemode/tag/InlineValue.svelte","../src/lib/components/modes/tablemode/ColumnHeader.svelte","../src/lib/actions/resizeObserver.ts","../src/lib/components/modes/tablemode/TableModeWelcome.svelte","../src/lib/components/modes/tablemode/RefreshColumnHeader.svelte","../src/lib/components/modes/tablemode/TableMode.svelte","../src/lib/components/modes/tablemode/contextmenu/createTableContextMenuItems.ts","../src/lib/components/modes/JSONEditorRoot.svelte","../src/lib/components/modals/JSONEditorModal.svelte","../src/lib/components/modals/ModalRef.svelte","../src/lib/components/JSONEditor.svelte","../src/lib/plugins/value/components/EnumValue.svelte","../src/lib/utils/jsonSchemaUtils.ts","../src/lib/plugins/value/renderJSONSchemaEnum.ts","../src/lib/plugins/validator/createAjvValidator.ts","../src/lib/plugins/query/lodashQueryLanguage.ts","../src/lib/plugins/query/jmespathQueryLanguage.ts"],"sourcesContent":["/** @returns {void} */\nexport function noop() {}\n\nexport const identity = (x) => x;\n\n/**\n * @template T\n * @template S\n * @param {T} tar\n * @param {S} src\n * @returns {T & S}\n */\nexport function assign(tar, src) {\n\t// @ts-ignore\n\tfor (const k in src) tar[k] = src[k];\n\treturn /** @type {T & S} */ (tar);\n}\n\n// Adapted from https://github.com/then/is-promise/blob/master/index.js\n// Distributed under MIT License https://github.com/then/is-promise/blob/master/LICENSE\n/**\n * @param {any} value\n * @returns {value is PromiseLike<any>}\n */\nexport function is_promise(value) {\n\treturn (\n\t\t!!value &&\n\t\t(typeof value === 'object' || typeof value === 'function') &&\n\t\ttypeof (/** @type {any} */ (value).then) === 'function'\n\t);\n}\n\n/** @returns {void} */\nexport function add_location(element, file, line, column, char) {\n\telement.__svelte_meta = {\n\t\tloc: { file, line, column, char }\n\t};\n}\n\nexport function run(fn) {\n\treturn fn();\n}\n\nexport function blank_object() {\n\treturn Object.create(null);\n}\n\n/**\n * @param {Function[]} fns\n * @returns {void}\n */\nexport function run_all(fns) {\n\tfns.forEach(run);\n}\n\n/**\n * @param {any} thing\n * @returns {thing is Function}\n */\nexport function is_function(thing) {\n\treturn typeof thing === 'function';\n}\n\n/** @returns {boolean} */\nexport function safe_not_equal(a, b) {\n\treturn a != a ? b == b : a !== b || (a && typeof a === 'object') || typeof a === 'function';\n}\n\nlet src_url_equal_anchor;\n\n/**\n * @param {string} element_src\n * @param {string} url\n * @returns {boolean}\n */\nexport function src_url_equal(element_src, url) {\n\tif (element_src === url) return true;\n\tif (!src_url_equal_anchor) {\n\t\tsrc_url_equal_anchor = document.createElement('a');\n\t}\n\t// This is actually faster than doing URL(..).href\n\tsrc_url_equal_anchor.href = url;\n\treturn element_src === src_url_equal_anchor.href;\n}\n\n/** @param {string} srcset */\nfunction split_srcset(srcset) {\n\treturn srcset.split(',').map((src) => src.trim().split(' ').filter(Boolean));\n}\n\n/**\n * @param {HTMLSourceElement | HTMLImageElement} element_srcset\n * @param {string | undefined | null} srcset\n * @returns {boolean}\n */\nexport function srcset_url_equal(element_srcset, srcset) {\n\tconst element_urls = split_srcset(element_srcset.srcset);\n\tconst urls = split_srcset(srcset || '');\n\n\treturn (\n\t\turls.length === element_urls.length &&\n\t\turls.every(\n\t\t\t([url, width], i) =>\n\t\t\t\twidth === element_urls[i][1] &&\n\t\t\t\t// We need to test both ways because Vite will create an a full URL with\n\t\t\t\t// `new URL(asset, import.meta.url).href` for the client when `base: './'`, and the\n\t\t\t\t// relative URLs inside srcset are not automatically resolved to absolute URLs by\n\t\t\t\t// browsers (in contrast to img.src). This means both SSR and DOM code could\n\t\t\t\t// contain relative or absolute URLs.\n\t\t\t\t(src_url_equal(element_urls[i][0], url) || src_url_equal(url, element_urls[i][0]))\n\t\t)\n\t);\n}\n\n/** @returns {boolean} */\nexport function not_equal(a, b) {\n\treturn a != a ? b == b : a !== b;\n}\n\n/** @returns {boolean} */\nexport function is_empty(obj) {\n\treturn Object.keys(obj).length === 0;\n}\n\n/** @returns {void} */\nexport function validate_store(store, name) {\n\tif (store != null && typeof store.subscribe !== 'function') {\n\t\tthrow new Error(`'${name}' is not a store with a 'subscribe' method`);\n\t}\n}\n\nexport function subscribe(store, ...callbacks) {\n\tif (store == null) {\n\t\tfor (const callback of callbacks) {\n\t\t\tcallback(undefined);\n\t\t}\n\t\treturn noop;\n\t}\n\tconst unsub = store.subscribe(...callbacks);\n\treturn unsub.unsubscribe ? () => unsub.unsubscribe() : unsub;\n}\n\n/**\n * Get the current value from a store by subscribing and immediately unsubscribing.\n *\n * https://svelte.dev/docs/svelte-store#get\n * @template T\n * @param {import('../store/public.js').Readable<T>} store\n * @returns {T}\n */\nexport function get_store_value(store) {\n\tlet value;\n\tsubscribe(store, (_) => (value = _))();\n\treturn value;\n}\n\n/** @returns {void} */\nexport function component_subscribe(component, store, callback) {\n\tcomponent.$$.on_destroy.push(subscribe(store, callback));\n}\n\nexport function create_slot(definition, ctx, $$scope, fn) {\n\tif (definition) {\n\t\tconst slot_ctx = get_slot_context(definition, ctx, $$scope, fn);\n\t\treturn definition[0](slot_ctx);\n\t}\n}\n\nfunction get_slot_context(definition, ctx, $$scope, fn) {\n\treturn definition[1] && fn ? assign($$scope.ctx.slice(), definition[1](fn(ctx))) : $$scope.ctx;\n}\n\nexport function get_slot_changes(definition, $$scope, dirty, fn) {\n\tif (definition[2] && fn) {\n\t\tconst lets = definition[2](fn(dirty));\n\t\tif ($$scope.dirty === undefined) {\n\t\t\treturn lets;\n\t\t}\n\t\tif (typeof lets === 'object') {\n\t\t\tconst merged = [];\n\t\t\tconst len = Math.max($$scope.dirty.length, lets.length);\n\t\t\tfor (let i = 0; i < len; i += 1) {\n\t\t\t\tmerged[i] = $$scope.dirty[i] | lets[i];\n\t\t\t}\n\t\t\treturn merged;\n\t\t}\n\t\treturn $$scope.dirty | lets;\n\t}\n\treturn $$scope.dirty;\n}\n\n/** @returns {void} */\nexport function update_slot_base(\n\tslot,\n\tslot_definition,\n\tctx,\n\t$$scope,\n\tslot_changes,\n\tget_slot_context_fn\n) {\n\tif (slot_changes) {\n\t\tconst slot_context = get_slot_context(slot_definition, ctx, $$scope, get_slot_context_fn);\n\t\tslot.p(slot_context, slot_changes);\n\t}\n}\n\n/** @returns {void} */\nexport function update_slot(\n\tslot,\n\tslot_definition,\n\tctx,\n\t$$scope,\n\tdirty,\n\tget_slot_changes_fn,\n\tget_slot_context_fn\n) {\n\tconst slot_changes = get_slot_changes(slot_definition, $$scope, dirty, get_slot_changes_fn);\n\tupdate_slot_base(slot, slot_definition, ctx, $$scope, slot_changes, get_slot_context_fn);\n}\n\n/** @returns {any[] | -1} */\nexport function get_all_dirty_from_scope($$scope) {\n\tif ($$scope.ctx.length > 32) {\n\t\tconst dirty = [];\n\t\tconst length = $$scope.ctx.length / 32;\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tdirty[i] = -1;\n\t\t}\n\t\treturn dirty;\n\t}\n\treturn -1;\n}\n\n/** @returns {{}} */\nexport function exclude_internal_props(props) {\n\tconst result = {};\n\tfor (const k in props) if (k[0] !== '$') result[k] = props[k];\n\treturn result;\n}\n\n/** @returns {{}} */\nexport function compute_rest_props(props, keys) {\n\tconst rest = {};\n\tkeys = new Set(keys);\n\tfor (const k in props) if (!keys.has(k) && k[0] !== '$') rest[k] = props[k];\n\treturn rest;\n}\n\n/** @returns {{}} */\nexport function compute_slots(slots) {\n\tconst result = {};\n\tfor (const key in slots) {\n\t\tresult[key] = true;\n\t}\n\treturn result;\n}\n\n/** @returns {(this: any, ...args: any[]) => void} */\nexport function once(fn) {\n\tlet ran = false;\n\treturn function (...args) {\n\t\tif (ran) return;\n\t\tran = true;\n\t\tfn.call(this, ...args);\n\t};\n}\n\nexport function null_to_empty(value) {\n\treturn value == null ? '' : value;\n}\n\nexport function set_store_value(store, ret, value) {\n\tstore.set(value);\n\treturn ret;\n}\n\nexport const has_prop = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop);\n\nexport function action_destroyer(action_result) {\n\treturn action_result && is_function(action_result.destroy) ? action_result.destroy : noop;\n}\n\n/** @param {number | string} value\n * @returns {[number, string]}\n */\nexport function split_css_unit(value) {\n\tconst split = typeof value === 'string' && value.match(/^\\s*(-?[\\d.]+)([^\\s]*)\\s*$/);\n\treturn split ? [parseFloat(split[1]), split[2] || 'px'] : [/** @type {number} */ (value), 'px'];\n}\n\nexport const contenteditable_truthy_values = ['', true, 1, 'true', 'contenteditable'];\n","import { noop } from './utils.js';\n\nexport const is_client = typeof window !== 'undefined';\n\n/** @type {() => number} */\nexport let now = is_client ? () => window.performance.now() : () => Date.now();\n\nexport let raf = is_client ? (cb) => requestAnimationFrame(cb) : noop;\n\n// used internally for testing\n/** @returns {void} */\nexport function set_now(fn) {\n\tnow = fn;\n}\n\n/** @returns {void} */\nexport function set_raf(fn) {\n\traf = fn;\n}\n","import { raf } from './environment.js';\n\nconst tasks = new Set();\n\n/**\n * @param {number} now\n * @returns {void}\n */\nfunction run_tasks(now) {\n\ttasks.forEach((task) => {\n\t\tif (!task.c(now)) {\n\t\t\ttasks.delete(task);\n\t\t\ttask.f();\n\t\t}\n\t});\n\tif (tasks.size !== 0) raf(run_tasks);\n}\n\n/**\n * For testing purposes only!\n * @returns {void}\n */\nexport function clear_loops() {\n\ttasks.clear();\n}\n\n/**\n * Creates a new task that runs on each raf frame\n * until it returns a falsy value or is aborted\n * @param {import('./private.js').TaskCallback} callback\n * @returns {import('./private.js').Task}\n */\nexport function loop(callback) {\n\t/** @type {import('./private.js').TaskEntry} */\n\tlet task;\n\tif (tasks.size === 0) raf(run_tasks);\n\treturn {\n\t\tpromise: new Promise((fulfill) => {\n\t\t\ttasks.add((task = { c: callback, f: fulfill }));\n\t\t}),\n\t\tabort() {\n\t\t\ttasks.delete(task);\n\t\t}\n\t};\n}\n","/** @type {typeof globalThis} */\nexport const globals =\n\ttypeof window !== 'undefined'\n\t\t? window\n\t\t: typeof globalThis !== 'undefined'\n\t\t? globalThis\n\t\t: // @ts-ignore Node typings have this\n\t\t  global;\n","import { contenteditable_truthy_values, has_prop } from './utils.js';\n\nimport { ResizeObserverSingleton } from './ResizeObserverSingleton.js';\n\n// Track which nodes are claimed during hydration. Unclaimed nodes can then be removed from the DOM\n// at the end of hydration without touching the remaining nodes.\nlet is_hydrating = false;\n\n/**\n * @returns {void}\n */\nexport function start_hydrating() {\n\tis_hydrating = true;\n}\n\n/**\n * @returns {void}\n */\nexport function end_hydrating() {\n\tis_hydrating = false;\n}\n\n/**\n * @param {number} low\n * @param {number} high\n * @param {(index: number) => number} key\n * @param {number} value\n * @returns {number}\n */\nfunction upper_bound(low, high, key, value) {\n\t// Return first index of value larger than input value in the range [low, high)\n\twhile (low < high) {\n\t\tconst mid = low + ((high - low) >> 1);\n\t\tif (key(mid) <= value) {\n\t\t\tlow = mid + 1;\n\t\t} else {\n\t\t\thigh = mid;\n\t\t}\n\t}\n\treturn low;\n}\n\n/**\n * @param {NodeEx} target\n * @returns {void}\n */\nfunction init_hydrate(target) {\n\tif (target.hydrate_init) return;\n\ttarget.hydrate_init = true;\n\t// We know that all children have claim_order values since the unclaimed have been detached if target is not <head>\n\n\tlet children = /** @type {ArrayLike<NodeEx2>} */ (target.childNodes);\n\t// If target is <head>, there may be children without claim_order\n\tif (target.nodeName === 'HEAD') {\n\t\tconst my_children = [];\n\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\tconst node = children[i];\n\t\t\tif (node.claim_order !== undefined) {\n\t\t\t\tmy_children.push(node);\n\t\t\t}\n\t\t}\n\t\tchildren = my_children;\n\t}\n\t/*\n\t * Reorder claimed children optimally.\n\t * We can reorder claimed children optimally by finding the longest subsequence of\n\t * nodes that are already claimed in order and only moving the rest. The longest\n\t * subsequence of nodes that are claimed in order can be found by\n\t * computing the longest increasing subsequence of .claim_order values.\n\t *\n\t * This algorithm is optimal in generating the least amount of reorder operations\n\t * possible.\n\t *\n\t * Proof:\n\t * We know that, given a set of reordering operations, the nodes that do not move\n\t * always form an increasing subsequence, since they do not move among each other\n\t * meaning that they must be already ordered among each other. Thus, the maximal\n\t * set of nodes that do not move form a longest increasing subsequence.\n\t */\n\t// Compute longest increasing subsequence\n\t// m: subsequence length j => index k of smallest value that ends an increasing subsequence of length j\n\tconst m = new Int32Array(children.length + 1);\n\t// Predecessor indices + 1\n\tconst p = new Int32Array(children.length);\n\tm[0] = -1;\n\tlet longest = 0;\n\tfor (let i = 0; i < children.length; i++) {\n\t\tconst current = children[i].claim_order;\n\t\t// Find the largest subsequence length such that it ends in a value less than our current value\n\t\t// upper_bound returns first greater value, so we subtract one\n\t\t// with fast path for when we are on the current longest subsequence\n\t\tconst seq_len =\n\t\t\t(longest > 0 && children[m[longest]].claim_order <= current\n\t\t\t\t? longest + 1\n\t\t\t\t: upper_bound(1, longest, (idx) => children[m[idx]].claim_order, current)) - 1;\n\t\tp[i] = m[seq_len] + 1;\n\t\tconst new_len = seq_len + 1;\n\t\t// We can guarantee that current is the smallest value. Otherwise, we would have generated a longer sequence.\n\t\tm[new_len] = i;\n\t\tlongest = Math.max(new_len, longest);\n\t}\n\t// The longest increasing subsequence of nodes (initially reversed)\n\n\t/**\n\t * @type {NodeEx2[]}\n\t */\n\tconst lis = [];\n\t// The rest of the nodes, nodes that will be moved\n\n\t/**\n\t * @type {NodeEx2[]}\n\t */\n\tconst to_move = [];\n\tlet last = children.length - 1;\n\tfor (let cur = m[longest] + 1; cur != 0; cur = p[cur - 1]) {\n\t\tlis.push(children[cur - 1]);\n\t\tfor (; last >= cur; last--) {\n\t\t\tto_move.push(children[last]);\n\t\t}\n\t\tlast--;\n\t}\n\tfor (; last >= 0; last--) {\n\t\tto_move.push(children[last]);\n\t}\n\tlis.reverse();\n\t// We sort the nodes being moved to guarantee that their insertion order matches the claim order\n\tto_move.sort((a, b) => a.claim_order - b.claim_order);\n\t// Finally, we move the nodes\n\tfor (let i = 0, j = 0; i < to_move.length; i++) {\n\t\twhile (j < lis.length && to_move[i].claim_order >= lis[j].claim_order) {\n\t\t\tj++;\n\t\t}\n\t\tconst anchor = j < lis.length ? lis[j] : null;\n\t\ttarget.insertBefore(to_move[i], anchor);\n\t}\n}\n\n/**\n * @param {Node} target\n * @param {Node} node\n * @returns {void}\n */\nexport function append(target, node) {\n\ttarget.appendChild(node);\n}\n\n/**\n * @param {Node} target\n * @param {string} style_sheet_id\n * @param {string} styles\n * @returns {void}\n */\nexport function append_styles(target, style_sheet_id, styles) {\n\tconst append_styles_to = get_root_for_style(target);\n\tif (!append_styles_to.getElementById(style_sheet_id)) {\n\t\tconst style = element('style');\n\t\tstyle.id = style_sheet_id;\n\t\tstyle.textContent = styles;\n\t\tappend_stylesheet(append_styles_to, style);\n\t}\n}\n\n/**\n * @param {Node} node\n * @returns {ShadowRoot | Document}\n */\nexport function get_root_for_style(node) {\n\tif (!node) return document;\n\tconst root = node.getRootNode ? node.getRootNode() : node.ownerDocument;\n\tif (root && /** @type {ShadowRoot} */ (root).host) {\n\t\treturn /** @type {ShadowRoot} */ (root);\n\t}\n\treturn node.ownerDocument;\n}\n\n/**\n * @param {Node} node\n * @returns {CSSStyleSheet}\n */\nexport function append_empty_stylesheet(node) {\n\tconst style_element = element('style');\n\t// For transitions to work without 'style-src: unsafe-inline' Content Security Policy,\n\t// these empty tags need to be allowed with a hash as a workaround until we move to the Web Animations API.\n\t// Using the hash for the empty string (for an empty tag) works in all browsers except Safari.\n\t// So as a workaround for the workaround, when we append empty style tags we set their content to /* empty */.\n\t// The hash 'sha256-9OlNO0DNEeaVzHL4RZwCLsBHA8WBQ8toBp/4F5XV2nc=' will then work even in Safari.\n\tstyle_element.textContent = '/* empty */';\n\tappend_stylesheet(get_root_for_style(node), style_element);\n\treturn style_element.sheet;\n}\n\n/**\n * @param {ShadowRoot | Document} node\n * @param {HTMLStyleElement} style\n * @returns {CSSStyleSheet}\n */\nfunction append_stylesheet(node, style) {\n\tappend(/** @type {Document} */ (node).head || node, style);\n\treturn style.sheet;\n}\n\n/**\n * @param {NodeEx} target\n * @param {NodeEx} node\n * @returns {void}\n */\nexport function append_hydration(target, node) {\n\tif (is_hydrating) {\n\t\tinit_hydrate(target);\n\t\tif (\n\t\t\ttarget.actual_end_child === undefined ||\n\t\t\t(target.actual_end_child !== null && target.actual_end_child.parentNode !== target)\n\t\t) {\n\t\t\ttarget.actual_end_child = target.firstChild;\n\t\t}\n\t\t// Skip nodes of undefined ordering\n\t\twhile (target.actual_end_child !== null && target.actual_end_child.claim_order === undefined) {\n\t\t\ttarget.actual_end_child = target.actual_end_child.nextSibling;\n\t\t}\n\t\tif (node !== target.actual_end_child) {\n\t\t\t// We only insert if the ordering of this node should be modified or the parent node is not target\n\t\t\tif (node.claim_order !== undefined || node.parentNode !== target) {\n\t\t\t\ttarget.insertBefore(node, target.actual_end_child);\n\t\t\t}\n\t\t} else {\n\t\t\ttarget.actual_end_child = node.nextSibling;\n\t\t}\n\t} else if (node.parentNode !== target || node.nextSibling !== null) {\n\t\ttarget.appendChild(node);\n\t}\n}\n\n/**\n * @param {Node} target\n * @param {Node} node\n * @param {Node} [anchor]\n * @returns {void}\n */\nexport function insert(target, node, anchor) {\n\ttarget.insertBefore(node, anchor || null);\n}\n\n/**\n * @param {NodeEx} target\n * @param {NodeEx} node\n * @param {NodeEx} [anchor]\n * @returns {void}\n */\nexport function insert_hydration(target, node, anchor) {\n\tif (is_hydrating && !anchor) {\n\t\tappend_hydration(target, node);\n\t} else if (node.parentNode !== target || node.nextSibling != anchor) {\n\t\ttarget.insertBefore(node, anchor || null);\n\t}\n}\n\n/**\n * @param {Node} node\n * @returns {void}\n */\nexport function detach(node) {\n\tif (node.parentNode) {\n\t\tnode.parentNode.removeChild(node);\n\t}\n}\n\n/**\n * @returns {void} */\nexport function destroy_each(iterations, detaching) {\n\tfor (let i = 0; i < iterations.length; i += 1) {\n\t\tif (iterations[i]) iterations[i].d(detaching);\n\t}\n}\n\n/**\n * @template {keyof HTMLElementTagNameMap} K\n * @param {K} name\n * @returns {HTMLElementTagNameMap[K]}\n */\nexport function element(name) {\n\treturn document.createElement(name);\n}\n\n/**\n * @template {keyof HTMLElementTagNameMap} K\n * @param {K} name\n * @param {string} is\n * @returns {HTMLElementTagNameMap[K]}\n */\nexport function element_is(name, is) {\n\treturn document.createElement(name, { is });\n}\n\n/**\n * @template T\n * @template {keyof T} K\n * @param {T} obj\n * @param {K[]} exclude\n * @returns {Pick<T, Exclude<keyof T, K>>}\n */\nexport function object_without_properties(obj, exclude) {\n\tconst target = /** @type {Pick<T, Exclude<keyof T, K>>} */ ({});\n\tfor (const k in obj) {\n\t\tif (\n\t\t\thas_prop(obj, k) &&\n\t\t\t// @ts-ignore\n\t\t\texclude.indexOf(k) === -1\n\t\t) {\n\t\t\t// @ts-ignore\n\t\t\ttarget[k] = obj[k];\n\t\t}\n\t}\n\treturn target;\n}\n\n/**\n * @template {keyof SVGElementTagNameMap} K\n * @param {K} name\n * @returns {SVGElement}\n */\nexport function svg_element(name) {\n\treturn document.createElementNS('http://www.w3.org/2000/svg', name);\n}\n\n/**\n * @param {string} data\n * @returns {Text}\n */\nexport function text(data) {\n\treturn document.createTextNode(data);\n}\n\n/**\n * @returns {Text} */\nexport function space() {\n\treturn text(' ');\n}\n\n/**\n * @returns {Text} */\nexport function empty() {\n\treturn text('');\n}\n\n/**\n * @param {string} content\n * @returns {Comment}\n */\nexport function comment(content) {\n\treturn document.createComment(content);\n}\n\n/**\n * @param {EventTarget} node\n * @param {string} event\n * @param {EventListenerOrEventListenerObject} handler\n * @param {boolean | AddEventListenerOptions | EventListenerOptions} [options]\n * @returns {() => void}\n */\nexport function listen(node, event, handler, options) {\n\tnode.addEventListener(event, handler, options);\n\treturn () => node.removeEventListener(event, handler, options);\n}\n\n/**\n * @returns {(event: any) => any} */\nexport function prevent_default(fn) {\n\treturn function (event) {\n\t\tevent.preventDefault();\n\t\t// @ts-ignore\n\t\treturn fn.call(this, event);\n\t};\n}\n\n/**\n * @returns {(event: any) => any} */\nexport function stop_propagation(fn) {\n\treturn function (event) {\n\t\tevent.stopPropagation();\n\t\t// @ts-ignore\n\t\treturn fn.call(this, event);\n\t};\n}\n\n/**\n * @returns {(event: any) => any} */\nexport function stop_immediate_propagation(fn) {\n\treturn function (event) {\n\t\tevent.stopImmediatePropagation();\n\t\t// @ts-ignore\n\t\treturn fn.call(this, event);\n\t};\n}\n\n/**\n * @returns {(event: any) => void} */\nexport function self(fn) {\n\treturn function (event) {\n\t\t// @ts-ignore\n\t\tif (event.target === this) fn.call(this, event);\n\t};\n}\n\n/**\n * @returns {(event: any) => void} */\nexport function trusted(fn) {\n\treturn function (event) {\n\t\t// @ts-ignore\n\t\tif (event.isTrusted) fn.call(this, event);\n\t};\n}\n\n/**\n * @param {Element} node\n * @param {string} attribute\n * @param {string} [value]\n * @returns {void}\n */\nexport function attr(node, attribute, value) {\n\tif (value == null) node.removeAttribute(attribute);\n\telse if (node.getAttribute(attribute) !== value) node.setAttribute(attribute, value);\n}\n/**\n * List of attributes that should always be set through the attr method,\n * because updating them through the property setter doesn't work reliably.\n * In the example of `width`/`height`, the problem is that the setter only\n * accepts numeric values, but the attribute can also be set to a string like `50%`.\n * If this list becomes too big, rethink this approach.\n */\nconst always_set_through_set_attribute = ['width', 'height'];\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {{ [x: string]: string }} attributes\n * @returns {void}\n */\nexport function set_attributes(node, attributes) {\n\t// @ts-ignore\n\tconst descriptors = Object.getOwnPropertyDescriptors(node.__proto__);\n\tfor (const key in attributes) {\n\t\tif (attributes[key] == null) {\n\t\t\tnode.removeAttribute(key);\n\t\t} else if (key === 'style') {\n\t\t\tnode.style.cssText = attributes[key];\n\t\t} else if (key === '__value') {\n\t\t\t/** @type {any} */ (node).value = node[key] = attributes[key];\n\t\t} else if (\n\t\t\tdescriptors[key] &&\n\t\t\tdescriptors[key].set &&\n\t\t\talways_set_through_set_attribute.indexOf(key) === -1\n\t\t) {\n\t\t\tnode[key] = attributes[key];\n\t\t} else {\n\t\t\tattr(node, key, attributes[key]);\n\t\t}\n\t}\n}\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {{ [x: string]: string }} attributes\n * @returns {void}\n */\nexport function set_svg_attributes(node, attributes) {\n\tfor (const key in attributes) {\n\t\tattr(node, key, attributes[key]);\n\t}\n}\n\n/**\n * @param {Record<string, unknown>} data_map\n * @returns {void}\n */\nexport function set_custom_element_data_map(node, data_map) {\n\tObject.keys(data_map).forEach((key) => {\n\t\tset_custom_element_data(node, key, data_map[key]);\n\t});\n}\n\n/**\n * @returns {void} */\nexport function set_custom_element_data(node, prop, value) {\n\tconst lower = prop.toLowerCase(); // for backwards compatibility with existing behavior we do lowercase first\n\tif (lower in node) {\n\t\tnode[lower] = typeof node[lower] === 'boolean' && value === '' ? true : value;\n\t} else if (prop in node) {\n\t\tnode[prop] = typeof node[prop] === 'boolean' && value === '' ? true : value;\n\t} else {\n\t\tattr(node, prop, value);\n\t}\n}\n\n/**\n * @param {string} tag\n */\nexport function set_dynamic_element_data(tag) {\n\treturn /-/.test(tag) ? set_custom_element_data_map : set_attributes;\n}\n\n/**\n * @returns {void}\n */\nexport function xlink_attr(node, attribute, value) {\n\tnode.setAttributeNS('http://www.w3.org/1999/xlink', attribute, value);\n}\n\n/**\n * @param {HTMLElement} node\n * @returns {string}\n */\nexport function get_svelte_dataset(node) {\n\treturn node.dataset.svelteH;\n}\n\n/**\n * @returns {unknown[]} */\nexport function get_binding_group_value(group, __value, checked) {\n\tconst value = new Set();\n\tfor (let i = 0; i < group.length; i += 1) {\n\t\tif (group[i].checked) value.add(group[i].__value);\n\t}\n\tif (!checked) {\n\t\tvalue.delete(__value);\n\t}\n\treturn Array.from(value);\n}\n\n/**\n * @param {HTMLInputElement[]} group\n * @returns {{ p(...inputs: HTMLInputElement[]): void; r(): void; }}\n */\nexport function init_binding_group(group) {\n\t/**\n\t * @type {HTMLInputElement[]} */\n\tlet _inputs;\n\treturn {\n\t\t/* push */ p(...inputs) {\n\t\t\t_inputs = inputs;\n\t\t\t_inputs.forEach((input) => group.push(input));\n\t\t},\n\t\t/* remove */ r() {\n\t\t\t_inputs.forEach((input) => group.splice(group.indexOf(input), 1));\n\t\t}\n\t};\n}\n\n/**\n * @param {number[]} indexes\n * @returns {{ u(new_indexes: number[]): void; p(...inputs: HTMLInputElement[]): void; r: () => void; }}\n */\nexport function init_binding_group_dynamic(group, indexes) {\n\t/**\n\t * @type {HTMLInputElement[]} */\n\tlet _group = get_binding_group(group);\n\n\t/**\n\t * @type {HTMLInputElement[]} */\n\tlet _inputs;\n\n\tfunction get_binding_group(group) {\n\t\tfor (let i = 0; i < indexes.length; i++) {\n\t\t\tgroup = group[indexes[i]] = group[indexes[i]] || [];\n\t\t}\n\t\treturn group;\n\t}\n\n\t/**\n\t * @returns {void} */\n\tfunction push() {\n\t\t_inputs.forEach((input) => _group.push(input));\n\t}\n\n\t/**\n\t * @returns {void} */\n\tfunction remove() {\n\t\t_inputs.forEach((input) => _group.splice(_group.indexOf(input), 1));\n\t}\n\treturn {\n\t\t/* update */ u(new_indexes) {\n\t\t\tindexes = new_indexes;\n\t\t\tconst new_group = get_binding_group(group);\n\t\t\tif (new_group !== _group) {\n\t\t\t\tremove();\n\t\t\t\t_group = new_group;\n\t\t\t\tpush();\n\t\t\t}\n\t\t},\n\t\t/* push */ p(...inputs) {\n\t\t\t_inputs = inputs;\n\t\t\tpush();\n\t\t},\n\t\t/* remove */ r: remove\n\t};\n}\n\n/** @returns {number} */\nexport function to_number(value) {\n\treturn value === '' ? null : +value;\n}\n\n/** @returns {any[]} */\nexport function time_ranges_to_array(ranges) {\n\tconst array = [];\n\tfor (let i = 0; i < ranges.length; i += 1) {\n\t\tarray.push({ start: ranges.start(i), end: ranges.end(i) });\n\t}\n\treturn array;\n}\n\n/**\n * @param {Element} element\n * @returns {ChildNode[]}\n */\nexport function children(element) {\n\treturn Array.from(element.childNodes);\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @returns {void}\n */\nfunction init_claim_info(nodes) {\n\tif (nodes.claim_info === undefined) {\n\t\tnodes.claim_info = { last_index: 0, total_claimed: 0 };\n\t}\n}\n\n/**\n * @template {ChildNodeEx} R\n * @param {ChildNodeArray} nodes\n * @param {(node: ChildNodeEx) => node is R} predicate\n * @param {(node: ChildNodeEx) => ChildNodeEx | undefined} process_node\n * @param {() => R} create_node\n * @param {boolean} dont_update_last_index\n * @returns {R}\n */\nfunction claim_node(nodes, predicate, process_node, create_node, dont_update_last_index = false) {\n\t// Try to find nodes in an order such that we lengthen the longest increasing subsequence\n\tinit_claim_info(nodes);\n\tconst result_node = (() => {\n\t\t// We first try to find an element after the previous one\n\t\tfor (let i = nodes.claim_info.last_index; i < nodes.length; i++) {\n\t\t\tconst node = nodes[i];\n\t\t\tif (predicate(node)) {\n\t\t\t\tconst replacement = process_node(node);\n\t\t\t\tif (replacement === undefined) {\n\t\t\t\t\tnodes.splice(i, 1);\n\t\t\t\t} else {\n\t\t\t\t\tnodes[i] = replacement;\n\t\t\t\t}\n\t\t\t\tif (!dont_update_last_index) {\n\t\t\t\t\tnodes.claim_info.last_index = i;\n\t\t\t\t}\n\t\t\t\treturn node;\n\t\t\t}\n\t\t}\n\t\t// Otherwise, we try to find one before\n\t\t// We iterate in reverse so that we don't go too far back\n\t\tfor (let i = nodes.claim_info.last_index - 1; i >= 0; i--) {\n\t\t\tconst node = nodes[i];\n\t\t\tif (predicate(node)) {\n\t\t\t\tconst replacement = process_node(node);\n\t\t\t\tif (replacement === undefined) {\n\t\t\t\t\tnodes.splice(i, 1);\n\t\t\t\t} else {\n\t\t\t\t\tnodes[i] = replacement;\n\t\t\t\t}\n\t\t\t\tif (!dont_update_last_index) {\n\t\t\t\t\tnodes.claim_info.last_index = i;\n\t\t\t\t} else if (replacement === undefined) {\n\t\t\t\t\t// Since we spliced before the last_index, we decrease it\n\t\t\t\t\tnodes.claim_info.last_index--;\n\t\t\t\t}\n\t\t\t\treturn node;\n\t\t\t}\n\t\t}\n\t\t// If we can't find any matching node, we create a new one\n\t\treturn create_node();\n\t})();\n\tresult_node.claim_order = nodes.claim_info.total_claimed;\n\tnodes.claim_info.total_claimed += 1;\n\treturn result_node;\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @param {string} name\n * @param {{ [key: string]: boolean }} attributes\n * @param {(name: string) => Element | SVGElement} create_element\n * @returns {Element | SVGElement}\n */\nfunction claim_element_base(nodes, name, attributes, create_element) {\n\treturn claim_node(\n\t\tnodes,\n\t\t/** @returns {node is Element | SVGElement} */\n\t\t(node) => node.nodeName === name,\n\t\t/** @param {Element} node */\n\t\t(node) => {\n\t\t\tconst remove = [];\n\t\t\tfor (let j = 0; j < node.attributes.length; j++) {\n\t\t\t\tconst attribute = node.attributes[j];\n\t\t\t\tif (!attributes[attribute.name]) {\n\t\t\t\t\tremove.push(attribute.name);\n\t\t\t\t}\n\t\t\t}\n\t\t\tremove.forEach((v) => node.removeAttribute(v));\n\t\t\treturn undefined;\n\t\t},\n\t\t() => create_element(name)\n\t);\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @param {string} name\n * @param {{ [key: string]: boolean }} attributes\n * @returns {Element | SVGElement}\n */\nexport function claim_element(nodes, name, attributes) {\n\treturn claim_element_base(nodes, name, attributes, element);\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @param {string} name\n * @param {{ [key: string]: boolean }} attributes\n * @returns {Element | SVGElement}\n */\nexport function claim_svg_element(nodes, name, attributes) {\n\treturn claim_element_base(nodes, name, attributes, svg_element);\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @returns {Text}\n */\nexport function claim_text(nodes, data) {\n\treturn claim_node(\n\t\tnodes,\n\t\t/** @returns {node is Text} */\n\t\t(node) => node.nodeType === 3,\n\t\t/** @param {Text} node */\n\t\t(node) => {\n\t\t\tconst data_str = '' + data;\n\t\t\tif (node.data.startsWith(data_str)) {\n\t\t\t\tif (node.data.length !== data_str.length) {\n\t\t\t\t\treturn node.splitText(data_str.length);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tnode.data = data_str;\n\t\t\t}\n\t\t},\n\t\t() => text(data),\n\t\ttrue // Text nodes should not update last index since it is likely not worth it to eliminate an increasing subsequence of actual elements\n\t);\n}\n\n/**\n * @returns {Text} */\nexport function claim_space(nodes) {\n\treturn claim_text(nodes, ' ');\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @returns {Comment}\n */\nexport function claim_comment(nodes, data) {\n\treturn claim_node(\n\t\tnodes,\n\t\t/** @returns {node is Comment} */\n\t\t(node) => node.nodeType === 8,\n\t\t/** @param {Comment} node */\n\t\t(node) => {\n\t\t\tnode.data = '' + data;\n\t\t\treturn undefined;\n\t\t},\n\t\t() => comment(data),\n\t\ttrue\n\t);\n}\n\nfunction get_comment_idx(nodes, text, start) {\n\tfor (let i = start; i < nodes.length; i += 1) {\n\t\tconst node = nodes[i];\n\t\tif (node.nodeType === 8 /* comment node */ && node.textContent.trim() === text) {\n\t\t\treturn i;\n\t\t}\n\t}\n\treturn -1;\n}\n\n/**\n * @param {boolean} is_svg\n * @returns {HtmlTagHydration}\n */\nexport function claim_html_tag(nodes, is_svg) {\n\t// find html opening tag\n\tconst start_index = get_comment_idx(nodes, 'HTML_TAG_START', 0);\n\tconst end_index = get_comment_idx(nodes, 'HTML_TAG_END', start_index + 1);\n\tif (start_index === -1 || end_index === -1) {\n\t\treturn new HtmlTagHydration(is_svg);\n\t}\n\n\tinit_claim_info(nodes);\n\tconst html_tag_nodes = nodes.splice(start_index, end_index - start_index + 1);\n\tdetach(html_tag_nodes[0]);\n\tdetach(html_tag_nodes[html_tag_nodes.length - 1]);\n\tconst claimed_nodes = html_tag_nodes.slice(1, html_tag_nodes.length - 1);\n\tif (claimed_nodes.length === 0) {\n\t\treturn new HtmlTagHydration(is_svg);\n\t}\n\tfor (const n of claimed_nodes) {\n\t\tn.claim_order = nodes.claim_info.total_claimed;\n\t\tnodes.claim_info.total_claimed += 1;\n\t}\n\treturn new HtmlTagHydration(is_svg, claimed_nodes);\n}\n\n/**\n * @param {Text} text\n * @param {unknown} data\n * @returns {void}\n */\nexport function set_data(text, data) {\n\tdata = '' + data;\n\tif (text.data === data) return;\n\ttext.data = /** @type {string} */ (data);\n}\n\n/**\n * @param {Text} text\n * @param {unknown} data\n * @returns {void}\n */\nexport function set_data_contenteditable(text, data) {\n\tdata = '' + data;\n\tif (text.wholeText === data) return;\n\ttext.data = /** @type {string} */ (data);\n}\n\n/**\n * @param {Text} text\n * @param {unknown} data\n * @param {string} attr_value\n * @returns {void}\n */\nexport function set_data_maybe_contenteditable(text, data, attr_value) {\n\tif (~contenteditable_truthy_values.indexOf(attr_value)) {\n\t\tset_data_contenteditable(text, data);\n\t} else {\n\t\tset_data(text, data);\n\t}\n}\n\n/**\n * @returns {void} */\nexport function set_input_value(input, value) {\n\tinput.value = value == null ? '' : value;\n}\n\n/**\n * @returns {void} */\nexport function set_input_type(input, type) {\n\ttry {\n\t\tinput.type = type;\n\t} catch (e) {\n\t\t// do nothing\n\t}\n}\n\n/**\n * @returns {void} */\nexport function set_style(node, key, value, important) {\n\tif (value == null) {\n\t\tnode.style.removeProperty(key);\n\t} else {\n\t\tnode.style.setProperty(key, value, important ? 'important' : '');\n\t}\n}\n\n/**\n * @returns {void} */\nexport function select_option(select, value, mounting) {\n\tfor (let i = 0; i < select.options.length; i += 1) {\n\t\tconst option = select.options[i];\n\t\tif (option.__value === value) {\n\t\t\toption.selected = true;\n\t\t\treturn;\n\t\t}\n\t}\n\tif (!mounting || value !== undefined) {\n\t\tselect.selectedIndex = -1; // no option should be selected\n\t}\n}\n\n/**\n * @returns {void} */\nexport function select_options(select, value) {\n\tfor (let i = 0; i < select.options.length; i += 1) {\n\t\tconst option = select.options[i];\n\t\toption.selected = ~value.indexOf(option.__value);\n\t}\n}\n\nexport function select_value(select) {\n\tconst selected_option = select.querySelector(':checked');\n\treturn selected_option && selected_option.__value;\n}\n\nexport function select_multiple_value(select) {\n\treturn [].map.call(select.querySelectorAll(':checked'), (option) => option.__value);\n}\n// unfortunately this can't be a constant as that wouldn't be tree-shakeable\n// so we cache the result instead\n\n/**\n * @type {boolean} */\nlet crossorigin;\n\n/**\n * @returns {boolean} */\nexport function is_crossorigin() {\n\tif (crossorigin === undefined) {\n\t\tcrossorigin = false;\n\t\ttry {\n\t\t\tif (typeof window !== 'undefined' && window.parent) {\n\t\t\t\tvoid window.parent.document;\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tcrossorigin = true;\n\t\t}\n\t}\n\treturn crossorigin;\n}\n\n/**\n * @param {HTMLElement} node\n * @param {() => void} fn\n * @returns {() => void}\n */\nexport function add_iframe_resize_listener(node, fn) {\n\tconst computed_style = getComputedStyle(node);\n\tif (computed_style.position === 'static') {\n\t\tnode.style.position = 'relative';\n\t}\n\tconst iframe = element('iframe');\n\tiframe.setAttribute(\n\t\t'style',\n\t\t'display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; ' +\n\t\t\t'overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;'\n\t);\n\tiframe.setAttribute('aria-hidden', 'true');\n\tiframe.tabIndex = -1;\n\tconst crossorigin = is_crossorigin();\n\n\t/**\n\t * @type {() => void}\n\t */\n\tlet unsubscribe;\n\tif (crossorigin) {\n\t\tiframe.src = \"data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}</script>\";\n\t\tunsubscribe = listen(\n\t\t\twindow,\n\t\t\t'message',\n\t\t\t/** @param {MessageEvent} event */ (event) => {\n\t\t\t\tif (event.source === iframe.contentWindow) fn();\n\t\t\t}\n\t\t);\n\t} else {\n\t\tiframe.src = 'about:blank';\n\t\tiframe.onload = () => {\n\t\t\tunsubscribe = listen(iframe.contentWindow, 'resize', fn);\n\t\t\t// make sure an initial resize event is fired _after_ the iframe is loaded (which is asynchronous)\n\t\t\t// see https://github.com/sveltejs/svelte/issues/4233\n\t\t\tfn();\n\t\t};\n\t}\n\tappend(node, iframe);\n\treturn () => {\n\t\tif (crossorigin) {\n\t\t\tunsubscribe();\n\t\t} else if (unsubscribe && iframe.contentWindow) {\n\t\t\tunsubscribe();\n\t\t}\n\t\tdetach(iframe);\n\t};\n}\nexport const resize_observer_content_box = /* @__PURE__ */ new ResizeObserverSingleton({\n\tbox: 'content-box'\n});\nexport const resize_observer_border_box = /* @__PURE__ */ new ResizeObserverSingleton({\n\tbox: 'border-box'\n});\nexport const resize_observer_device_pixel_content_box = /* @__PURE__ */ new ResizeObserverSingleton(\n\t{ box: 'device-pixel-content-box' }\n);\nexport { ResizeObserverSingleton };\n\n/**\n * @returns {void} */\nexport function toggle_class(element, name, toggle) {\n\t// The `!!` is required because an `undefined` flag means flipping the current state.\n\telement.classList.toggle(name, !!toggle);\n}\n\n/**\n * @template T\n * @param {string} type\n * @param {T} [detail]\n * @param {{ bubbles?: boolean, cancelable?: boolean }} [options]\n * @returns {CustomEvent<T>}\n */\nexport function custom_event(type, detail, { bubbles = false, cancelable = false } = {}) {\n\treturn new CustomEvent(type, { detail, bubbles, cancelable });\n}\n\n/**\n * @param {string} selector\n * @param {HTMLElement} parent\n * @returns {ChildNodeArray}\n */\nexport function query_selector_all(selector, parent = document.body) {\n\treturn Array.from(parent.querySelectorAll(selector));\n}\n\n/**\n * @param {string} nodeId\n * @param {HTMLElement} head\n * @returns {any[]}\n */\nexport function head_selector(nodeId, head) {\n\tconst result = [];\n\tlet started = 0;\n\tfor (const node of head.childNodes) {\n\t\tif (node.nodeType === 8 /* comment node */) {\n\t\t\tconst comment = node.textContent.trim();\n\t\t\tif (comment === `HEAD_${nodeId}_END`) {\n\t\t\t\tstarted -= 1;\n\t\t\t\tresult.push(node);\n\t\t\t} else if (comment === `HEAD_${nodeId}_START`) {\n\t\t\t\tstarted += 1;\n\t\t\t\tresult.push(node);\n\t\t\t}\n\t\t} else if (started > 0) {\n\t\t\tresult.push(node);\n\t\t}\n\t}\n\treturn result;\n}\n/** */\nexport class HtmlTag {\n\t/**\n\t * @private\n\t * @default false\n\t */\n\tis_svg = false;\n\t/** parent for creating node */\n\te = undefined;\n\t/** html tag nodes */\n\tn = undefined;\n\t/** target */\n\tt = undefined;\n\t/** anchor */\n\ta = undefined;\n\tconstructor(is_svg = false) {\n\t\tthis.is_svg = is_svg;\n\t\tthis.e = this.n = null;\n\t}\n\n\t/**\n\t * @param {string} html\n\t * @returns {void}\n\t */\n\tc(html) {\n\t\tthis.h(html);\n\t}\n\n\t/**\n\t * @param {string} html\n\t * @param {HTMLElement | SVGElement} target\n\t * @param {HTMLElement | SVGElement} anchor\n\t * @returns {void}\n\t */\n\tm(html, target, anchor = null) {\n\t\tif (!this.e) {\n\t\t\tif (this.is_svg)\n\t\t\t\tthis.e = svg_element(/** @type {keyof SVGElementTagNameMap} */ (target.nodeName));\n\t\t\t/** #7364  target for <template> may be provided as #document-fragment(11) */ else\n\t\t\t\tthis.e = element(\n\t\t\t\t\t/** @type {keyof HTMLElementTagNameMap} */ (\n\t\t\t\t\t\ttarget.nodeType === 11 ? 'TEMPLATE' : target.nodeName\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\tthis.t =\n\t\t\t\ttarget.tagName !== 'TEMPLATE'\n\t\t\t\t\t? target\n\t\t\t\t\t: /** @type {HTMLTemplateElement} */ (target).content;\n\t\t\tthis.c(html);\n\t\t}\n\t\tthis.i(anchor);\n\t}\n\n\t/**\n\t * @param {string} html\n\t * @returns {void}\n\t */\n\th(html) {\n\t\tthis.e.innerHTML = html;\n\t\tthis.n = Array.from(\n\t\t\tthis.e.nodeName === 'TEMPLATE' ? this.e.content.childNodes : this.e.childNodes\n\t\t);\n\t}\n\n\t/**\n\t * @returns {void} */\n\ti(anchor) {\n\t\tfor (let i = 0; i < this.n.length; i += 1) {\n\t\t\tinsert(this.t, this.n[i], anchor);\n\t\t}\n\t}\n\n\t/**\n\t * @param {string} html\n\t * @returns {void}\n\t */\n\tp(html) {\n\t\tthis.d();\n\t\tthis.h(html);\n\t\tthis.i(this.a);\n\t}\n\n\t/**\n\t * @returns {void} */\n\td() {\n\t\tthis.n.forEach(detach);\n\t}\n}\n\nexport class HtmlTagHydration extends HtmlTag {\n\t/** @type {Element[]} hydration claimed nodes */\n\tl = undefined;\n\n\tconstructor(is_svg = false, claimed_nodes) {\n\t\tsuper(is_svg);\n\t\tthis.e = this.n = null;\n\t\tthis.l = claimed_nodes;\n\t}\n\n\t/**\n\t * @param {string} html\n\t * @returns {void}\n\t */\n\tc(html) {\n\t\tif (this.l) {\n\t\t\tthis.n = this.l;\n\t\t} else {\n\t\t\tsuper.c(html);\n\t\t}\n\t}\n\n\t/**\n\t * @returns {void} */\n\ti(anchor) {\n\t\tfor (let i = 0; i < this.n.length; i += 1) {\n\t\t\tinsert_hydration(this.t, this.n[i], anchor);\n\t\t}\n\t}\n}\n\n/**\n * @param {NamedNodeMap} attributes\n * @returns {{}}\n */\nexport function attribute_to_object(attributes) {\n\tconst result = {};\n\tfor (const attribute of attributes) {\n\t\tresult[attribute.name] = attribute.value;\n\t}\n\treturn result;\n}\n\nconst escaped = {\n\t'\"': '&quot;',\n\t'&': '&amp;',\n\t'<': '&lt;'\n};\n\nconst regex_attribute_characters_to_escape = /[\"&<]/g;\n\n/**\n * Note that the attribute itself should be surrounded in double quotes\n * @param {any} attribute\n */\nfunction escape_attribute(attribute) {\n\treturn String(attribute).replace(regex_attribute_characters_to_escape, (match) => escaped[match]);\n}\n\n/**\n * @param {Record<string, string>} attributes\n */\nexport function stringify_spread(attributes) {\n\tlet str = ' ';\n\tfor (const key in attributes) {\n\t\tif (attributes[key] != null) {\n\t\t\tstr += `${key}=\"${escape_attribute(attributes[key])}\" `;\n\t\t}\n\t}\n\n\treturn str;\n}\n\n/**\n * @param {HTMLElement} element\n * @returns {{}}\n */\nexport function get_custom_elements_slots(element) {\n\tconst result = {};\n\telement.childNodes.forEach(\n\t\t/** @param {Element} node */ (node) => {\n\t\t\tresult[node.slot || 'default'] = true;\n\t\t}\n\t);\n\treturn result;\n}\n\nexport function construct_svelte_component(component, props) {\n\treturn new component(props);\n}\n\n/**\n * @typedef {Node & {\n * \tclaim_order?: number;\n * \thydrate_init?: true;\n * \tactual_end_child?: NodeEx;\n * \tchildNodes: NodeListOf<NodeEx>;\n * }} NodeEx\n */\n\n/** @typedef {ChildNode & NodeEx} ChildNodeEx */\n\n/** @typedef {NodeEx & { claim_order: number }} NodeEx2 */\n\n/**\n * @typedef {ChildNodeEx[] & {\n * \tclaim_info?: {\n * \t\tlast_index: number;\n * \t\ttotal_claimed: number;\n * \t};\n * }} ChildNodeArray\n */\n","import { append_empty_stylesheet, detach, get_root_for_style } from './dom.js';\nimport { raf } from './environment.js';\n\n// we need to store the information for multiple documents because a Svelte application could also contain iframes\n// https://github.com/sveltejs/svelte/issues/3624\n/** @type {Map<Document | ShadowRoot, import('./private.d.ts').StyleInformation>} */\nconst managed_styles = new Map();\n\nlet active = 0;\n\n// https://github.com/darkskyapp/string-hash/blob/master/index.js\n/**\n * @param {string} str\n * @returns {number}\n */\nfunction hash(str) {\n\tlet hash = 5381;\n\tlet i = str.length;\n\twhile (i--) hash = ((hash << 5) - hash) ^ str.charCodeAt(i);\n\treturn hash >>> 0;\n}\n\n/**\n * @param {Document | ShadowRoot} doc\n * @param {Element & ElementCSSInlineStyle} node\n * @returns {{ stylesheet: any; rules: {}; }}\n */\nfunction create_style_information(doc, node) {\n\tconst info = { stylesheet: append_empty_stylesheet(node), rules: {} };\n\tmanaged_styles.set(doc, info);\n\treturn info;\n}\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {number} a\n * @param {number} b\n * @param {number} duration\n * @param {number} delay\n * @param {(t: number) => number} ease\n * @param {(t: number, u: number) => string} fn\n * @param {number} uid\n * @returns {string}\n */\nexport function create_rule(node, a, b, duration, delay, ease, fn, uid = 0) {\n\tconst step = 16.666 / duration;\n\tlet keyframes = '{\\n';\n\tfor (let p = 0; p <= 1; p += step) {\n\t\tconst t = a + (b - a) * ease(p);\n\t\tkeyframes += p * 100 + `%{${fn(t, 1 - t)}}\\n`;\n\t}\n\tconst rule = keyframes + `100% {${fn(b, 1 - b)}}\\n}`;\n\tconst name = `__svelte_${hash(rule)}_${uid}`;\n\tconst doc = get_root_for_style(node);\n\tconst { stylesheet, rules } = managed_styles.get(doc) || create_style_information(doc, node);\n\tif (!rules[name]) {\n\t\trules[name] = true;\n\t\tstylesheet.insertRule(`@keyframes ${name} ${rule}`, stylesheet.cssRules.length);\n\t}\n\tconst animation = node.style.animation || '';\n\tnode.style.animation = `${\n\t\tanimation ? `${animation}, ` : ''\n\t}${name} ${duration}ms linear ${delay}ms 1 both`;\n\tactive += 1;\n\treturn name;\n}\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {string} [name]\n * @returns {void}\n */\nexport function delete_rule(node, name) {\n\tconst previous = (node.style.animation || '').split(', ');\n\tconst next = previous.filter(\n\t\tname\n\t\t\t? (anim) => anim.indexOf(name) < 0 // remove specific animation\n\t\t\t: (anim) => anim.indexOf('__svelte') === -1 // remove all Svelte animations\n\t);\n\tconst deleted = previous.length - next.length;\n\tif (deleted) {\n\t\tnode.style.animation = next.join(', ');\n\t\tactive -= deleted;\n\t\tif (!active) clear_rules();\n\t}\n}\n\n/** @returns {void} */\nexport function clear_rules() {\n\traf(() => {\n\t\tif (active) return;\n\t\tmanaged_styles.forEach((info) => {\n\t\t\tconst { ownerNode } = info.stylesheet;\n\t\t\t// there is no ownerNode if it runs on jsdom.\n\t\t\tif (ownerNode) detach(ownerNode);\n\t\t});\n\t\tmanaged_styles.clear();\n\t});\n}\n","import { custom_event } from './dom.js';\n\nexport let current_component;\n\n/** @returns {void} */\nexport function set_current_component(component) {\n\tcurrent_component = component;\n}\n\nexport function get_current_component() {\n\tif (!current_component) throw new Error('Function called outside component initialization');\n\treturn current_component;\n}\n\n/**\n * Schedules a callback to run immediately before the component is updated after any state change.\n *\n * The first time the callback runs will be before the initial `onMount`\n *\n * https://svelte.dev/docs/svelte#beforeupdate\n * @param {() => any} fn\n * @returns {void}\n */\nexport function beforeUpdate(fn) {\n\tget_current_component().$$.before_update.push(fn);\n}\n\n/**\n * The `onMount` function schedules a callback to run as soon as the component has been mounted to the DOM.\n * It must be called during the component's initialisation (but doesn't need to live *inside* the component;\n * it can be called from an external module).\n *\n * If a function is returned _synchronously_ from `onMount`, it will be called when the component is unmounted.\n *\n * `onMount` does not run inside a [server-side component](https://svelte.dev/docs#run-time-server-side-component-api).\n *\n * https://svelte.dev/docs/svelte#onmount\n * @template T\n * @param {() => import('./private.js').NotFunction<T> | Promise<import('./private.js').NotFunction<T>> | (() => any)} fn\n * @returns {void}\n */\nexport function onMount(fn) {\n\tget_current_component().$$.on_mount.push(fn);\n}\n\n/**\n * Schedules a callback to run immediately after the component has been updated.\n *\n * The first time the callback runs will be after the initial `onMount`\n *\n * https://svelte.dev/docs/svelte#afterupdate\n * @param {() => any} fn\n * @returns {void}\n */\nexport function afterUpdate(fn) {\n\tget_current_component().$$.after_update.push(fn);\n}\n\n/**\n * Schedules a callback to run immediately before the component is unmounted.\n *\n * Out of `onMount`, `beforeUpdate`, `afterUpdate` and `onDestroy`, this is the\n * only one that runs inside a server-side component.\n *\n * https://svelte.dev/docs/svelte#ondestroy\n * @param {() => any} fn\n * @returns {void}\n */\nexport function onDestroy(fn) {\n\tget_current_component().$$.on_destroy.push(fn);\n}\n\n/**\n * Creates an event dispatcher that can be used to dispatch [component events](https://svelte.dev/docs#template-syntax-component-directives-on-eventname).\n * Event dispatchers are functions that can take two arguments: `name` and `detail`.\n *\n * Component events created with `createEventDispatcher` create a\n * [CustomEvent](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent).\n * These events do not [bubble](https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Building_blocks/Events#Event_bubbling_and_capture).\n * The `detail` argument corresponds to the [CustomEvent.detail](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/detail)\n * property and can contain any type of data.\n *\n * The event dispatcher can be typed to narrow the allowed event names and the type of the `detail` argument:\n * ```ts\n * const dispatch = createEventDispatcher<{\n *  loaded: never; // does not take a detail argument\n *  change: string; // takes a detail argument of type string, which is required\n *  optional: number | null; // takes an optional detail argument of type number\n * }>();\n * ```\n *\n * https://svelte.dev/docs/svelte#createeventdispatcher\n * @template {Record<string, any>} [EventMap=any]\n * @returns {import('./public.js').EventDispatcher<EventMap>}\n */\nexport function createEventDispatcher() {\n\tconst component = get_current_component();\n\treturn (type, detail, { cancelable = false } = {}) => {\n\t\tconst callbacks = component.$$.callbacks[type];\n\t\tif (callbacks) {\n\t\t\t// TODO are there situations where events could be dispatched\n\t\t\t// in a server (non-DOM) environment?\n\t\t\tconst event = custom_event(/** @type {string} */ (type), detail, { cancelable });\n\t\t\tcallbacks.slice().forEach((fn) => {\n\t\t\t\tfn.call(component, event);\n\t\t\t});\n\t\t\treturn !event.defaultPrevented;\n\t\t}\n\t\treturn true;\n\t};\n}\n\n/**\n * Associates an arbitrary `context` object with the current component and the specified `key`\n * and returns that object. The context is then available to children of the component\n * (including slotted content) with `getContext`.\n *\n * Like lifecycle functions, this must be called during component initialisation.\n *\n * https://svelte.dev/docs/svelte#setcontext\n * @template T\n * @param {any} key\n * @param {T} context\n * @returns {T}\n */\nexport function setContext(key, context) {\n\tget_current_component().$$.context.set(key, context);\n\treturn context;\n}\n\n/**\n * Retrieves the context that belongs to the closest parent component with the specified `key`.\n * Must be called during component initialisation.\n *\n * https://svelte.dev/docs/svelte#getcontext\n * @template T\n * @param {any} key\n * @returns {T}\n */\nexport function getContext(key) {\n\treturn get_current_component().$$.context.get(key);\n}\n\n/**\n * Retrieves the whole context map that belongs to the closest parent component.\n * Must be called during component initialisation. Useful, for example, if you\n * programmatically create a component and want to pass the existing context to it.\n *\n * https://svelte.dev/docs/svelte#getallcontexts\n * @template {Map<any, any>} [T=Map<any, any>]\n * @returns {T}\n */\nexport function getAllContexts() {\n\treturn get_current_component().$$.context;\n}\n\n/**\n * Checks whether a given `key` has been set in the context of a parent component.\n * Must be called during component initialisation.\n *\n * https://svelte.dev/docs/svelte#hascontext\n * @param {any} key\n * @returns {boolean}\n */\nexport function hasContext(key) {\n\treturn get_current_component().$$.context.has(key);\n}\n\n// TODO figure out if we still want to support\n// shorthand events, or if we want to implement\n// a real bubbling mechanism\n/**\n * @param component\n * @param event\n * @returns {void}\n */\nexport function bubble(component, event) {\n\tconst callbacks = component.$$.callbacks[event.type];\n\tif (callbacks) {\n\t\t// @ts-ignore\n\t\tcallbacks.slice().forEach((fn) => fn.call(this, event));\n\t}\n}\n","import { run_all } from './utils.js';\nimport { current_component, set_current_component } from './lifecycle.js';\n\nexport const dirty_components = [];\nexport const intros = { enabled: false };\nexport const binding_callbacks = [];\n\nlet render_callbacks = [];\n\nconst flush_callbacks = [];\n\nconst resolved_promise = /* @__PURE__ */ Promise.resolve();\n\nlet update_scheduled = false;\n\n/** @returns {void} */\nexport function schedule_update() {\n\tif (!update_scheduled) {\n\t\tupdate_scheduled = true;\n\t\tresolved_promise.then(flush);\n\t}\n}\n\n/** @returns {Promise<void>} */\nexport function tick() {\n\tschedule_update();\n\treturn resolved_promise;\n}\n\n/** @returns {void} */\nexport function add_render_callback(fn) {\n\trender_callbacks.push(fn);\n}\n\n/** @returns {void} */\nexport function add_flush_callback(fn) {\n\tflush_callbacks.push(fn);\n}\n\n// flush() calls callbacks in this order:\n// 1. All beforeUpdate callbacks, in order: parents before children\n// 2. All bind:this callbacks, in reverse order: children before parents.\n// 3. All afterUpdate callbacks, in order: parents before children. EXCEPT\n//    for afterUpdates called during the initial onMount, which are called in\n//    reverse order: children before parents.\n// Since callbacks might update component values, which could trigger another\n// call to flush(), the following steps guard against this:\n// 1. During beforeUpdate, any updated components will be added to the\n//    dirty_components array and will cause a reentrant call to flush(). Because\n//    the flush index is kept outside the function, the reentrant call will pick\n//    up where the earlier call left off and go through all dirty components. The\n//    current_component value is saved and restored so that the reentrant call will\n//    not interfere with the \"parent\" flush() call.\n// 2. bind:this callbacks cannot trigger new flush() calls.\n// 3. During afterUpdate, any updated components will NOT have their afterUpdate\n//    callback called a second time; the seen_callbacks set, outside the flush()\n//    function, guarantees this behavior.\nconst seen_callbacks = new Set();\n\nlet flushidx = 0; // Do *not* move this inside the flush() function\n\n/** @returns {void} */\nexport function flush() {\n\t// Do not reenter flush while dirty components are updated, as this can\n\t// result in an infinite loop. Instead, let the inner flush handle it.\n\t// Reentrancy is ok afterwards for bindings etc.\n\tif (flushidx !== 0) {\n\t\treturn;\n\t}\n\tconst saved_component = current_component;\n\tdo {\n\t\t// first, call beforeUpdate functions\n\t\t// and update components\n\t\ttry {\n\t\t\twhile (flushidx < dirty_components.length) {\n\t\t\t\tconst component = dirty_components[flushidx];\n\t\t\t\tflushidx++;\n\t\t\t\tset_current_component(component);\n\t\t\t\tupdate(component.$$);\n\t\t\t}\n\t\t} catch (e) {\n\t\t\t// reset dirty state to not end up in a deadlocked state and then rethrow\n\t\t\tdirty_components.length = 0;\n\t\t\tflushidx = 0;\n\t\t\tthrow e;\n\t\t}\n\t\tset_current_component(null);\n\t\tdirty_components.length = 0;\n\t\tflushidx = 0;\n\t\twhile (binding_callbacks.length) binding_callbacks.pop()();\n\t\t// then, once components are updated, call\n\t\t// afterUpdate functions. This may cause\n\t\t// subsequent updates...\n\t\tfor (let i = 0; i < render_callbacks.length; i += 1) {\n\t\t\tconst callback = render_callbacks[i];\n\t\t\tif (!seen_callbacks.has(callback)) {\n\t\t\t\t// ...so guard against infinite loops\n\t\t\t\tseen_callbacks.add(callback);\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t\trender_callbacks.length = 0;\n\t} while (dirty_components.length);\n\twhile (flush_callbacks.length) {\n\t\tflush_callbacks.pop()();\n\t}\n\tupdate_scheduled = false;\n\tseen_callbacks.clear();\n\tset_current_component(saved_component);\n}\n\n/** @returns {void} */\nfunction update($$) {\n\tif ($$.fragment !== null) {\n\t\t$$.update();\n\t\trun_all($$.before_update);\n\t\tconst dirty = $$.dirty;\n\t\t$$.dirty = [-1];\n\t\t$$.fragment && $$.fragment.p($$.ctx, dirty);\n\t\t$$.after_update.forEach(add_render_callback);\n\t}\n}\n\n/**\n * Useful for example to execute remaining `afterUpdate` callbacks before executing `destroy`.\n * @param {Function[]} fns\n * @returns {void}\n */\nexport function flush_render_callbacks(fns) {\n\tconst filtered = [];\n\tconst targets = [];\n\trender_callbacks.forEach((c) => (fns.indexOf(c) === -1 ? filtered.push(c) : targets.push(c)));\n\ttargets.forEach((c) => c());\n\trender_callbacks = filtered;\n}\n","import { identity as linear, is_function, noop, run_all } from './utils.js';\nimport { now } from './environment.js';\nimport { loop } from './loop.js';\nimport { create_rule, delete_rule } from './style_manager.js';\nimport { custom_event } from './dom.js';\nimport { add_render_callback } from './scheduler.js';\n\n/**\n * @type {Promise<void> | null}\n */\nlet promise;\n\n/**\n * @returns {Promise<void>}\n */\nfunction wait() {\n\tif (!promise) {\n\t\tpromise = Promise.resolve();\n\t\tpromise.then(() => {\n\t\t\tpromise = null;\n\t\t});\n\t}\n\treturn promise;\n}\n\n/**\n * @param {Element} node\n * @param {INTRO | OUTRO | boolean} direction\n * @param {'start' | 'end'} kind\n * @returns {void}\n */\nfunction dispatch(node, direction, kind) {\n\tnode.dispatchEvent(custom_event(`${direction ? 'intro' : 'outro'}${kind}`));\n}\n\nconst outroing = new Set();\n\n/**\n * @type {Outro}\n */\nlet outros;\n\n/**\n * @returns {void} */\nexport function group_outros() {\n\toutros = {\n\t\tr: 0,\n\t\tc: [],\n\t\tp: outros // parent group\n\t};\n}\n\n/**\n * @returns {void} */\nexport function check_outros() {\n\tif (!outros.r) {\n\t\trun_all(outros.c);\n\t}\n\toutros = outros.p;\n}\n\n/**\n * @param {import('./private.js').Fragment} block\n * @param {0 | 1} [local]\n * @returns {void}\n */\nexport function transition_in(block, local) {\n\tif (block && block.i) {\n\t\toutroing.delete(block);\n\t\tblock.i(local);\n\t}\n}\n\n/**\n * @param {import('./private.js').Fragment} block\n * @param {0 | 1} local\n * @param {0 | 1} [detach]\n * @param {() => void} [callback]\n * @returns {void}\n */\nexport function transition_out(block, local, detach, callback) {\n\tif (block && block.o) {\n\t\tif (outroing.has(block)) return;\n\t\toutroing.add(block);\n\t\toutros.c.push(() => {\n\t\t\toutroing.delete(block);\n\t\t\tif (callback) {\n\t\t\t\tif (detach) block.d(1);\n\t\t\t\tcallback();\n\t\t\t}\n\t\t});\n\t\tblock.o(local);\n\t} else if (callback) {\n\t\tcallback();\n\t}\n}\n\n/**\n * @type {import('../transition/public.js').TransitionConfig}\n */\nconst null_transition = { duration: 0 };\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {TransitionFn} fn\n * @param {any} params\n * @returns {{ start(): void; invalidate(): void; end(): void; }}\n */\nexport function create_in_transition(node, fn, params) {\n\t/**\n\t * @type {TransitionOptions} */\n\tconst options = { direction: 'in' };\n\tlet config = fn(node, params, options);\n\tlet running = false;\n\tlet animation_name;\n\tlet task;\n\tlet uid = 0;\n\n\t/**\n\t * @returns {void} */\n\tfunction cleanup() {\n\t\tif (animation_name) delete_rule(node, animation_name);\n\t}\n\n\t/**\n\t * @returns {void} */\n\tfunction go() {\n\t\tconst {\n\t\t\tdelay = 0,\n\t\t\tduration = 300,\n\t\t\teasing = linear,\n\t\t\ttick = noop,\n\t\t\tcss\n\t\t} = config || null_transition;\n\t\tif (css) animation_name = create_rule(node, 0, 1, duration, delay, easing, css, uid++);\n\t\ttick(0, 1);\n\t\tconst start_time = now() + delay;\n\t\tconst end_time = start_time + duration;\n\t\tif (task) task.abort();\n\t\trunning = true;\n\t\tadd_render_callback(() => dispatch(node, true, 'start'));\n\t\ttask = loop((now) => {\n\t\t\tif (running) {\n\t\t\t\tif (now >= end_time) {\n\t\t\t\t\ttick(1, 0);\n\t\t\t\t\tdispatch(node, true, 'end');\n\t\t\t\t\tcleanup();\n\t\t\t\t\treturn (running = false);\n\t\t\t\t}\n\t\t\t\tif (now >= start_time) {\n\t\t\t\t\tconst t = easing((now - start_time) / duration);\n\t\t\t\t\ttick(t, 1 - t);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn running;\n\t\t});\n\t}\n\tlet started = false;\n\treturn {\n\t\tstart() {\n\t\t\tif (started) return;\n\t\t\tstarted = true;\n\t\t\tdelete_rule(node);\n\t\t\tif (is_function(config)) {\n\t\t\t\tconfig = config(options);\n\t\t\t\twait().then(go);\n\t\t\t} else {\n\t\t\t\tgo();\n\t\t\t}\n\t\t},\n\t\tinvalidate() {\n\t\t\tstarted = false;\n\t\t},\n\t\tend() {\n\t\t\tif (running) {\n\t\t\t\tcleanup();\n\t\t\t\trunning = false;\n\t\t\t}\n\t\t}\n\t};\n}\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {TransitionFn} fn\n * @param {any} params\n * @returns {{ end(reset: any): void; }}\n */\nexport function create_out_transition(node, fn, params) {\n\t/** @type {TransitionOptions} */\n\tconst options = { direction: 'out' };\n\tlet config = fn(node, params, options);\n\tlet running = true;\n\tlet animation_name;\n\tconst group = outros;\n\tgroup.r += 1;\n\t/** @type {boolean} */\n\tlet original_inert_value;\n\n\t/**\n\t * @returns {void} */\n\tfunction go() {\n\t\tconst {\n\t\t\tdelay = 0,\n\t\t\tduration = 300,\n\t\t\teasing = linear,\n\t\t\ttick = noop,\n\t\t\tcss\n\t\t} = config || null_transition;\n\n\t\tif (css) animation_name = create_rule(node, 1, 0, duration, delay, easing, css);\n\n\t\tconst start_time = now() + delay;\n\t\tconst end_time = start_time + duration;\n\t\tadd_render_callback(() => dispatch(node, false, 'start'));\n\n\t\tif ('inert' in node) {\n\t\t\toriginal_inert_value = /** @type {HTMLElement} */ (node).inert;\n\t\t\tnode.inert = true;\n\t\t}\n\n\t\tloop((now) => {\n\t\t\tif (running) {\n\t\t\t\tif (now >= end_time) {\n\t\t\t\t\ttick(0, 1);\n\t\t\t\t\tdispatch(node, false, 'end');\n\t\t\t\t\tif (!--group.r) {\n\t\t\t\t\t\t// this will result in `end()` being called,\n\t\t\t\t\t\t// so we don't need to clean up here\n\t\t\t\t\t\trun_all(group.c);\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (now >= start_time) {\n\t\t\t\t\tconst t = easing((now - start_time) / duration);\n\t\t\t\t\ttick(1 - t, t);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn running;\n\t\t});\n\t}\n\n\tif (is_function(config)) {\n\t\twait().then(() => {\n\t\t\t// @ts-ignore\n\t\t\tconfig = config(options);\n\t\t\tgo();\n\t\t});\n\t} else {\n\t\tgo();\n\t}\n\n\treturn {\n\t\tend(reset) {\n\t\t\tif (reset && 'inert' in node) {\n\t\t\t\tnode.inert = original_inert_value;\n\t\t\t}\n\t\t\tif (reset && config.tick) {\n\t\t\t\tconfig.tick(1, 0);\n\t\t\t}\n\t\t\tif (running) {\n\t\t\t\tif (animation_name) delete_rule(node, animation_name);\n\t\t\t\trunning = false;\n\t\t\t}\n\t\t}\n\t};\n}\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {TransitionFn} fn\n * @param {any} params\n * @param {boolean} intro\n * @returns {{ run(b: 0 | 1): void; end(): void; }}\n */\nexport function create_bidirectional_transition(node, fn, params, intro) {\n\t/**\n\t * @type {TransitionOptions} */\n\tconst options = { direction: 'both' };\n\tlet config = fn(node, params, options);\n\tlet t = intro ? 0 : 1;\n\n\t/**\n\t * @type {Program | null} */\n\tlet running_program = null;\n\n\t/**\n\t * @type {PendingProgram | null} */\n\tlet pending_program = null;\n\tlet animation_name = null;\n\n\t/** @type {boolean} */\n\tlet original_inert_value;\n\n\t/**\n\t * @returns {void} */\n\tfunction clear_animation() {\n\t\tif (animation_name) delete_rule(node, animation_name);\n\t}\n\n\t/**\n\t * @param {PendingProgram} program\n\t * @param {number} duration\n\t * @returns {Program}\n\t */\n\tfunction init(program, duration) {\n\t\tconst d = /** @type {Program['d']} */ (program.b - t);\n\t\tduration *= Math.abs(d);\n\t\treturn {\n\t\t\ta: t,\n\t\t\tb: program.b,\n\t\t\td,\n\t\t\tduration,\n\t\t\tstart: program.start,\n\t\t\tend: program.start + duration,\n\t\t\tgroup: program.group\n\t\t};\n\t}\n\n\t/**\n\t * @param {INTRO | OUTRO} b\n\t * @returns {void}\n\t */\n\tfunction go(b) {\n\t\tconst {\n\t\t\tdelay = 0,\n\t\t\tduration = 300,\n\t\t\teasing = linear,\n\t\t\ttick = noop,\n\t\t\tcss\n\t\t} = config || null_transition;\n\n\t\t/**\n\t\t * @type {PendingProgram} */\n\t\tconst program = {\n\t\t\tstart: now() + delay,\n\t\t\tb\n\t\t};\n\n\t\tif (!b) {\n\t\t\t// @ts-ignore todo: improve typings\n\t\t\tprogram.group = outros;\n\t\t\toutros.r += 1;\n\t\t}\n\n\t\tif ('inert' in node) {\n\t\t\tif (b) {\n\t\t\t\tif (original_inert_value !== undefined) {\n\t\t\t\t\t// aborted/reversed outro  restore previous inert value\n\t\t\t\t\tnode.inert = original_inert_value;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\toriginal_inert_value = /** @type {HTMLElement} */ (node).inert;\n\t\t\t\tnode.inert = true;\n\t\t\t}\n\t\t}\n\n\t\tif (running_program || pending_program) {\n\t\t\tpending_program = program;\n\t\t} else {\n\t\t\t// if this is an intro, and there's a delay, we need to do\n\t\t\t// an initial tick and/or apply CSS animation immediately\n\t\t\tif (css) {\n\t\t\t\tclear_animation();\n\t\t\t\tanimation_name = create_rule(node, t, b, duration, delay, easing, css);\n\t\t\t}\n\t\t\tif (b) tick(0, 1);\n\t\t\trunning_program = init(program, duration);\n\t\t\tadd_render_callback(() => dispatch(node, b, 'start'));\n\t\t\tloop((now) => {\n\t\t\t\tif (pending_program && now > pending_program.start) {\n\t\t\t\t\trunning_program = init(pending_program, duration);\n\t\t\t\t\tpending_program = null;\n\t\t\t\t\tdispatch(node, running_program.b, 'start');\n\t\t\t\t\tif (css) {\n\t\t\t\t\t\tclear_animation();\n\t\t\t\t\t\tanimation_name = create_rule(\n\t\t\t\t\t\t\tnode,\n\t\t\t\t\t\t\tt,\n\t\t\t\t\t\t\trunning_program.b,\n\t\t\t\t\t\t\trunning_program.duration,\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\teasing,\n\t\t\t\t\t\t\tconfig.css\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (running_program) {\n\t\t\t\t\tif (now >= running_program.end) {\n\t\t\t\t\t\ttick((t = running_program.b), 1 - t);\n\t\t\t\t\t\tdispatch(node, running_program.b, 'end');\n\t\t\t\t\t\tif (!pending_program) {\n\t\t\t\t\t\t\t// we're done\n\t\t\t\t\t\t\tif (running_program.b) {\n\t\t\t\t\t\t\t\t// intro  we can tidy up immediately\n\t\t\t\t\t\t\t\tclear_animation();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// outro  needs to be coordinated\n\t\t\t\t\t\t\t\tif (!--running_program.group.r) run_all(running_program.group.c);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\trunning_program = null;\n\t\t\t\t\t} else if (now >= running_program.start) {\n\t\t\t\t\t\tconst p = now - running_program.start;\n\t\t\t\t\t\tt = running_program.a + running_program.d * easing(p / running_program.duration);\n\t\t\t\t\t\ttick(t, 1 - t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn !!(running_program || pending_program);\n\t\t\t});\n\t\t}\n\t}\n\treturn {\n\t\trun(b) {\n\t\t\tif (is_function(config)) {\n\t\t\t\twait().then(() => {\n\t\t\t\t\tconst opts = { direction: b ? 'in' : 'out' };\n\t\t\t\t\t// @ts-ignore\n\t\t\t\t\tconfig = config(opts);\n\t\t\t\t\tgo(b);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tgo(b);\n\t\t\t}\n\t\t},\n\t\tend() {\n\t\t\tclear_animation();\n\t\t\trunning_program = pending_program = null;\n\t\t}\n\t};\n}\n\n/** @typedef {1} INTRO */\n/** @typedef {0} OUTRO */\n/** @typedef {{ direction: 'in' | 'out' | 'both' }} TransitionOptions */\n/** @typedef {(node: Element, params: any, options: TransitionOptions) => import('../transition/public.js').TransitionConfig} TransitionFn */\n\n/**\n * @typedef {Object} Outro\n * @property {number} r\n * @property {Function[]} c\n * @property {Object} p\n */\n\n/**\n * @typedef {Object} PendingProgram\n * @property {number} start\n * @property {INTRO|OUTRO} b\n * @property {Outro} [group]\n */\n\n/**\n * @typedef {Object} Program\n * @property {number} a\n * @property {INTRO|OUTRO} b\n * @property {1|-1} d\n * @property {number} duration\n * @property {number} start\n * @property {number} end\n * @property {Outro} [group]\n */\n","import { transition_in, transition_out } from './transitions.js';\nimport { run_all } from './utils.js';\n\n// general each functions:\n\nexport function ensure_array_like(array_like_or_iterator) {\n\treturn array_like_or_iterator?.length !== undefined\n\t\t? array_like_or_iterator\n\t\t: Array.from(array_like_or_iterator);\n}\n\n// keyed each functions:\n\n/** @returns {void} */\nexport function destroy_block(block, lookup) {\n\tblock.d(1);\n\tlookup.delete(block.key);\n}\n\n/** @returns {void} */\nexport function outro_and_destroy_block(block, lookup) {\n\ttransition_out(block, 1, 1, () => {\n\t\tlookup.delete(block.key);\n\t});\n}\n\n/** @returns {void} */\nexport function fix_and_destroy_block(block, lookup) {\n\tblock.f();\n\tdestroy_block(block, lookup);\n}\n\n/** @returns {void} */\nexport function fix_and_outro_and_destroy_block(block, lookup) {\n\tblock.f();\n\toutro_and_destroy_block(block, lookup);\n}\n\n/** @returns {any[]} */\nexport function update_keyed_each(\n\told_blocks,\n\tdirty,\n\tget_key,\n\tdynamic,\n\tctx,\n\tlist,\n\tlookup,\n\tnode,\n\tdestroy,\n\tcreate_each_block,\n\tnext,\n\tget_context\n) {\n\tlet o = old_blocks.length;\n\tlet n = list.length;\n\tlet i = o;\n\tconst old_indexes = {};\n\twhile (i--) old_indexes[old_blocks[i].key] = i;\n\tconst new_blocks = [];\n\tconst new_lookup = new Map();\n\tconst deltas = new Map();\n\tconst updates = [];\n\ti = n;\n\twhile (i--) {\n\t\tconst child_ctx = get_context(ctx, list, i);\n\t\tconst key = get_key(child_ctx);\n\t\tlet block = lookup.get(key);\n\t\tif (!block) {\n\t\t\tblock = create_each_block(key, child_ctx);\n\t\t\tblock.c();\n\t\t} else if (dynamic) {\n\t\t\t// defer updates until all the DOM shuffling is done\n\t\t\tupdates.push(() => block.p(child_ctx, dirty));\n\t\t}\n\t\tnew_lookup.set(key, (new_blocks[i] = block));\n\t\tif (key in old_indexes) deltas.set(key, Math.abs(i - old_indexes[key]));\n\t}\n\tconst will_move = new Set();\n\tconst did_move = new Set();\n\t/** @returns {void} */\n\tfunction insert(block) {\n\t\ttransition_in(block, 1);\n\t\tblock.m(node, next);\n\t\tlookup.set(block.key, block);\n\t\tnext = block.first;\n\t\tn--;\n\t}\n\twhile (o && n) {\n\t\tconst new_block = new_blocks[n - 1];\n\t\tconst old_block = old_blocks[o - 1];\n\t\tconst new_key = new_block.key;\n\t\tconst old_key = old_block.key;\n\t\tif (new_block === old_block) {\n\t\t\t// do nothing\n\t\t\tnext = new_block.first;\n\t\t\to--;\n\t\t\tn--;\n\t\t} else if (!new_lookup.has(old_key)) {\n\t\t\t// remove old block\n\t\t\tdestroy(old_block, lookup);\n\t\t\to--;\n\t\t} else if (!lookup.has(new_key) || will_move.has(new_key)) {\n\t\t\tinsert(new_block);\n\t\t} else if (did_move.has(old_key)) {\n\t\t\to--;\n\t\t} else if (deltas.get(new_key) > deltas.get(old_key)) {\n\t\t\tdid_move.add(new_key);\n\t\t\tinsert(new_block);\n\t\t} else {\n\t\t\twill_move.add(old_key);\n\t\t\to--;\n\t\t}\n\t}\n\twhile (o--) {\n\t\tconst old_block = old_blocks[o];\n\t\tif (!new_lookup.has(old_block.key)) destroy(old_block, lookup);\n\t}\n\twhile (n) insert(new_blocks[n - 1]);\n\trun_all(updates);\n\treturn new_blocks;\n}\n\n/** @returns {void} */\nexport function validate_each_keys(ctx, list, get_context, get_key) {\n\tconst keys = new Map();\n\tfor (let i = 0; i < list.length; i++) {\n\t\tconst key = get_key(get_context(ctx, list, i));\n\t\tif (keys.has(key)) {\n\t\t\tlet value = '';\n\t\t\ttry {\n\t\t\t\tvalue = `with value '${String(key)}' `;\n\t\t\t} catch (e) {\n\t\t\t\t// can't stringify\n\t\t\t}\n\t\t\tthrow new Error(\n\t\t\t\t`Cannot have duplicate keys in a keyed each: Keys at index ${keys.get(\n\t\t\t\t\tkey\n\t\t\t\t)} and ${i} ${value}are duplicates`\n\t\t\t);\n\t\t}\n\t\tkeys.set(key, i);\n\t}\n}\n","/** @returns {{}} */\nexport function get_spread_update(levels, updates) {\n\tconst update = {};\n\tconst to_null_out = {};\n\tconst accounted_for = { $$scope: 1 };\n\tlet i = levels.length;\n\twhile (i--) {\n\t\tconst o = levels[i];\n\t\tconst n = updates[i];\n\t\tif (n) {\n\t\t\tfor (const key in o) {\n\t\t\t\tif (!(key in n)) to_null_out[key] = 1;\n\t\t\t}\n\t\t\tfor (const key in n) {\n\t\t\t\tif (!accounted_for[key]) {\n\t\t\t\t\tupdate[key] = n[key];\n\t\t\t\t\taccounted_for[key] = 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tlevels[i] = n;\n\t\t} else {\n\t\t\tfor (const key in o) {\n\t\t\t\taccounted_for[key] = 1;\n\t\t\t}\n\t\t}\n\t}\n\tfor (const key in to_null_out) {\n\t\tif (!(key in update)) update[key] = undefined;\n\t}\n\treturn update;\n}\n\nexport function get_spread_object(spread_props) {\n\treturn typeof spread_props === 'object' && spread_props !== null ? spread_props : {};\n}\n","import {\n\tadd_render_callback,\n\tflush,\n\tflush_render_callbacks,\n\tschedule_update,\n\tdirty_components\n} from './scheduler.js';\nimport { current_component, set_current_component } from './lifecycle.js';\nimport { blank_object, is_empty, is_function, run, run_all, noop } from './utils.js';\nimport {\n\tchildren,\n\tdetach,\n\tstart_hydrating,\n\tend_hydrating,\n\tget_custom_elements_slots,\n\tinsert,\n\telement,\n\tattr\n} from './dom.js';\nimport { transition_in } from './transitions.js';\n\n/** @returns {void} */\nexport function bind(component, name, callback) {\n\tconst index = component.$$.props[name];\n\tif (index !== undefined) {\n\t\tcomponent.$$.bound[index] = callback;\n\t\tcallback(component.$$.ctx[index]);\n\t}\n}\n\n/** @returns {void} */\nexport function create_component(block) {\n\tblock && block.c();\n}\n\n/** @returns {void} */\nexport function claim_component(block, parent_nodes) {\n\tblock && block.l(parent_nodes);\n}\n\n/** @returns {void} */\nexport function mount_component(component, target, anchor) {\n\tconst { fragment, after_update } = component.$$;\n\tfragment && fragment.m(target, anchor);\n\t// onMount happens before the initial afterUpdate\n\tadd_render_callback(() => {\n\t\tconst new_on_destroy = component.$$.on_mount.map(run).filter(is_function);\n\t\t// if the component was destroyed immediately\n\t\t// it will update the `$$.on_destroy` reference to `null`.\n\t\t// the destructured on_destroy may still reference to the old array\n\t\tif (component.$$.on_destroy) {\n\t\t\tcomponent.$$.on_destroy.push(...new_on_destroy);\n\t\t} else {\n\t\t\t// Edge case - component was destroyed immediately,\n\t\t\t// most likely as a result of a binding initialising\n\t\t\trun_all(new_on_destroy);\n\t\t}\n\t\tcomponent.$$.on_mount = [];\n\t});\n\tafter_update.forEach(add_render_callback);\n}\n\n/** @returns {void} */\nexport function destroy_component(component, detaching) {\n\tconst $$ = component.$$;\n\tif ($$.fragment !== null) {\n\t\tflush_render_callbacks($$.after_update);\n\t\trun_all($$.on_destroy);\n\t\t$$.fragment && $$.fragment.d(detaching);\n\t\t// TODO null out other refs, including component.$$ (but need to\n\t\t// preserve final state?)\n\t\t$$.on_destroy = $$.fragment = null;\n\t\t$$.ctx = [];\n\t}\n}\n\n/** @returns {void} */\nfunction make_dirty(component, i) {\n\tif (component.$$.dirty[0] === -1) {\n\t\tdirty_components.push(component);\n\t\tschedule_update();\n\t\tcomponent.$$.dirty.fill(0);\n\t}\n\tcomponent.$$.dirty[(i / 31) | 0] |= 1 << i % 31;\n}\n\n// TODO: Document the other params\n/**\n * @param {SvelteComponent} component\n * @param {import('./public.js').ComponentConstructorOptions} options\n *\n * @param {import('./utils.js')['not_equal']} not_equal Used to compare props and state values.\n * @param {(target: Element | ShadowRoot) => void} [append_styles] Function that appends styles to the DOM when the component is first initialised.\n * This will be the `add_css` function from the compiled component.\n *\n * @returns {void}\n */\nexport function init(\n\tcomponent,\n\toptions,\n\tinstance,\n\tcreate_fragment,\n\tnot_equal,\n\tprops,\n\tappend_styles = null,\n\tdirty = [-1]\n) {\n\tconst parent_component = current_component;\n\tset_current_component(component);\n\t/** @type {import('./private.js').T$$} */\n\tconst $$ = (component.$$ = {\n\t\tfragment: null,\n\t\tctx: [],\n\t\t// state\n\t\tprops,\n\t\tupdate: noop,\n\t\tnot_equal,\n\t\tbound: blank_object(),\n\t\t// lifecycle\n\t\ton_mount: [],\n\t\ton_destroy: [],\n\t\ton_disconnect: [],\n\t\tbefore_update: [],\n\t\tafter_update: [],\n\t\tcontext: new Map(options.context || (parent_component ? parent_component.$$.context : [])),\n\t\t// everything else\n\t\tcallbacks: blank_object(),\n\t\tdirty,\n\t\tskip_bound: false,\n\t\troot: options.target || parent_component.$$.root\n\t});\n\tappend_styles && append_styles($$.root);\n\tlet ready = false;\n\t$$.ctx = instance\n\t\t? instance(component, options.props || {}, (i, ret, ...rest) => {\n\t\t\t\tconst value = rest.length ? rest[0] : ret;\n\t\t\t\tif ($$.ctx && not_equal($$.ctx[i], ($$.ctx[i] = value))) {\n\t\t\t\t\tif (!$$.skip_bound && $$.bound[i]) $$.bound[i](value);\n\t\t\t\t\tif (ready) make_dirty(component, i);\n\t\t\t\t}\n\t\t\t\treturn ret;\n\t\t  })\n\t\t: [];\n\t$$.update();\n\tready = true;\n\trun_all($$.before_update);\n\t// `false` as a special case of no DOM component\n\t$$.fragment = create_fragment ? create_fragment($$.ctx) : false;\n\tif (options.target) {\n\t\tif (options.hydrate) {\n\t\t\tstart_hydrating();\n\t\t\t// TODO: what is the correct type here?\n\t\t\t// @ts-expect-error\n\t\t\tconst nodes = children(options.target);\n\t\t\t$$.fragment && $$.fragment.l(nodes);\n\t\t\tnodes.forEach(detach);\n\t\t} else {\n\t\t\t// eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n\t\t\t$$.fragment && $$.fragment.c();\n\t\t}\n\t\tif (options.intro) transition_in(component.$$.fragment);\n\t\tmount_component(component, options.target, options.anchor);\n\t\tend_hydrating();\n\t\tflush();\n\t}\n\tset_current_component(parent_component);\n}\n\nexport let SvelteElement;\n\nif (typeof HTMLElement === 'function') {\n\tSvelteElement = class extends HTMLElement {\n\t\t/** The Svelte component constructor */\n\t\t$$ctor;\n\t\t/** Slots */\n\t\t$$s;\n\t\t/** The Svelte component instance */\n\t\t$$c;\n\t\t/** Whether or not the custom element is connected */\n\t\t$$cn = false;\n\t\t/** Component props data */\n\t\t$$d = {};\n\t\t/** `true` if currently in the process of reflecting component props back to attributes */\n\t\t$$r = false;\n\t\t/** @type {Record<string, CustomElementPropDefinition>} Props definition (name, reflected, type etc) */\n\t\t$$p_d = {};\n\t\t/** @type {Record<string, Function[]>} Event listeners */\n\t\t$$l = {};\n\t\t/** @type {Map<Function, Function>} Event listener unsubscribe functions */\n\t\t$$l_u = new Map();\n\n\t\tconstructor($$componentCtor, $$slots, use_shadow_dom) {\n\t\t\tsuper();\n\t\t\tthis.$$ctor = $$componentCtor;\n\t\t\tthis.$$s = $$slots;\n\t\t\tif (use_shadow_dom) {\n\t\t\t\tthis.attachShadow({ mode: 'open' });\n\t\t\t}\n\t\t}\n\n\t\taddEventListener(type, listener, options) {\n\t\t\t// We can't determine upfront if the event is a custom event or not, so we have to\n\t\t\t// listen to both. If someone uses a custom event with the same name as a regular\n\t\t\t// browser event, this fires twice - we can't avoid that.\n\t\t\tthis.$$l[type] = this.$$l[type] || [];\n\t\t\tthis.$$l[type].push(listener);\n\t\t\tif (this.$$c) {\n\t\t\t\tconst unsub = this.$$c.$on(type, listener);\n\t\t\t\tthis.$$l_u.set(listener, unsub);\n\t\t\t}\n\t\t\tsuper.addEventListener(type, listener, options);\n\t\t}\n\n\t\tremoveEventListener(type, listener, options) {\n\t\t\tsuper.removeEventListener(type, listener, options);\n\t\t\tif (this.$$c) {\n\t\t\t\tconst unsub = this.$$l_u.get(listener);\n\t\t\t\tif (unsub) {\n\t\t\t\t\tunsub();\n\t\t\t\t\tthis.$$l_u.delete(listener);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tasync connectedCallback() {\n\t\t\tthis.$$cn = true;\n\t\t\tif (!this.$$c) {\n\t\t\t\t// We wait one tick to let possible child slot elements be created/mounted\n\t\t\t\tawait Promise.resolve();\n\t\t\t\tif (!this.$$cn || this.$$c) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tfunction create_slot(name) {\n\t\t\t\t\treturn () => {\n\t\t\t\t\t\tlet node;\n\t\t\t\t\t\tconst obj = {\n\t\t\t\t\t\t\tc: function create() {\n\t\t\t\t\t\t\t\tnode = element('slot');\n\t\t\t\t\t\t\t\tif (name !== 'default') {\n\t\t\t\t\t\t\t\t\tattr(node, 'name', name);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t/**\n\t\t\t\t\t\t\t * @param {HTMLElement} target\n\t\t\t\t\t\t\t * @param {HTMLElement} [anchor]\n\t\t\t\t\t\t\t */\n\t\t\t\t\t\t\tm: function mount(target, anchor) {\n\t\t\t\t\t\t\t\tinsert(target, node, anchor);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\td: function destroy(detaching) {\n\t\t\t\t\t\t\t\tif (detaching) {\n\t\t\t\t\t\t\t\t\tdetach(node);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\treturn obj;\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tconst $$slots = {};\n\t\t\t\tconst existing_slots = get_custom_elements_slots(this);\n\t\t\t\tfor (const name of this.$$s) {\n\t\t\t\t\tif (name in existing_slots) {\n\t\t\t\t\t\t$$slots[name] = [create_slot(name)];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (const attribute of this.attributes) {\n\t\t\t\t\t// this.$$data takes precedence over this.attributes\n\t\t\t\t\tconst name = this.$$g_p(attribute.name);\n\t\t\t\t\tif (!(name in this.$$d)) {\n\t\t\t\t\t\tthis.$$d[name] = get_custom_element_value(name, attribute.value, this.$$p_d, 'toProp');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Port over props that were set programmatically before ce was initialized\n\t\t\t\tfor (const key in this.$$p_d) {\n\t\t\t\t\tif (!(key in this.$$d) && this[key] !== undefined) {\n\t\t\t\t\t\tthis.$$d[key] = this[key]; // don't transform, these were set through JavaScript\n\t\t\t\t\t\tdelete this[key]; // remove the property that shadows the getter/setter\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.$$c = new this.$$ctor({\n\t\t\t\t\ttarget: this.shadowRoot || this,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\t...this.$$d,\n\t\t\t\t\t\t$$slots,\n\t\t\t\t\t\t$$scope: {\n\t\t\t\t\t\t\tctx: []\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// Reflect component props as attributes\n\t\t\t\tconst reflect_attributes = () => {\n\t\t\t\t\tthis.$$r = true;\n\t\t\t\t\tfor (const key in this.$$p_d) {\n\t\t\t\t\t\tthis.$$d[key] = this.$$c.$$.ctx[this.$$c.$$.props[key]];\n\t\t\t\t\t\tif (this.$$p_d[key].reflect) {\n\t\t\t\t\t\t\tconst attribute_value = get_custom_element_value(\n\t\t\t\t\t\t\t\tkey,\n\t\t\t\t\t\t\t\tthis.$$d[key],\n\t\t\t\t\t\t\t\tthis.$$p_d,\n\t\t\t\t\t\t\t\t'toAttribute'\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tif (attribute_value == null) {\n\t\t\t\t\t\t\t\tthis.removeAttribute(this.$$p_d[key].attribute || key);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.setAttribute(this.$$p_d[key].attribute || key, attribute_value);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.$$r = false;\n\t\t\t\t};\n\t\t\t\tthis.$$c.$$.after_update.push(reflect_attributes);\n\t\t\t\treflect_attributes(); // once initially because after_update is added too late for first render\n\n\t\t\t\tfor (const type in this.$$l) {\n\t\t\t\t\tfor (const listener of this.$$l[type]) {\n\t\t\t\t\t\tconst unsub = this.$$c.$on(type, listener);\n\t\t\t\t\t\tthis.$$l_u.set(listener, unsub);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.$$l = {};\n\t\t\t}\n\t\t}\n\n\t\t// We don't need this when working within Svelte code, but for compatibility of people using this outside of Svelte\n\t\t// and setting attributes through setAttribute etc, this is helpful\n\t\tattributeChangedCallback(attr, _oldValue, newValue) {\n\t\t\tif (this.$$r) return;\n\t\t\tattr = this.$$g_p(attr);\n\t\t\tthis.$$d[attr] = get_custom_element_value(attr, newValue, this.$$p_d, 'toProp');\n\t\t\tthis.$$c?.$set({ [attr]: this.$$d[attr] });\n\t\t}\n\n\t\tdisconnectedCallback() {\n\t\t\tthis.$$cn = false;\n\t\t\t// In a microtask, because this could be a move within the DOM\n\t\t\tPromise.resolve().then(() => {\n\t\t\t\tif (!this.$$cn) {\n\t\t\t\t\tthis.$$c.$destroy();\n\t\t\t\t\tthis.$$c = undefined;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t$$g_p(attribute_name) {\n\t\t\treturn (\n\t\t\t\tObject.keys(this.$$p_d).find(\n\t\t\t\t\t(key) =>\n\t\t\t\t\t\tthis.$$p_d[key].attribute === attribute_name ||\n\t\t\t\t\t\t(!this.$$p_d[key].attribute && key.toLowerCase() === attribute_name)\n\t\t\t\t) || attribute_name\n\t\t\t);\n\t\t}\n\t};\n}\n\n/**\n * @param {string} prop\n * @param {any} value\n * @param {Record<string, CustomElementPropDefinition>} props_definition\n * @param {'toAttribute' | 'toProp'} [transform]\n */\nfunction get_custom_element_value(prop, value, props_definition, transform) {\n\tconst type = props_definition[prop]?.type;\n\tvalue = type === 'Boolean' && typeof value !== 'boolean' ? value != null : value;\n\tif (!transform || !props_definition[prop]) {\n\t\treturn value;\n\t} else if (transform === 'toAttribute') {\n\t\tswitch (type) {\n\t\t\tcase 'Object':\n\t\t\tcase 'Array':\n\t\t\t\treturn value == null ? null : JSON.stringify(value);\n\t\t\tcase 'Boolean':\n\t\t\t\treturn value ? '' : null;\n\t\t\tcase 'Number':\n\t\t\t\treturn value == null ? null : value;\n\t\t\tdefault:\n\t\t\t\treturn value;\n\t\t}\n\t} else {\n\t\tswitch (type) {\n\t\t\tcase 'Object':\n\t\t\tcase 'Array':\n\t\t\t\treturn value && JSON.parse(value);\n\t\t\tcase 'Boolean':\n\t\t\t\treturn value; // conversion already handled above\n\t\t\tcase 'Number':\n\t\t\t\treturn value != null ? +value : value;\n\t\t\tdefault:\n\t\t\t\treturn value;\n\t\t}\n\t}\n}\n\n/**\n * @internal\n *\n * Turn a Svelte component into a custom element.\n * @param {import('./public.js').ComponentType} Component  A Svelte component constructor\n * @param {Record<string, CustomElementPropDefinition>} props_definition  The props to observe\n * @param {string[]} slots  The slots to create\n * @param {string[]} accessors  Other accessors besides the ones for props the component has\n * @param {boolean} use_shadow_dom  Whether to use shadow DOM\n * @param {(ce: new () => HTMLElement) => new () => HTMLElement} [extend]\n */\nexport function create_custom_element(\n\tComponent,\n\tprops_definition,\n\tslots,\n\taccessors,\n\tuse_shadow_dom,\n\textend\n) {\n\tlet Class = class extends SvelteElement {\n\t\tconstructor() {\n\t\t\tsuper(Component, slots, use_shadow_dom);\n\t\t\tthis.$$p_d = props_definition;\n\t\t}\n\t\tstatic get observedAttributes() {\n\t\t\treturn Object.keys(props_definition).map((key) =>\n\t\t\t\t(props_definition[key].attribute || key).toLowerCase()\n\t\t\t);\n\t\t}\n\t};\n\tObject.keys(props_definition).forEach((prop) => {\n\t\tObject.defineProperty(Class.prototype, prop, {\n\t\t\tget() {\n\t\t\t\treturn this.$$c && prop in this.$$c ? this.$$c[prop] : this.$$d[prop];\n\t\t\t},\n\t\t\tset(value) {\n\t\t\t\tvalue = get_custom_element_value(prop, value, props_definition);\n\t\t\t\tthis.$$d[prop] = value;\n\t\t\t\tthis.$$c?.$set({ [prop]: value });\n\t\t\t}\n\t\t});\n\t});\n\taccessors.forEach((accessor) => {\n\t\tObject.defineProperty(Class.prototype, accessor, {\n\t\t\tget() {\n\t\t\t\treturn this.$$c?.[accessor];\n\t\t\t}\n\t\t});\n\t});\n\tif (extend) {\n\t\t// @ts-expect-error - assigning here is fine\n\t\tClass = extend(Class);\n\t}\n\tComponent.element = /** @type {any} */ (Class);\n\treturn Class;\n}\n\n/**\n * Base class for Svelte components. Used when dev=false.\n *\n * @template {Record<string, any>} [Props=any]\n * @template {Record<string, any>} [Events=any]\n */\nexport class SvelteComponent {\n\t/**\n\t * ### PRIVATE API\n\t *\n\t * Do not use, may change at any time\n\t *\n\t * @type {any}\n\t */\n\t$$ = undefined;\n\t/**\n\t * ### PRIVATE API\n\t *\n\t * Do not use, may change at any time\n\t *\n\t * @type {any}\n\t */\n\t$$set = undefined;\n\n\t/** @returns {void} */\n\t$destroy() {\n\t\tdestroy_component(this, 1);\n\t\tthis.$destroy = noop;\n\t}\n\n\t/**\n\t * @template {Extract<keyof Events, string>} K\n\t * @param {K} type\n\t * @param {((e: Events[K]) => void) | null | undefined} callback\n\t * @returns {() => void}\n\t */\n\t$on(type, callback) {\n\t\tif (!is_function(callback)) {\n\t\t\treturn noop;\n\t\t}\n\t\tconst callbacks = this.$$.callbacks[type] || (this.$$.callbacks[type] = []);\n\t\tcallbacks.push(callback);\n\t\treturn () => {\n\t\t\tconst index = callbacks.indexOf(callback);\n\t\t\tif (index !== -1) callbacks.splice(index, 1);\n\t\t};\n\t}\n\n\t/**\n\t * @param {Partial<Props>} props\n\t * @returns {void}\n\t */\n\t$set(props) {\n\t\tif (this.$$set && !is_empty(props)) {\n\t\t\tthis.$$.skip_bound = true;\n\t\t\tthis.$$set(props);\n\t\t\tthis.$$.skip_bound = false;\n\t\t}\n\t}\n}\n\n/**\n * @typedef {Object} CustomElementPropDefinition\n * @property {string} [attribute]\n * @property {boolean} [reflect]\n * @property {'String'|'Boolean'|'Number'|'Array'|'Object'} [type]\n */\n","/**\n * Create a lightweight debug function to log output into the browser console.\n *\n * Inspired by https://github.com/visionmedia/debug (some code is copied below)\n *\n * Usage:\n *\n *     import { createDebug } from './debug.js'\n *\n *     const debug = createDebug('my:namespace')\n *\n *     debug('testing:', 2 + 2)\n *\n * By default, logging is only enabled when a property DEBUG is set in the\n * localStorage of your browser:\n *\n *     localStorage['debug'] = '*'\n *     localStorage['debug'] = 'jsoneditor:*'\n *     localStorage['debug'] = 'jsoneditor:TreeMode'\n *\n * The actual value of 'debug' is used to filter the debug messages.\n * The value can end with a '*' wild card to match any remaining text.\n *\n * By providing a value for `enabled`, you can choose conditions to\n * enable/disable debugging if you want, for example some flag determining\n * whether in development or production.\n */\nexport function createDebug(\n  namespace: string,\n  enabled = enableDebug(namespace)\n): (...args: unknown[]) => void {\n  if (!enabled) {\n    return noop\n  }\n\n  const color = selectColor(namespace)\n\n  return function debug(...args) {\n    console.log(`%c${namespace}`, `color:${color}`, ...args)\n  }\n}\n\nfunction enableDebug(namespace: string) {\n  const debug = tryReadLocalStorage('debug')\n\n  return debug?.endsWith('*') ? namespace.startsWith(debug.slice(0, -1)) : namespace === debug\n}\n\nfunction noop() {\n  // no operation\n}\n\n/**\n * Try read a specific key from localStorage\n */\nfunction tryReadLocalStorage(key: string): string | undefined {\n  try {\n    if (typeof window !== 'undefined' && typeof window.localStorage !== 'undefined') {\n      // reading local storage can fail for example because of security restrictions\n      return window.localStorage[key]\n    }\n  } catch (error) {\n    // we do nothing with the error, not needed in this specific case\n  }\n}\n\n/**\n * Selects a color for a debug namespace\n *\n * Code is copied from the following source: https://github.com/visionmedia/debug\n *\n * @param namespace The namespace string for the debug instance to be colored\n * @return An ANSI color code for the given namespace\n */\nfunction selectColor(namespace: string): string {\n  let hash = 0\n\n  for (let i = 0; i < namespace.length; i++) {\n    hash = (hash << 5) - hash + namespace.charCodeAt(i)\n    hash |= 0 // Convert to 32bit integer\n  }\n\n  return colors[Math.abs(hash) % colors.length]\n}\n\nconst colors = [\n  '#0000CC',\n  '#0099FF',\n  '#009400',\n  '#8dd200',\n  '#CCCC00',\n  '#CC9933',\n  '#ae04e7',\n  '#ff35d7',\n  '#FF3333',\n  '#FF6600',\n  '#FF9933',\n  '#FFCC33'\n]\n","import { PUBLIC_VERSION } from '../../../shared/version.js';\n\nif (typeof window !== 'undefined')\n\t// @ts-ignore\n\t(window.__svelte || (window.__svelte = { v: new Set() })).v.add(PUBLIC_VERSION);\n","// generated during release, do not modify\n\n/**\n * The current version, as set in package.json.\n *\n * https://svelte.dev/docs/svelte-compiler#svelte-version\n * @type {string}\n */\nexport const VERSION = '4.2.12';\nexport const PUBLIC_VERSION = '4';\n","import { cubicOut, cubicInOut, linear } from '../easing/index.js';\nimport { assign, split_css_unit, is_function } from '../internal/index.js';\n\n/**\n * Animates a `blur` filter alongside an element's opacity.\n *\n * https://svelte.dev/docs/svelte-transition#blur\n * @param {Element} node\n * @param {import('./public').BlurParams} [params]\n * @returns {import('./public').TransitionConfig}\n */\nexport function blur(\n\tnode,\n\t{ delay = 0, duration = 400, easing = cubicInOut, amount = 5, opacity = 0 } = {}\n) {\n\tconst style = getComputedStyle(node);\n\tconst target_opacity = +style.opacity;\n\tconst f = style.filter === 'none' ? '' : style.filter;\n\tconst od = target_opacity * (1 - opacity);\n\tconst [value, unit] = split_css_unit(amount);\n\treturn {\n\t\tdelay,\n\t\tduration,\n\t\teasing,\n\t\tcss: (_t, u) => `opacity: ${target_opacity - od * u}; filter: ${f} blur(${u * value}${unit});`\n\t};\n}\n\n/**\n * Animates the opacity of an element from 0 to the current opacity for `in` transitions and from the current opacity to 0 for `out` transitions.\n *\n * https://svelte.dev/docs/svelte-transition#fade\n * @param {Element} node\n * @param {import('./public').FadeParams} [params]\n * @returns {import('./public').TransitionConfig}\n */\nexport function fade(node, { delay = 0, duration = 400, easing = linear } = {}) {\n\tconst o = +getComputedStyle(node).opacity;\n\treturn {\n\t\tdelay,\n\t\tduration,\n\t\teasing,\n\t\tcss: (t) => `opacity: ${t * o}`\n\t};\n}\n\n/**\n * Animates the x and y positions and the opacity of an element. `in` transitions animate from the provided values, passed as parameters to the element's default values. `out` transitions animate from the element's default values to the provided values.\n *\n * https://svelte.dev/docs/svelte-transition#fly\n * @param {Element} node\n * @param {import('./public').FlyParams} [params]\n * @returns {import('./public').TransitionConfig}\n */\nexport function fly(\n\tnode,\n\t{ delay = 0, duration = 400, easing = cubicOut, x = 0, y = 0, opacity = 0 } = {}\n) {\n\tconst style = getComputedStyle(node);\n\tconst target_opacity = +style.opacity;\n\tconst transform = style.transform === 'none' ? '' : style.transform;\n\tconst od = target_opacity * (1 - opacity);\n\tconst [xValue, xUnit] = split_css_unit(x);\n\tconst [yValue, yUnit] = split_css_unit(y);\n\treturn {\n\t\tdelay,\n\t\tduration,\n\t\teasing,\n\t\tcss: (t, u) => `\n\t\t\ttransform: ${transform} translate(${(1 - t) * xValue}${xUnit}, ${(1 - t) * yValue}${yUnit});\n\t\t\topacity: ${target_opacity - od * u}`\n\t};\n}\n\n/**\n * Slides an element in and out.\n *\n * https://svelte.dev/docs/svelte-transition#slide\n * @param {Element} node\n * @param {import('./public').SlideParams} [params]\n * @returns {import('./public').TransitionConfig}\n */\nexport function slide(node, { delay = 0, duration = 400, easing = cubicOut, axis = 'y' } = {}) {\n\tconst style = getComputedStyle(node);\n\tconst opacity = +style.opacity;\n\tconst primary_property = axis === 'y' ? 'height' : 'width';\n\tconst primary_property_value = parseFloat(style[primary_property]);\n\tconst secondary_properties = axis === 'y' ? ['top', 'bottom'] : ['left', 'right'];\n\tconst capitalized_secondary_properties = secondary_properties.map(\n\t\t(e) => `${e[0].toUpperCase()}${e.slice(1)}`\n\t);\n\tconst padding_start_value = parseFloat(style[`padding${capitalized_secondary_properties[0]}`]);\n\tconst padding_end_value = parseFloat(style[`padding${capitalized_secondary_properties[1]}`]);\n\tconst margin_start_value = parseFloat(style[`margin${capitalized_secondary_properties[0]}`]);\n\tconst margin_end_value = parseFloat(style[`margin${capitalized_secondary_properties[1]}`]);\n\tconst border_width_start_value = parseFloat(\n\t\tstyle[`border${capitalized_secondary_properties[0]}Width`]\n\t);\n\tconst border_width_end_value = parseFloat(\n\t\tstyle[`border${capitalized_secondary_properties[1]}Width`]\n\t);\n\treturn {\n\t\tdelay,\n\t\tduration,\n\t\teasing,\n\t\tcss: (t) =>\n\t\t\t'overflow: hidden;' +\n\t\t\t`opacity: ${Math.min(t * 20, 1) * opacity};` +\n\t\t\t`${primary_property}: ${t * primary_property_value}px;` +\n\t\t\t`padding-${secondary_properties[0]}: ${t * padding_start_value}px;` +\n\t\t\t`padding-${secondary_properties[1]}: ${t * padding_end_value}px;` +\n\t\t\t`margin-${secondary_properties[0]}: ${t * margin_start_value}px;` +\n\t\t\t`margin-${secondary_properties[1]}: ${t * margin_end_value}px;` +\n\t\t\t`border-${secondary_properties[0]}-width: ${t * border_width_start_value}px;` +\n\t\t\t`border-${secondary_properties[1]}-width: ${t * border_width_end_value}px;`\n\t};\n}\n\n/**\n * Animates the opacity and scale of an element. `in` transitions animate from an element's current (default) values to the provided values, passed as parameters. `out` transitions animate from the provided values to an element's default values.\n *\n * https://svelte.dev/docs/svelte-transition#scale\n * @param {Element} node\n * @param {import('./public').ScaleParams} [params]\n * @returns {import('./public').TransitionConfig}\n */\nexport function scale(\n\tnode,\n\t{ delay = 0, duration = 400, easing = cubicOut, start = 0, opacity = 0 } = {}\n) {\n\tconst style = getComputedStyle(node);\n\tconst target_opacity = +style.opacity;\n\tconst transform = style.transform === 'none' ? '' : style.transform;\n\tconst sd = 1 - start;\n\tconst od = target_opacity * (1 - opacity);\n\treturn {\n\t\tdelay,\n\t\tduration,\n\t\teasing,\n\t\tcss: (_t, u) => `\n\t\t\ttransform: ${transform} scale(${1 - sd * u});\n\t\t\topacity: ${target_opacity - od * u}\n\t\t`\n\t};\n}\n\n/**\n * Animates the stroke of an SVG element, like a snake in a tube. `in` transitions begin with the path invisible and draw the path to the screen over time. `out` transitions start in a visible state and gradually erase the path. `draw` only works with elements that have a `getTotalLength` method, like `<path>` and `<polyline>`.\n *\n * https://svelte.dev/docs/svelte-transition#draw\n * @param {SVGElement & { getTotalLength(): number }} node\n * @param {import('./public').DrawParams} [params]\n * @returns {import('./public').TransitionConfig}\n */\nexport function draw(node, { delay = 0, speed, duration, easing = cubicInOut } = {}) {\n\tlet len = node.getTotalLength();\n\tconst style = getComputedStyle(node);\n\tif (style.strokeLinecap !== 'butt') {\n\t\tlen += parseInt(style.strokeWidth);\n\t}\n\tif (duration === undefined) {\n\t\tif (speed === undefined) {\n\t\t\tduration = 800;\n\t\t} else {\n\t\t\tduration = len / speed;\n\t\t}\n\t} else if (typeof duration === 'function') {\n\t\tduration = duration(len);\n\t}\n\treturn {\n\t\tdelay,\n\t\tduration,\n\t\teasing,\n\t\tcss: (_, u) => `\n\t\t\tstroke-dasharray: ${len};\n\t\t\tstroke-dashoffset: ${u * len};\n\t\t`\n\t};\n}\n\n/**\n * The `crossfade` function creates a pair of [transitions](https://svelte.dev/docs#template-syntax-element-directives-transition-fn) called `send` and `receive`. When an element is 'sent', it looks for a corresponding element being 'received', and generates a transition that transforms the element to its counterpart's position and fades it out. When an element is 'received', the reverse happens. If there is no counterpart, the `fallback` transition is used.\n *\n * https://svelte.dev/docs/svelte-transition#crossfade\n * @param {import('./public').CrossfadeParams & {\n * \tfallback?: (node: Element, params: import('./public').CrossfadeParams, intro: boolean) => import('./public').TransitionConfig;\n * }} params\n * @returns {[(node: any, params: import('./public').CrossfadeParams & { key: any; }) => () => import('./public').TransitionConfig, (node: any, params: import('./public').CrossfadeParams & { key: any; }) => () => import('./public').TransitionConfig]}\n */\nexport function crossfade({ fallback, ...defaults }) {\n\t/** @type {Map<any, Element>} */\n\tconst to_receive = new Map();\n\t/** @type {Map<any, Element>} */\n\tconst to_send = new Map();\n\t/**\n\t * @param {Element} from_node\n\t * @param {Element} node\n\t * @param {import('./public').CrossfadeParams} params\n\t * @returns {import('./public').TransitionConfig}\n\t */\n\tfunction crossfade(from_node, node, params) {\n\t\tconst {\n\t\t\tdelay = 0,\n\t\t\tduration = (d) => Math.sqrt(d) * 30,\n\t\t\teasing = cubicOut\n\t\t} = assign(assign({}, defaults), params);\n\t\tconst from = from_node.getBoundingClientRect();\n\t\tconst to = node.getBoundingClientRect();\n\t\tconst dx = from.left - to.left;\n\t\tconst dy = from.top - to.top;\n\t\tconst dw = from.width / to.width;\n\t\tconst dh = from.height / to.height;\n\t\tconst d = Math.sqrt(dx * dx + dy * dy);\n\t\tconst style = getComputedStyle(node);\n\t\tconst transform = style.transform === 'none' ? '' : style.transform;\n\t\tconst opacity = +style.opacity;\n\t\treturn {\n\t\t\tdelay,\n\t\t\tduration: is_function(duration) ? duration(d) : duration,\n\t\t\teasing,\n\t\t\tcss: (t, u) => `\n\t\t\t\topacity: ${t * opacity};\n\t\t\t\ttransform-origin: top left;\n\t\t\t\ttransform: ${transform} translate(${u * dx}px,${u * dy}px) scale(${t + (1 - t) * dw}, ${\n\t\t\t\tt + (1 - t) * dh\n\t\t\t});\n\t\t\t`\n\t\t};\n\t}\n\n\t/**\n\t * @param {Map<any, Element>} items\n\t * @param {Map<any, Element>} counterparts\n\t * @param {boolean} intro\n\t * @returns {(node: any, params: import('./public').CrossfadeParams & { key: any; }) => () => import('./public').TransitionConfig}\n\t */\n\tfunction transition(items, counterparts, intro) {\n\t\treturn (node, params) => {\n\t\t\titems.set(params.key, node);\n\t\t\treturn () => {\n\t\t\t\tif (counterparts.has(params.key)) {\n\t\t\t\t\tconst other_node = counterparts.get(params.key);\n\t\t\t\t\tcounterparts.delete(params.key);\n\t\t\t\t\treturn crossfade(other_node, node, params);\n\t\t\t\t}\n\t\t\t\t// if the node is disappearing altogether\n\t\t\t\t// (i.e. wasn't claimed by the other list)\n\t\t\t\t// then we need to supply an outro\n\t\t\t\titems.delete(params.key);\n\t\t\t\treturn fallback && fallback(node, params, intro);\n\t\t\t};\n\t\t};\n\t}\n\treturn [transition(to_send, to_receive, false), transition(to_receive, to_send, true)];\n}\n","<script context=\"module\">\n  /**\n   * @typedef {typeof import('svelte').SvelteComponent | typeof import('svelte').SvelteComponent<any>} Component\n   * @typedef {import('svelte/types/runtime/transition').BlurParams} BlurParams\n   * @typedef {import('svelte/types/runtime/transition').FadeParams} FadeParams\n   * @typedef {import('svelte/types/runtime/transition').FlyParams} FlyParams\n   * @typedef {import('svelte/types/runtime/transition').SlideParams} SlideParams\n   * @typedef {import('svelte/types/runtime/transition').TransitionConfig} TransitionConfig\n   * @typedef {Record<string, string | number>} Styles\n   * @typedef {(node: Element, parameters: BlurParams | FadeParams | FlyParams | SlideParams) => TransitionConfig} TransitionFn\n   * @typedef {{ id: string | null, ariaLabel: string | null, ariaLabelledBy: string | null, closeButton: Component | boolean, closeOnEsc: boolean, closeOnOuterClick: boolean, styleBg: Styles, styleWindowWrap: Styles, styleWindow: Styles, styleContent: Styles, styleCloseButton: Styles, classBg: string | null, classWindowWrap: string | null, classWindow: string | null, classContent: string | null, classCloseButton: string | null, transitionBg: TransitionFn, transitionBgProps: BlurParams, transitionWindow: TransitionFn, transitionWindowProps: BlurParams, disableFocusTrap: boolean, isTabbable: boolean, unstyled: boolean }} Options\n   * @typedef {() => void} Callback\n   * @typedef {{ onOpen: Callback; onOpened: Callback; onClose: Callback; onClosed: Callback }} Callbacks\n   * @typedef {(NewComponent: Component, newProps?: Record<string, any>, options?: Partial<Options>, callbacks?: Partial<Callbacks>) => void} Open\n   * @typedef {(callback?: Partial<Callbacks>) => void} Close\n   * @typedef {{ open: Open, close: Close }} Context\n   */\n\n  /**\n   * Create a Svelte component with props bound to it.\n   * @type {(component: Component, props: Record<string, any>) => Component}\n   */\n  export function bind(Component, props = {}) {\n    return function ModalComponent(options) {\n      return new Component({\n        ...options,\n        props: {\n          ...props,\n          ...options.props,\n        },\n      });\n    };\n  }\n</script>\n\n<script>\n  import * as svelte from 'svelte';\n  import { fade } from 'svelte/transition';\n  import { createEventDispatcher } from 'svelte';\n\n  const dispatch = createEventDispatcher();\n\n  const baseSetContext = svelte.setContext;\n\n  /**\n   * A basic function that checks if a node is tabbale\n   */\n  const baseIsTabbable = (node) =>\n    node.tabIndex >= 0 &&\n    !node.hidden &&\n    !node.disabled &&\n    node.style.display !== 'none' &&\n    node.type !== 'hidden' &&\n    Boolean(\n      node.offsetWidth || node.offsetHeight || node.getClientRects().length\n    );\n\n  /**\n   * A function to determine if an HTML element is tabbable\n   * @type {((node: Element) => boolean)}\n   */\n  export let isTabbable = baseIsTabbable;\n\n  /**\n   * Svelte component to be shown as the modal\n   * @type {Component | null}\n   */\n  export let show = null;\n\n  /**\n   * Element ID assigned to the modal's root DOM element\n   * @type {string | null}\n   */\n  export let id = null;\n\n  /**\n   * Svelte context key to reference the simple modal context\n   * @type {string}\n   */\n  export let key = 'simple-modal';\n\n  /**\n   * Accessibility label of the modal\n   * @see https://www.w3.org/TR/wai-aria-1.1/#aria-label\n   * @type {string | null}\n   */\n  export let ariaLabel = null;\n\n  /**\n   * Element ID holding the accessibility label of the modal\n   * @see https://www.w3.org/TR/wai-aria-1.1/#aria-labelledby\n   * @type {string | null}\n   */\n  export let ariaLabelledBy = null;\n\n  /**\n   * Whether to show a close button or not\n   * @type {Component | boolean}\n   */\n  export let closeButton = true;\n\n  /**\n   * Whether to close the modal on hitting the escape key or not\n   * @type {boolean}\n   */\n  export let closeOnEsc = true;\n\n  /**\n   * Whether to close the modal upon an outside mouse click or not\n   * @type {boolean}\n   */\n  export let closeOnOuterClick = true;\n\n  /**\n   * CSS for styling the background element\n   * @type {Styles}\n   */\n  export let styleBg = {};\n\n  /**\n   * CSS for styling the window wrapper element\n   * @type {Styles}\n   */\n  export let styleWindowWrap = {};\n\n  /**\n   * CSS for styling the window element\n   * @type {Styles}\n   */\n  export let styleWindow = {};\n\n  /**\n   * CSS for styling the content element\n   * @type {Styles}\n   */\n  export let styleContent = {};\n\n  /**\n   * CSS for styling the close element\n   * @type {Styles}\n   */\n  export let styleCloseButton = {};\n\n  /**\n   * Class name for the background element\n   * @type {string | null}\n   */\n  export let classBg = null;\n\n  /**\n   * Class name for window wrapper element\n   * @type {string | null}\n   */\n  export let classWindowWrap = null;\n\n  /**\n   * Class name for window element\n   * @type {string | null}\n   */\n  export let classWindow = null;\n\n  /**\n   * Class name for content element\n   * @type {string | null}\n   */\n  export let classContent = null;\n\n  /**\n   * Class name for close element\n   * @type {string | null}\n   */\n  export let classCloseButton = null;\n\n  /**\n   * Do not apply default styles to the modal\n   * @type {boolean}\n   */\n  export let unstyled = false;\n\n  /**\n   * The setContext() function associated with this library\n   * @description If you want to bundle simple-modal with its own version of\n   * Svelte you have to pass `setContext()` from your main app to simple-modal\n   * using this parameter\n   * @see https://svelte.dev/docs#run-time-svelte-setcontext\n   * @type {<T>(key: any, context: T) => T}\n   */\n  export let setContext = baseSetContext;\n\n  /**\n   * Transition function for the background element\n   * @see https://svelte.dev/docs#transition_fn\n   * @type {TransitionFn}\n   */\n  export let transitionBg = fade;\n\n  /**\n   * Parameters for the background element transition\n   * @type {BlurParams | FadeParams | FlyParams | SlideParams}\n   */\n  export let transitionBgProps = { duration: 250 };\n\n  /**\n   * Transition function for the window element\n   * @see https://svelte.dev/docs#transition_fn\n   * @type {TransitionFn}\n   */\n  export let transitionWindow = transitionBg;\n\n  /**\n   * Parameters for the window element transition\n   * @type {BlurParams | FadeParams | FlyParams | SlideParams}\n   */\n  export let transitionWindowProps = transitionBgProps;\n\n  /**\n   * If `true` elements outside the modal can be focused\n   * @type {boolean}\n   */\n  export let disableFocusTrap = false;\n\n  const defaultState = {\n    id,\n    ariaLabel,\n    ariaLabelledBy,\n    closeButton,\n    closeOnEsc,\n    closeOnOuterClick,\n    styleBg,\n    styleWindowWrap,\n    styleWindow,\n    styleContent,\n    styleCloseButton,\n    classBg,\n    classWindowWrap,\n    classWindow,\n    classContent,\n    classCloseButton,\n    transitionBg,\n    transitionBgProps,\n    transitionWindow,\n    transitionWindowProps,\n    disableFocusTrap,\n    isTabbable,\n    unstyled,\n  };\n  let state = { ...defaultState };\n\n  let Component = null;\n\n  let background;\n  let wrap;\n  let modalWindow;\n  let scrollY;\n  let cssBg;\n  let cssWindowWrap;\n  let cssWindow;\n  let cssContent;\n  let cssCloseButton;\n  let currentTransitionBg;\n  let currentTransitionWindow;\n  let prevBodyPosition;\n  let prevBodyOverflow;\n  let prevBodyWidth;\n  let outerClickTarget;\n\n  const camelCaseToDash = (str) =>\n    str.replace(/([a-zA-Z])(?=[A-Z])/g, '$1-').toLowerCase();\n\n  const toCssString = (props) =>\n    props\n      ? Object.keys(props).reduce(\n          (str, key) => `${str}; ${camelCaseToDash(key)}: ${props[key]}`,\n          ''\n        )\n      : '';\n\n  const isFunction = (f) => !!(f && f.constructor && f.call && f.apply);\n\n  const updateStyleTransition = () => {\n    cssBg = toCssString(\n      Object.assign(\n        {},\n        {\n          width: window.innerWidth,\n          height: window.innerHeight,\n        },\n        state.styleBg\n      )\n    );\n    cssWindowWrap = toCssString(state.styleWindowWrap);\n    cssWindow = toCssString(state.styleWindow);\n    cssContent = toCssString(state.styleContent);\n    cssCloseButton = toCssString(state.styleCloseButton);\n    currentTransitionBg = state.transitionBg;\n    currentTransitionWindow = state.transitionWindow;\n  };\n\n  const toVoid = () => {};\n  let onOpen = toVoid;\n  let onClose = toVoid;\n  let onOpened = toVoid;\n  let onClosed = toVoid;\n\n  /**\n   * Open a modal.\n   * @description Calling this method will close the modal. Additionally, it\n   * allows to specify onClose and onClosed event handlers.`\n   * @type {Open}\n   */\n  const open = (NewComponent, newProps = {}, options = {}, callbacks = {}) => {\n    Component = bind(NewComponent, newProps);\n    state = { ...defaultState, ...options };\n    updateStyleTransition();\n    disableScroll();\n    onOpen = (event) => {\n      if (callbacks.onOpen) callbacks.onOpen(event);\n      /**\n       * The open event is fired right before the modal opens\n       * @event {void} open\n       */\n      dispatch('open');\n      /**\n       * The opening event is fired right before the modal opens\n       * @event {void} opening\n       * @deprecated Listen to the `open` event instead\n       */\n      dispatch('opening'); // Deprecated. Do not use!\n    };\n    onClose = (event) => {\n      if (callbacks.onClose) callbacks.onClose(event);\n      /**\n       * The close event is fired right before the modal closes\n       * @event {void} close\n       */\n      dispatch('close');\n      /**\n       * The closing event is fired right before the modal closes\n       * @event {void} closing\n       * @deprecated Listen to the `close` event instead\n       */\n      dispatch('closing'); // Deprecated. Do not use!\n    };\n    onOpened = (event) => {\n      if (callbacks.onOpened) callbacks.onOpened(event);\n      /**\n       * The opened event is fired after the modal's opening transition\n       * @event {void} opened\n       */\n      dispatch('opened');\n    };\n    onClosed = (event) => {\n      if (callbacks.onClosed) callbacks.onClosed(event);\n      /**\n       * The closed event is fired after the modal's closing transition\n       * @event {void} closed\n       */\n      dispatch('closed');\n    };\n  };\n\n  /**\n   * Close the modal.\n   * @description Calling this method will close the modal. Additionally, it\n   * allows to specify onClose and onClosed event handlers.`\n   * @type {Close}\n   */\n  const close = (callbacks = {}) => {\n    if (!Component) return;\n    onClose = callbacks.onClose || onClose;\n    onClosed = callbacks.onClosed || onClosed;\n    Component = null;\n    enableScroll();\n  };\n\n  const handleKeydown = (event) => {\n    if (state.closeOnEsc && Component && event.key === 'Escape') {\n      event.preventDefault();\n      close();\n    }\n\n    if (Component && event.key === 'Tab' && !state.disableFocusTrap) {\n      // trap focus\n      const nodes = modalWindow.querySelectorAll('*');\n      const tabbable = Array.from(nodes)\n        .filter(state.isTabbable)\n        .sort((a, b) => a.tabIndex - b.tabIndex);\n\n      let index = tabbable.indexOf(document.activeElement);\n      if (index === -1 && event.shiftKey) index = 0;\n\n      index += tabbable.length + (event.shiftKey ? -1 : 1);\n      index %= tabbable.length;\n\n      tabbable[index].focus();\n      event.preventDefault();\n    }\n  };\n\n  const handleOuterMousedown = (event) => {\n    if (\n      state.closeOnOuterClick &&\n      (event.target === background || event.target === wrap)\n    )\n      outerClickTarget = event.target;\n  };\n\n  const handleOuterMouseup = (event) => {\n    if (state.closeOnOuterClick && event.target === outerClickTarget) {\n      event.preventDefault();\n      close();\n    }\n  };\n\n  const disableScroll = () => {\n    scrollY = window.scrollY;\n    prevBodyPosition = document.body.style.position;\n    prevBodyOverflow = document.body.style.overflow;\n    prevBodyWidth = document.body.style.width;\n    document.body.style.position = 'fixed';\n    document.body.style.top = `-${scrollY}px`;\n    document.body.style.overflow = 'hidden';\n    document.body.style.width = '100%';\n  };\n\n  const enableScroll = () => {\n    document.body.style.position = prevBodyPosition || '';\n    document.body.style.top = '';\n    document.body.style.overflow = prevBodyOverflow || '';\n    document.body.style.width = prevBodyWidth || '';\n    window.scrollTo({\n      top: scrollY,\n      left: 0,\n      behavior: 'instant',\n    });\n  };\n\n  /**\n   * The exposed context methods: open() and close()\n   * @type {Context}\n   */\n  const context = { open, close };\n\n  setContext(key, context);\n\n  let isMounted = false;\n\n  $: {\n    if (isMounted) {\n      if (isFunction(show)) {\n        open(show);\n      } else {\n        close();\n      }\n    }\n  }\n\n  svelte.onDestroy(() => {\n    if (isMounted) close();\n  });\n\n  svelte.onMount(() => {\n    isMounted = true;\n  });\n</script>\n\n<svelte:window on:keydown={handleKeydown} />\n\n{#if Component}\n  <div\n    aria-hidden=\"true\"\n    id={state.id}\n    class={state.classBg}\n    class:bg={!unstyled}\n    on:mousedown={handleOuterMousedown}\n    on:mouseup={handleOuterMouseup}\n    bind:this={background}\n    transition:currentTransitionBg={state.transitionBgProps}\n    style={cssBg}\n  >\n    <div\n      class={state.classWindowWrap}\n      class:wrap={!unstyled}\n      bind:this={wrap}\n      style={cssWindowWrap}\n    >\n      <div\n        class={state.classWindow}\n        class:window={!unstyled}\n        role=\"dialog\"\n        aria-modal=\"true\"\n        aria-label={state.ariaLabelledBy ? null : state.ariaLabel || null}\n        aria-labelledby={state.ariaLabelledBy || null}\n        bind:this={modalWindow}\n        transition:currentTransitionWindow={state.transitionWindowProps}\n        on:introstart={onOpen}\n        on:outrostart={onClose}\n        on:introend={onOpened}\n        on:outroend={onClosed}\n        style={cssWindow}\n      >\n        {#if state.closeButton}\n          {#if isFunction(state.closeButton)}\n            <svelte:component this={state.closeButton} onClose={close} />\n          {:else}\n            <button\n              class={state.classCloseButton}\n              class:close={!unstyled}\n              aria-label=\"Close modal\"\n              on:click={close}\n              style={cssCloseButton}\n              type=\"button\"\n            />\n          {/if}\n        {/if}\n        <div\n          class={state.classContent}\n          class:content={!unstyled}\n          style={cssContent}\n        >\n          <svelte:component this={Component} />\n        </div>\n      </div>\n    </div>\n  </div>\n{/if}\n<slot />\n\n<style>\n  * {\n    box-sizing: border-box;\n  }\n\n  .bg {\n    position: fixed;\n    z-index: 1000;\n    top: 0;\n    left: 0;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    width: 100vw;\n    height: 100vh;\n    background: rgba(0, 0, 0, 0.66);\n  }\n\n  @supports (-webkit-touch-callout: none) {\n    body {\n      /* The hack for Safari iOS */\n      height: -webkit-fill-available;\n    }\n  }\n\n  .wrap {\n    position: relative;\n    margin: 2rem;\n    max-height: 100%;\n  }\n\n  .window {\n    position: relative;\n    width: 40rem;\n    max-width: 100%;\n    max-height: 100%;\n    margin: 2rem auto;\n    color: black;\n    border-radius: 0.5rem;\n    background: white;\n  }\n\n  .content {\n    position: relative;\n    padding: 1rem;\n    max-height: calc(100vh - 4rem);\n    overflow: auto;\n  }\n\n  .close {\n    display: block;\n    box-sizing: border-box;\n    position: absolute;\n    z-index: 1000;\n    top: 1rem;\n    right: 1rem;\n    margin: 0;\n    padding: 0;\n    width: 1.5rem;\n    height: 1.5rem;\n    border: 0;\n    color: black;\n    border-radius: 1.5rem;\n    background: white;\n    box-shadow: 0 0 0 1px black;\n    transition: transform 0.2s cubic-bezier(0.25, 0.1, 0.25, 1),\n      background 0.2s cubic-bezier(0.25, 0.1, 0.25, 1);\n    -webkit-appearance: none;\n  }\n\n  .close:before,\n  .close:after {\n    content: '';\n    display: block;\n    box-sizing: border-box;\n    position: absolute;\n    top: 50%;\n    width: 1rem;\n    height: 1px;\n    background: black;\n    transform-origin: center;\n    transition: height 0.2s cubic-bezier(0.25, 0.1, 0.25, 1),\n      background 0.2s cubic-bezier(0.25, 0.1, 0.25, 1);\n  }\n\n  .close:before {\n    -webkit-transform: translate(0, -50%) rotate(45deg);\n    -moz-transform: translate(0, -50%) rotate(45deg);\n    transform: translate(0, -50%) rotate(45deg);\n    left: 0.25rem;\n  }\n\n  .close:after {\n    -webkit-transform: translate(0, -50%) rotate(-45deg);\n    -moz-transform: translate(0, -50%) rotate(-45deg);\n    transform: translate(0, -50%) rotate(-45deg);\n    left: 0.25rem;\n  }\n\n  .close:hover {\n    background: black;\n  }\n\n  .close:hover:before,\n  .close:hover:after {\n    height: 2px;\n    background: white;\n  }\n\n  .close:focus {\n    border-color: #3399ff;\n    box-shadow: 0 0 0 2px #3399ff;\n  }\n\n  .close:active {\n    transform: scale(0.9);\n  }\n\n  .close:hover,\n  .close:focus,\n  .close:active {\n    outline: none;\n  }\n</style>\n","import type { JSONPatchDocument, JSONPath, JSONPointer } from 'immutable-json-patch'\nimport type { SvelteComponent } from 'svelte'\nimport type { IconDefinition } from '@fortawesome/free-solid-svg-icons'\nimport type { Action } from 'svelte/action'\n\nexport type TextContent = { text: string }\n\nexport type JSONContent = { json: unknown }\n\nexport type Content = JSONContent | TextContent\n\n// The `JSONParser` interface is compatible with `JSON`,\n// except that JSON.stringify is wrongly defined to return a string whilst it can return a string or undefined\n// see: https://stackoverflow.com/questions/74461780/is-the-official-type-definition-for-json-stringify-wrong\nexport interface JSONParser {\n  parse(\n    text: string,\n    reviver?: ((this: unknown, key: string, value: unknown) => unknown) | null\n  ): unknown\n\n  stringify(\n    value: unknown,\n    replacer?:\n      | ((this: unknown, key: string, value: unknown) => unknown)\n      | Array<number | string>\n      | null,\n    space?: string | number\n  ): string | undefined\n}\n\nexport interface JSONPathParser {\n  parse: (pathStr: string) => JSONPath\n  stringify: (path: JSONPath) => string\n}\n\nexport interface VisibleSection {\n  start: number\n  end: number\n}\n\nexport enum Mode {\n  text = 'text',\n  tree = 'tree',\n  table = 'table'\n}\n\nexport enum SelectionType {\n  after = 'after',\n  inside = 'inside',\n  key = 'key',\n  value = 'value',\n  multi = 'multi',\n  text = 'text' // in text mode\n}\n\nexport enum CaretType {\n  after = 'after',\n  key = 'key',\n  value = 'value',\n  inside = 'inside'\n}\n\nexport interface PathOption {\n  value: JSONPath\n  label: string\n}\n\nexport interface NumberOption {\n  value: 1 | -1\n  label: string\n}\n\nexport interface CaretPosition {\n  path: JSONPath\n  type: CaretType // TODO: refactor this to use SelectionType here, then we can simplify the util functions to turn this into a selection\n}\n\nexport interface DocumentState {\n  expandedMap: JSONPointerMap<boolean>\n  enforceStringMap: JSONPointerMap<boolean>\n  visibleSectionsMap: JSONPointerMap<VisibleSection[]>\n  selection: JSONSelection | null\n  sortedColumn: SortedColumn | null\n}\n\nexport interface JSONPatchResult {\n  json: unknown\n  previousJson: unknown\n  undo: JSONPatchDocument\n  redo: JSONPatchDocument\n}\n\nexport type AfterPatchCallback = (\n  patchedJson: unknown,\n  patchedState: DocumentState\n) => { json?: unknown; state?: DocumentState } | undefined\n\nexport interface MultiSelection {\n  type: SelectionType.multi\n  anchorPath: JSONPath\n  focusPath: JSONPath\n}\n\nexport interface AfterSelection {\n  type: SelectionType.after\n  path: JSONPath\n}\n\nexport interface InsideSelection {\n  type: SelectionType.inside\n  path: JSONPath\n}\n\nexport interface KeySelection {\n  type: SelectionType.key\n  path: JSONPath\n  edit?: boolean\n}\n\nexport interface ValueSelection {\n  type: SelectionType.value\n  path: JSONPath\n  edit?: boolean\n}\n\nexport type JSONSelection =\n  | MultiSelection\n  | AfterSelection\n  | InsideSelection\n  | KeySelection\n  | ValueSelection\n\n// TextSelection is the result of EditorSelection.toJSON() from CodeMirror,\n// with an additional `type` property\nexport interface TextSelection {\n  type: SelectionType.text\n  ranges: { anchor: number; head: number }[]\n  main: number\n}\n\nexport type JSONEditorSelection = JSONSelection | TextSelection\n\nexport type JSONPointerMap<T> = Record<JSONPointer, T>\n\nexport type ClipboardValues = Array<{ key: string; value: unknown }>\n\nexport interface MenuButton {\n  type: 'button'\n  onClick: (event: MouseEvent) => void\n  icon?: IconDefinition\n  text?: string\n  title?: string\n  className?: string\n  disabled?: boolean\n}\n\nexport interface MenuDropDownButton {\n  type: 'dropdown-button'\n  main: MenuButton\n  width?: string\n  items: MenuButton[]\n}\n\nexport interface MenuLabel {\n  type: 'label'\n  text: string\n}\n\nexport interface MenuSeparator {\n  type: 'separator'\n}\n\nexport interface MenuSpace {\n  type: 'space'\n}\n\nexport type MenuItem = MenuButton | MenuSeparator | MenuSpace\n\nexport interface ContextMenuColumn {\n  type: 'column'\n  items: Array<MenuButton | MenuDropDownButton | MenuLabel | MenuSeparator>\n}\nexport interface ContextMenuRow {\n  type: 'row'\n  items: Array<MenuButton | MenuDropDownButton | ContextMenuColumn>\n}\nexport type ContextMenuItem = MenuButton | MenuDropDownButton | MenuSeparator | ContextMenuRow\n\nexport interface MessageAction {\n  text: string\n  title: string\n  icon?: IconDefinition\n  onClick?: () => void\n  onMouseDown?: () => void\n  disabled?: boolean\n}\n\nexport enum ValidationSeverity {\n  info = 'info',\n  warning = 'warning',\n  error = 'error'\n}\n\nexport interface ValidationError {\n  path: JSONPath\n  message: string\n  severity: ValidationSeverity\n}\n\nexport interface NestedValidationError extends ValidationError {\n  isChildError?: boolean\n}\n\nexport type Validator = (json: unknown) => ValidationError[]\n\nexport interface ParseError {\n  position: number | null\n  line: number | null\n  column: number | null\n  message: string\n}\n\nexport interface ContentParseError {\n  parseError: ParseError\n  isRepairable: boolean\n}\n\nexport interface ContentValidationErrors {\n  validationErrors: ValidationError[]\n}\n\nexport type ContentErrors = ContentParseError | ContentValidationErrors\n\nexport interface RichValidationError extends ValidationError {\n  line: number | null\n  column: number | null\n  from: number | null\n  to: number | null\n  actions: Array<{ name: string; apply: () => void }> | null\n}\n\nexport interface TextLocation {\n  path: JSONPath\n  line: number\n  column: number\n  from: number\n  to: number\n}\n\nexport interface Section {\n  start: number // start included\n  end: number // end excluded\n}\n\nexport interface QueryLanguage {\n  id: string\n  name: string\n  description: string\n  createQuery: (json: unknown, queryOptions: QueryLanguageOptions) => string\n  executeQuery: (json: unknown, query: string, parser: JSONParser) => unknown\n}\n\nexport interface QueryLanguageOptions {\n  filter?: {\n    path?: JSONPath\n    relation?: '==' | '!=' | '<' | '<=' | '>' | '>='\n    value?: string\n  }\n  sort?: {\n    path?: JSONPath\n    direction?: 'asc' | 'desc'\n  }\n  projection?: {\n    paths?: JSONPath[]\n  }\n}\n\nexport type OnChangeQueryLanguage = (queryLanguageId: string) => void\nexport interface OnChangeStatus {\n  contentErrors: ContentErrors | null\n  patchResult: JSONPatchResult | null\n}\nexport type OnChange =\n  | ((content: Content, previousContent: Content, status: OnChangeStatus) => void)\n  | null\nexport type OnJSONSelect = (selection: JSONSelection) => void\nexport type OnSelect = (selection: JSONEditorSelection | null) => void\nexport type OnPatch = (\n  operations: JSONPatchDocument,\n  afterPatch?: AfterPatchCallback\n) => JSONPatchResult\nexport type OnChangeText = (updatedText: string, afterPatch?: AfterPatchCallback) => void\nexport type OnSort = (params: {\n  operations: JSONPatchDocument\n  rootPath: JSONPath\n  itemPath: JSONPath\n  direction: 1 | -1\n}) => void\nexport type OnFind = (findAndReplace: boolean) => void\nexport type OnPaste = (pastedText: string) => void\nexport type OnPasteJson = (pastedJson: { path: JSONPath; contents: unknown }) => void\nexport type OnExpand = (path: JSONPath) => boolean\nexport type OnRenderValue = (props: RenderValueProps) => RenderValueComponentDescription[]\nexport type OnClassName = (path: JSONPath, value: unknown) => string | undefined\nexport type OnChangeMode = (mode: Mode) => void\nexport type OnContextMenu = (contextMenuProps: AbsolutePopupOptions) => void\nexport type RenderMenuContext = {\n  mode: Mode\n  modal: boolean\n  readOnly: boolean\n}\nexport type OnRenderMenu = (items: MenuItem[], context: RenderMenuContext) => MenuItem[] | undefined\nexport type OnRenderMenuInternal = (items: MenuItem[]) => MenuItem[]\nexport type RenderContextMenuContext = RenderMenuContext & { selection: JSONEditorSelection | null }\nexport type OnRenderContextMenu = (\n  items: ContextMenuItem[],\n  context: RenderContextMenuContext\n) => ContextMenuItem[] | false | undefined\nexport type OnRenderContextMenuInternal = (items: ContextMenuItem[]) => ContextMenuItem[] | false\nexport type OnError = (error: Error) => void\nexport type OnFocus = () => void\nexport type OnBlur = () => void\nexport type OnSortModal = (props: SortModalCallback) => void\nexport type OnTransformModal = (props: TransformModalCallback) => void\nexport type OnJSONEditorModal = (props: JSONEditorModalCallback) => void\nexport type FindNextInside = (path: JSONPath) => JSONSelection | null\n\nexport interface SearchResult {\n  items: ExtendedSearchResultItem[]\n  itemsMap: JSONPointerMap<ExtendedSearchResultItem[]>\n  activeItem: ExtendedSearchResultItem | undefined\n  activeIndex: number | -1\n}\n\nexport enum SearchField {\n  key = 'key',\n  value = 'value'\n}\n\nexport interface SearchOptions {\n  maxResults?: number\n  columns?: JSONPath[]\n}\n\nexport interface SearchResultItem {\n  path: JSONPath\n  field: SearchField\n  fieldIndex: number\n  start: number\n  end: number\n}\n\nexport interface ExtendedSearchResultItem extends SearchResultItem {\n  active: boolean\n}\n\nexport type EscapeValue = (value: unknown) => string\n\nexport type UnescapeValue = (escapedValue: string) => string\n\nexport interface ValueNormalization {\n  escapeValue: EscapeValue\n  unescapeValue: UnescapeValue\n}\n\nexport type PastedJson = { contents: unknown; path: JSONPath } | undefined\n\nexport interface DragInsideProps {\n  json: unknown\n  selection: JSONSelection\n  deltaY: number\n  items: Array<{ path: JSONPath; height: number }>\n}\n\nexport type DragInsideAction =\n  | { beforePath: JSONPath; offset: number }\n  | { append: true; offset: number }\n\nexport interface RenderedItem {\n  path: JSONPath\n  height: number\n}\n\nexport interface HistoryItem {\n  undo: {\n    patch: JSONPatchDocument | undefined\n    json: unknown | undefined\n    text: string | undefined\n    state: DocumentState\n    textIsRepaired: boolean\n  }\n  redo: {\n    patch: JSONPatchDocument | undefined\n    json: unknown | undefined\n    text: string | undefined\n    state: DocumentState\n    textIsRepaired: boolean\n  }\n}\n\nexport type ConvertType = 'value' | 'object' | 'array'\nexport type InsertType = ConvertType | 'structure'\n\nexport interface PopupEntry {\n  id: number\n  component: typeof SvelteComponent<Record<string, unknown>>\n  props: Record<string, unknown>\n  options: AbsolutePopupOptions\n}\n\nexport interface AbsolutePopupOptions {\n  anchor?: Element\n  position?: 'top' | 'left'\n  left?: number\n  top?: number\n  width?: number\n  height?: number\n  offsetTop?: number\n  offsetLeft?: number\n  showTip?: boolean\n  closeOnOuterClick?: boolean\n  onClose?: () => void\n}\n\nexport interface AbsolutePopupContext {\n  openAbsolutePopup: (\n    component: typeof SvelteComponent<Record<string, unknown>>,\n    props: Record<string, unknown>,\n    options: AbsolutePopupOptions\n  ) => number\n  closeAbsolutePopup: (popupId: number | undefined) => void\n}\n\nexport interface JSONEditorPropsOptional {\n  content?: Content\n  readOnly?: boolean\n  indentation?: number | string\n  tabSize?: number\n  mode?: Mode\n  mainMenuBar?: boolean\n  navigationBar?: boolean\n  statusBar?: boolean\n  askToFormat?: boolean\n  escapeControlCharacters?: boolean\n  escapeUnicodeCharacters?: boolean\n  flattenColumns?: boolean\n  parser?: JSONParser\n  validator?: Validator | null\n  validationParser?: JSONParser\n  pathParser?: JSONPathParser\n\n  queryLanguages?: QueryLanguage[]\n  queryLanguageId?: string\n\n  onChangeQueryLanguage?: OnChangeQueryLanguage\n  onChange?: OnChange\n  onRenderValue?: OnRenderValue\n  onClassName?: OnClassName\n  onRenderMenu?: OnRenderMenu\n  onRenderContextMenu?: OnRenderContextMenu\n  onChangeMode?: OnChangeMode\n  onSelect?: OnSelect\n  onError?: OnError\n  onFocus?: OnFocus\n  onBlur?: OnBlur\n}\n\nexport interface JSONEditorContext {\n  readOnly: boolean\n  parser: JSONParser\n  normalization: ValueNormalization\n  getJson: () => unknown | undefined\n  getDocumentState: () => DocumentState\n  findElement: (path: JSONPath) => Element | null\n  findNextInside: FindNextInside\n  focus: () => void\n  onPatch: OnPatch\n  onSelect: OnJSONSelect\n  onFind: OnFind\n  onPasteJson: (newPastedJson: PastedJson) => void\n  onRenderValue: OnRenderValue\n}\n\nexport interface TreeModeContext extends JSONEditorContext {\n  getJson: () => unknown | undefined\n  getDocumentState: () => DocumentState\n  findElement: (path: JSONPath) => Element | null\n  onInsert: (type: InsertType) => void\n  onExpand: (path: JSONPath, expanded: boolean, recursive?: boolean) => void\n  onExpandSection: (path: JSONPath, section: Section) => void\n  onContextMenu: OnContextMenu\n  onClassName: OnClassName\n  onDrag: (event: MouseEvent) => void\n  onDragEnd: () => void\n}\n\nexport interface RenderValueProps {\n  path: JSONPath\n  value: unknown\n  readOnly: boolean\n  enforceString: boolean\n  selection: JSONSelection | null\n  searchResultItems: SearchResultItem[] | undefined\n  isEditing: boolean\n  parser: JSONParser\n  normalization: ValueNormalization\n  onPatch: OnPatch\n  onPasteJson: OnPasteJson\n  onSelect: OnJSONSelect\n  onFind: OnFind\n  findNextInside: FindNextInside\n  focus: () => void\n}\n\nexport type RenderValuePropsOptional = Partial<RenderValueProps>\n\nexport interface JSONNodeProp {\n  key: string\n  value: unknown\n  path: JSONPath\n  expandedMap: JSONPointerMap<boolean> | undefined\n  enforceStringMap: JSONPointerMap<boolean> | undefined\n  visibleSectionsMap: JSONPointerMap<VisibleSection[]> | undefined\n  validationErrorsMap: JSONPointerMap<NestedValidationError> | undefined\n  keySearchResultItemsMap: ExtendedSearchResultItem[] | undefined\n  valueSearchResultItemsMap: JSONPointerMap<ExtendedSearchResultItem[]> | undefined\n  selection: JSONSelection | null\n}\n\nexport interface JSONNodeItem {\n  index: number\n  value: unknown\n  path: JSONPath\n  expandedMap: JSONPointerMap<boolean> | undefined\n  enforceStringMap: JSONPointerMap<boolean> | undefined\n  visibleSectionsMap: JSONPointerMap<VisibleSection[]> | undefined\n  validationErrorsMap: JSONPointerMap<NestedValidationError> | undefined\n  searchResultItemsMap: JSONPointerMap<ExtendedSearchResultItem[]> | undefined\n  selection: JSONSelection | null\n}\n\nexport interface DraggingState {\n  initialTarget: Element\n  initialClientY: number\n  initialContentTop: number\n  selectionStartIndex: number\n  selectionItemsCount: number\n  items: RenderedItem[]\n  offset: number\n  didMoveItems: boolean\n}\n\nexport type RenderValueComponentDescription = SvelteComponentRenderer | SvelteActionRenderer\n\nexport interface SvelteComponentRenderer {\n  component: typeof SvelteComponent<RenderValuePropsOptional>\n  props: Record<string, unknown>\n}\n\nexport interface SvelteActionRenderer {\n  action: Action<HTMLElement, Record<string, unknown>>\n  props: Record<string, unknown>\n}\n\nexport interface TransformModalOptions {\n  id?: string\n  rootPath?: JSONPath\n  onTransform?: (state: {\n    operations: JSONPatchDocument\n    json: unknown\n    transformedJson: unknown\n  }) => void\n  onClose?: () => void\n}\n\nexport interface TransformModalCallback {\n  id: string\n  rootPath: JSONPath\n  json: unknown\n  onTransform: (operations: JSONPatchDocument) => void\n  onClose: () => void\n}\n\nexport interface SortModalCallback {\n  id: string\n  json: unknown\n  rootPath: JSONPath\n  onSort: OnSort\n  onClose: () => void\n}\n\nexport interface JSONEditorModalCallback {\n  content: Content\n  path: JSONPath\n  onPatch: OnPatch\n  onClose: () => void\n}\n\nexport enum SortDirection {\n  asc = 'asc',\n  desc = 'desc'\n}\n\nexport enum UpdateSelectionAfterChange {\n  no = 'no',\n  self = 'self',\n  nextInside = 'nextInside'\n}\n\nexport interface TableCellIndex {\n  rowIndex: number\n  columnIndex: number\n}\n\nexport interface SortedColumn {\n  path: JSONPath\n  sortDirection: SortDirection\n}\n\n// TODO: work out the JSONSchema type in detail.\n//  Ideally, we use use Schema from Ajv, but this interface isn't worked out either\nexport type JSONSchema = Record<string, unknown>\nexport type JSONSchemaDefinitions = Record<string, JSONSchema>\nexport type JSONSchemaEnum = Array<unknown>\n","import type { Section } from './types'\nimport { SortDirection } from './types.js'\n\nexport const SCROLL_DURATION = 300 // ms\nexport const DEBOUNCE_DELAY = 300 // ms\nexport const TEXT_MODE_ONCHANGE_DELAY = 300 // ms\nexport const AUTO_SCROLL_INTERVAL = 50 // ms\nexport const AUTO_SCROLL_SPEED_SLOW = 200 // pixels per second\nexport const AUTO_SCROLL_SPEED_NORMAL = 400 // pixels per second\nexport const AUTO_SCROLL_SPEED_FAST = 1200 // pixels per second\nexport const MAX_SEARCH_RESULTS = 1000\nexport const ARRAY_SECTION_SIZE = 100\nexport const MAX_VALIDATION_ERRORS = 100\nexport const MAX_CHARACTERS_TEXT_PREVIEW = 20000\nexport const MAX_INLINE_OBJECT_CHARS = 50\nexport const MAX_HEADER_NAME_CHARACTERS = 50\nexport const DEFAULT_VISIBLE_SECTIONS: Section[] = [{ start: 0, end: ARRAY_SECTION_SIZE }]\nexport const MAX_VALIDATABLE_SIZE = 100 * 1024 * 1024 // 1 MB\nexport const MAX_AUTO_REPAIRABLE_SIZE = 1024 * 1024 // 1 MB\nexport const MAX_DOCUMENT_SIZE_TEXT_MODE = 10 * 1024 * 1024 // 10 MB\nexport const MAX_DOCUMENT_SIZE_EXPAND_ALL = 10 * 1024 // 10 KB\n\nexport const SIMPLE_MODAL_OPTIONS = {\n  closeButton: false,\n  classBg: 'jse-modal-bg',\n  classWindow: 'jse-modal-window',\n  classWindowWrap: 'jse-modal-window-wrap',\n  classContent: 'jse-modal-container'\n}\n\nexport const SORT_MODAL_OPTIONS = {\n  ...SIMPLE_MODAL_OPTIONS,\n  classWindow: 'jse-modal-window jse-modal-window-sort'\n}\n\nexport const TRANSFORM_MODAL_OPTIONS = {\n  ...SIMPLE_MODAL_OPTIONS,\n  classWindow: 'jse-modal-window jse-modal-window-transform'\n}\n\nexport const JSONEDITOR_MODAL_OPTIONS = {\n  ...SIMPLE_MODAL_OPTIONS,\n  classWindow: 'jse-modal-window jse-modal-window-jsoneditor'\n}\n\nexport const INSERT_EXPLANATION =\n  'Insert or paste contents, ' +\n  'enter [ insert a new array, ' +\n  'enter { to insert a new object, ' +\n  'or start typing to insert a new value'\n\nexport const CONTEXT_MENU_EXPLANATION =\n  'Open context menu ' +\n  '(Click here, ' +\n  'right click on the selection, ' +\n  'or use the context menu button or Ctrl+Q)'\n\nexport const HOVER_INSERT_INSIDE = 'hover-insert-inside'\nexport const HOVER_INSERT_AFTER = 'hover-insert-after'\nexport const HOVER_COLLECTION = 'hover-collection'\n\nexport const JSON_STATUS_VALID = 'valid'\nexport const JSON_STATUS_REPAIRABLE = 'repairable'\nexport const JSON_STATUS_INVALID = 'invalid'\n\n// TODO: can we dynamically calculate the size?\nexport const CONTEXT_MENU_HEIGHT = (40 + 2) * 8 // px\nexport const CONTEXT_MENU_WIDTH = 260 // px\nexport const SEARCH_BOX_HEIGHT = 100 // px for search and replace\n\nexport const SORT_DIRECTION_NAMES = {\n  [SortDirection.asc]: 'ascending',\n  [SortDirection.desc]: 'descending'\n}\n","let id = 0\n\nexport function uniqueId(): number {\n  id++\n  return id\n}\n","export function int(value: string): number {\n  return parseInt(value, 10)\n}\n\nexport function isDigit(char: string): boolean {\n  return DIGIT_REGEX.test(char)\n}\n\nconst DIGIT_REGEX = /^[0-9]$/\n\n// TODO: unit test\nexport function isNumber(value: string): boolean {\n  return NUMBER_REGEX.test(value)\n}\n\nconst NUMBER_REGEX = /^-?(?:0|[1-9]\\d*)(?:\\.\\d+)?(?:[eE][+-]?\\d+)?$/\n","// TODO: unit test typeUtils.js\n\nimport { isNumber } from './numberUtils.js'\nimport type { JSONParser } from '../types.js'\n\n/**\n * Test whether a value is an Object (and not an Array or Class)\n */\nexport function isObject(value: unknown): value is Record<string, unknown> {\n  // note that we check constructor.name, not constructor === Object,\n  // so we can use objects created in a different JS realm like an iframe.\n  return (\n    typeof value === 'object' &&\n    value !== null &&\n    (value.constructor === undefined || value.constructor.name === 'Object')\n  )\n}\n\n/**\n * Test whether a value is an Object or an Array (and not a Class)\n */\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport function isObjectOrArray(value: unknown): value is Object | Array<unknown> {\n  // Note that we check constructor.name, not constructor === Object,\n  // so we can use objects created in a different JS realm like an iframe.\n  return (\n    typeof value === 'object' &&\n    value !== null &&\n    (value.constructor === undefined ||\n      value.constructor.name === 'Object' ||\n      value.constructor.name === 'Array')\n  )\n}\n\n/**\n * Test whether a value is a boolean\n *\n * @param {*} value\n * @return {boolean}\n */\nexport function isBoolean(value: unknown): value is boolean {\n  return value === true || value === false\n}\n\n/**\n * Test whether a value is a timestamp in milliseconds after the year 2000.\n */\nexport function isTimestamp(value: unknown): boolean {\n  const YEAR_2000 = 946684800000\n\n  if (typeof value === 'number') {\n    return (\n      value > YEAR_2000 &&\n      isFinite(value) &&\n      Math.floor(value) === value &&\n      !isNaN(new Date(value).valueOf())\n    )\n  }\n\n  if (typeof value === 'bigint') {\n    return isTimestamp(Number(value))\n  }\n\n  // try getting the primitive value if that is different. For example when having a LosslessNumber\n  try {\n    const valueOf = value ? value.valueOf() : value\n    if (valueOf !== value) {\n      return isTimestamp(valueOf)\n    }\n  } catch (err) {\n    return false\n  }\n\n  return false\n}\n\n/**\n * Get the applied color given a color name or code\n * Returns the color if the input is a valid color, and returns null otherwise.\n *\n * Example output:\n *\n *     'rgba(255,0,0,0.7)' or 'rgb(255,0,0)'\n *\n * Source: https://stackoverflow.com/questions/6386090/validating-css-color-names/33184805\n */\nexport function getColorCSS(color: string): string | null {\n  colorTestDiv = colorTestDiv || window.document.createElement('div')\n\n  colorTestDiv.style.color = ''\n  colorTestDiv.style.color = color\n\n  const applied = colorTestDiv.style.color\n  return applied !== '' ? applied.replace(/\\s+/g, '').toLowerCase() : null\n}\nlet colorTestDiv: HTMLDivElement | null = null\n\n/**\n * Test if a string contains a valid color name or code.\n * Returns true if a valid color, false otherwise\n */\nexport function isColor(value: unknown): boolean {\n  const maxColorLength = 99\n  return typeof value === 'string' && value.length < maxColorLength && !!getColorCSS(value)\n}\n\n/**\n * Get the type of the value\n */\nexport function valueType(value: unknown, parser: JSONParser): string {\n  // primitive types\n  if (\n    typeof value === 'number' ||\n    typeof value === 'string' ||\n    typeof value === 'boolean' ||\n    typeof value === 'undefined'\n  ) {\n    return typeof value\n  }\n  if (typeof value === 'bigint') {\n    return 'number' // we return number here, not bigint: all numeric types should return the same name\n  }\n  if (value === null) {\n    return 'null'\n  }\n\n  if (Array.isArray(value)) {\n    return 'array'\n  }\n  if (isObject(value)) {\n    // plain object only\n    return 'object'\n  }\n\n  // unknown type (like a LosslessNumber). Try out what stringfying results in\n  const valueStr = parser.stringify(value)\n  if (valueStr && isNumber(valueStr)) {\n    return 'number'\n  }\n  if (valueStr === 'true' || valueStr === 'false') {\n    return 'boolean'\n  }\n  if (valueStr === 'null') {\n    return 'null'\n  }\n\n  return 'unknown'\n}\n\n/**\n * Test whether a text contains a url (matches when a string starts\n * with 'http://*' or 'https://*' and has no whitespace characters)\n */\nconst isUrlRegex = /^https?:\\/\\/\\S+$/\nexport function isUrl(text: unknown): boolean {\n  return typeof text === 'string' && isUrlRegex.test(text)\n}\n\n/**\n * Convert contents of a string to the correct JSON type. This can be a string,\n * a number, a boolean, etc\n */\nexport function stringConvert(str: string, parser: JSONParser): unknown {\n  if (str === '') {\n    return ''\n  }\n\n  const strTrim = str.trim()\n\n  if (strTrim === 'null') {\n    return null\n  }\n\n  if (strTrim === 'true') {\n    return true\n  }\n\n  if (strTrim === 'false') {\n    return false\n  }\n\n  if (isNumber(strTrim)) {\n    return parser.parse(strTrim)\n  }\n\n  return str\n}\n\n/**\n * Test whether a string contains a numeric, boolean, or null value.\n * Returns true when the string contains a number, boolean, or null.\n */\nexport function isStringContainingPrimitiveValue(str: unknown, parser: JSONParser): boolean {\n  return typeof str === 'string' && typeof stringConvert(str, parser) !== 'string'\n}\n\n/**\n * Test whether a string contains an integer number\n */\nexport function isInteger(value: string): boolean {\n  return INTEGER_REGEX.test(value)\n}\n\nconst INTEGER_REGEX = /^-?[0-9]+$/\n","import { isObject } from './typeUtils.js'\nimport type { JSONPath } from 'immutable-json-patch'\nimport { compileJSONPointer, parseJSONPointer } from 'immutable-json-patch'\nimport { isEqual } from 'lodash-es'\n\nconst MAX_ITEM_PATHS_COLLECTION = 10000\nconst ROOT_PATH: JSONPath = []\n\n/**\n * Comparator to sort an array in ascending order\n *\n * Usage:\n *     [4,2,5].sort(compareAsc)    // [2,4,5]\n */\nexport function compareAsc<T>(a: T, b: T): number {\n  return a > b ? 1 : a < b ? -1 : 0\n}\n\n/**\n * Comparator to sort an array in ascending order\n *\n * Usage:\n *     [4,2,5].sort(compareDesc)   // [5,4,2]\n */\nexport function compareDesc<T>(a: T, b: T): number {\n  return a > b ? -1 : a < b ? 1 : 0\n}\n\n/**\n * Test whether all items of an array are strictly equal\n */\nexport function strictShallowEqual<T>(a: Array<T>, b: Array<T>): boolean {\n  if (a.length !== b.length) {\n    return false\n  }\n\n  for (let i = 0; i < a.length; i++) {\n    if (a[i] !== b[i]) {\n      return false\n    }\n  }\n\n  return true\n}\n\nexport function compareArrays<T>(a: Array<T>, b: Array<T>): number {\n  const minLength = Math.min(a.length, b.length)\n\n  for (let i = 0; i < minLength; i++) {\n    if (a[i] < b[i]) {\n      return -1\n    }\n\n    if (a[i] > b[i]) {\n      return 1\n    }\n  }\n\n  return a.length - b.length\n}\n\n/**\n * Get the paths of all nested properties in the items of an array\n * @param array\n * @param includeObjects If true, object and array paths are returned as well\n */\nexport function getNestedPaths(array: unknown, includeObjects = false): JSONPath[] {\n  const pointersMap: Record<string, boolean> = {}\n\n  if (!Array.isArray(array)) {\n    throw new TypeError('Array expected')\n  }\n\n  function recurseNestedPaths(obj: unknown, path: JSONPath) {\n    const isValue = !Array.isArray(obj) && !isObject(obj)\n\n    if (isValue || (includeObjects && path.length > 0)) {\n      pointersMap[compileJSONPointer(path)] = true\n    }\n\n    if (isObject(obj)) {\n      Object.keys(obj).forEach((key) => {\n        recurseNestedPaths(obj[key], path.concat(key))\n      })\n    }\n  }\n\n  const max = Math.min(array.length, MAX_ITEM_PATHS_COLLECTION)\n  for (let i = 0; i < max; i++) {\n    const item = array[i]\n    recurseNestedPaths(item, ROOT_PATH)\n  }\n\n  const pathsArray = Object.keys(pointersMap).sort()\n\n  return pathsArray.map(parseJSONPointer)\n}\n\n/**\n * Invoke the callback with\n * @param start   Included start index\n * @param end       Excluded end index. End must be larger or equal to start\n * @param iteratee\n */\n// TODO: write tests\nexport function forEachIndex(start: number, end: number, iteratee: (index: number) => void) {\n  if (end <= start) {\n    return\n  }\n\n  for (let index = start; index < end; index++) {\n    iteratee(index)\n  }\n}\n\n/**\n * Limit the number of items in an array\n */\n// TODO: write unit test\nexport function limit<T>(array: Array<T>, max: number): Array<T> {\n  return array.length > max ? array.slice(0, max) : array\n}\n\n/**\n * Convert an array into an object having the array indices as keys\n */\nexport function arrayToObject<T>(array: Array<T>): Record<number, T> {\n  return {\n    ...array\n  }\n}\n\n/**\n * Get the values of an object as an array\n */\nexport function objectToArray<T>(object: Record<string, T>): Array<T> {\n  return Object.values(object)\n}\n\n/**\n * Test whether an array starts with a sub array\n */\nexport function arrayStartsWith<T>(\n  array: T[],\n  searchArray: T[],\n  equal: (a: T, b: T) => boolean = isEqual\n): boolean {\n  for (let i = 0; i < searchArray.length; i++) {\n    if (!equal(array[i], searchArray[i])) {\n      return false\n    }\n  }\n\n  return true\n}\n\n/**\n * Move a set of items inside an array\n */\nexport function moveItems<T>(array: T[], index: number, count: number, offset: number): T[] {\n  // TODO: check boundaries: index+offset >= 0, index+offset+count<array.length, index+count<array.length, etc\n  const copy = array.slice(0)\n  const moving: T[] = copy.splice(index, count)\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore\n  copy.splice.apply(copy, [index + offset, 0, ...moving])\n  return copy\n}\n\n/**\n * Take samples out of a large array, equally spread from start till end\n */\nexport function forEachSample<T>(\n  array: T[],\n  maxSampleCount: number,\n  callback: (item: T, index: number, array: T[]) => void\n) {\n  if (array.length < maxSampleCount) {\n    array.forEach(callback)\n  } else {\n    const step = maxSampleCount > 1 ? (array.length - 1) / (maxSampleCount - 1) : array.length\n    for (let i = 0; i < maxSampleCount; i++) {\n      const index = Math.floor(i * step)\n      callback(array[index], index, array)\n    }\n  }\n}\n","import type { JSONPath } from 'immutable-json-patch'\nimport { compileJSONPointer } from 'immutable-json-patch'\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\nimport jsonSourceMap from 'json-source-map'\nimport { jsonrepair } from 'jsonrepair'\nimport { isObject, isObjectOrArray, valueType } from './typeUtils.js'\nimport { arrayToObject, objectToArray } from './arrayUtils.js'\nimport type {\n  Content,\n  JSONContent,\n  JSONParser,\n  ParseError,\n  TextContent,\n  TextLocation\n} from '../types'\nimport { int } from './numberUtils.js'\n\n/**\n * Parse the JSON. if this fails, try to repair and parse.\n * Throws an exception when the JSON is invalid and could not be parsed.\n */\nexport function parseAndRepair(jsonText: string, parser: JSONParser): unknown {\n  try {\n    return parser.parse(jsonText)\n  } catch (err) {\n    // this can also throw\n    return parser.parse(jsonrepair(jsonText))\n  }\n}\n\n/**\n * Parse the JSON and if needed repair it.\n * When not valid, undefined is returned.\n */\nexport function parseAndRepairOrUndefined(\n  partialJson: string,\n  parser: JSONParser\n): unknown | undefined {\n  try {\n    return parseAndRepair(partialJson, parser)\n  } catch (err) {\n    return undefined\n  }\n}\n\n// TODO: deduplicate the logic in repairPartialJson and parseAndRepairPartialJson ?\nexport function parsePartialJson(partialJson: string, parse: (text: string) => unknown): unknown {\n  // for now: dumb brute force approach: simply try out a few things...\n\n  // remove trailing comma\n  partialJson = partialJson.replace(END_WITH_COMMA_AND_OPTIONAL_WHITESPACES_REGEX, '')\n\n  try {\n    return parse(partialJson)\n  } catch (err) {\n    // we ignore the error on purpose\n  }\n\n  try {\n    return parse('[' + partialJson + ']')\n  } catch (err) {\n    // we ignore the error on purpose\n  }\n\n  try {\n    return parse('{' + partialJson + '}')\n  } catch (err) {\n    // we ignore the error on purpose\n  }\n\n  throw new Error('Failed to parse partial JSON')\n}\n\n/**\n * Repair partial JSON\n */\nexport function repairPartialJson(partialJson: string): string {\n  // for now: dumb brute force approach: simply try out a few things...\n\n  // remove trailing comma\n  partialJson = partialJson.replace(END_WITH_COMMA_AND_OPTIONAL_WHITESPACES_REGEX, '')\n\n  try {\n    return jsonrepair(partialJson)\n  } catch (err) {\n    // we ignore the error on purpose\n  }\n\n  try {\n    const repaired = jsonrepair('[' + partialJson + ']')\n    return repaired.substring(1, repaired.length - 1) // remove the outer [...] again\n  } catch (err) {\n    // we ignore the error on purpose\n  }\n\n  try {\n    const repaired = jsonrepair('{' + partialJson + '}')\n    return repaired.substring(1, repaired.length - 1) // remove the outer {...} again\n  } catch (err) {\n    // we ignore the error on purpose\n  }\n\n  throw new Error('Failed to repair partial JSON')\n}\n\n// test whether a string ends with a comma, followed by zero or more white space characters\nconst END_WITH_COMMA_AND_OPTIONAL_WHITESPACES_REGEX = /,\\s*$/\n\n/**\n * Normalize a parse error message like\n *     \"Unexpected token i in JSON at position 4\"\n * or\n *     \"JSON.parse: expected property name or '}' at line 2 column 3 of the JSON data\"\n * and return the line and column numbers in an object\n *\n * Note that the returned line and column number in the object are zero-based,\n * and in the message are one based (human-readable)\n */\nexport function normalizeJsonParseError(jsonText: string, parseErrorMessage: string): ParseError {\n  const positionMatch = POSITION_REGEX.exec(parseErrorMessage)\n\n  if (positionMatch) {\n    // a message from Chrome, like \"Unexpected token i in JSON at line 2 column 3\"\n    const position = int(positionMatch[2])\n\n    const line = countCharacterOccurrences(jsonText, '\\n', 0, position)\n    const lastIndex = jsonText.lastIndexOf('\\n', position)\n    const column = position - lastIndex - 1\n\n    return {\n      position,\n      line,\n      column,\n      message: parseErrorMessage.replace(POSITION_REGEX, () => {\n        return `line ${line + 1} column ${column + 1}`\n      })\n    }\n  } else {\n    // a message from Firefox, like \"JSON.parse: expected property name or '}' at line 2 column 3 of the JSON data\"\n    const lineMatch = LINE_REGEX.exec(parseErrorMessage)\n    const lineOneBased = lineMatch ? int(lineMatch[1]) : null\n    const line = lineOneBased !== null ? lineOneBased - 1 : null\n\n    const columnMatch = COLUMN_REGEX.exec(parseErrorMessage)\n    const columnOneBased = columnMatch ? int(columnMatch[1]) : null\n    const column = columnOneBased !== null ? columnOneBased - 1 : null\n\n    const position =\n      line !== null && column !== null ? calculatePosition(jsonText, line, column) : null\n\n    // line and column are one based in the message\n    return {\n      position,\n      line,\n      column,\n      message: parseErrorMessage.replace(/^JSON.parse: /, '').replace(/ of the JSON data$/, '')\n    }\n  }\n}\n\n/**\n * Calculate the position in the text based on a line and column number\n * @param text\n * @param line     Zero-based line number\n * @param column   Zero-based column number\n */\nexport function calculatePosition(text: string, line: number, column: number): number | null {\n  let index = text.indexOf('\\n')\n  let i = 1\n\n  while (i < line && index !== -1) {\n    index = text.indexOf('\\n', index + 1)\n    i++\n  }\n\n  return index !== -1\n    ? index + column + 1 // +1 for the return character itself\n    : null\n}\n\nexport function countCharacterOccurrences(\n  text: string,\n  character: string,\n  start = 0,\n  end = text.length\n) {\n  let count = 0\n\n  for (let i = start; i < end; i++) {\n    if (text.charAt(i) === character) {\n      count++\n    }\n  }\n\n  return count\n}\n\n/**\n * Find the text location of a JSON path\n */\n// TODO: write unit tests\nexport function findTextLocation(text: string, path: JSONPath): TextLocation {\n  try {\n    const jsmap = jsonSourceMap.parse(text)\n\n    const pointerName = compileJSONPointer(path)\n    const pointer = jsmap.pointers[pointerName]\n    if (pointer) {\n      return {\n        path,\n        line: pointer.key ? pointer.key.line : pointer.value ? pointer.value.line : 0,\n        column: pointer.key ? pointer.key.column : pointer.value ? pointer.value.column : 0,\n        from: pointer.key ? pointer.key.pos : pointer.value ? pointer.value.pos : 0,\n        to: pointer.keyEnd ? pointer.keyEnd.pos : pointer.valueEnd ? pointer.valueEnd.pos : 0\n      }\n    }\n  } catch (err) {\n    console.error(err)\n  }\n\n  return {\n    path,\n    line: 0,\n    column: 0,\n    from: 0,\n    to: 0\n  }\n}\n\n/**\n * Convert a JSON object, array, or value to another type\n * If it cannot be converted, an error is thrown\n */\nexport function convertValue(\n  value: unknown,\n  type: 'value' | 'object' | 'array',\n  parser: JSONParser\n): unknown {\n  // FIXME: improve the TypeScript here, there are a couple of conversions\n  if (type === 'array') {\n    if (Array.isArray(value)) {\n      // nothing to do\n      return value\n    }\n\n    if (isObject(value)) {\n      return objectToArray(value)\n    }\n\n    if (typeof value === 'string') {\n      try {\n        const parsedValue = parser.parse(value)\n\n        if (Array.isArray(parsedValue)) {\n          return parsedValue\n        }\n\n        if (isObject(parsedValue)) {\n          // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n          // @ts-ignore\n          return objectToArray(parsedValue)\n        }\n      } catch (e) {\n        //we could not parse the string, so we return the string as the first key of the array\n        return [value]\n      }\n    }\n\n    //all other cases, we return the value as the first key of the array, same as the parsing error under the string case\n    return [value]\n  }\n\n  if (type === 'object') {\n    if (Array.isArray(value)) {\n      return arrayToObject(value)\n    }\n\n    if (isObject(value)) {\n      // nothing to do\n      return value\n    }\n\n    if (typeof value === 'string') {\n      try {\n        const parsedValue = parser.parse(value)\n\n        if (isObject(parsedValue)) {\n          return parsedValue\n        }\n\n        if (Array.isArray(parsedValue)) {\n          return arrayToObject(parsedValue)\n        }\n      } catch (e) {\n        //we could not parse the string, so we return the string as the first value of the object with key 'value'\n        return { value: value }\n      }\n    }\n\n    //all other cases, we return the value keyed under \"value\", same as the parsing error under the string case\n    return { value: value }\n  }\n\n  if (type === 'value') {\n    if (isObjectOrArray(value)) {\n      return parser.stringify(value)\n    }\n\n    // nothing to do\n    return value\n  }\n\n  throw new Error(`Cannot convert ${valueType(value, parser)} to ${type}`)\n}\n\n/**\n * Check whether provided value is valid a content type for JSONEditor\n * Returns a string with validation error message when there is an issue,\n * or null otherwise\n */\nexport function validateContentType(content: unknown): string | null {\n  if (!isObject(content)) {\n    return 'Content must be an object'\n  }\n\n  if (content.json !== undefined) {\n    if (content.text !== undefined) {\n      return 'Content must contain either a property \"json\" or a property \"text\" but not both'\n    } else {\n      return null\n    }\n  } else {\n    if (content.text === undefined) {\n      return 'Content must contain either a property \"json\" or a property \"text\"'\n    } else if (typeof content.text !== 'string') {\n      return (\n        'Content \"text\" property must be a string containing a JSON document. ' +\n        'Did you mean to use the \"json\" property instead?'\n      )\n    } else {\n      return null\n    }\n  }\n}\n\n/**\n * Check whether a value is Content (TextContent or JSONContent)\n */\nexport function isContent(content: unknown): content is Content {\n  return (\n    isObject(content) && (typeof content.json !== 'undefined' || typeof content.text === 'string')\n  )\n}\n\n/**\n * Check whether content contains text (and not JSON)\n */\nexport function isTextContent(content: unknown): content is TextContent {\n  return isObject(content) && typeof content.text === 'string'\n}\n\n/**\n * Check whether content contains json\n */\nexport function isJSONContent(content: unknown): content is JSONContent {\n  return isObject(content) && typeof content.json !== 'undefined'\n}\n\n/**\n * Convert Content into TextContent if it is JSONContent, else leave it as is\n */\nexport function toTextContent(\n  content: Content,\n  indentation: number | string | undefined = undefined,\n  parser: JSONParser = JSON\n): TextContent {\n  return isTextContent(content)\n    ? content\n    : { text: parser.stringify(content.json, null, indentation) as string }\n}\n\n/**\n * Convert Content into TextContent if it is JSONContent, else leave it as is\n * @throws {SyntaxError} Will throw a parse error when the text contents does not contain valid JSON\n */\nexport function toJSONContent(content: Content, parser: JSONParser = JSON): JSONContent {\n  return isJSONContent(content) ? content : { json: parser.parse(content.text) }\n}\n\n/**\n * Get the contents as Text. If the contents is JSON, the JSON will be parsed.\n */\nexport function getText(content: Content, indentation: number | string, parser: JSONParser) {\n  return toTextContent(content, indentation, parser).text\n}\n\n/**\n * Returns true when the (estimated) size of the contents exceeds the\n * provided maxSize.\n * @param content\n * @param maxSize  Maximum content size in bytes\n */\nexport function isLargeContent(content: Content, maxSize: number): boolean {\n  return estimateSerializedSize(content, maxSize) > maxSize\n}\n\n/**\n * A rough, fast estimation on whether a document is larger than given size\n * when serialized.\n *\n * maxSize is an optional max size in bytes. When reached, size estimation will\n * be cancelled. This is useful when you're only interested in knowing whether\n * the size exceeds a certain maximum size.\n */\nexport function estimateSerializedSize(content: Content, maxSize = Infinity): number {\n  if (isTextContent(content)) {\n    return content.text.length\n  }\n\n  const json = content.json\n\n  let estimatedSize = 0\n\n  function recurse(json: unknown) {\n    if (Array.isArray(json)) {\n      // open and close bracket, commas between items\n      estimatedSize += 2 + (json.length - 1)\n\n      if (estimatedSize > maxSize) {\n        return estimatedSize\n      }\n\n      for (let i = 0; i < json.length; i++) {\n        const item = json[i]\n\n        recurse(item)\n\n        if (estimatedSize > maxSize) {\n          return estimatedSize\n        }\n      }\n    } else if (isObject(json)) {\n      const keys = Object.keys(json)\n\n      // open and close brackets, separators between all keys and values, comma's between key/value pairs\n      estimatedSize += 2 + keys.length + (keys.length - 1)\n\n      for (let k = 0; k < keys.length; k++) {\n        const key = keys[k]\n        const value = json[key]\n\n        // key length and double quotes around it\n        estimatedSize += key.length + 2\n\n        recurse(value)\n      }\n    } else if (typeof json === 'string') {\n      estimatedSize += json.length + 2 // string length plus two for the double quote characters\n    } else {\n      // true, false, null, number\n      estimatedSize += String(json).length\n    }\n  }\n\n  recurse(json)\n\n  return estimatedSize\n}\n\nconst POSITION_REGEX = /(position|char) (\\d+)/\nconst LINE_REGEX = /line (\\d+)/\nconst COLUMN_REGEX = /column (\\d+)/\n\n/**\n * Check whether the actual functions of parse and stringify are strictly equal.\n * The object holding the functions may be a differing instance.\n */\nexport function isEqualParser(a: JSONParser, b: JSONParser): boolean {\n  return a.parse === b.parse && a.stringify === b.stringify\n}\n\n/**\n * Apply a fast and cheap heuristic to determine whether the content needs formatting (i.e. is compact).\n */\nexport function needsFormatting(jsonText: string): boolean {\n  const maxLength = 999\n  const head = jsonText.substring(0, maxLength).trim()\n  return !head.includes('\\n') && DELIMITER_WITHOUT_SPACING_REGEX.test(head)\n}\n\n// This regex matches cases of a comma or colon NOT followed by a whitespace\nconst DELIMITER_WITHOUT_SPACING_REGEX = /[,:]\\S/\n","import type { ValueNormalization } from '$lib/types.js'\nimport { SelectionType } from '$lib/types.js'\nimport type { JSONPath } from 'immutable-json-patch'\nimport { compileJSONPointer, parseJSONPointer } from 'immutable-json-patch'\nimport { map, minBy } from 'lodash-es'\n\n/**\n * Create serialization functions to escape and stringify text,\n * and the other way around: to parse and unescape text.\n */\nexport function createNormalizationFunctions({\n  escapeControlCharacters,\n  escapeUnicodeCharacters\n}: {\n  escapeControlCharacters: boolean\n  escapeUnicodeCharacters: boolean\n}): ValueNormalization {\n  if (escapeControlCharacters) {\n    if (escapeUnicodeCharacters) {\n      return normalizeControlAndUnicode\n    } else {\n      return normalizeControl\n    }\n  } else {\n    if (escapeUnicodeCharacters) {\n      return normalizeUnicode\n    } else {\n      return normalizeNothing\n    }\n  }\n}\n\nconst normalizeControlAndUnicode = {\n  escapeValue: (value: unknown) => jsonEscapeUnicode(jsonEscapeControl(String(value))),\n  unescapeValue: (value: string) => jsonUnescapeControl(jsonUnescapeUnicode(value))\n}\n\nconst normalizeControl = {\n  escapeValue: (value: unknown) => jsonEscapeControl(String(value)),\n  unescapeValue: (value: string) => jsonUnescapeControl(value)\n}\n\nconst normalizeUnicode = {\n  escapeValue: (value: unknown) => jsonEscapeUnicode(String(value)),\n  unescapeValue: (value: string) => jsonUnescapeUnicode(value)\n}\n\nconst normalizeNothing = {\n  escapeValue: (value: unknown) => String(value),\n  unescapeValue: (value: string) => value\n}\n\n/**\n * Source:  https://stackoverflow.com/questions/12271547/shouldnt-json-stringify-escape-unicode-characters\n */\nexport function jsonEscapeUnicode(value: string): string {\n  return value.replace(/[^\\x20-\\x7F]/g, (x) => {\n    if (x === '\\b' || x === '\\f' || x === '\\n' || x === '\\r' || x === '\\t') {\n      return x\n    }\n\n    return '\\\\u' + ('000' + x.codePointAt(0)?.toString(16)).slice(-4)\n  })\n}\n\nexport function jsonUnescapeUnicode(value: string): string {\n  return value.replace(/\\\\u[a-fA-F0-9]{4}/g, (x) => {\n    try {\n      const unescaped: string = JSON.parse('\"' + x + '\"')\n      // the resolved character can be a control character like \" or \\n,\n      // that would result in invalid JSON, so we need to keep that escaped\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      return controlCharacters[unescaped] || unescaped\n    } catch (err) {\n      return x\n    }\n  })\n}\n\nconst controlCharacters = {\n  '\"': '\\\\\"',\n  '\\\\': '\\\\\\\\',\n  // escaped forward slash '\\/' is the same as '/', we can't escape/unescape it\n  '\\b': '\\\\b',\n  '\\f': '\\\\f',\n  '\\n': '\\\\n',\n  '\\r': '\\\\r',\n  '\\t': '\\\\t'\n  // unicode is handled separately\n}\n\nconst escapedControlCharacters = {\n  '\\\\\"': '\"',\n  '\\\\\\\\': '\\\\',\n  // escaped forward slash '\\/' is the same as '/', we can't escape/unescape it\n  '\\\\/': '/',\n  '\\\\b': '\\b',\n  '\\\\f': '\\f',\n  '\\\\n': '\\n',\n  '\\\\r': '\\r',\n  '\\\\t': '\\t'\n  // unicode is handled separately\n}\n\nexport function jsonEscapeControl(value: string): string {\n  return value.replace(/[\"\\b\\f\\n\\r\\t\\\\]/g, (x) => {\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    return controlCharacters[x] || x\n  })\n}\n\nexport function jsonUnescapeControl(value: string): string {\n  return value.replace(/\\\\[\"bfnrt\\\\]/g, (x) => {\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    return escapedControlCharacters[x] || x\n  })\n}\n\nexport function addNewLineSuffix(value: unknown): string {\n  if (typeof value !== 'string') {\n    return String(value)\n  }\n\n  if (value.endsWith('\\n')) {\n    // DOM innerText strips the last \\n, therefore we add an extra \\n here\n    return value + '\\n'\n  }\n\n  return value\n}\n\n/**\n * Remove a newline suffix from text returned by element.innerText, it adds\n * one return too much.\n */\nexport function removeNewLineSuffix(text: string): string {\n  return text.replace(/\\n$/, '')\n}\n\n// regular expression matching one or multiple return characters with all their\n// enclosing white spaces\nexport function removeReturnsAndSurroundingWhitespace(text: string): string {\n  return text.replace(/(\\b|^)\\s*(\\b|$)/g, (match) => {\n    return /\\n/.exec(match) ? '' : match\n  })\n}\n\nexport function isChildOfNodeName(element: Element, nodeName: string): boolean {\n  return isChildOf(element, (e) => e.nodeName.toUpperCase() === nodeName.toUpperCase())\n}\n\nexport function isChildOfAttribute(element: Element, name: string, value: string): boolean {\n  return isChildOf(element, (e) => hasAttribute(e, name, value))\n}\n\n// test whether a DOM element is a content editable div\nexport function isContentEditableDiv(element: HTMLElement): boolean {\n  return element.nodeName === 'DIV' && element.contentEditable === 'true'\n}\n\n// test whether a DOM element is an \"input\" with type \"text\"\nexport function isTextInput(element: HTMLInputElement): boolean {\n  return (\n    element.nodeName === 'INPUT' &&\n    element.type !== undefined &&\n    element.type.toLowerCase() === 'text'\n  )\n}\n\nfunction hasAttribute(element: Element, name: string, value: string): boolean {\n  return typeof element.getAttribute === 'function' && element.getAttribute(name) === value\n}\n\n/**\n * Test if the element or one of its parents has a certain predicate\n * Can be use for example to check whether the element or it's parent has\n * a specific attribute or nodeName.\n */\nexport function isChildOf(element: Element, predicate: (element: Element) => boolean): boolean {\n  return !!findParent(element, predicate)\n}\n\n/**\n * Test if the element or one of its parents has a certain predicate\n * Can be use for example to check whether the element or it's parent has\n * a specific attribute or nodeName.\n * @param {HTMLElement} element\n * @param {function (element: HTMLElement) : boolean} predicate\n * @returns {HTMLElement | undefined}\n */\nexport function findParent(\n  element: Element,\n  predicate: (element: Element) => boolean\n): Element | undefined {\n  let e: Element | null = element\n\n  while (e && !predicate(e)) {\n    e = e.parentNode as Element\n  }\n\n  return e || undefined\n}\n\n/**\n * Set the cursor to the end of a content editable div\n * Source: https://stackoverflow.com/questions/13513329/set-cursor-to-the-end-of-contenteditable-div\n * @param {HTMLElement} element\n */\nexport function setCursorToEnd(element: HTMLElement) {\n  if (element.firstChild == null) {\n    element.focus()\n    return\n  }\n\n  const range = document.createRange()\n  const selection = window.getSelection()\n  range.setStart(element, 1)\n  range.collapse(true)\n  selection?.removeAllRanges()\n  selection?.addRange(range)\n}\n\n/**\n * Insert (append or replace) the text contents of the current active element\n */\nexport function insertActiveElementContents(\n  container: HTMLElement,\n  text: string,\n  replaceContents: boolean,\n  onActiveElement?: (activeElement: HTMLElement) => void\n) {\n  const window = getWindow(container)\n  if (!window) {\n    return\n  }\n\n  const activeElement: HTMLElement | null = window.document.activeElement\n    ? (window.document.activeElement as HTMLElement)\n    : null\n\n  if (activeElement && activeElement.isContentEditable) {\n    activeElement.textContent = replaceContents ? text : activeElement.textContent + text\n    setCursorToEnd(activeElement)\n    if (onActiveElement) {\n      onActiveElement(activeElement)\n    }\n  }\n}\n\n/**\n * Gets a DOM element's Window.  This is normally just the global `window`\n * variable, but if we opened a child window, it may be different.\n */\nexport function getWindow(element: Element): Window | null {\n  return element && element.ownerDocument ? element.ownerDocument.defaultView : null\n}\n\nexport function activeElementIsChildOf(element: Element) {\n  const window = getWindow(element)\n  const activeElement = window?.document.activeElement\n  return activeElement ? isChildOf(activeElement, (e) => e === element) : false\n}\n\n/**\n * Traverse over the parents of the element until a node is found with the\n * searched for node name. If the element itself contains the nodeName, the\n * element itself will be returned\n */\nexport function findParentWithNodeName(element: Element, nodeName: string): Element | undefined {\n  return findParent(element, (e) => e.nodeName === nodeName)\n}\n\nexport function getSelectionTypeFromTarget(target: Element): SelectionType {\n  if (isChildOfAttribute(target, 'data-type', 'selectable-key')) {\n    return SelectionType.key\n  }\n\n  if (isChildOfAttribute(target, 'data-type', 'selectable-value')) {\n    return SelectionType.value\n  }\n\n  if (isChildOfAttribute(target, 'data-type', 'insert-selection-area-inside')) {\n    return SelectionType.inside\n  }\n\n  if (isChildOfAttribute(target, 'data-type', 'insert-selection-area-after')) {\n    return SelectionType.after\n  }\n\n  return SelectionType.multi\n}\n\n/**\n * Encode a path into a string that can be used as attribute in HTML\n */\nexport function encodeDataPath(path: JSONPath): string {\n  return encodeURIComponent(compileJSONPointer(path))\n}\n\n/**\n * Decode a path that was stringified for use as an HTML attribute\n */\nexport function decodeDataPath(pathStr: string): JSONPath {\n  return parseJSONPointer(decodeURIComponent(pathStr))\n}\n\n/**\n * Find the data path of the given element. Traverses the parent nodes until find\n */\nexport function getDataPathFromTarget(target: Element): JSONPath | null {\n  const parent = findParent(target, (element) => {\n    return element?.hasAttribute ? element.hasAttribute('data-path') : false\n  })\n\n  const dataPath = parent?.getAttribute('data-path')\n  return dataPath ? decodeDataPath(dataPath) : null\n}\n\n/**\n * Find the nearest element in a given context menu with buttons or inputs\n */\n// TODO: unit test\nexport function findNearestElement<T extends Element>({\n  allElements,\n  currentElement,\n  direction,\n  hasPrio = () => true,\n  margin = 10\n}: {\n  allElements: T[]\n  currentElement: T\n  direction: 'Up' | 'Down' | 'Left' | 'Right'\n  margin?: number\n  hasPrio?: (element: T) => boolean\n}): T | undefined {\n  const all = map(allElements.filter(isVisible), calculateCenter)\n  const current = calculateCenter(currentElement)\n\n  interface CenterLocation {\n    x: number\n    y: number\n    rect: DOMRect\n    element: T\n  }\n\n  function isVisible(element: T): boolean {\n    const rect = element.getBoundingClientRect()\n    return rect.width > 0 && rect.height > 0\n  }\n\n  function calculateCenter(element: T): CenterLocation {\n    const rect = element.getBoundingClientRect()\n    return {\n      x: rect.left + rect.width / 2,\n      y: rect.top + rect.height / 2,\n      rect,\n      element\n    }\n  }\n\n  const isOnSameRow = (a: CenterLocation, b: CenterLocation) => Math.abs(a.y - b.y) < margin\n  const isLeft = (a: CenterLocation, b: CenterLocation) => a.rect.left + margin < b.rect.left\n  const isRight = (a: CenterLocation, b: CenterLocation) => a.rect.right > b.rect.right + margin\n  const isAbove = (a: CenterLocation, b: CenterLocation) => a.y + margin < b.y\n  const isBelow = (a: CenterLocation, b: CenterLocation) => a.y > b.y + margin\n\n  function distance(a: CenterLocation, b: CenterLocation, weightY = 1): number {\n    const diffX = a.x - b.x\n    const diffY = (a.y - b.y) * weightY\n    return Math.sqrt(diffX * diffX + diffY * diffY)\n  }\n  const distanceToCurrent = (candidate: CenterLocation) => distance(candidate, current)\n  const distanceToCurrentWeighted = (candidate: CenterLocation) => distance(candidate, current, 10)\n\n  if (direction === 'Left' || direction === 'Right') {\n    // First we find the first button left from the current button on the same row\n    // if not found, search the closest button left/right from current button\n    const candidatesLeft =\n      direction === 'Left'\n        ? all.filter((button) => isLeft(button, current))\n        : all.filter((button) => isRight(button, current))\n    const candidatesLeftOnRow = candidatesLeft.filter((button) => isOnSameRow(button, current))\n    const nearest =\n      minBy(candidatesLeftOnRow, distanceToCurrent) ||\n      minBy(candidatesLeft, distanceToCurrentWeighted)\n\n    return nearest?.element\n  }\n\n  if (direction === 'Up' || direction === 'Down') {\n    // first we only search through the prio buttons\n    // if there were no matching prio buttons, search all matching buttons\n    const candidates =\n      direction === 'Up'\n        ? all.filter((button) => isAbove(button, current))\n        : all.filter((button) => isBelow(button, current))\n    const prioCandidates = candidates.filter((button) => hasPrio(button.element))\n    const nearest = minBy(prioCandidates, distanceToCurrent) || minBy(candidates, distanceToCurrent)\n\n    return nearest?.element\n  }\n\n  return undefined\n}\n\nexport interface EditableDivElement extends HTMLDivElement {\n  refresh: () => void\n  cancel: () => void\n}\n\nexport function isEditableDivRef(element: Element | null): element is EditableDivElement {\n  return (\n    !!element &&\n    element.nodeName === 'DIV' &&\n    typeof (element as unknown as Record<string, unknown>).refresh === 'function' &&\n    typeof (element as unknown as Record<string, unknown>).cancel === 'function'\n  )\n}\n","// inspiration: https://github.com/andrepolischuk/keycomb\n\n// KeyComboEvent is a subset of KeyboardEvent\nexport interface KeyComboEvent {\n  ctrlKey?: boolean\n  metaKey?: boolean\n  altKey?: boolean\n  shiftKey?: boolean\n  key: string\n}\n\n/**\n * Get the active key combination from a keyboard event.\n * For example returns \"Ctrl+Shift+ArrowUp\" or \"Ctrl+A\"\n *\n * Returns the same output on both Windows and Mac:\n * meta keys \"Ctrl\" (\"Command\" on Mac), and \"Alt\" (\"Alt\" or \"Option\" on Mac)\n * So pressing \"Command\" and \"A\"on Mac will return \"Ctrl+A\"\n */\nexport function keyComboFromEvent(event: KeyComboEvent, separator = '+'): string {\n  const combi = []\n\n  if (event.ctrlKey) {\n    // Control on Windows\n    combi.push('Ctrl')\n  }\n  if (event.metaKey) {\n    // Command on Mac\n    combi.push('Ctrl')\n  }\n  if (event.altKey) {\n    // on Mac this is called Option\n    combi.push('Alt')\n  }\n  if (event.shiftKey) {\n    combi.push('Shift')\n  }\n\n  const keyName = event.key.length === 1 ? event.key.toUpperCase() : event.key\n  if (!(keyName in metaKeys)) {\n    // prevent output like 'Ctrl+Ctrl'\n    combi.push(keyName)\n  }\n\n  return combi.join(separator)\n}\n\nconst metaKeys = {\n  Ctrl: true,\n  Command: true,\n  Control: true,\n  Alt: true,\n  Option: true,\n  Shift: true\n}\n","<script lang=\"ts\">\n  import type { AbsolutePopupOptions, PopupEntry } from '$lib/types.js'\n  import { onMount } from 'svelte'\n  import { isChildOf } from '$lib/utils/domUtils.js'\n  import { keyComboFromEvent } from '$lib/utils/keyBindings.js'\n\n  export let popup: PopupEntry\n  export let closeAbsolutePopup: (popupId: number) => void\n\n  let refRootPopup: HTMLDivElement\n  let refHiddenInput: HTMLInputElement\n\n  onMount(focus)\n\n  function closeWhenOutside(event: Event) {\n    if (\n      popup.options &&\n      popup.options.closeOnOuterClick &&\n      !isChildOf(event.target as HTMLElement, (e) => e === refRootPopup)\n    ) {\n      closeAbsolutePopup(popup.id)\n    }\n  }\n\n  function handleWindowMouseDown(event: Event) {\n    closeWhenOutside(event)\n  }\n\n  function handleMouseDownInside(event: Event) {\n    event.stopPropagation()\n  }\n\n  function handleKeyDown(event: KeyboardEvent) {\n    const combo = keyComboFromEvent(event)\n    if (combo === 'Escape') {\n      closeAbsolutePopup(popup.id)\n    }\n  }\n\n  function handleScrollWheel(event: Event) {\n    closeWhenOutside(event)\n  }\n\n  function calculateStyle(refRootPopup: HTMLDivElement, options: AbsolutePopupOptions) {\n    function calculatePosition() {\n      if (options.anchor) {\n        const { anchor, width = 0, height = 0, offsetTop = 0, offsetLeft = 0, position } = options\n        const { left, top, bottom, right } = anchor.getBoundingClientRect()\n\n        const positionAbove =\n          position === 'top' || (top + height > window.innerHeight && top > height)\n        const positionLeft =\n          position === 'left' || (left + width > window.innerWidth && left > width)\n\n        return {\n          left: positionLeft ? right - offsetLeft : left + offsetLeft,\n          top: positionAbove ? top - offsetTop : bottom + offsetTop,\n          positionAbove,\n          positionLeft\n        }\n      } else if (typeof options.left === 'number' && typeof options.top === 'number') {\n        const { left, top, width = 0, height = 0 } = options\n\n        const positionAbove = top + height > window.innerHeight && top > height\n        const positionLeft = left + width > window.innerWidth && left > width\n\n        return {\n          left,\n          top,\n          positionAbove,\n          positionLeft\n        }\n      } else {\n        throw new Error('Invalid config: pass either \"left\" and \"top\", or pass \"anchor\"')\n      }\n    }\n\n    const rootRect = refRootPopup.getBoundingClientRect()\n    const { left, top, positionAbove, positionLeft } = calculatePosition()\n\n    const verticalStyling = positionAbove\n      ? `bottom: ${rootRect.top - top}px;`\n      : `top: ${top - rootRect.top}px;`\n\n    const horizontalStyling = positionLeft\n      ? `right: ${rootRect.left - left}px;`\n      : `left: ${left - rootRect.left}px;`\n\n    return verticalStyling + horizontalStyling\n  }\n\n  function focus() {\n    if (refHiddenInput) {\n      refHiddenInput.focus()\n    }\n  }\n</script>\n\n<svelte:window\n  on:mousedown|capture={handleWindowMouseDown}\n  on:keydown|capture={handleKeyDown}\n  on:wheel|capture={handleScrollWheel}\n/>\n\n<div\n  role=\"none\"\n  bind:this={refRootPopup}\n  class=\"jse-absolute-popup\"\n  on:mousedown={handleMouseDownInside}\n  on:keydown={handleKeyDown}\n>\n  {#if refRootPopup}\n    <div class=\"jse-absolute-popup-content\" style={calculateStyle(refRootPopup, popup.options)}>\n      <input\n        type=\"text\"\n        readonly\n        tabindex=\"-1\"\n        class=\"jse-hidden-input\"\n        bind:this={refHiddenInput}\n      />\n      <svelte:component this={popup.component} {...popup.props} />\n    </div>\n  {/if}\n</div>\n\n<style src=\"./AbsolutePopupEntry.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { createDebug } from '$lib/utils/debug.js'\n  import { setContext, SvelteComponent } from 'svelte'\n  import type { AbsolutePopupOptions, PopupEntry, AbsolutePopupContext } from '$lib/types'\n  import { uniqueId } from '$lib/utils/uniqueId.js'\n  import AbsolutePopupEntry from './AbsolutePopupEntry.svelte'\n\n  const debug = createDebug('jsoneditor:AbsolutePopup')\n\n  let popups: PopupEntry[] = []\n\n  function openAbsolutePopup(\n    component: typeof SvelteComponent<Record<string, unknown>>,\n    props: Record<string, unknown>,\n    options: AbsolutePopupOptions\n  ): number {\n    debug('open...', props, options)\n\n    const popup: PopupEntry = {\n      id: uniqueId(),\n      component: component,\n      props: props || {},\n      options: options || {}\n    }\n\n    popups = [...popups, popup]\n\n    return popup.id\n  }\n\n  function closeAbsolutePopup(popupId: number | undefined) {\n    const popupIndex = popups.findIndex((popup) => popup.id === popupId)\n\n    if (popupIndex !== -1) {\n      const popup = popups[popupIndex]\n      if (popup.options.onClose) {\n        popup.options.onClose()\n      }\n\n      popups = popups.filter((popup) => popup.id !== popupId)\n    }\n  }\n\n  $: debug('popups', popups)\n\n  setContext<AbsolutePopupContext>('absolute-popup', { openAbsolutePopup, closeAbsolutePopup })\n</script>\n\n{#each popups as popup}\n  <AbsolutePopupEntry {popup} {closeAbsolutePopup} />\n{/each}\n\n<slot />\n","import { isEmpty, memoize } from 'lodash-es'\nimport type { JSONPath } from 'immutable-json-patch'\nimport type { PathOption } from '$lib/types.js'\n\n/**\n **\n * Stringify an array with a path like ['items', '3', 'name'] into string like 'items[3].name'\n * Note that we allow all characters in a property name, like \"item with spaces[3].name\",\n * so this path is not usable as-is in JavaScript.\n */\nexport function stringifyJSONPath(path: JSONPath): string {\n  return path\n    .map((p, index) => {\n      return integerNumberRegex.test(p)\n        ? '[' + p + ']'\n        : /[.[\\]]/.test(p) || p === '' // match any character . or [ or ] and handle an empty string\n          ? '[\"' + escapeQuotes(p) + '\"]'\n          : (index > 0 ? '.' : '') + p\n    })\n    .join('')\n}\n\nfunction escapeQuotes(prop: string): string {\n  return prop.replace(/\"/g, '\\\\\"')\n}\n\n/**\n * Parse a JSON path like 'items[3].name' into a path like ['items', '3', 'name']\n */\nexport function parseJSONPath(pathStr: string): JSONPath {\n  const path: JSONPath = []\n  let i = 0\n\n  while (i < pathStr.length) {\n    if (pathStr[i] === '.') {\n      i++\n    }\n\n    if (pathStr[i] === '[') {\n      i++\n\n      if (pathStr[i] === '\"') {\n        i++\n        path.push(parseProp((c) => c === '\"', true))\n        eatCharacter('\"')\n      } else {\n        path.push(parseProp((c) => c === ']'))\n      }\n\n      eatCharacter(']')\n    } else {\n      path.push(parseProp((c) => c === '.' || c === '['))\n    }\n  }\n\n  function parseProp(isEnd: (char: string) => boolean, unescape = false) {\n    let prop = ''\n\n    while (i < pathStr.length && !isEnd(pathStr[i])) {\n      if (unescape && pathStr[i] === '\\\\' && pathStr[i + 1] === '\"') {\n        // escaped double quote\n        prop += '\"'\n        i += 2\n      } else {\n        prop += pathStr[i]\n        i++\n      }\n    }\n\n    return prop\n  }\n\n  function eatCharacter(char: string) {\n    if (pathStr[i] !== char) {\n      throw new SyntaxError(`Invalid JSON path: ${char} expected at position ${i}`)\n    }\n    i++\n  }\n\n  return path\n}\n\n/**\n * Convert a JSONPath into an option for use in a select box\n */\nexport function pathToOption(path: JSONPath): PathOption {\n  return {\n    value: path,\n    label: isEmpty(path) ? '(item root)' : stringifyJSONPath(path)\n  }\n}\n\n/**\n * Stringify a JSON path into a lodash path like:\n *\n *     [\"data\", 2, \"nested property\", \"name\"]\n *\n * into a lodash path like:\n *\n *     \"data[2].nested.name\"\n *\n */\nexport function createLodashPropertySelector(path: JSONPath): string {\n  return path.length === 0\n    ? ''\n    : path.every((prop) => integerNumberRegex.test(prop) || javaScriptPropertyRegex.test(prop))\n      ? \"'\" + path.map(stringifyLodashProperty).join('').replace(/^\\./, '') + \"'\"\n      : JSON.stringify(path)\n}\n\n/**\n * Stringify a single property of a JSON path. See also createLodashPropertySelector\n */\nfunction stringifyLodashProperty(prop: string): string {\n  if (integerNumberRegex.test(prop)) {\n    return '[' + prop + ']'\n  } else if (javaScriptPropertyRegex.test(prop)) {\n    return '.' + prop\n  } else {\n    const propStr = JSON.stringify(prop)\n    // remove enclosing double quotes, and unescape escaped double quotes \\\"\n    const jsonPathStr = propStr.substring(1, propStr.length - 1).replace(/\\\\\"/g, '\"')\n    return \"['\" + jsonPathStr + \"']\"\n  }\n}\n\n/**\n * Create a JavaScript property selector\n *\n * Turn a paths like:\n *\n *   ['location', 'latitude']\n *   ['address', 'full name']\n *\n * into a JavaScript selector (string) like:\n *\n *   '?.location?.latitude'\n *   '?.address?.[\"full name\"]'\n */\nexport function createPropertySelector(path: JSONPath): string {\n  return path\n    .map((prop) => {\n      if (integerNumberRegex.test(prop)) {\n        // an index\n        return `?.[${prop}]`\n      } else if (javaScriptPropertyRegex.test(prop)) {\n        // a key without special characters\n        return `?.${prop}`\n      } else {\n        // a key that may have special characters (like spaces or so)\n        return `?.[${JSON.stringify(prop)}]`\n      }\n    })\n    .join('')\n}\n\n// https://developer.mozilla.org/en-US/docs/Glossary/Identifier\n// Note: We can extend this regex to allow unicode characters too.\n// I'm too lazy to figure that out right now\nconst javaScriptPropertyRegex = /^[a-zA-Z$_][a-zA-Z$_\\d]*$/\nconst integerNumberRegex = /^\\d+$/\n\n/**\n * Create a memoized function that will memoize the input path, and return\n * the memoized instance of the path when the stringified version is the same.\n */\nexport function createMemoizePath(): (path: JSONPath) => JSONPath {\n  return memoize((path) => path, stringifyJSONPath)\n}\n","/**\n * Find a unique name. Suffix the name with ' (copy)', '(copy 2)', etc\n * until a unique name is found\n * @param name    Proposed name\n * @param keys    Array with existing keys\n */\nexport function findUniqueName(name: string, keys: string[]): string {\n  const keysSet = new Set(keys)\n\n  // remove any \" (copy)\" or \" (copy 2)\" suffix from the name\n  const nameWithoutCopySuffix = name.replace(/ \\(copy( \\d+)?\\)$/, '')\n\n  let validName = name\n  let i = 1\n\n  while (keysSet.has(validName)) {\n    const copy = 'copy' + (i > 1 ? ' ' + i : '')\n    validName = `${nameWithoutCopySuffix} (${copy})`\n    i++\n  }\n\n  return validName\n}\n\n/**\n * Transform a text into lower case with the first character upper case\n */\nexport function toCapital(text: string): string {\n  return text && text.length > 0 ? text[0].toUpperCase() + text.substring(1).toLowerCase() : text\n}\n\nexport function compareStrings(a: string, b: string): -1 | 0 | 1 {\n  return a < b ? -1 : a > b ? 1 : 0\n}\n\n/**\n * Duplicate a piece of text\n */\nexport function duplicateInText(text: string, anchorOffset: number, focusOffset: number): string {\n  const startOffset = Math.min(anchorOffset, focusOffset)\n  const endOffset = Math.max(anchorOffset, focusOffset)\n\n  return (\n    text.slice(0, endOffset) +\n    text.slice(startOffset, endOffset) + // the duplicated piece of the text\n    text.slice(endOffset)\n  )\n}\n\n/**\n * Truncate a text to a maximum length.\n * When truncated, the text will pe appended with ellipsis '...'\n * @param text Text to be truncated\n * @param maxLength Maximum allowed length for the text including ellipsis\n */\nexport function truncate(text: string, maxLength: number): string {\n  const ellipsis = '...'\n  const maxTextLength = maxLength - ellipsis.length\n\n  return text.length > maxLength ? text.substring(0, maxTextLength) + ellipsis : text\n}\n\n/**\n * Cast contents of a string to the correct type.\n * This can be a string, a number, a boolean, null, undefined, etc\n * @param str\n * @return parsed string\n */\nexport function parseString(str: string): string | number | boolean | null | undefined {\n  if (str === '') {\n    return ''\n  }\n\n  const lower = str.toLowerCase()\n  if (lower === 'null') {\n    return null\n  }\n  if (lower === 'true') {\n    return true\n  }\n  if (lower === 'false') {\n    return false\n  }\n  if (lower === 'undefined') {\n    return undefined\n  }\n\n  const num = Number(str) // will nicely fail with '123ab'\n  const numFloat = parseFloat(str) // will nicely fail with '  '\n  if (!isNaN(num) && !isNaN(numFloat)) {\n    return num\n  }\n\n  return str\n}\n","import { createPropertySelector } from '../../utils/pathUtils.js'\nimport { parseString } from '../../utils/stringUtils.js'\nimport type { QueryLanguage, QueryLanguageOptions } from '../../types.js'\nimport { isInteger } from '../../utils/typeUtils.js'\n\nconst description = `\n<p>\n  Enter a JavaScript function to filter, sort, or transform the data.\n</p>\n`\n\nexport const javascriptQueryLanguage: QueryLanguage = {\n  id: 'javascript',\n  name: 'JavaScript',\n  description,\n  createQuery,\n  executeQuery\n}\n\nfunction createQuery(json: unknown, queryOptions: QueryLanguageOptions): string {\n  const { filter, sort, projection } = queryOptions\n  const queryParts = ['  return data\\n']\n\n  if (filter && filter.path && filter.relation && filter.value) {\n    // Note that the comparisons embrace type coercion,\n    // so a filter value like '5' (text) will match numbers like 5 too.\n    const actualValueGetter = `item => item${createPropertySelector(filter.path)}`\n\n    const filterValue = parseString(filter.value)\n    const filterValueStr =\n      typeof filterValue === 'string'\n        ? `'${filter.value}'`\n        : isInteger(filter.value) && !Number.isSafeInteger(filterValue)\n          ? `${filter.value}n` // bigint\n          : filter.value\n\n    queryParts.push(`    .filter(${actualValueGetter} ${filter.relation} ${filterValueStr})\\n`)\n  }\n\n  if (sort && sort.path && sort.direction) {\n    if (sort.direction === 'desc') {\n      queryParts.push(\n        `    .slice()\\n` +\n          `    .sort((a, b) => {\\n` +\n          `      // sort descending\\n` +\n          `      const valueA = a${createPropertySelector(sort.path)}\\n` +\n          `      const valueB = b${createPropertySelector(sort.path)}\\n` +\n          `      return valueA > valueB ? -1 : valueA < valueB ? 1 : 0\\n` +\n          `    })\\n`\n      )\n    } else {\n      // sort direction 'asc'\n      queryParts.push(\n        `    .slice()\\n` +\n          `    .sort((a, b) => {\\n` +\n          `      // sort ascending\\n` +\n          `      const valueA = a${createPropertySelector(sort.path)}\\n` +\n          `      const valueB = b${createPropertySelector(sort.path)}\\n` +\n          `      return valueA > valueB ? 1 : valueA < valueB ? -1 : 0\\n` +\n          `    })\\n`\n      )\n    }\n  }\n\n  if (projection && projection.paths) {\n    // It is possible to make a util function \"pickFlat\"\n    // and use that when building the query to make it more readable.\n    if (projection.paths.length > 1) {\n      const paths = projection.paths.map((path) => {\n        const name = path[path.length - 1] || 'item' // 'item' in case of having selected the item root\n        const item = `item${createPropertySelector(path)}`\n        return `      ${JSON.stringify(name)}: ${item}`\n      })\n\n      queryParts.push(`    .map(item => ({\\n${paths.join(',\\n')}})\\n    )\\n`)\n    } else {\n      const item = `item${createPropertySelector(projection.paths[0])}`\n\n      queryParts.push(`    .map(item => ${item})\\n`)\n    }\n  }\n\n  return `function query (data) {\\n${queryParts.join('')}}`\n}\n\nfunction executeQuery(json: unknown, query: string): unknown {\n  // FIXME: replace unsafe new Function with a JS based query language\n  //  As long as we don't persist or fetch queries, there is no security risk.\n  // TODO: only import the most relevant subset of lodash instead of the full library?\n  // eslint-disable-next-line no-new-func\n  const queryFn = new Function(\n    '\"use strict\";\\n' +\n      '\\n' +\n      query +\n      '\\n' +\n      '\\n' +\n      'if (typeof query !== \"function\") {\\n' +\n      '  throw new Error(\"Cannot execute query: expecting a function named \\'query\\' but is undefined\")\\n' +\n      '}\\n' +\n      '\\n' +\n      'return query;\\n'\n  )()\n\n  const output = queryFn(json)\n  return output !== undefined ? output : null\n}\n","<g>\n  {@html raw}\n</g>\n\n<script>let cursor = 0xd4937;\nfunction getId() {\n    cursor += 1;\n    return `fa-${cursor.toString(16)}`;\n}\nlet raw = '';\nexport let data;\nfunction getRaw(data) {\n    if (!data || !data.raw) {\n        return '';\n    }\n    let rawData = data.raw;\n    const ids = {};\n    rawData = rawData.replace(/\\s(?:xml:)?id=[\"']?([^\"')\\s]+)/g, (match, id) => {\n        const uniqueId = getId();\n        ids[id] = uniqueId;\n        return ` id=\"${uniqueId}\"`;\n    });\n    rawData = rawData.replace(/#(?:([^'\")\\s]+)|xpointer\\(id\\((['\"]?)([^')]+)\\2\\)\\))/g, (match, rawId, _, pointerId) => {\n        const id = rawId || pointerId;\n        if (!id || !ids[id]) {\n            return match;\n        }\n        return `#${ids[id]}`;\n    });\n    return rawData;\n}\n$: raw = getRaw(data);\n</script>\n","<svg\n  version=\"1.1\"\n  class=\"fa-icon {className}\"\n  class:fa-spin={spin}\n  class:fa-pulse={pulse}\n  class:fa-inverse={inverse}\n  class:fa-flip-horizontal={flip === 'horizontal'}\n  class:fa-flip-vertical={flip === 'vertical'}\n  {width}\n  {height}\n  aria-label={label}\n  role={label ? 'img' : 'presentation'}\n  viewBox={box}\n  {style}\n  {...$$restProps}\n>\n  <slot />\n</svg>\n\n<style>\n  .fa-icon {\n    display: inline-block;\n    fill: currentColor;\n  }\n  .fa-flip-horizontal {\n    transform: scale(-1, 1);\n  }\n  .fa-flip-vertical {\n    transform: scale(1, -1);\n  }\n  .fa-spin {\n    animation: fa-spin 1s 0s infinite linear;\n  }\n  .fa-inverse {\n    color: #fff;\n  }\n  .fa-pulse {\n    animation: fa-spin 1s infinite steps(8);\n  }\n  @keyframes fa-spin {\n    0% {\n      transform: rotate(0deg);\n    }\n    100% {\n      transform: rotate(360deg);\n    }\n  }\n</style>\n\n<script>let className = '';\nexport { className as class };\nexport let width;\nexport let height;\nexport let box = '0 0 0 0';\nexport let spin = false;\nexport let inverse = false;\nexport let pulse = false;\nexport let flip = 'none';\n// optionals\nexport let style = '';\nexport let label = '';\n</script>\n","<Svg\n  {label}\n  {width}\n  {height}\n  {box}\n  style={combinedStyle}\n  {spin}\n  {flip}\n  {inverse}\n  {pulse}\n  class={className}\n  {...$$restProps}\n>\n  <slot>\n    {#each iconData?.paths || [] as path}\n      <path {...path} />\n    {/each}\n    {#each iconData?.polygons || [] as polygon}\n      <polygon {...polygon} />\n    {/each}\n    {#if iconData?.raw}\n      <Raw bind:data={iconData} />\n    {/if}\n  </slot>\n</Svg>\n\n<script context=\"module\"></script>\n\n<script>import Raw from './svg/Raw.svelte';\nimport Svg from './svg/Svg.svelte';\nlet className = '';\nexport let data;\nlet iconData;\nexport let scale = 1;\nexport let spin = false;\nexport let inverse = false;\nexport let pulse = false;\nexport let flip = undefined;\nexport let label = '';\nexport let style = '';\nexport { className as class };\n// internal\nlet childrenHeight = 0;\nlet childrenWidth = 0;\nlet outerScale = 1;\nlet width = 10;\nlet height = 10;\nlet combinedStyle;\nlet box;\nfunction normaliseData(data) {\n    let name;\n    let iconData;\n    if (!data) {\n        return undefined;\n    }\n    else if ('definition' in data) {\n        console.error(\"`import faIconName from '@fortawesome/package-name/faIconName` not supported - Please use `import { faIconName } from '@fortawesome/package-name/faIconName'` instead\");\n        return undefined;\n    }\n    else if ('iconName' in data && 'icon' in data) {\n        name = data.iconName;\n        // fontawesome v5/6 icon imported with:\n        // import { iconName } from '@fortawesome/packagename/iconName';\n        // import { iconName } from '@fortawesome/packagename';\n        const [width, height, , , path] = data.icon;\n        const paths = Array.isArray(path) ? path : [path];\n        iconData = {\n            width,\n            height,\n            paths: paths.map((path) => {\n                return { d: path };\n            })\n        };\n    }\n    else {\n        // inbuilt icons\n        name = Object.keys(data)[0];\n        iconData = data[name];\n    }\n    return iconData;\n}\nfunction normalisedScale() {\n    let numScale = 1;\n    if (typeof scale !== 'undefined') {\n        numScale = Number(scale);\n    }\n    if (isNaN(numScale) || numScale <= 0) {\n        console.warn('Invalid prop: prop \"scale\" should be a number over 0.');\n        return outerScale;\n    }\n    return numScale * outerScale;\n}\nfunction calculateBox() {\n    if (iconData) {\n        return `0 0 ${iconData.width} ${iconData.height}`;\n    }\n    return `0 0 ${width} ${height}`;\n}\nfunction calculateRatio() {\n    if (!iconData) {\n        return 1;\n    }\n    return Math.max(iconData.width, iconData.height) / 16;\n}\nfunction calculateWidth() {\n    if (childrenWidth) {\n        return childrenWidth;\n    }\n    if (iconData) {\n        return (iconData.width / calculateRatio()) * normalisedScale();\n    }\n    return 0;\n}\nfunction calculateHeight() {\n    if (childrenHeight) {\n        return childrenHeight;\n    }\n    if (iconData) {\n        return (iconData.height / calculateRatio()) * normalisedScale();\n    }\n    return 0;\n}\nfunction calculateStyle() {\n    let combined = '';\n    if (style !== null) {\n        combined += style;\n    }\n    let size = normalisedScale();\n    if (size === 1) {\n        if (combined.length === 0) {\n            return '';\n        }\n        return combined;\n    }\n    if (combined !== '' && !combined.endsWith(';')) {\n        combined += '; ';\n    }\n    return `${combined}font-size: ${size}em`;\n}\n$: {\n    iconData = normaliseData(data);\n    style;\n    scale;\n    width = calculateWidth();\n    height = calculateHeight();\n    combinedStyle = calculateStyle();\n    box = calculateBox();\n}\n</script>\n\n<svelte:options namespace=\"svg\" />\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { faCheckSquare, faSquare } from '@fortawesome/free-regular-svg-icons'\n  import type { JSONPath } from 'immutable-json-patch'\n  import { compileJSONPointer } from 'immutable-json-patch'\n  import Icon from 'svelte-awesome'\n  import type { OnPatch } from '$lib/types.js'\n\n  export let path: JSONPath\n  export let value: unknown\n  export let readOnly: boolean\n  export let onPatch: OnPatch\n  export let focus: () => void\n\n  function toggleBooleanValue(event: MouseEvent) {\n    event.stopPropagation()\n\n    if (readOnly) {\n      return\n    }\n\n    onPatch([\n      {\n        op: 'replace',\n        path: compileJSONPointer(path),\n        value: !value\n      }\n    ])\n\n    focus()\n  }\n</script>\n\n<div\n  role=\"checkbox\"\n  tabindex=\"-1\"\n  aria-checked={value === true}\n  class=\"jse-boolean-toggle\"\n  class:jse-readonly={readOnly}\n  on:mousedown={toggleBooleanValue}\n  title={!readOnly ? 'Click to toggle this boolean value' : `Boolean value ${value}`}\n>\n  <Icon data={value === true ? faCheckSquare : faSquare} />\n</div>\n\n<style src=\"./BooleanToggle.scss\"></style>\n","<script lang=\"ts\">\n  import { onDestroy, onMount } from 'svelte'\n\n  export let color: string\n  export let onChange: (newColor: string) => void\n  export let showOnTop: boolean\n\n  let ref: HTMLElement | undefined\n  let destroyColorPicker = () => {}\n\n  onMount(async () => {\n    // Dynamically import VanillaPicker, because it requires `document` to be defined,\n    // and that is not supported server side\n    const VanillaPicker = (await import('vanilla-picker'))?.default\n\n    const colorPicker = new VanillaPicker({\n      parent: ref,\n      color,\n      popup: showOnTop ? 'top' : 'bottom',\n      onDone: function (color) {\n        const alpha = color.rgba[3]\n        const hex =\n          alpha === 1\n            ? color.hex.substring(0, 7) // return #RRGGBB\n            : color.hex // return #RRGGBBAA\n        onChange(hex)\n      }\n    })\n\n    colorPicker.show()\n\n    destroyColorPicker = () => {\n      colorPicker.destroy()\n    }\n  })\n\n  onDestroy(() => {\n    destroyColorPicker()\n  })\n</script>\n\n<div class=\"jse-color-picker-popup\" bind:this={ref} />\n\n<style src=\"./ColorPickerPopup.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { getColorCSS } from '$lib/utils/typeUtils.js'\n  import { getWindow } from '$lib/utils/domUtils.js'\n  import type { JSONPath } from 'immutable-json-patch'\n  import { compileJSONPointer } from 'immutable-json-patch'\n  import { getContext } from 'svelte'\n  import ColorPickerPopup from '../../../components/controls/ColorPickerPopup.svelte'\n  import type { AbsolutePopupContext, OnPatch } from '$lib/types.js'\n\n  const { openAbsolutePopup } = getContext<AbsolutePopupContext>('absolute-popup')\n\n  export let path: JSONPath\n  export let value: string\n  export let readOnly: boolean\n  export let onPatch: OnPatch\n  export let focus: () => void\n\n  $: color = getColorCSS(value)\n\n  function onChange(color: string) {\n    onPatch([\n      {\n        op: 'replace',\n        path: compileJSONPointer(path),\n        value: color\n      }\n    ])\n\n    onClose()\n  }\n\n  function onClose() {\n    focus()\n  }\n\n  function openColorPicker(event: MouseEvent) {\n    if (readOnly) {\n      return\n    }\n\n    // estimate of the color picker height\n    // we'll render the color picker on top\n    // when there is not enough space below, and there is enough space above\n    const height = 300\n\n    const target = event.target as Element\n    const top = target.getBoundingClientRect().top\n    const windowHeight = getWindow(target)?.innerHeight ?? 0\n    const showOnTop = windowHeight - top < height && top > height\n\n    const props = {\n      color: value,\n      onChange,\n      showOnTop\n    }\n\n    openAbsolutePopup(ColorPickerPopup, props, {\n      anchor: target,\n      closeOnOuterClick: true,\n      onClose,\n      offsetTop: 18,\n      offsetLeft: -8,\n      height\n    })\n  }\n</script>\n\n<button\n  type=\"button\"\n  class=\"jse-color-picker-button\"\n  class:jse-readonly={readOnly}\n  style=\"background: {color}\"\n  title={!readOnly ? 'Click to open a color picker' : `Color ${value}`}\n  on:click={openColorPicker}\n/>\n\n<style src=\"./ColorPicker.scss\"></style>\n","import { sortBy } from 'lodash-es'\nimport { ARRAY_SECTION_SIZE } from '../constants.js'\nimport type { Section } from '$lib/types.js'\n\n/**\n * Create sections that can be expanded.\n * Used to display a button like \"Show items 100-200\"\n */\nexport function getExpandItemsSections(startIndex: number, endIndex: number): Section[] {\n  // expand the start of the section\n  const section1 = {\n    start: startIndex,\n    end: Math.min(nextRoundNumber(startIndex), endIndex)\n  }\n\n  // expand the middle of the section\n  const start2 = Math.max(currentRoundNumber((startIndex + endIndex) / 2), startIndex)\n  const section2 = {\n    start: start2,\n    end: Math.min(nextRoundNumber(start2), endIndex)\n  }\n\n  // expand the end of the section\n  const currentIndex = currentRoundNumber(endIndex)\n  const previousIndex = currentIndex === endIndex ? currentIndex - ARRAY_SECTION_SIZE : currentIndex\n  const section3 = {\n    start: Math.max(previousIndex, startIndex),\n    end: endIndex\n  }\n\n  const sections = [section1]\n\n  const showSection2 = section2.start >= section1.end && section2.end <= section3.start\n  if (showSection2) {\n    sections.push(section2)\n  }\n\n  const showSection3 = section3.start >= (showSection2 ? section2.end : section1.end)\n  if (showSection3) {\n    sections.push(section3)\n  }\n\n  return sections\n}\n\n/**\n * Sort and merge a list with sections\n */\nexport function mergeSections(sections: Section[]): Section[] {\n  const sortedSections = sortBy(sections, (section) => section.start)\n\n  const mergedSections = [sortedSections[0]]\n\n  for (let sortedIndex = 0; sortedIndex < sortedSections.length; sortedIndex++) {\n    const mergedIndex = mergedSections.length - 1\n    const previous = mergedSections[mergedIndex]\n    const current = sortedSections[sortedIndex]\n\n    if (current.start <= previous.end) {\n      // there is overlap -> replace the previous item\n      mergedSections[mergedIndex] = {\n        start: Math.min(previous.start, current.start),\n        end: Math.max(previous.end, current.end)\n      }\n    } else {\n      // no overlap, just add the item\n      mergedSections.push(current)\n    }\n  }\n\n  return mergedSections\n}\n\n// TODO: write unit test\nexport function inVisibleSection(sections: Section[], index: number): boolean {\n  return sections.some((section) => {\n    return index >= section.start && index < section.end\n  })\n}\n\nexport function nextRoundNumber(index: number): number {\n  return currentRoundNumber(index) + ARRAY_SECTION_SIZE\n}\n\nexport function currentRoundNumber(index: number): number {\n  return Math.floor(index / ARRAY_SECTION_SIZE) * ARRAY_SECTION_SIZE\n}\n","import {\n  compileJSONPointer,\n  existsIn,\n  getIn,\n  immutableJSONPatch,\n  isJSONArray,\n  isJSONObject,\n  isJSONPatchAdd,\n  isJSONPatchCopy,\n  isJSONPatchMove,\n  isJSONPatchRemove,\n  isJSONPatchReplace,\n  type JSONPatchAdd,\n  type JSONPatchCopy,\n  type JSONPatchDocument,\n  type JSONPatchMove,\n  type JSONPatchRemove,\n  type JSONPatchReplace,\n  type JSONPath,\n  type JSONPointer,\n  parseJSONPointer,\n  parsePath,\n  startsWithJSONPointer\n} from 'immutable-json-patch'\nimport { initial, isEqual, last } from 'lodash-es'\nimport { DEFAULT_VISIBLE_SECTIONS, MAX_DOCUMENT_SIZE_EXPAND_ALL } from '../constants.js'\nimport { forEachIndex } from '../utils/arrayUtils.js'\nimport { isObject, isObjectOrArray, isStringContainingPrimitiveValue } from '../utils/typeUtils.js'\nimport {\n  currentRoundNumber,\n  inVisibleSection,\n  mergeSections,\n  nextRoundNumber\n} from './expandItemsSections.js'\nimport type {\n  CaretPosition,\n  DocumentState,\n  JSONParser,\n  JSONPointerMap,\n  JSONSelection,\n  OnExpand,\n  Section,\n  VisibleSection\n} from '$lib/types'\nimport { CaretType } from '$lib/types.js'\nimport { int } from '../utils/numberUtils.js'\nimport { isLargeContent } from '$lib/utils/jsonUtils.js'\n\ntype OnCreateSelection = (json: unknown, documentState: DocumentState) => JSONSelection\n\nexport type CreateDocumentStateProps = {\n  json: unknown | undefined\n  expand?: OnExpand\n  select?: OnCreateSelection\n}\n\nexport function createDocumentState(props?: CreateDocumentStateProps): DocumentState {\n  let documentState: DocumentState = {\n    expandedMap: {},\n    enforceStringMap: {},\n    visibleSectionsMap: {},\n    selection: null,\n    sortedColumn: null\n  }\n\n  if (props?.select && props.json !== undefined) {\n    documentState = {\n      ...documentState,\n      selection: props.select(props.json, documentState)\n    }\n  }\n\n  if (props?.expand) {\n    documentState = expandWithCallback(props.json, documentState, [], props.expand)\n  }\n\n  return documentState\n}\n\nexport function getVisibleSections(\n  documentState: DocumentState,\n  pointer: JSONPointer\n): VisibleSection[] {\n  return documentState.visibleSectionsMap[pointer] || DEFAULT_VISIBLE_SECTIONS\n}\n\n/**\n * Invoke a callback function for every visible item in the array\n */\nexport function forEachVisibleIndex(\n  jsonArray: Array<unknown>,\n  visibleSections: VisibleSection[],\n  callback: (index: number) => void\n) {\n  visibleSections.forEach(({ start, end }) => {\n    forEachIndex(start, Math.min(jsonArray.length, end), callback)\n  })\n}\n\n/**\n * Expand all nodes on given path\n * The end of the path itself is not expanded\n */\nexport function expandPath(\n  json: unknown,\n  documentState: DocumentState,\n  path: JSONPath\n): DocumentState {\n  const expandedMap: JSONPointerMap<boolean> = { ...documentState.expandedMap }\n  const visibleSectionsMap = { ...documentState.visibleSectionsMap }\n\n  for (let i = 0; i < path.length; i++) {\n    const partialPath = path.slice(0, i)\n    const partialPointer = compileJSONPointer(partialPath)\n\n    const value = getIn(json, partialPath)\n\n    if (isObjectOrArray(value)) {\n      expandedMap[partialPointer] = true\n    }\n\n    // if needed, enlarge the expanded sections such that the search result becomes visible in the array\n    if (Array.isArray(value) && i < path.length) {\n      const sections = visibleSectionsMap[partialPointer] || DEFAULT_VISIBLE_SECTIONS\n      const index = int(path[i])\n\n      if (!inVisibleSection(sections, index)) {\n        const start = currentRoundNumber(index)\n        const end = nextRoundNumber(start)\n        const newSection = { start, end }\n        visibleSectionsMap[partialPointer] = mergeSections(sections.concat(newSection))\n      }\n    }\n  }\n\n  return {\n    ...documentState,\n    expandedMap,\n    visibleSectionsMap\n  }\n}\n\n/**\n * Expand a node, end expand its children according to the provided callback\n * Nodes that are already expanded will be left untouched\n */\nexport function expandWithCallback(\n  json: unknown | undefined,\n  documentState: DocumentState,\n  path: JSONPath,\n  expandedCallback: OnExpand\n): DocumentState {\n  const expandedMap = { ...documentState.expandedMap }\n\n  function recurse(value: unknown) {\n    const pathIndex = currentPath.length\n\n    if (Array.isArray(value)) {\n      if (expandedCallback(currentPath)) {\n        const pointer = compileJSONPointer(currentPath)\n        expandedMap[pointer] = true\n\n        if (value.length > 0) {\n          const visibleSections = getVisibleSections(documentState, pointer)\n\n          forEachVisibleIndex(value, visibleSections, (index) => {\n            currentPath[pathIndex] = String(index)\n            recurse(value[index])\n          })\n\n          currentPath.pop()\n        }\n      }\n    } else if (isObject(value)) {\n      if (expandedCallback(currentPath)) {\n        expandedMap[compileJSONPointer(currentPath)] = true\n\n        const keys = Object.keys(value)\n        if (keys.length > 0) {\n          for (const key of keys) {\n            currentPath[pathIndex] = key\n            recurse(value[key])\n          }\n\n          currentPath.pop()\n        }\n      }\n    }\n  }\n\n  const currentPath = path.slice()\n  const value = json !== undefined ? getIn(json, path) : json\n  if (value !== undefined) {\n    recurse(value)\n  }\n\n  return {\n    ...documentState,\n    expandedMap\n  }\n}\n\n// TODO: write unit tests\nexport function expandSingleItem(documentState: DocumentState, path: JSONPath): DocumentState {\n  return {\n    ...documentState,\n    expandedMap: {\n      ...documentState.expandedMap,\n      [compileJSONPointer(path)]: true\n    }\n  }\n}\n\n// TODO: write unit tests\nexport function collapsePath(documentState: DocumentState, path: JSONPath): DocumentState {\n  // delete the expanded state of the path and all it's nested paths\n  const expandedMap = deletePath(documentState.expandedMap, path)\n  const enforceStringMap = deletePath(documentState.enforceStringMap, path)\n  const visibleSectionsMap = deletePath(documentState.visibleSectionsMap, path)\n\n  return {\n    ...documentState,\n    expandedMap,\n    enforceStringMap,\n    visibleSectionsMap\n  }\n}\n\n// TODO: write unit tests\nexport function setEnforceString(\n  documentState: DocumentState,\n  pointer: JSONPointer,\n  enforceString: boolean\n): DocumentState {\n  if (enforceString) {\n    const updatedEnforceString = { ...documentState.enforceStringMap }\n    updatedEnforceString[pointer] = enforceString\n\n    return {\n      ...documentState,\n      enforceStringMap: updatedEnforceString\n    }\n  } else {\n    // remove if defined\n    if (typeof documentState.enforceStringMap[pointer] === 'boolean') {\n      const updatedEnforceString = { ...documentState.enforceStringMap }\n      delete updatedEnforceString[pointer]\n      return {\n        ...documentState,\n        enforceStringMap: updatedEnforceString\n      }\n    } else {\n      return documentState\n    }\n  }\n}\n\n/**\n * Expand a section of items in an array\n */\nexport function expandSection(\n  json: unknown,\n  documentState: DocumentState,\n  pointer: JSONPointer,\n  section: Section\n): DocumentState {\n  return {\n    ...documentState,\n    visibleSectionsMap: {\n      ...documentState.visibleSectionsMap,\n      [pointer]: mergeSections(getVisibleSections(documentState, pointer).concat(section))\n    }\n  }\n}\n\nexport function syncKeys(actualKeys: string[], prevKeys?: string[]): string[] {\n  if (!prevKeys) {\n    return actualKeys\n  }\n\n  // copy the keys that still exist\n  const actualKeysSet = new Set(actualKeys)\n  const keys = prevKeys.filter((key) => actualKeysSet.has(key))\n\n  // add new keys\n  const keysSet = new Set(keys)\n  actualKeys.filter((key) => !keysSet.has(key)).forEach((key) => keys.push(key))\n\n  return keys\n}\n\n/**\n * Apply patch operations to both json and state\n */\nexport function documentStatePatch(\n  json: unknown,\n  documentState: DocumentState,\n  operations: JSONPatchDocument\n): { json: unknown; documentState: DocumentState } {\n  const updatedJson: unknown = immutableJSONPatch(json, operations)\n\n  const updatedDocumentState = operations.reduce((updatingState, operation) => {\n    if (isJSONPatchAdd(operation)) {\n      return documentStateAdd(updatedJson, updatingState, operation)\n    }\n\n    if (isJSONPatchRemove(operation)) {\n      return documentStateRemove(updatedJson, updatingState, operation)\n    }\n\n    if (isJSONPatchReplace(operation)) {\n      return documentStateReplace(updatedJson, updatingState, operation)\n    }\n\n    if (isJSONPatchCopy(operation) || isJSONPatchMove(operation)) {\n      return documentStateMoveOrCopy(updatedJson, updatingState, operation)\n    }\n\n    return updatingState\n  }, documentState)\n\n  return {\n    json: updatedJson,\n    documentState: updatedDocumentState\n  }\n}\n\nexport function documentStateAdd(\n  json: unknown,\n  documentState: DocumentState,\n  operation: JSONPatchAdd\n): DocumentState {\n  const path = parsePath(json, operation.path)\n  const parentPath = initial(path)\n  const parentPointer = compileJSONPointer(parentPath)\n  const parent = getIn(json, parentPath)\n\n  if (isJSONArray(parent)) {\n    const index = int(last(path) as string)\n\n    // shift all paths of the relevant parts of the state\n    const expandedMap = shiftPath(documentState.expandedMap, parentPath, index, 1)\n    const enforceStringMap = shiftPath(documentState.enforceStringMap, parentPath, index, 1)\n    let visibleSectionsMap = shiftPath(documentState.visibleSectionsMap, parentPath, index, 1)\n\n    // shift visible sections of array\n    visibleSectionsMap = updateInPathsMap(visibleSectionsMap, parentPointer, (sections) =>\n      shiftVisibleSections(sections, index, 1)\n    )\n\n    return {\n      ...documentState,\n      expandedMap,\n      enforceStringMap,\n      visibleSectionsMap\n    }\n  }\n\n  // object, nothing to do\n  return documentState\n}\n\nexport function documentStateRemove(\n  updatedJson: unknown,\n  documentState: DocumentState,\n  operation: JSONPatchRemove\n): DocumentState {\n  const path = parsePath(updatedJson, operation.path)\n  const parentPath = initial(path)\n  const parentPointer = compileJSONPointer(parentPath)\n  const parent = getIn(updatedJson, parentPath)\n\n  let { expandedMap, enforceStringMap, visibleSectionsMap } = documentState\n\n  // delete the path itself and its children\n  expandedMap = deletePath(expandedMap, path)\n  enforceStringMap = deletePath(enforceStringMap, path)\n  visibleSectionsMap = deletePath(visibleSectionsMap, path)\n\n  if (isJSONArray(parent)) {\n    const index = int(last(path) as string)\n\n    // shift all paths of the relevant parts of the state\n    expandedMap = shiftPath(expandedMap, parentPath, index, -1)\n    enforceStringMap = shiftPath(enforceStringMap, parentPath, index, -1)\n    visibleSectionsMap = shiftPath(visibleSectionsMap, parentPath, index, -1)\n\n    // shift visible sections of array\n    visibleSectionsMap = updateInPathsMap(visibleSectionsMap, parentPointer, (sections) =>\n      shiftVisibleSections(sections, index, -1)\n    )\n  }\n\n  return {\n    ...documentState,\n    expandedMap,\n    enforceStringMap,\n    visibleSectionsMap\n  }\n}\n\nexport function documentStateReplace(\n  updatedJson: unknown,\n  documentState: DocumentState,\n  operation: JSONPatchReplace\n): DocumentState {\n  const pointer = operation.path\n\n  // cleanup state from paths that are removed now\n  const expandedMap = cleanupNonExistingPaths(updatedJson, documentState.expandedMap)\n  const enforceStringMap = cleanupNonExistingPaths(updatedJson, documentState.enforceStringMap)\n  const visibleSectionsMap = cleanupNonExistingPaths(updatedJson, documentState.visibleSectionsMap)\n\n  // cleanup props of the object/array/value itself that are not applicable anymore\n  if (!isJSONObject(operation.value) && !isJSONArray(operation.value)) {\n    delete expandedMap[pointer]\n  }\n  if (!isJSONArray(operation.value)) {\n    delete visibleSectionsMap[pointer]\n  }\n  if (isJSONObject(operation.value) || isJSONArray(operation.value)) {\n    delete enforceStringMap[pointer]\n  }\n\n  return {\n    ...documentState,\n    expandedMap,\n    enforceStringMap,\n    visibleSectionsMap\n  }\n}\n\nexport function documentStateMoveOrCopy(\n  updatedJson: unknown,\n  documentState: DocumentState,\n  operation: JSONPatchCopy | JSONPatchMove\n): DocumentState {\n  if (isJSONPatchMove(operation) && operation.from === operation.path) {\n    // nothing to do\n    return documentState\n  }\n\n  // get the state that we will move or copy, and move it to the new location\n  const renamePointer = (pointer: JSONPointer) =>\n    operation.path + pointer.substring(operation.from.length)\n  const expandedMapCopy = movePath(\n    filterPath(documentState.expandedMap, operation.from),\n    renamePointer\n  )\n  const enforceStringMapCopy = movePath(\n    filterPath(documentState.enforceStringMap, operation.from),\n    renamePointer\n  )\n  const visibleSectionsMapCopy = movePath(\n    filterPath(documentState.visibleSectionsMap, operation.from),\n    renamePointer\n  )\n\n  // patch the document state: use the remove and add operations to apply a move or copy\n  // note that `value` is just a fake value, we do not use this for real\n  let updatedState = documentState\n  if (isJSONPatchMove(operation)) {\n    updatedState = documentStateRemove(updatedJson, updatedState, {\n      op: 'remove',\n      path: operation.from\n    })\n  }\n  updatedState = documentStateAdd(updatedJson, updatedState, {\n    op: 'add',\n    path: operation.path,\n    value: null\n  })\n\n  // merge the original and the copied state\n  const expandedMap = mergePaths(updatedState.expandedMap, expandedMapCopy)\n  const enforceStringMap = mergePaths(updatedState.enforceStringMap, enforceStringMapCopy)\n  const visibleSectionsMap = mergePaths(updatedState.visibleSectionsMap, visibleSectionsMapCopy)\n\n  return {\n    ...documentState,\n    expandedMap,\n    enforceStringMap,\n    visibleSectionsMap\n  }\n}\n\n/**\n * Delete a path from a PathsMap. Will delete the path and its child paths\n * IMPORTANT: will NOT shift array items when an array item is removed, use shiftPath for that\n */\nexport function deletePath<T>(map: JSONPointerMap<T>, path: JSONPath): JSONPointerMap<T> {\n  const updatedMap: JSONPointerMap<T> = {}\n  const pointer = compileJSONPointer(path)\n\n  // partition the contents of the map\n  Object.keys(map).forEach((itemPointer) => {\n    if (!startsWithJSONPointer(itemPointer, pointer)) {\n      updatedMap[itemPointer] = map[itemPointer]\n    }\n  })\n\n  return updatedMap\n}\n\n// TODO: unit test\nexport function filterPath<T>(map: JSONPointerMap<T>, pointer: JSONPointer): JSONPointerMap<T> {\n  const filteredMap: JSONPointerMap<T> = {}\n\n  Object.keys(map).forEach((itemPointer) => {\n    if (startsWithJSONPointer(itemPointer, pointer)) {\n      filteredMap[itemPointer] = map[itemPointer]\n    }\n  })\n\n  return filteredMap\n}\n\n// TODO: unit test\nexport function mergePaths<T>(a: JSONPointerMap<T>, b: JSONPointerMap<T>): JSONPointerMap<T> {\n  return { ...a, ...b }\n}\n\n// TODO: unit test\nexport function movePath<T>(\n  map: JSONPointerMap<T>,\n  changePointer: (pointer: JSONPointer) => JSONPointer\n): JSONPointerMap<T> {\n  const movedMap: JSONPointerMap<T> = {}\n\n  Object.keys(map).forEach((oldPointer) => {\n    const newPointer = changePointer(oldPointer)\n    movedMap[newPointer] = map[oldPointer]\n  })\n\n  return movedMap\n}\n\nexport function shiftPath<T>(\n  map: JSONPointerMap<T>,\n  path: JSONPath,\n  index: number,\n  offset: number\n): JSONPointerMap<T> {\n  const indexPathPos = path.length\n  const pointer = compileJSONPointer(path)\n\n  // collect all paths that need to be shifted, with their old path, new path, and value\n  const matches: { oldPointer: JSONPointer; newPointer: JSONPointer; value: T }[] = []\n  for (const itemPointer of Object.keys(map)) {\n    if (startsWithJSONPointer(itemPointer, pointer)) {\n      const itemPath: JSONPath = parseJSONPointer(itemPointer)\n      const pathIndex = int(itemPath[indexPathPos])\n\n      if (pathIndex >= index) {\n        itemPath[indexPathPos] = String(pathIndex + offset)\n\n        matches.push({\n          oldPointer: itemPointer,\n          newPointer: compileJSONPointer(itemPath),\n          value: map[itemPointer]\n        })\n      }\n    }\n  }\n\n  // if there are no changes, just return the original map\n  if (matches.length === 0) {\n    return map\n  }\n\n  const updatedMap = { ...map }\n\n  // delete all old paths from the map\n  // we do this *before* inserting new paths to prevent deleting a math that is already moved\n  matches.forEach((match) => {\n    delete updatedMap[match.oldPointer]\n  })\n\n  // insert shifted paths in the map\n  matches.forEach((match) => {\n    updatedMap[match.newPointer] = match.value\n  })\n\n  return updatedMap\n}\n\n// TODO: unit test\nexport function cleanupNonExistingPaths<T>(\n  json: unknown,\n  map: JSONPointerMap<T>\n): JSONPointerMap<T> {\n  const updatedMap: JSONPointerMap<T> = {}\n\n  // TODO: for optimization, we could pass a filter callback which allows you to filter paths\n  //  starting with a specific, so you don't need to invoke parseJSONPointer and existsIn for largest part\n\n  Object.keys(map)\n    .filter((pointer) => existsIn(json, parsePath(json, pointer)))\n    .forEach((pointer) => {\n      updatedMap[pointer] = map[pointer]\n    })\n\n  return updatedMap\n}\n\n/**\n * Update a value in a PathsMap.\n * When the path exists, the callback will be invoked.\n * When the path does not exist, the callback is not invoked.\n */\nexport function updateInPathsMap<T>(\n  map: JSONPointerMap<T>,\n  pointer: JSONPointer,\n  callback: (value: T) => T\n) {\n  const value = map[pointer]\n\n  if (pointer in map) {\n    const updatedValue = callback(value)\n    if (!isEqual(value, updatedValue)) {\n      const updatedMap = { ...map }\n\n      if (updatedValue === undefined) {\n        delete updatedMap[pointer]\n      } else {\n        updatedMap[pointer] = updatedValue\n      }\n\n      return updatedMap\n    }\n  }\n\n  return map\n}\n\n/**\n * Shift visible sections in an Array with a specified offset\n */\nexport function shiftVisibleSections(\n  visibleSections: VisibleSection[],\n  index: number,\n  offset: number\n): VisibleSection[] {\n  const shiftedSections = visibleSections.map((section) => {\n    return {\n      start: section.start > index ? section.start + offset : section.start,\n      end: section.end > index ? section.end + offset : section.end\n    }\n  })\n\n  return mergeAdjacentSections(shiftedSections)\n}\n\n// merge adjacent sections like [{start:0, end:100}, {start:100, end:200}] into [{start:0, end:200}]\nfunction mergeAdjacentSections(visibleSections: VisibleSection[]): VisibleSection[] {\n  const merged = visibleSections.slice(0)\n\n  let i = 1\n  while (i < merged.length) {\n    if (merged[i - 1].end === merged[i].start) {\n      merged[i - 1] = {\n        start: merged[i - 1].start,\n        end: merged[i].end\n      }\n      merged.splice(i)\n    }\n    i++\n  }\n\n  return merged\n}\n\nexport function getEnforceString(\n  value: unknown,\n  enforceStringMap: JSONPointerMap<boolean> | undefined,\n  pointer: JSONPointer,\n  parser: JSONParser\n): boolean {\n  const enforceString = enforceStringMap ? enforceStringMap[pointer] : undefined\n\n  if (typeof enforceString === 'boolean') {\n    return enforceString\n  }\n\n  return isStringContainingPrimitiveValue(value, parser)\n}\n\nexport function getNextKeys(keys: string[], key: string, includeKey = false): string[] {\n  const index = keys.indexOf(key)\n  if (index !== -1) {\n    return includeKey ? keys.slice(index) : keys.slice(index + 1)\n  } else {\n    // a new key, that doesn't have next keys\n    return []\n  }\n}\n\n/**\n * Get all paths which are visible and rendered\n */\n// TODO: create memoized version of getVisiblePaths which remembers just the previous result if json and state are the same\nexport function getVisiblePaths(json: unknown, documentState: DocumentState): JSONPath[] {\n  const paths: JSONPath[] = []\n\n  function _recurse(value: unknown, path: JSONPath) {\n    paths.push(path)\n    const pointer = compileJSONPointer(path)\n\n    if (value && documentState.expandedMap[pointer] === true) {\n      if (isJSONArray(value)) {\n        const visibleSections = getVisibleSections(documentState, pointer)\n        forEachVisibleIndex(value, visibleSections, (index) => {\n          _recurse(value[index], path.concat(String(index)))\n        })\n      }\n\n      if (isJSONObject(value)) {\n        Object.keys(value).forEach((key) => {\n          _recurse(value[key], path.concat(key))\n        })\n      }\n    }\n  }\n\n  _recurse(json, [])\n\n  return paths\n}\n\n/**\n * Get all caret position which are visible and rendered:\n * before a node, at a key, at a value, appending an object/array\n */\n// TODO: create memoized version of getVisibleCaretPositions which remembers just the previous result if json and state are the same\nexport function getVisibleCaretPositions(\n  json: unknown,\n  documentState: DocumentState,\n  includeInside = true\n): CaretPosition[] {\n  const paths: CaretPosition[] = []\n\n  function _recurse(value: unknown, path: JSONPath) {\n    paths.push({ path, type: CaretType.value })\n\n    const pointer = compileJSONPointer(path)\n    if (value && documentState.expandedMap[pointer] === true) {\n      if (includeInside) {\n        paths.push({ path, type: CaretType.inside })\n      }\n\n      if (isJSONArray(value)) {\n        const visibleSections = getVisibleSections(documentState, pointer)\n        forEachVisibleIndex(value, visibleSections, (index) => {\n          const itemPath = path.concat(String(index))\n\n          _recurse(value[index], itemPath)\n\n          if (includeInside) {\n            paths.push({ path: itemPath, type: CaretType.after })\n          }\n        })\n      }\n\n      if (isJSONObject(value)) {\n        const keys = Object.keys(value)\n        keys.forEach((key) => {\n          const propertyPath = path.concat(key)\n\n          paths.push({ path: propertyPath, type: CaretType.key })\n\n          _recurse(value[key], propertyPath)\n\n          if (includeInside) {\n            paths.push({ path: propertyPath, type: CaretType.after })\n          }\n        })\n      }\n    }\n  }\n\n  _recurse(json, [])\n\n  return paths\n}\n\n/**\n * Find the previous visible path.\n * This can be the last child of the previous object or array, or the parent of a first entry.\n */\n// TODO: write tests for getPreviousVisiblePath\nexport function getPreviousVisiblePath(\n  json: unknown,\n  documentState: DocumentState,\n  path: JSONPath\n): JSONPath | null {\n  const visiblePaths = getVisiblePaths(json, documentState)\n  const visiblePathPointers = visiblePaths.map(compileJSONPointer)\n  const pathPointer = compileJSONPointer(path)\n  const index = visiblePathPointers.indexOf(pathPointer)\n\n  if (index !== -1 && index > 0) {\n    return visiblePaths[index - 1]\n  }\n\n  return null\n}\n\n/**\n * Find the next visible path.\n * This can be the next parent entry.\n */\n// TODO: write tests for getNextVisiblePath\nexport function getNextVisiblePath(\n  json: unknown,\n  documentState: DocumentState,\n  path: JSONPath\n): JSONPath | null {\n  const visiblePaths = getVisiblePaths(json, documentState)\n  const visiblePathPointers = visiblePaths.map(compileJSONPointer)\n  const index = visiblePathPointers.indexOf(compileJSONPointer(path))\n\n  if (index !== -1 && index < visiblePaths.length - 1) {\n    return visiblePaths[index + 1]\n  }\n\n  return null\n}\n\n/**\n * Expand recursively when the expanded contents is small enough,\n * else expand in a minimalistic way\n */\n// TODO: write unit test\nexport function expandRecursive(\n  json: unknown,\n  documentState: DocumentState,\n  path: JSONPath\n): DocumentState {\n  const expandContents: unknown | undefined = getIn(json, path)\n  if (expandContents === undefined) {\n    return documentState\n  }\n\n  const expandAllRecursive = !isLargeContent({ json: expandContents }, MAX_DOCUMENT_SIZE_EXPAND_ALL)\n  const expandCallback = expandAllRecursive ? expandAll : expandMinimal\n\n  return expandWithCallback(json, documentState, path, expandCallback)\n}\n\n// TODO: write unit test\nexport function expandMinimal(path: JSONPath): boolean {\n  return path.length === 0 ? true : path.length === 1 && path[0] === '0' // first item of an array\n}\n\n// TODO: write unit test\nexport function expandAll(): boolean {\n  return true\n}\n\n// TODO: write unit test\nexport function getDefaultExpand(json: unknown): OnExpand {\n  return isLargeContent({ json }, MAX_DOCUMENT_SIZE_EXPAND_ALL) ? expandMinimal : expandAll\n}\n","import {\n  getIn,\n  isJSONArray,\n  isJSONObject,\n  isJSONPatchCopy,\n  isJSONPatchMove,\n  type JSONPatchDocument,\n  type JSONPatchOperation,\n  type JSONPath,\n  parsePath\n} from 'immutable-json-patch'\nimport { first, initial, isEmpty, isEqual, last } from 'lodash-es'\nimport { isObjectOrArray } from '$lib/utils/typeUtils.js'\nimport {\n  collapsePath,\n  getNextVisiblePath,\n  getPreviousVisiblePath,\n  getVisibleCaretPositions,\n  getVisiblePaths\n} from './documentState.js'\nimport type {\n  AfterSelection,\n  CaretPosition,\n  DocumentState,\n  InsideSelection,\n  JSONEditorSelection,\n  JSONParser,\n  JSONSelection,\n  KeySelection,\n  MultiSelection,\n  TextSelection,\n  ValueSelection\n} from '../types.js'\nimport { CaretType, SelectionType } from '$lib/types.js'\nimport { int } from '$lib/utils/numberUtils.js'\n\nexport function isAfterSelection(\n  selection: JSONEditorSelection | null\n): selection is AfterSelection {\n  return (selection && selection.type === SelectionType.after) || false\n}\n\nexport function isInsideSelection(\n  selection: JSONEditorSelection | null\n): selection is InsideSelection {\n  return (selection && selection.type === SelectionType.inside) || false\n}\n\nexport function isKeySelection(selection: JSONEditorSelection | null): selection is KeySelection {\n  return (selection && selection.type === SelectionType.key) || false\n}\n\nexport function isValueSelection(\n  selection: JSONEditorSelection | null\n): selection is ValueSelection {\n  return (selection && selection.type === SelectionType.value) || false\n}\n\nexport function isMultiSelection(\n  selection: JSONEditorSelection | null\n): selection is MultiSelection {\n  return (selection && selection.type === SelectionType.multi) || false\n}\n\nexport function isMultiSelectionWithOneItem(\n  selection: JSONEditorSelection | null\n): selection is MultiSelection {\n  return isMultiSelection(selection) && isEqual(selection.focusPath, selection.anchorPath)\n}\n\nexport function isJSONSelection(selection: JSONEditorSelection | null): selection is JSONSelection {\n  return (\n    isMultiSelection(selection) ||\n    isAfterSelection(selection) ||\n    isInsideSelection(selection) ||\n    isKeySelection(selection) ||\n    isValueSelection(selection)\n  )\n}\n\nexport function isTextSelection(selection: JSONEditorSelection | null): selection is TextSelection {\n  return (selection && selection.type === SelectionType.text) || false\n}\n\n/**\n * Expand a selection start and end into an array containing all paths\n * between (and including) start and end\n */\nexport function getSelectionPaths(json: unknown, selection: JSONSelection): JSONPath[] {\n  const paths: JSONPath[] = []\n\n  iterateOverSelection(json, selection, (path) => {\n    paths.push(path)\n  })\n\n  return paths\n}\n\n/**\n * Expand a selection start and end into an array containing all paths\n * between (and including) start and end.\n *\n * The function iterates always from start to end, independent of the order\n * of focusPath and anchorPath.\n *\n * When the callback returns something other than undefined, the iteration is\n * canceled and the value returned by the callback is returned by iterateOverSelection.\n */\nexport function iterateOverSelection<T>(\n  json: unknown | undefined,\n  selection: JSONSelection | null,\n  callback: (path: JSONPath) => void | undefined | T\n): void | undefined | T {\n  if (!selection) {\n    return undefined\n  }\n\n  const anchorPath = getAnchorPath(selection)\n  const focusPath = getFocusPath(selection)\n\n  if (isEqual(anchorPath, focusPath)) {\n    // just a single node\n    return callback(anchorPath)\n  } else {\n    // multiple nodes\n    if (json === undefined) {\n      return undefined\n    }\n\n    const sharedPath = findSharedPath(anchorPath, focusPath)\n\n    if (anchorPath.length === sharedPath.length || focusPath.length === sharedPath.length) {\n      // a parent and a child, like ['arr', 1] and ['arr']\n      return callback(sharedPath)\n    }\n\n    const selection = createMultiSelection(anchorPath, focusPath)\n    const startPath = getStartPath(json, selection)\n    const endPath = getEndPath(json, selection)\n\n    const startIndex = getChildIndex(json, selection, startPath)\n    const endIndex = getChildIndex(json, selection, endPath)\n\n    if (startIndex === -1 || endIndex === -1) {\n      return undefined\n    }\n\n    const value = getIn(json, sharedPath)\n\n    if (isJSONObject(value)) {\n      const keys = Object.keys(value)\n\n      for (let i = startIndex; i <= endIndex; i++) {\n        const value = callback(sharedPath.concat(keys[i]))\n        if (value !== undefined) {\n          return value\n        }\n      }\n\n      return undefined\n    }\n\n    if (isJSONArray(value)) {\n      for (let i = startIndex; i <= endIndex; i++) {\n        const value = callback(sharedPath.concat(String(i)))\n        if (value !== undefined) {\n          return value\n        }\n      }\n\n      return undefined\n    }\n  }\n\n  throw new Error('Failed to create selection')\n}\n\nexport function getParentPath(selection: JSONSelection): JSONPath {\n  if (isInsideSelection(selection)) {\n    return selection.path\n  } else {\n    return initial(getFocusPath(selection))\n  }\n}\n\nexport function getStartPath(json: unknown, selection: JSONSelection): JSONPath {\n  if (!isMultiSelection(selection)) {\n    return selection.path\n  }\n\n  const anchorIndex = getChildIndex(json, selection, selection.anchorPath)\n  const focusIndex = getChildIndex(json, selection, selection.focusPath)\n\n  return focusIndex < anchorIndex ? selection.focusPath : selection.anchorPath\n}\n\nexport function getEndPath(json: unknown, selection: JSONSelection): JSONPath {\n  if (!isMultiSelection(selection)) {\n    return selection.path\n  }\n\n  const anchorIndex = getChildIndex(json, selection, selection.anchorPath)\n  const focusIndex = getChildIndex(json, selection, selection.focusPath)\n\n  return focusIndex > anchorIndex ? selection.focusPath : selection.anchorPath\n}\n\n// TODO: write unit test\nexport function isSelectionInsidePath(selection: JSONSelection, path: JSONPath): boolean {\n  return (\n    pathStartsWith(getFocusPath(selection), path) &&\n    (getFocusPath(selection).length > path.length || isInsideSelection(selection))\n  )\n}\n\nexport function getSelectionUp(\n  json: unknown,\n  documentState: DocumentState,\n  keepAnchorPath = false\n): JSONSelection | null {\n  const selection = documentState.selection\n  if (!selection) {\n    return null\n  }\n\n  const focusPath = keepAnchorPath ? getFocusPath(selection) : getStartPath(json, selection)\n  const previousPath = getPreviousVisiblePath(json, documentState, focusPath)\n\n  if (keepAnchorPath) {\n    // create a multi-selection with multiple nodes\n    if (isInsideSelection(selection) || isAfterSelection(selection)) {\n      return previousPath !== null ? createMultiSelection(focusPath, focusPath) : null\n    }\n\n    return previousPath !== null\n      ? createMultiSelection(getAnchorPath(selection), previousPath)\n      : null\n  }\n\n  if (isAfterSelection(selection)) {\n    // select the node itself, not the previous node,\n    // FIXME: when after an expanded object/array, should go to the last item inside the object/array\n    return createValueSelection(focusPath, false)\n  }\n\n  if (isInsideSelection(selection)) {\n    // select the node itself, not the previous node,\n    return createValueSelection(focusPath, false)\n  }\n\n  if (isKeySelection(selection)) {\n    if (previousPath == null || previousPath.length === 0) {\n      return null\n    }\n\n    const parentPath = initial(previousPath)\n    const parent = getIn(json, parentPath)\n    if (Array.isArray(parent) || isEmpty(previousPath)) {\n      // switch to value selection: array has no keys, and root object also not\n      return createValueSelection(previousPath, false)\n    } else {\n      return createKeySelection(previousPath, false)\n    }\n  }\n\n  if (isValueSelection(selection)) {\n    return previousPath !== null ? createValueSelection(previousPath, false) : null\n  }\n\n  if (previousPath !== null) {\n    return createValueSelection(previousPath, false)\n  }\n\n  return null\n}\n\nexport function getSelectionDown(\n  json: unknown,\n  documentState: DocumentState,\n  keepAnchorPath = false\n): JSONSelection | null {\n  const selection = documentState.selection\n  if (!selection) {\n    return null\n  }\n  const focusPath = keepAnchorPath ? getFocusPath(selection) : getEndPath(json, selection)\n\n  // if the focusPath is an Array or object, we must not step into it but\n  // over it, we pass state with this array/object collapsed\n  const collapsedState = isObjectOrArray(getIn(json, focusPath))\n    ? collapsePath(documentState, focusPath)\n    : documentState\n\n  const nextPath = getNextVisiblePath(json, documentState, focusPath)\n  const nextPathAfter = getNextVisiblePath(json, collapsedState, focusPath)\n\n  if (keepAnchorPath) {\n    // create a multi-selection with multiple nodes\n    if (isInsideSelection(selection)) {\n      return nextPath !== null ? createMultiSelection(nextPath, nextPath) : null\n    }\n\n    if (isAfterSelection(selection)) {\n      return nextPathAfter !== null ? createMultiSelection(nextPathAfter, nextPathAfter) : null\n    }\n\n    return nextPathAfter !== null\n      ? createMultiSelection(getAnchorPath(selection), nextPathAfter)\n      : null\n  }\n\n  if (isAfterSelection(selection)) {\n    return nextPathAfter !== null ? createValueSelection(nextPathAfter, false) : null\n  }\n\n  if (isInsideSelection(selection)) {\n    return nextPath !== null ? createValueSelection(nextPath, false) : null\n  }\n\n  if (isValueSelection(selection)) {\n    return nextPath !== null ? createValueSelection(nextPath, false) : null\n  }\n\n  if (isKeySelection(selection)) {\n    if (nextPath === null || nextPath.length === 0) {\n      return null\n    }\n\n    const parentPath = initial(nextPath) // not nextPathAfter!\n    const parent = getIn(json, parentPath)\n    if (Array.isArray(parent)) {\n      // switch to value selection: array has no keys\n      return createValueSelection(nextPath, false)\n    } else {\n      return createKeySelection(nextPath, false)\n    }\n  }\n\n  if (isMultiSelection(selection)) {\n    return nextPathAfter !== null\n      ? createValueSelection(nextPathAfter, false)\n      : nextPath !== null\n        ? createValueSelection(nextPath, false)\n        : null\n  }\n\n  return null\n}\n\n/**\n * Get the next selection for a value inside the current object/array\n * If there is no next value, select AFTER.\n * Only applicable for ValueSelection\n */\nexport function getSelectionNextInside(\n  json: unknown,\n  documentState: DocumentState,\n  path: JSONPath\n): JSONSelection | null {\n  // TODO: write unit tests for getSelectionNextInside\n  const parentPath = initial(path)\n  const childPath = [last(path) as string]\n\n  const parent: unknown | undefined = getIn(json, parentPath)\n  const nextPathInside = parent ? getNextVisiblePath(parent, documentState, childPath) : undefined\n\n  if (nextPathInside) {\n    return createValueSelection(parentPath.concat(nextPathInside), false)\n  } else {\n    return createAfterSelection(path)\n  }\n}\n\n/**\n * Find the caret position and its siblings for a given selection\n */\n// TODO: unit test\nexport function findCaretAndSiblings(\n  json: unknown,\n  documentState: DocumentState,\n  includeInside: boolean\n): { next: CaretPosition | null; caret: CaretPosition | null; previous: CaretPosition | null } {\n  const selection = documentState.selection\n  if (!selection) {\n    return { caret: null, previous: null, next: null }\n  }\n  const visibleCaretPositions = getVisibleCaretPositions(json, documentState, includeInside)\n\n  const index = visibleCaretPositions.findIndex((caret) => {\n    return (\n      isEqual(caret.path, getFocusPath(selection)) && String(caret.type) === String(selection.type)\n    )\n  })\n\n  return {\n    caret: index !== -1 ? visibleCaretPositions[index] : null,\n\n    previous: index !== -1 && index > 0 ? visibleCaretPositions[index - 1] : null,\n\n    next:\n      index !== -1 && index < visibleCaretPositions.length - 1\n        ? visibleCaretPositions[index + 1]\n        : null\n  }\n}\n\nexport function getSelectionLeft(\n  json: unknown,\n  documentState: DocumentState,\n  keepAnchorPath = false,\n  includeInside = true\n): JSONSelection | null {\n  const selection = documentState.selection\n  if (!selection) {\n    return null\n  }\n\n  const { caret, previous } = findCaretAndSiblings(json, documentState, includeInside)\n\n  if (keepAnchorPath) {\n    if (!isMultiSelection(selection)) {\n      return createMultiSelection(selection.path, selection.path)\n    }\n\n    return null\n  }\n\n  if (caret && previous) {\n    return fromCaretPosition(previous)\n  }\n\n  const parentPath = initial(getFocusPath(selection))\n  const parent = getIn(json, parentPath)\n\n  if (isValueSelection(selection) && Array.isArray(parent)) {\n    return createMultiSelection(selection.path, selection.path)\n  }\n\n  if (isMultiSelection(selection) && !Array.isArray(parent)) {\n    return createKeySelection(selection.focusPath, false)\n  }\n\n  return null\n}\n\nexport function getSelectionRight(\n  json: unknown,\n  documentState: DocumentState,\n  keepAnchorPath = false,\n  includeInside = true\n): JSONSelection | null {\n  const selection = documentState.selection\n  if (!selection) {\n    return null\n  }\n\n  const { caret, next } = findCaretAndSiblings(json, documentState, includeInside)\n\n  if (keepAnchorPath) {\n    if (!isMultiSelection(selection)) {\n      return createMultiSelection(selection.path, selection.path)\n    }\n\n    return null\n  }\n\n  if (caret && next) {\n    return fromCaretPosition(next)\n  }\n\n  if (isMultiSelection(selection)) {\n    return createValueSelection(selection.focusPath, false)\n  }\n\n  return null\n}\n\n/**\n * Get a proper initial selection based on what is visible\n */\nexport function getInitialSelection(json: unknown, documentState: DocumentState): JSONSelection {\n  const visiblePaths = getVisiblePaths(json, documentState)\n\n  // find the first, deepest nested entry (normally a value, not an Object/Array)\n  let index = 0\n  while (\n    index < visiblePaths.length - 1 &&\n    visiblePaths[index + 1].length > visiblePaths[index].length\n  ) {\n    index++\n  }\n\n  const path = visiblePaths[index]\n  return path === undefined || path.length === 0 || Array.isArray(getIn(json, initial(path)))\n    ? createValueSelection(path, false) // Array items and root object/array do not have a key, so select value in that case\n    : createKeySelection(path, false)\n}\n\nexport function createSelectionFromOperations(\n  json: unknown,\n  operations: JSONPatchDocument\n): JSONSelection | null {\n  if (operations.length === 1) {\n    const operation = first(operations) as JSONPatchOperation\n    if (operation.op === 'replace') {\n      // a replaced value\n      const path = parsePath(json, operation.path)\n\n      return createValueSelection(path, false)\n    }\n  }\n\n  if (!isEmpty(operations) && operations.every((operation) => operation.op === 'move')) {\n    const firstOp = first(operations)\n    const otherOps = operations.slice(1)\n\n    if (\n      (isJSONPatchCopy(firstOp) || isJSONPatchMove(firstOp)) &&\n      firstOp.from !== firstOp.path &&\n      otherOps.every((op) => (isJSONPatchCopy(op) || isJSONPatchMove(op)) && op.from === op.path)\n    ) {\n      // a renamed key\n      const path = parsePath(json, firstOp.path)\n\n      return createKeySelection(path, false)\n    }\n  }\n\n  const paths = operations\n    .filter((operation) => {\n      return (\n        operation.op !== 'test' &&\n        operation.op !== 'remove' &&\n        (operation.op !== 'move' || operation.from !== operation.path) &&\n        typeof operation.path === 'string'\n      )\n    })\n    .map((operation) => parsePath(json, operation.path))\n\n  if (isEmpty(paths)) {\n    return null\n  }\n\n  // TODO: make this function robust against operations which do not have consecutive paths or have wrongly ordered paths\n\n  return {\n    type: SelectionType.multi,\n    anchorPath: first(paths) as JSONPath,\n    focusPath: last(paths) as JSONPath\n  }\n}\n\n/**\n * Find the common path of two paths.\n * For example findCommonRoot(['arr', '1', 'name'], ['arr', '1', 'address', 'contact']) returns ['arr', '1']\n */\n// TODO: write unit tests for findSharedPath\nexport function findSharedPath(path1: JSONPath, path2: JSONPath): JSONPath {\n  let i = 0\n  while (i < path1.length && i < path2.length && path1[i] === path2[i]) {\n    i++\n  }\n\n  return path1.slice(0, i)\n}\n\nexport function singleItemSelected(selection: JSONSelection | null): boolean {\n  return (\n    isKeySelection(selection) ||\n    isValueSelection(selection) ||\n    isMultiSelectionWithOneItem(selection)\n  )\n}\n\nexport function findRootPath(json: unknown, selection: JSONSelection): JSONPath {\n  return singleItemSelected(selection) && isObjectOrArray(getIn(json, getFocusPath(selection)))\n    ? getFocusPath(selection)\n    : initial(getFocusPath(selection)) // the parent path of the paths\n}\n\n// TODO: unit test\nexport function pathStartsWith(path: JSONPath, parentPath: JSONPath): boolean {\n  if (path.length < parentPath.length) {\n    return false\n  }\n\n  for (let i = 0; i < parentPath.length; i++) {\n    if (path[i] !== parentPath[i]) {\n      return false\n    }\n  }\n\n  return true\n}\n\n// TODO: write unit tests\nexport function removeEditModeFromSelection(documentState: DocumentState): DocumentState {\n  const selection = documentState.selection\n\n  if ((isKeySelection(selection) || isValueSelection(selection)) && selection.edit) {\n    return {\n      ...documentState,\n      selection: {\n        ...selection,\n        edit: false\n      }\n    }\n  }\n\n  return documentState\n}\n\nexport function createKeySelection(path: JSONPath, edit: boolean): KeySelection {\n  return {\n    type: SelectionType.key,\n    path,\n    edit\n  }\n}\n\nexport function createValueSelection(path: JSONPath, edit: boolean): ValueSelection {\n  return {\n    type: SelectionType.value,\n    path,\n    edit\n  }\n}\n\nexport function createInsideSelection(path: JSONPath): InsideSelection {\n  return {\n    type: SelectionType.inside,\n    path\n  }\n}\n\nexport function createAfterSelection(path: JSONPath): AfterSelection {\n  return {\n    type: SelectionType.after,\n    path\n  }\n}\n\nexport function createMultiSelection(anchorPath: JSONPath, focusPath: JSONPath): MultiSelection {\n  // normalize the paths to both be a child of a shared parent\n  const sharedPath = findSharedPath(anchorPath, focusPath)\n  const isParent = anchorPath.length > sharedPath.length && focusPath.length > sharedPath.length\n\n  return {\n    type: SelectionType.multi,\n    anchorPath: isParent ? sharedPath.concat(anchorPath[sharedPath.length]) : sharedPath,\n    focusPath: isParent ? sharedPath.concat(focusPath[sharedPath.length]) : sharedPath\n  }\n}\n\n/**\n * Turn selected contents into plain text partial JSON, usable for copying to\n * clipboard for example.\n */\nexport function selectionToPartialJson(\n  json: unknown,\n  selection: JSONSelection | null,\n  indentation: number | string | undefined,\n  parser: JSONParser\n): string | null {\n  if (isKeySelection(selection)) {\n    return String(last(selection.path))\n  }\n\n  if (isValueSelection(selection)) {\n    const value = getIn(json, selection.path)\n    return typeof value === 'string' ? value : parser.stringify(value, null, indentation) ?? null // TODO: customizable indentation?\n  }\n\n  if (isMultiSelection(selection)) {\n    if (isEmpty(selection.focusPath)) {\n      // root object -> does not have a parent key/index\n      return parser.stringify(json, null, indentation) ?? null\n    }\n\n    const parentPath = getParentPath(selection)\n    const parent = getIn(json, parentPath)\n    if (Array.isArray(parent)) {\n      if (isMultiSelectionWithOneItem(selection)) {\n        // do not suffix a single selected array item with a comma\n        const item = getIn(json, selection.focusPath)\n        return parser.stringify(item, null, indentation) ?? null\n      } else {\n        return getSelectionPaths(json, selection)\n          .map((path) => {\n            const item = getIn(json, path)\n            return `${parser.stringify(item, null, indentation)},`\n          })\n          .join('\\n')\n      }\n    } else {\n      // parent is Object\n      return getSelectionPaths(json, selection)\n        .map((path) => {\n          const key = last(path)\n          const value = getIn(json, path)\n          return `${parser.stringify(key)}: ${parser.stringify(value, null, indentation)},`\n        })\n        .join('\\n')\n    }\n  }\n\n  return null\n}\n\nexport function isEditingSelection(selection: JSONSelection | null): boolean {\n  return (isKeySelection(selection) || isValueSelection(selection)) && selection.edit === true\n}\n\nexport function updateSelectionInDocumentState(\n  documentState: DocumentState,\n  selection: JSONSelection | null,\n  replaceIfUndefined = true\n): DocumentState {\n  if (!selection && !replaceIfUndefined) {\n    return documentState\n  }\n\n  return {\n    ...documentState,\n    selection\n  }\n}\n\n/**\n * Create a selection which selects the root of the document\n */\n// TODO: write unit tests\nexport function selectAll(): JSONSelection {\n  return createValueSelection([], false)\n}\n\n// TODO: write unit tests\nexport function hasSelectionContents(selection: JSONSelection | null): boolean {\n  return isKeySelection(selection) || isValueSelection(selection) || isMultiSelection(selection)\n}\n\n/**\n * Test whether the current selection can be converted.\n * That is the case when the selection is a key/value, or a multi selection with only one path\n */\nexport function canConvert(selection: JSONSelection | null): boolean {\n  return (\n    isKeySelection(selection) ||\n    isValueSelection(selection) ||\n    isMultiSelectionWithOneItem(selection)\n  )\n}\n\n// TODO: unit test\nexport function fromCaretPosition(caretPosition: CaretPosition): JSONSelection {\n  switch (caretPosition.type) {\n    case CaretType.key:\n      return createKeySelection(caretPosition.path, false)\n    case CaretType.value:\n      return createValueSelection(caretPosition.path, false)\n    case CaretType.after:\n      return createAfterSelection(caretPosition.path)\n    case CaretType.inside:\n      return createInsideSelection(caretPosition.path)\n  }\n}\n\n// TODO: unit test\nexport function fromSelectionType(\n  json: unknown,\n  selectionType: SelectionType,\n  path: JSONPath\n): JSONSelection {\n  switch (selectionType) {\n    case SelectionType.key:\n      return createKeySelection(path, false)\n    case SelectionType.value:\n      return createValueSelection(path, false)\n    case SelectionType.after:\n      return createAfterSelection(path)\n    case SelectionType.inside:\n      return createInsideSelection(path)\n    case SelectionType.multi:\n    case SelectionType.text: // type `text` is not applicable, but we need to handle all types\n      return createMultiSelection(path, path)\n  }\n}\n\nexport function selectionIfOverlapping(\n  json: unknown | undefined,\n  selection: JSONSelection | null,\n  path: JSONPath\n): JSONSelection | null {\n  if (!selection) {\n    return null\n  }\n\n  if (pathInSelection(json, selection, path)) {\n    return selection\n  }\n\n  const sharedPath = isMultiSelection(selection) ? initial(selection.focusPath) : selection.path\n  if (pathStartsWith(sharedPath, path)) {\n    return selection\n  }\n\n  return null\n}\n\nexport function pathInSelection(\n  json: unknown | undefined,\n  selection: JSONSelection | null,\n  path: JSONPath\n): boolean {\n  if (json === undefined || !selection) {\n    return false\n  }\n\n  if (isKeySelection(selection) || isInsideSelection(selection) || isAfterSelection(selection)) {\n    return isEqual(selection.path, path)\n  }\n\n  if (isValueSelection(selection)) {\n    return pathStartsWith(path, selection.path)\n  }\n\n  if (isMultiSelection(selection)) {\n    const startPath = getStartPath(json, selection)\n    const endPath = getEndPath(json, selection)\n    const parentPath = initial(selection.focusPath)\n\n    if (!pathStartsWith(path, parentPath) || path.length <= parentPath.length) {\n      return false\n    }\n\n    const startIndex = getChildIndex(json, selection, startPath)\n    const endIndex = getChildIndex(json, selection, endPath)\n    const pathIndex = getChildIndex(json, selection, path)\n    return pathIndex !== -1 && pathIndex >= startIndex && pathIndex <= endIndex\n  }\n\n  return false\n}\n\nfunction getChildIndex(json: unknown, selection: MultiSelection, path: JSONPath): number {\n  const parentPath = initial(selection.focusPath)\n  if (!pathStartsWith(path, parentPath) || path.length <= parentPath.length) {\n    return -1\n  }\n\n  const key = path[parentPath.length]\n  const parent = getIn(json, parentPath)\n\n  if (isJSONObject(parent)) {\n    const keys = Object.keys(parent)\n    return keys.indexOf(key)\n  }\n\n  if (isJSONArray(parent)) {\n    const index = int(key)\n    if (index < parent.length) {\n      return index\n    }\n  }\n\n  return -1\n}\n\n// TODO: write some unit tests\nexport function getFocusPath(selection: JSONSelection): JSONPath {\n  return isMultiSelection(selection) ? selection.focusPath : selection.path\n}\n\n// TODO: write some unit tests\nexport function getAnchorPath(selection: JSONSelection): JSONPath {\n  return isMultiSelection(selection) ? selection.anchorPath : selection.path\n}\n","/**\n * A simplified version of https://github.com/JedWatson/classnames\n *\n * Example usage:\n *\n *     classnames('primary-button', { selected: true }, 'left')\n *\n */\nexport function classnames(...args: Array<string | Record<string, boolean> | undefined>): string {\n  const classes = []\n\n  for (const arg of args) {\n    if (typeof arg === 'string') {\n      classes.push(arg)\n    }\n\n    if (arg && typeof arg === 'object') {\n      for (const key in arg) {\n        if (Object.hasOwnProperty.call(arg, key) && arg[key]) {\n          classes.push(key)\n        }\n      }\n    }\n  }\n\n  return classes.join(' ')\n}\n","import { isUrl, valueType } from '$lib/utils/typeUtils.js'\nimport type { JSONParser } from '$lib/types.js'\nimport { classnames } from '$lib/utils/cssUtils.js'\n\nexport function getValueClass(value: unknown, parser: JSONParser): string {\n  const type = valueType(value, parser)\n\n  return classnames('jse-value', 'jse-' + type, {\n    'jse-url': isUrl(value),\n    'jse-empty': typeof value === 'string' && value.length === 0\n  })\n}\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { onDestroy, onMount } from 'svelte'\n  import { addNewLineSuffix, removeNewLineSuffix, setCursorToEnd } from '$lib/utils/domUtils.js'\n  import { keyComboFromEvent } from '$lib/utils/keyBindings.js'\n  import { createDebug } from '$lib/utils/debug.js'\n  import { noop } from 'lodash-es'\n  import type { OnFind, OnPaste } from '$lib/types'\n  import { UpdateSelectionAfterChange } from '$lib/types'\n  import { classnames } from '$lib/utils/cssUtils.js'\n\n  const debug = createDebug('jsoneditor:EditableDiv')\n\n  export let value: string\n  export let shortText = false\n  export let onChange: (newValue: string, updateSelection: UpdateSelectionAfterChange) => void\n  export let onCancel: () => void\n  export let onFind: OnFind\n  export let onPaste: OnPaste = noop\n  export let onValueClass: (value: string) => string = () => ''\n\n  let domValue: HTMLDivElement | undefined\n  let valueClass: string\n  $: valueClass = onValueClass(value)\n  let closed = false\n\n  onMount(() => {\n    debug('onMount', { value })\n    setDomValue(value)\n\n    // focus\n    if (domValue) {\n      setCursorToEnd(domValue)\n\n      // The refresh method can be used to update the classnames for example\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      domValue.refresh = handleValueInput\n\n      // The cancel method can be used to cancel editing, without firing a change\n      // when the contents did change in the meantime. It is the same as pressing ESC\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      domValue.cancel = handleCancel\n    }\n  })\n\n  onDestroy(() => {\n    const newValue = getDomValue()\n\n    debug('onDestroy', { closed, value, newValue })\n\n    if (!closed && newValue !== value) {\n      onChange(newValue, UpdateSelectionAfterChange.no)\n    }\n  })\n\n  function getDomValue(): string {\n    if (!domValue) {\n      return ''\n    }\n    return removeNewLineSuffix(domValue.innerText)\n  }\n\n  function setDomValue(updatedValue: string) {\n    if (!domValue) {\n      return\n    }\n    domValue.innerText = addNewLineSuffix(updatedValue)\n  }\n\n  function handleValueInput() {\n    const newValue = getDomValue()\n\n    if (newValue === '') {\n      // immediately update to clean up any left over <br/>\n      setDomValue('')\n    }\n\n    // update class\n    valueClass = onValueClass(newValue)\n  }\n\n  function handleCancel() {\n    // cancel changes (needed to prevent triggering a change onDestroy)\n    closed = true\n\n    onCancel()\n  }\n\n  function handleValueKeyDown(event: KeyboardEvent) {\n    event.stopPropagation()\n\n    const combo = keyComboFromEvent(event)\n\n    if (combo === 'Escape') {\n      handleCancel()\n    }\n\n    if (combo === 'Enter' || combo === 'Tab') {\n      // apply changes\n      closed = true\n\n      const newValue = getDomValue()\n      onChange(newValue, UpdateSelectionAfterChange.nextInside)\n    }\n\n    if (combo === 'Ctrl+F') {\n      event.preventDefault()\n      onFind(false)\n    }\n\n    if (combo === 'Ctrl+H') {\n      event.preventDefault()\n      onFind(true)\n    }\n  }\n\n  function handleValuePaste(event: ClipboardEvent) {\n    event.stopPropagation()\n\n    if (!onPaste || !event.clipboardData) {\n      return\n    }\n\n    const clipboardText = event.clipboardData.getData('text/plain')\n    onPaste(clipboardText)\n  }\n\n  function handleBlur() {\n    const hasFocus = document.hasFocus()\n    const newValue = getDomValue()\n\n    debug('handleBlur', { hasFocus, closed, value, newValue })\n\n    // we only want to close the editable div when the focus did go to another\n    // element on the same page, but not when the user switches to another\n    // application or browser tab to copy/paste something whilst still editing\n    // the value, hence the check for document.hasFocus()\n    if (document.hasFocus() && !closed) {\n      closed = true\n      if (newValue !== value) {\n        onChange(newValue, UpdateSelectionAfterChange.self)\n      } else {\n        // Note that we do not fire an onCancel here: a blur action\n        // is caused by the user clicking somewhere else. If we apply\n        // onCancel now, we would override the selection that the user\n        // wants by clicking somewhere else in the editor (since `blur`\n        // is occurring *after* `mousedown`).\n      }\n    }\n  }\n</script>\n\n<div\n  role=\"textbox\"\n  tabindex=\"0\"\n  class={classnames('jse-editable-div', valueClass, { 'jse-short-text': shortText })}\n  contenteditable=\"true\"\n  spellcheck=\"false\"\n  on:input={handleValueInput}\n  on:keydown={handleValueKeyDown}\n  on:paste={handleValuePaste}\n  on:blur={handleBlur}\n  bind:this={domValue}\n/>\n\n<style src=\"./EditableDiv.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import type { JSONPath } from 'immutable-json-patch'\n  import { compileJSONPointer } from 'immutable-json-patch'\n  import { isObjectOrArray, stringConvert } from '$lib/utils/typeUtils.js'\n  import { createValueSelection, getFocusPath } from '$lib/logic/selection.js'\n  import { getValueClass } from '$lib/plugins/value/components/utils/getValueClass.js'\n  import EditableDiv from '../../../components/controls/EditableDiv.svelte'\n  import type {\n    FindNextInside,\n    JSONParser,\n    OnFind,\n    OnJSONSelect,\n    OnPasteJson,\n    OnPatch,\n    ValueNormalization\n  } from '$lib/types.js'\n  import { UpdateSelectionAfterChange } from '$lib/types.js'\n  import { isEqual } from 'lodash-es'\n\n  export let path: JSONPath\n  export let value: unknown\n  export let parser: JSONParser\n  export let normalization: ValueNormalization\n  export let enforceString: boolean\n  export let onPatch: OnPatch\n  export let onPasteJson: OnPasteJson\n  export let onSelect: OnJSONSelect\n  export let onFind: OnFind\n  export let focus: () => void\n  export let findNextInside: FindNextInside\n\n  function convert(value: string): unknown {\n    return enforceString ? value : stringConvert(value, parser)\n  }\n\n  function handleChangeValue(newValue: string, updateSelection: UpdateSelectionAfterChange) {\n    onPatch(\n      [\n        {\n          op: 'replace',\n          path: compileJSONPointer(path),\n          value: convert(normalization.unescapeValue(newValue))\n        }\n      ],\n      (patchedJson, patchedState) => {\n        // Leave the selection as is when it is no longer the path that we were editing here\n        // This happens for example when the user clicks or double-clicks on another value\n        // whilst editing a value\n        if (patchedState.selection && !isEqual(path, getFocusPath(patchedState.selection))) {\n          return undefined\n        }\n\n        const selection =\n          updateSelection === UpdateSelectionAfterChange.nextInside\n            ? findNextInside(path)\n            : createValueSelection(path, false)\n\n        return {\n          state: {\n            ...patchedState,\n            selection\n          }\n        }\n      }\n    )\n\n    focus()\n  }\n\n  function handleCancelChange() {\n    onSelect(createValueSelection(path, false))\n    focus()\n  }\n\n  function handlePaste(pastedText: string): void {\n    try {\n      const pastedJson = parser.parse(pastedText)\n      if (isObjectOrArray(pastedJson)) {\n        onPasteJson({\n          path,\n          contents: pastedJson\n        })\n      }\n    } catch (err) {\n      // silently ignore: thee pasted text is no valid JSON object or array,\n      // no need to do anything\n    }\n  }\n\n  function handleOnValueClass(value: string): string {\n    return getValueClass(convert(normalization.unescapeValue(value)), parser)\n  }\n</script>\n\n<EditableDiv\n  value={normalization.escapeValue(value)}\n  onChange={handleChangeValue}\n  onCancel={handleCancelChange}\n  onPaste={handlePaste}\n  {onFind}\n  onValueClass={handleOnValueClass}\n/>\n","import { cloneDeepWith, first, initial, isEmpty, last, times } from 'lodash-es'\nimport {\n  compileJSONPointer,\n  existsIn,\n  getIn,\n  isJSONArray,\n  isJSONObject,\n  isJSONPatchMove,\n  isJSONPatchRemove,\n  isJSONPatchReplace,\n  type JSONPatchAdd,\n  type JSONPatchCopy,\n  type JSONPatchDocument,\n  type JSONPatchOperation,\n  type JSONPath,\n  parseJSONPointer,\n  revertJSONPatch\n} from 'immutable-json-patch'\nimport { parseAndRepair, parseAndRepairOrUndefined, parsePartialJson } from '../utils/jsonUtils.js'\nimport { findUniqueName } from '../utils/stringUtils.js'\nimport { isObject, isObjectOrArray } from '../utils/typeUtils.js'\nimport { getNextKeys } from './documentState.js'\nimport {\n  createAfterSelection,\n  createInsideSelection,\n  createSelectionFromOperations,\n  createValueSelection,\n  getEndPath,\n  getFocusPath,\n  getParentPath,\n  getSelectionPaths,\n  getStartPath,\n  isAfterSelection,\n  isInsideSelection,\n  isKeySelection,\n  isMultiSelection,\n  isValueSelection,\n  pathStartsWith\n} from './selection.js'\nimport type { ClipboardValues, DragInsideAction, JSONParser, JSONSelection } from '$lib/types'\nimport { int } from '../utils/numberUtils.js'\n\n/**\n * Create a JSONPatch for an insert operation.\n *\n * This function needs the current data in order to be able to determine\n * a unique property name for the inserted node in case of duplicating\n * and object property\n */\n// TODO: write tests\nexport function insertBefore(\n  json: unknown,\n  path: JSONPath,\n  values: ClipboardValues\n): JSONPatchDocument {\n  const parentPath = initial(path)\n  const parent = getIn(json, parentPath)\n\n  if (isJSONArray(parent)) {\n    // the path is parsed from a JSONPatch operation,\n    // so array indices are a string which we have to parse into a number\n    const offset = int(last(path) as string)\n    return values.map((entry, index) => ({\n      op: 'add',\n      path: compileJSONPointer(parentPath.concat(String(offset + index))),\n      value: entry.value\n    }))\n  } else if (isJSONObject(parent)) {\n    // 'object'\n    const afterKey = last(path)\n    const keys = Object.keys(parent)\n    const nextKeys = afterKey !== undefined ? getNextKeys(keys, afterKey, true) : []\n\n    return [\n      // insert new values\n      ...values.map((entry) => {\n        const newProp = findUniqueName(entry.key, keys)\n        return {\n          op: 'add',\n          path: compileJSONPointer(parentPath.concat(newProp)),\n          value: entry.value\n        } as JSONPatchAdd\n      }),\n\n      // move all lower down keys so the inserted key will maintain its position\n      ...nextKeys.map((key) => moveDown(parentPath, key))\n    ]\n  } else {\n    throw new Error('Cannot create insert operations: parent must be an Object or Array')\n  }\n}\n\n/**\n * Create a JSONPatch for an append operation. The values will be appended\n * to the end of the array or object.\n *\n * This function needs the current data in order to be able to determine\n * a unique property name for the inserted node in case of duplicating\n * and object property\n */\nexport function append(json: unknown, path: JSONPath, values: ClipboardValues): JSONPatchDocument {\n  const parent = getIn(json, path)\n\n  if (Array.isArray(parent)) {\n    const offset = parent.length\n    return values.map((entry, index) => ({\n      op: 'add',\n      path: compileJSONPointer(path.concat(String(offset + index))),\n      value: entry.value\n    }))\n  } else {\n    // 'object'\n    return values.map((entry) => {\n      const newProp = findUniqueName(entry.key, Object.keys(parent as Record<string, unknown>))\n      return {\n        op: 'add',\n        path: compileJSONPointer(path.concat(newProp)),\n        value: entry.value\n      }\n    })\n  }\n}\n\n/**\n * Rename an object key\n * Not applicable to arrays\n */\nexport function rename(\n  parentPath: JSONPath,\n  keys: string[],\n  oldKey: string,\n  newKey: string\n): JSONPatchDocument {\n  const filteredKeys = keys.filter((key) => key !== oldKey)\n  const newKeyUnique = findUniqueName(newKey, filteredKeys)\n  const nextKeys = getNextKeys(keys, oldKey, false)\n\n  return [\n    // rename a key\n    {\n      op: 'move',\n      from: compileJSONPointer(parentPath.concat(oldKey)),\n      path: compileJSONPointer(parentPath.concat(newKeyUnique))\n    },\n\n    // move all lower down keys so the renamed key will maintain it's position\n    ...nextKeys.map((key) => moveDown(parentPath, key))\n  ]\n}\n\n/**\n * Create a JSONPatch for an insert operation.\n *\n * This function needs the current data in order to be able to determine\n * a unique property name for the inserted node in case of duplicating\n * and object property\n */\nexport function replace(\n  json: unknown,\n  paths: JSONPath[],\n  values: ClipboardValues\n): JSONPatchDocument {\n  const firstPath = first(paths)\n  const parentPath = initial(firstPath)\n  const parent = getIn(json, parentPath)\n\n  if (isJSONArray(parent)) {\n    const firstPath = first(paths)\n    const offset = firstPath ? int(last(firstPath) as string) : 0\n\n    return [\n      // remove operations\n      ...removeAll(paths),\n\n      // insert operations\n      ...values.map((entry, index) => {\n        const operation: JSONPatchOperation = {\n          op: 'add',\n          path: compileJSONPointer(parentPath.concat(String(index + offset))),\n          value: entry.value\n        }\n\n        return operation\n      })\n    ]\n  } else if (isJSONObject(parent)) {\n    // parent is Object\n    // if we're going to replace an existing object with key \"a\" with a new\n    // key \"a\", we must not create a new unique name \"a (copy)\".\n    const lastPath = last(paths)\n    const parentPath = initial(lastPath)\n    const beforeKey = last(lastPath)\n    const keys: string[] = Object.keys(parent)\n    const nextKeys = beforeKey !== undefined ? getNextKeys(keys, beforeKey, false) : []\n    const removeKeys = new Set(paths.map((path) => last(path)))\n    const filteredKeys = keys.filter((key) => !removeKeys.has(key))\n\n    return [\n      // remove operations\n      ...removeAll(paths),\n\n      // insert operations\n      ...values.map((entry) => {\n        const newProp = findUniqueName(entry.key, filteredKeys)\n        return {\n          op: 'add',\n          path: compileJSONPointer(parentPath.concat(newProp)),\n          value: entry.value\n        } as JSONPatchAdd\n      }),\n\n      // move down operations\n      // move all lower down keys so the renamed key will maintain its position\n      ...nextKeys.map((key) => moveDown(parentPath, key))\n    ]\n  } else {\n    throw new Error('Cannot create replace operations: parent must be an Object or Array')\n  }\n}\n\n/**\n * Create a JSONPatch for a duplicate action.\n *\n * This function needs the current data in order to be able to determine\n * a unique property name for the duplicated node in case of duplicating\n * and object property\n */\nexport function duplicate(json: unknown, paths: JSONPath[]): JSONPatchDocument {\n  // FIXME: here we assume paths is sorted correctly, that's a dangerous assumption\n  const lastPath = last(paths)\n\n  if (isEmpty(lastPath)) {\n    throw new Error('Cannot duplicate root object')\n  }\n\n  const parentPath = initial(lastPath)\n  const beforeKey = last(lastPath)\n  const parent = getIn(json, parentPath)\n\n  if (isJSONArray(parent)) {\n    const lastPath = last(paths)\n    const offset = lastPath ? int(last(lastPath) as string) + 1 : 0\n\n    return [\n      // copy operations\n      ...paths.map((path, index) => {\n        const operation: JSONPatchOperation = {\n          op: 'copy',\n          from: compileJSONPointer(path),\n          path: compileJSONPointer(parentPath.concat(String(index + offset)))\n        }\n\n        return operation\n      })\n    ]\n  } else if (isJSONObject(parent)) {\n    // 'object'\n    const keys = Object.keys(parent)\n    const nextKeys = beforeKey !== undefined ? getNextKeys(keys, beforeKey, false) : []\n\n    return [\n      // copy operations\n      ...paths.map((path) => {\n        const prop = last(path) as string\n        const newProp = findUniqueName(prop, keys)\n\n        return {\n          op: 'copy',\n          from: compileJSONPointer(path),\n          path: compileJSONPointer(parentPath.concat(newProp))\n        } as JSONPatchCopy\n      }),\n\n      // move down operations\n      // move all lower down keys so the renamed key will maintain it's position\n      ...nextKeys.map((key) => moveDown(parentPath, key))\n    ]\n  } else {\n    throw new Error('Cannot create duplicate operations: parent must be an Object or Array')\n  }\n}\n\n/**\n * Create a JSONPatch for an extract action.\n */\n// TODO: write unit tests\nexport function extract(json: unknown, selection: JSONSelection): JSONPatchDocument {\n  if (isValueSelection(selection)) {\n    return [\n      {\n        op: 'move',\n        from: compileJSONPointer(selection.path),\n        path: ''\n      }\n    ]\n  }\n\n  if (isMultiSelection(selection)) {\n    const parentPath = initial(selection.focusPath)\n    const parent = getIn(json, parentPath)\n\n    if (isJSONArray(parent)) {\n      const value = getSelectionPaths(json, selection).map((path) => {\n        const index = int(last(path) as string)\n        return parent[index]\n      })\n\n      return [\n        {\n          op: 'replace',\n          path: '',\n          value\n        }\n      ]\n    } else if (isJSONObject(parent)) {\n      // object\n      const value: Record<string, unknown> = {}\n      getSelectionPaths(json, selection).forEach((path) => {\n        const key = String(last(path))\n        value[key] = parent[key]\n      })\n\n      return [\n        {\n          op: 'replace',\n          path: '',\n          value\n        }\n      ]\n    }\n  } else {\n    throw new Error('Cannot create extract operations: parent must be an Object or Array')\n  }\n\n  // this should never happen\n  throw new Error('Cannot extract: unsupported type of selection ' + JSON.stringify(selection))\n}\n\n// TODO: write unit tests\nexport function insert(\n  json: unknown,\n  selection: JSONSelection | null,\n  clipboardText: string,\n  parser: JSONParser\n): JSONPatchDocument {\n  if (isKeySelection(selection)) {\n    // rename key\n    const clipboard = parseAndRepairOrUndefined(clipboardText, parser)\n    const parentPath = initial(selection.path)\n    const parent = getIn(json, parentPath)\n    const keys = Object.keys(parent as Record<string, unknown>)\n    const oldKey = last(selection.path) as string\n    const newKey = typeof clipboard === 'string' ? clipboard : clipboardText\n\n    return rename(parentPath, keys, oldKey, newKey)\n  }\n\n  if (\n    isValueSelection(selection) ||\n    (isMultiSelection(selection) && isEmpty(selection.focusPath)) // root selected\n  ) {\n    // replace selected value (new value can be primitive or an array/object with contents)\n    try {\n      return [\n        {\n          op: 'replace',\n          path: compileJSONPointer(getFocusPath(selection)),\n          value: parsePartialJson(clipboardText, (text) => parseAndRepair(text, parser))\n        }\n      ]\n    } catch (err) {\n      // parsing failed -> just paste the raw text as value\n      return [\n        {\n          op: 'replace',\n          path: compileJSONPointer(getFocusPath(selection)),\n          value: clipboardText\n        }\n      ]\n    }\n  }\n\n  if (isMultiSelection(selection)) {\n    const newValues = clipboardToValues(clipboardText, parser)\n\n    return replace(json, getSelectionPaths(json, selection), newValues)\n  }\n\n  if (isAfterSelection(selection)) {\n    const newValues = clipboardToValues(clipboardText, parser)\n    const path = selection.path\n    const parentPath = initial(path)\n    const parent = getIn(json, parentPath)\n\n    if (isJSONArray(parent)) {\n      const index = int(last(path) as string)\n      const nextItemPath = parentPath.concat(String(index + 1))\n\n      return insertBefore(json, nextItemPath, newValues)\n    } else if (isJSONObject(parent)) {\n      // value is an Object\n      const key = String(last(path))\n      const keys: string[] = Object.keys(parent)\n      if (isEmpty(keys) || last(keys) === key) {\n        return append(json, parentPath, newValues)\n      } else {\n        const index = keys.indexOf(key)\n        const nextKey = keys[index + 1]\n        const nextKeyPath = parentPath.concat(nextKey)\n\n        return insertBefore(json, nextKeyPath, newValues)\n      }\n    } else {\n      throw new Error('Cannot create insert operations: parent must be an Object or Array')\n    }\n  }\n\n  if (isInsideSelection(selection)) {\n    const newValues = clipboardToValues(clipboardText, parser)\n    const path = selection.path\n    const value = getIn(json, path)\n\n    if (isJSONArray(value)) {\n      const firstItemPath = path.concat('0')\n      return insertBefore(json, firstItemPath, newValues)\n    } else if (isJSONObject(value)) {\n      // value is an Object\n      const keys = Object.keys(value)\n      if (isEmpty(keys)) {\n        return append(json, path, newValues)\n      } else {\n        const firstKey = first(keys) as string\n        const firstKeyPath = path.concat(firstKey)\n\n        return insertBefore(json, firstKeyPath, newValues)\n      }\n    } else {\n      throw new Error('Cannot create insert operations: parent must be an Object or Array')\n    }\n  }\n\n  // this should never happen\n  throw new Error('Cannot insert: unsupported type of selection ' + JSON.stringify(selection))\n}\n\nexport function moveInsideParent(\n  json: unknown,\n  selection: JSONSelection | null,\n  dragInsideAction: DragInsideAction\n): JSONPatchDocument {\n  if (!selection) {\n    return []\n  }\n\n  const beforePath = 'beforePath' in dragInsideAction ? dragInsideAction['beforePath'] : undefined\n  const append = 'append' in dragInsideAction ? dragInsideAction['append'] : undefined\n\n  const parentPath = initial(getFocusPath(selection))\n  const parent = getIn(json, parentPath)\n\n  if (\n    !append &&\n    !(beforePath && pathStartsWith(beforePath, parentPath) && beforePath.length > parentPath.length)\n  ) {\n    return []\n  }\n\n  const startPath = getStartPath(json, selection)\n  const endPath = getEndPath(json, selection)\n  const startKey = last(startPath) as string\n  const endKey = last(endPath) as string\n  const toKey: string | undefined = beforePath ? beforePath[parentPath.length] : undefined\n\n  if (isJSONObject(parent)) {\n    const keys = Object.keys(parent)\n    const startIndex = keys.indexOf(startKey)\n    const endIndex = keys.indexOf(endKey)\n    const toIndex = append ? keys.length : toKey !== undefined ? keys.indexOf(toKey) : -1\n\n    if (startIndex !== -1 && endIndex !== -1 && toIndex !== -1) {\n      if (toIndex > startIndex) {\n        // moving down\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        return [...keys.slice(startIndex, endIndex + 1), ...keys.slice(toIndex, keys.length)].map(\n          (key) => moveDown(parentPath, key)\n        )\n      } else {\n        // moving up\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        return [...keys.slice(toIndex, startIndex), ...keys.slice(endIndex + 1, keys.length)].map(\n          (key) => moveDown(parentPath, key)\n        )\n      }\n    }\n  } else if (isJSONArray(parent)) {\n    // array\n    const startIndex = int(startKey)\n    const endIndex = int(endKey)\n    const toIndex = toKey !== undefined ? int(toKey) : parent.length\n    const count = endIndex - startIndex + 1\n\n    if (toIndex < startIndex) {\n      // move up\n      return times(count, (offset) => {\n        return {\n          op: 'move',\n          from: compileJSONPointer(parentPath.concat(String(startIndex + offset))),\n          path: compileJSONPointer(parentPath.concat(String(toIndex + offset)))\n        }\n      })\n    } else {\n      // move down\n      return times(count, () => {\n        return {\n          op: 'move',\n          from: compileJSONPointer(parentPath.concat(String(startIndex))),\n          path: compileJSONPointer(parentPath.concat(String(toIndex)))\n        }\n      })\n    }\n  } else {\n    throw new Error('Cannot create move operations: parent must be an Object or Array')\n  }\n\n  return []\n}\n\nexport function createNewValue(\n  json: unknown | undefined,\n  selection: JSONSelection | null,\n  valueType: 'object' | 'array' | 'structure' | 'value'\n): unknown {\n  if (valueType === 'object') {\n    return {}\n  }\n\n  if (valueType === 'array') {\n    return []\n  }\n\n  if (valueType === 'structure' && json !== undefined) {\n    const parentPath = selection ? getParentPath(selection) : []\n    const parent = getIn(json, parentPath)\n\n    if (Array.isArray(parent) && !isEmpty(parent)) {\n      const jsonExample = first(parent)\n      if (isObjectOrArray(jsonExample)) {\n        return cloneDeepWith(jsonExample, (value) => {\n          return Array.isArray(value)\n            ? []\n            : isObject(value)\n              ? undefined // leave object as is, will recurse into it\n              : ''\n        })\n      } else {\n        // just a primitive value\n        return ''\n      }\n    }\n  }\n\n  // type === value,\n  // or type === structure but the parent is no array or an array containing\n  // primitive values (and no objects having any structure).\n  return ''\n}\n\n/**\n * Create a JSONPatch for a remove operation\n */\nexport function remove(path: JSONPath): JSONPatchDocument {\n  return [\n    {\n      op: 'remove',\n      path: compileJSONPointer(path)\n    }\n  ]\n}\n\n/**\n * Create a JSONPatch for a multiple remove operation\n */\nexport function removeAll(paths: JSONPath[]): JSONPatchDocument {\n  return paths\n    .map((path) => {\n      const operation: JSONPatchOperation = {\n        op: 'remove',\n        path: compileJSONPointer(path)\n      }\n\n      return operation\n    })\n    .reverse() // reverse is needed for arrays: delete the last index first\n}\n\n// helper function to move a key down in an object,\n// so another key can get positioned before the moved down keys\nfunction moveDown(parentPath: JSONPath, key: string): JSONPatchOperation {\n  return {\n    op: 'move',\n    from: compileJSONPointer(parentPath.concat(key)),\n    path: compileJSONPointer(parentPath.concat(key))\n  }\n}\n\nexport function clipboardToValues(clipboardText: string, parser: JSONParser): ClipboardValues {\n  const textIsObject = /^\\s*{/.test(clipboardText)\n  const textIsArray = /^\\s*\\[/.test(clipboardText)\n\n  const clipboardOriginal = parseAndRepairOrUndefined(clipboardText, parser)\n  const clipboardRepaired =\n    clipboardOriginal !== undefined\n      ? clipboardOriginal\n      : parsePartialJson(clipboardText, (text) => parseAndRepair(text, parser))\n\n  if (\n    (textIsObject && isObject(clipboardRepaired)) ||\n    (textIsArray && Array.isArray(clipboardRepaired))\n  ) {\n    return [{ key: 'New item', value: clipboardRepaired }]\n  }\n\n  if (Array.isArray(clipboardRepaired)) {\n    return clipboardRepaired.map((value, index) => {\n      return { key: 'New item ' + index, value }\n    })\n  }\n\n  if (isObject(clipboardRepaired)) {\n    return Object.keys(clipboardRepaired).map((key) => {\n      return { key, value: clipboardRepaired[key] }\n    })\n  }\n\n  // regular value\n  return [{ key: 'New item', value: clipboardRepaired }]\n}\n\n// TODO: write unit tests\nexport function createRemoveOperations(\n  json: unknown,\n  selection: JSONSelection\n): { newSelection: JSONSelection | null; operations: JSONPatchDocument } {\n  if (isKeySelection(selection)) {\n    // FIXME: DOESN'T work yet\n    const parentPath = initial(selection.path)\n    const parent = getIn(json, parentPath)\n    const keys = Object.keys(parent as Record<string, unknown>)\n    const oldKey = last(selection.path) as string\n    const newKey = ''\n\n    const operations = rename(parentPath, keys, oldKey, newKey)\n    const newSelection = createSelectionFromOperations(json, operations)\n\n    return { operations, newSelection }\n  }\n\n  if (isValueSelection(selection)) {\n    const operations: JSONPatchDocument = [\n      {\n        op: 'replace',\n        path: compileJSONPointer(selection.path),\n        value: ''\n      }\n    ]\n\n    return { operations, newSelection: selection }\n  }\n\n  if (isMultiSelection(selection)) {\n    const paths = getSelectionPaths(json, selection)\n    const operations = removeAll(paths)\n    const lastPath = last(paths)\n\n    if (isEmpty(lastPath)) {\n      // there is no parent, this is the root document\n      const operations: JSONPatchDocument = [{ op: 'replace', path: '', value: '' }]\n\n      const newSelection = createValueSelection([], false)\n\n      return { operations, newSelection }\n    }\n\n    const parentPath = initial(lastPath)\n    const parent = getIn(json, parentPath)\n\n    if (isJSONArray(parent)) {\n      const firstPath = first(paths)\n      const index = int(last(firstPath) as string)\n      const newSelection =\n        index === 0\n          ? createInsideSelection(parentPath)\n          : createAfterSelection(parentPath.concat(String(index - 1)))\n\n      return { operations, newSelection }\n    } else if (isJSONObject(parent)) {\n      // parent is object\n      const keys = Object.keys(parent)\n      const firstPath = first(paths)\n      const key = last(firstPath) as string\n      const index = keys.indexOf(key)\n      const previousKey = keys[index - 1]\n      const newSelection =\n        index === 0\n          ? createInsideSelection(parentPath)\n          : createAfterSelection(parentPath.concat(previousKey))\n\n      return { operations, newSelection }\n    } else {\n      throw new Error('Cannot create remove operations: parent must be an Object or Array')\n    }\n  }\n\n  // this should never happen\n  throw new Error('Cannot remove: unsupported type of selection ' + JSON.stringify(selection))\n}\n\nexport function revertJSONPatchWithMoveOperations(\n  json: unknown,\n  operations: JSONPatchDocument\n): JSONPatchDocument {\n  return revertJSONPatch(json, operations, {\n    before: (json, operation, revertOperations) => {\n      if (isJSONPatchRemove(operation)) {\n        const path = parseJSONPointer(operation.path)\n        return {\n          revertOperations: [...revertOperations, ...createRevertMoveOperations(json, path)]\n        }\n      }\n\n      if (isJSONPatchMove(operation)) {\n        const from = parseJSONPointer(operation.from)\n        return {\n          revertOperations: [...revertOperations, ...createRevertMoveOperations(json, from)]\n        }\n      }\n\n      return { document: json }\n    }\n  })\n}\n\nfunction createRevertMoveOperations(json: unknown, path: JSONPath): JSONPatchOperation[] {\n  const parentPath = initial(path)\n  const afterKey = last(path) as string\n  const parent = getIn(json, parentPath)\n  if (isJSONObject(parent)) {\n    const keys = Object.keys(parent)\n    const nextKeys = getNextKeys(keys, afterKey, false)\n\n    // move all lower down keys so the inserted key will maintain its position\n    return nextKeys.map((key) => moveDown(parentPath, key))\n  }\n\n  return []\n}\n\n/**\n * Add operations to create parent objects when missing before replacing a nested value\n */\nexport function createNestedValueOperations(operations: JSONPatchOperation[], json: unknown) {\n  return operations.flatMap((operation) => {\n    if (isJSONPatchReplace(operation)) {\n      const path = parseJSONPointer(operation.path)\n      if (path.length > 0) {\n        const extendedOperations: JSONPatchOperation[] = [operation]\n\n        let parentPath = initial(path)\n        while (parentPath.length > 0 && !existsIn(json, parentPath)) {\n          extendedOperations.unshift({\n            op: 'add',\n            path: compileJSONPointer(parentPath),\n            value: {}\n          })\n\n          parentPath = initial(parentPath)\n        }\n\n        return extendedOperations\n      }\n    }\n\n    return operation\n  })\n}\n","import type {\n  JSONPatchDocument,\n  JSONPatchOperation,\n  JSONPath,\n  JSONPointer\n} from 'immutable-json-patch'\nimport { compileJSONPointer, getIn, isJSONArray, isJSONObject } from 'immutable-json-patch'\nimport { forEachRight, groupBy, initial, isEqual, last } from 'lodash-es'\nimport { getEnforceString } from './documentState.js'\nimport { createSelectionFromOperations } from './selection.js'\nimport { rename } from './operations.js'\nimport { stringConvert } from '../utils/typeUtils.js'\nimport type {\n  DocumentState,\n  ExtendedSearchResultItem,\n  JSONParser,\n  JSONPointerMap,\n  JSONSelection,\n  SearchOptions,\n  SearchResult,\n  SearchResultItem\n} from '$lib/types'\nimport { SearchField } from '$lib/types.js'\n\n// TODO: comment\n// TODO: unit test\nexport function updateSearchResult(\n  json: unknown,\n  newResultItems: SearchResultItem[],\n  previousResult: SearchResult | undefined\n): SearchResult {\n  const activePath = previousResult?.activeItem\n    ? getSearchResultPath(previousResult.activeItem)\n    : undefined\n\n  const matchingActiveIndex = newResultItems.findIndex((item) => {\n    return isEqual(activePath, getSearchResultPath(item))\n  })\n\n  const activeIndex =\n    matchingActiveIndex !== -1\n      ? matchingActiveIndex\n      : previousResult?.activeIndex !== undefined &&\n          previousResult?.activeIndex < newResultItems.length\n        ? previousResult?.activeIndex\n        : newResultItems.length > 0\n          ? 0\n          : -1\n\n  const items: ExtendedSearchResultItem[] = newResultItems.map((item, index) => {\n    return { ...item, active: index === activeIndex }\n  })\n\n  const activeItem = items[activeIndex]\n\n  return {\n    items,\n    itemsMap: groupBy(items, (item) => compileJSONPointer(item.path)),\n    activeItem,\n    activeIndex\n  }\n}\n\n// TODO: unit test\nexport function searchNext(searchResult: SearchResult): SearchResult {\n  const nextActiveIndex =\n    searchResult.activeIndex < searchResult.items.length - 1\n      ? searchResult.activeIndex + 1\n      : searchResult.items.length > 0\n        ? 0\n        : -1\n\n  const nextActiveItem = searchResult.items[nextActiveIndex]\n\n  const items: ExtendedSearchResultItem[] = searchResult.items.map((item, index) => {\n    return { ...item, active: index === nextActiveIndex }\n  })\n\n  return {\n    ...searchResult,\n    items,\n    itemsMap: groupBy(items, (item) => compileJSONPointer(item.path)),\n    activeItem: nextActiveItem,\n    activeIndex: nextActiveIndex\n  }\n}\n\n// TODO: unit test\nexport function searchPrevious(searchResult: SearchResult): SearchResult {\n  const previousActiveIndex =\n    searchResult.activeIndex > 0 ? searchResult.activeIndex - 1 : searchResult.items.length - 1\n\n  const previousActiveItem = searchResult.items[previousActiveIndex]\n\n  const items: ExtendedSearchResultItem[] = searchResult.items.map((item, index) => {\n    return { ...item, active: index === previousActiveIndex }\n  })\n\n  return {\n    ...searchResult,\n    items,\n    itemsMap: groupBy(items, (item) => compileJSONPointer(item.path)),\n    activeItem: previousActiveItem,\n    activeIndex: previousActiveIndex\n  }\n}\n\n// TODO: comment\nexport function search(\n  searchText: string,\n  json: unknown,\n  options: SearchOptions = {}\n): SearchResultItem[] {\n  const searchTextLowerCase = searchText.toLowerCase()\n  const maxResults = options?.maxResults ?? Infinity\n  const columns = options?.columns\n  const results: SearchResultItem[] = []\n  const path: JSONPath = [] // we reuse the same Array recursively, this is *much* faster than creating a new path every time\n\n  function onMatch(match: SearchResultItem) {\n    if (results.length >= maxResults) {\n      return\n    }\n\n    results.push(match)\n  }\n\n  function searchRecursive(searchTextLowerCase: string, value: unknown) {\n    if (isJSONArray(value)) {\n      const level = path.length\n      path.push('0')\n\n      for (let i = 0; i < value.length; i++) {\n        path[level] = String(i)\n\n        searchRecursive(searchTextLowerCase, value[i])\n\n        if (results.length >= maxResults) {\n          return\n        }\n      }\n\n      path.pop()\n    } else if (isJSONObject(value)) {\n      const keys = Object.keys(value)\n      const level = path.length\n\n      path.push('')\n\n      for (const key of keys) {\n        path[level] = key\n\n        findCaseInsensitiveMatches(key, searchTextLowerCase, path, SearchField.key, onMatch)\n\n        searchRecursive(searchTextLowerCase, value[key])\n\n        if (results.length >= maxResults) {\n          return\n        }\n      }\n\n      path.pop()\n    } else {\n      // type is a value\n      findCaseInsensitiveMatches(\n        String(value),\n        searchTextLowerCase,\n        path,\n        SearchField.value,\n        onMatch\n      )\n    }\n  }\n\n  if (searchText === '') {\n    return []\n  } else if (columns) {\n    if (!Array.isArray(json)) {\n      throw new Error('json must be an Array when option columns is defined')\n    }\n\n    for (let i = 0; i < json.length; i++) {\n      path[0] = String(i)\n\n      const item = json[i]\n\n      for (let c = 0; c < columns.length; c++) {\n        const column = columns[c]\n\n        if (column.length === 1) {\n          path[1] = column[0]\n        } else {\n          for (let p = 0; p < column.length; p++) {\n            path[p + 1] = column[p]\n          }\n        }\n        while (path.length > column.length + 1) {\n          path.pop()\n        }\n\n        const value = getIn(item, column)\n\n        searchRecursive(searchTextLowerCase, value)\n      }\n\n      if (results.length >= maxResults) {\n        break\n      }\n    }\n\n    return results\n  } else {\n    searchRecursive(searchTextLowerCase, json)\n    return results\n  }\n}\n\n/**\n * Do a case-insensitive search for a search text in a text\n */\nexport function findCaseInsensitiveMatches(\n  text: string,\n  searchTextLowerCase: string,\n  path: JSONPath,\n  field: SearchField,\n  onMatch: (searchResultItem: SearchResultItem) => void\n): void {\n  const textLower = text.toLowerCase()\n\n  let fieldIndex = 0\n  let position = -1\n  let index = -1\n\n  do {\n    index = textLower.indexOf(searchTextLowerCase, position)\n\n    if (index !== -1) {\n      position = index + searchTextLowerCase.length\n\n      onMatch({\n        path: path.slice(0), // path may be mutated in a later stage, therefore we store a copy\n        field,\n        fieldIndex,\n        start: index,\n        end: position\n      })\n\n      fieldIndex++\n    }\n  } while (index !== -1)\n}\n\n/**\n * Replace a search result item with a replacement text\n */\nexport function replaceText(text: string, replacementText: string, start: number, end: number) {\n  return text.substring(0, start) + replacementText + text.substring(end)\n}\n\n/**\n * Replace all matches with a replacement text\n */\nexport function replaceAllText(\n  text: string,\n  replacementText: string,\n  occurrences: Array<{ start: number; end: number }>\n): string {\n  let updatedText = text\n\n  forEachRight(occurrences, (occurrence) => {\n    updatedText = replaceText(updatedText, replacementText, occurrence.start, occurrence.end)\n  })\n\n  return updatedText\n}\n\nexport function createSearchAndReplaceOperations(\n  json: unknown,\n  documentState: DocumentState,\n  replacementText: string,\n  searchResultItem: SearchResultItem,\n  parser: JSONParser\n): { newSelection: JSONSelection | null; operations: JSONPatchDocument } {\n  const { field, path, start, end } = searchResultItem\n\n  if (field === SearchField.key) {\n    // replace a key\n    const parentPath = initial(path)\n    const parent = getIn(json, parentPath)\n    const oldKey = last(path) as string\n    const keys = Object.keys(parent as Record<string, unknown>)\n    const newKey = replaceText(oldKey, replacementText, start, end)\n\n    const operations = rename(parentPath, keys, oldKey, newKey)\n    const newSelection = createSelectionFromOperations(json, operations)\n\n    return {\n      newSelection,\n      operations\n    }\n  } else if (field === SearchField.value) {\n    // replace a value\n    const currentValue: unknown | undefined = getIn(json, path)\n    if (currentValue === undefined) {\n      throw new Error(`Cannot replace: path not found ${compileJSONPointer(path)}`)\n    }\n    const currentValueText = typeof currentValue === 'string' ? currentValue : String(currentValue)\n\n    const pointer = compileJSONPointer(path)\n    const enforceString = getEnforceString(\n      currentValue,\n      documentState.enforceStringMap,\n      pointer,\n      parser\n    )\n\n    const value = replaceText(currentValueText, replacementText, start, end)\n\n    const operations: JSONPatchOperation[] = [\n      {\n        op: 'replace',\n        path: compileJSONPointer(path),\n        value: enforceString ? value : stringConvert(value, parser)\n      }\n    ]\n\n    const newSelection = createSelectionFromOperations(json, operations)\n\n    return {\n      newSelection,\n      operations\n    }\n  } else {\n    throw new Error(`Cannot replace: unknown type of search result field ${field}`)\n  }\n}\n\nexport function createSearchAndReplaceAllOperations(\n  json: unknown,\n  documentState: DocumentState,\n  searchText: string,\n  replacementText: string,\n  parser: JSONParser\n): { newSelection: JSONSelection | null; operations: JSONPatchDocument } {\n  // TODO: to improve performance, we could reuse existing search results (except when hitting a maxResult limit)\n  const searchResultItems = search(searchText, json, { maxResults: Infinity })\n\n  interface Match {\n    path: JSONPath\n    field: string\n    items: SearchResultItem[]\n  }\n\n  // step 1: deduplicate matches inside the same field/value\n  // (filter, map, and group)\n  const deduplicatedMatches: Match[] = []\n  for (let i = 0; i < searchResultItems.length; i++) {\n    const previousItem = searchResultItems[i - 1]\n    const item = searchResultItems[i]\n    if (i === 0 || item.field !== previousItem.field || !isEqual(item.path, previousItem.path)) {\n      deduplicatedMatches.push({\n        path: item.path,\n        field: item.field,\n        items: [item]\n      })\n    } else {\n      ;(last(deduplicatedMatches) as Match).items.push(item)\n    }\n  }\n\n  // step 2: sort from deepest nested to least nested\n  // this is needed to replace in that order because paths may change\n  // if there are replacements in keys\n  deduplicatedMatches.sort((a, b) => {\n    // sort values first, properties next\n    if (a.field !== b.field) {\n      if (a.field === SearchField.key) {\n        return 1\n      } else {\n        return -1\n      }\n    }\n\n    // sort longest paths first, shortest last\n    return b.path.length - a.path.length\n  })\n\n  // step 3: call createSearchAndReplaceOperations for each of the matches\n  let allOperations: JSONPatchDocument = []\n  let lastNewSelection: JSONSelection | null = null\n  deduplicatedMatches.forEach((match) => {\n    // TODO: there is overlap with the logic of createSearchAndReplaceOperations. Can we extract and reuse this logic?\n    const { field, path, items } = match\n\n    if (field === SearchField.key) {\n      // replace a key\n      const parentPath = initial(path)\n      const parent = getIn(json, parentPath)\n      const oldKey = last(path) as string\n      const keys = Object.keys(parent as Record<string, unknown>)\n      const newKey = replaceAllText(oldKey, replacementText, items)\n\n      const operations = rename(parentPath, keys, oldKey, newKey)\n      allOperations = allOperations.concat(operations)\n\n      lastNewSelection = createSelectionFromOperations(json, operations)\n    } else if (field === SearchField.value) {\n      // replace a value\n      const currentValue: unknown | undefined = getIn(json, path)\n      if (currentValue === undefined) {\n        throw new Error(`Cannot replace: path not found ${compileJSONPointer(path)}`)\n      }\n      const currentValueText =\n        typeof currentValue === 'string' ? currentValue : String(currentValue)\n\n      const pointer = compileJSONPointer(path)\n      const enforceString = getEnforceString(\n        currentValue,\n        documentState.enforceStringMap,\n        pointer,\n        parser\n      )\n\n      const value = replaceAllText(currentValueText, replacementText, items)\n\n      const operations: JSONPatchOperation[] = [\n        {\n          op: 'replace',\n          path: compileJSONPointer(path),\n          value: enforceString ? value : stringConvert(value, parser)\n        }\n      ]\n      allOperations = allOperations.concat(operations)\n\n      lastNewSelection = createSelectionFromOperations(json, operations)\n    } else {\n      throw new Error(`Cannot replace: unknown type of search result field ${field}`)\n    }\n  })\n\n  return {\n    operations: allOperations,\n    newSelection: lastNewSelection\n  }\n}\n\nexport interface SplitValuePart {\n  text: string\n  type: 'normal' | 'highlight'\n  active: boolean\n}\n\n/**\n * Split the text into separate parts for each search result and the text\n * in between.\n */\nexport function splitValue(text: string, matches: ExtendedSearchResultItem[]): SplitValuePart[] {\n  const parts: SplitValuePart[] = []\n\n  let previousEnd = 0\n\n  for (const match of matches) {\n    const precedingText = text.slice(previousEnd, match.start)\n    if (precedingText !== '') {\n      parts.push({\n        type: 'normal',\n        text: precedingText,\n        active: false\n      })\n    }\n\n    const matchingText = text.slice(match.start, match.end)\n    parts.push({\n      type: 'highlight',\n      text: matchingText,\n      active: match.active\n    })\n\n    previousEnd = match.end\n  }\n\n  const lastMatch = last(matches)\n  if (lastMatch && lastMatch.end < text.length) {\n    parts.push({\n      type: 'normal',\n      text: text.slice(lastMatch.end),\n      active: false\n    })\n  }\n\n  return parts\n}\n\n/**\n * Get the path of the search result property on a nested search result\n */\nfunction getSearchResultPath(searchResultItem: SearchResultItem): JSONPath {\n  return searchResultItem.path.concat(searchResultItem.field, String(searchResultItem.fieldIndex))\n}\n\n// TODO: write unit tests\nexport function filterKeySearchResults(\n  map: JSONPointerMap<ExtendedSearchResultItem[]> | undefined,\n  pointer: JSONPointer\n): ExtendedSearchResultItem[] | undefined {\n  const items = map?.[pointer]?.filter((item: SearchResultItem) => item.field === SearchField.key)\n\n  if (!items || items.length === 0) {\n    return undefined\n  }\n\n  return items\n}\n\n// TODO: write unit tests\nexport function filterValueSearchResults(\n  map: JSONPointerMap<ExtendedSearchResultItem[]> | undefined,\n  pointer: JSONPointer\n): ExtendedSearchResultItem[] | undefined {\n  const items = map?.[pointer]?.filter((item: SearchResultItem) => item.field === SearchField.value)\n\n  if (!items || items.length === 0) {\n    return undefined\n  }\n\n  return items\n}\n","<script lang=\"ts\">\n  import { splitValue } from '$lib/logic/search.js'\n  import { addNewLineSuffix } from '$lib/utils/domUtils.js'\n  import type { ExtendedSearchResultItem } from '$lib/types'\n\n  export let text: string\n  export let searchResultItems: ExtendedSearchResultItem[]\n\n  $: parts = splitValue(String(text), searchResultItems)\n</script>\n\n{#each parts as part}\n  {#if part.type === 'normal'}\n    {part.text}\n  {:else}\n    <span class=\"jse-highlight\" class:jse-active={part.active}>{addNewLineSuffix(part.text)}</span>\n  {/if}\n{/each}\n\n<style src=\"./SearchResultHighlighter.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { isUrl } from '$lib/utils/typeUtils.js'\n  import { createValueSelection } from '$lib/logic/selection.js'\n  import SearchResultHighlighter from '../../../components/modes/treemode/highlight/SearchResultHighlighter.svelte'\n  import { getValueClass } from './utils/getValueClass.js'\n  import { addNewLineSuffix } from '$lib/utils/domUtils.js'\n  import type {\n    ExtendedSearchResultItem,\n    JSONParser,\n    OnJSONSelect,\n    ValueNormalization\n  } from '$lib/types.js'\n  import type { JSONPath } from 'immutable-json-patch'\n\n  export let path: JSONPath\n  export let value: unknown\n  export let readOnly: boolean\n  export let normalization: ValueNormalization\n  export let parser: JSONParser\n  export let onSelect: OnJSONSelect\n\n  export let searchResultItems: ExtendedSearchResultItem[] | undefined\n\n  $: valueIsUrl = isUrl(value)\n\n  function handleValueClick(event: MouseEvent) {\n    if (typeof value === 'string' && valueIsUrl && event.ctrlKey) {\n      event.preventDefault()\n      event.stopPropagation()\n\n      window.open(value, '_blank')\n    }\n  }\n\n  function handleValueDoubleClick(event: MouseEvent) {\n    if (!readOnly) {\n      event.preventDefault()\n      onSelect(createValueSelection(path, true))\n    }\n  }\n</script>\n\n<!-- svelte-ignore a11y-click-events-have-key-events -->\n<div\n  role=\"button\"\n  tabindex=\"-1\"\n  data-type=\"selectable-value\"\n  class={getValueClass(value, parser)}\n  on:click={handleValueClick}\n  on:dblclick={handleValueDoubleClick}\n  title={valueIsUrl ? 'Ctrl+Click or Ctrl+Enter to open url in new window' : null}\n>\n  {#if searchResultItems}\n    <SearchResultHighlighter text={normalization.escapeValue(value)} {searchResultItems} />\n  {:else}\n    {addNewLineSuffix(normalization.escapeValue(value))}\n  {/if}\n</div>\n\n<style src=\"./ReadonlyValue.scss\"></style>\n","<script lang=\"ts\">\n  export let text: string\n</script>\n\n<div class=\"jse-tooltip\">\n  {text}\n</div>\n\n<style src=\"./Tooltip.scss\"></style>\n","import Tooltip from './Tooltip.svelte'\nimport type { SvelteComponent } from 'svelte'\nimport type { AbsolutePopupOptions } from '$lib/types'\n\nexport interface TooltipOptions {\n  text: string\n  openAbsolutePopup: (\n    component: typeof SvelteComponent<Record<string, unknown>>,\n    props: Record<string, unknown>,\n    options: AbsolutePopupOptions\n  ) => number\n  closeAbsolutePopup: (popupId: number | undefined) => void\n}\n\nexport function tooltip(\n  node: Element,\n  { text, openAbsolutePopup, closeAbsolutePopup }: TooltipOptions\n) {\n  let popupId: number | undefined\n\n  function handleMouseEnter() {\n    const props = {\n      text\n    }\n\n    // opening popup will fail if there is already a popup open\n    popupId = openAbsolutePopup(Tooltip, props, {\n      position: 'top',\n      width: 10 * text.length, // rough estimate of the width of the message\n      offsetTop: 3,\n      anchor: node,\n      closeOnOuterClick: true\n    })\n  }\n\n  function handleMouseLeave() {\n    closeAbsolutePopup(popupId)\n  }\n\n  node.addEventListener('mouseenter', handleMouseEnter)\n  node.addEventListener('mouseleave', handleMouseLeave)\n\n  return {\n    destroy() {\n      node.removeEventListener('mouseenter', handleMouseEnter)\n      node.removeEventListener('mouseleave', handleMouseLeave)\n    }\n  }\n}\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import Icon from 'svelte-awesome'\n  import { faClock } from '@fortawesome/free-regular-svg-icons'\n  import { getContext } from 'svelte'\n  import { tooltip } from '$lib/components/controls/tooltip/tooltip.js'\n  import type { AbsolutePopupContext } from '$lib/types'\n\n  const absolutePopupContext = getContext<AbsolutePopupContext>('absolute-popup')\n\n  export let value: number\n\n  $: text = `Time: ${new Date(value).toString()}`\n</script>\n\n<div class=\"jse-timestamp\" use:tooltip={{ text, ...absolutePopupContext }}>\n  <Icon data={faClock} />\n</div>\n\n<style src=\"./TimestampTag.scss\"></style>\n","import { isBoolean, isColor, isTimestamp } from '../../utils/typeUtils.js'\nimport BooleanToggle from './components/BooleanToggle.svelte'\nimport ColorPicker from './components/ColorPicker.svelte'\nimport EditableValue from './components/EditableValue.svelte'\nimport ReadonlyValue from './components/ReadonlyValue.svelte'\nimport TimestampTag from './components/TimestampTag.svelte'\nimport type { RenderValueComponentDescription, RenderValueProps } from '../../types'\n\nexport function renderValue({\n  path,\n  value,\n  readOnly,\n  enforceString,\n  searchResultItems,\n  isEditing,\n  parser,\n  normalization,\n  onPatch,\n  onPasteJson,\n  onSelect,\n  onFind,\n  findNextInside,\n  focus\n}: RenderValueProps): RenderValueComponentDescription[] {\n  const renderers: RenderValueComponentDescription[] = []\n\n  if (!isEditing && isBoolean(value)) {\n    renderers.push({\n      component: BooleanToggle,\n      props: { path, value, readOnly, onPatch, focus }\n    })\n  }\n\n  if (!isEditing && isColor(value)) {\n    renderers.push({\n      component: ColorPicker,\n      props: { path, value, readOnly, onPatch, focus }\n    })\n  }\n\n  if (isEditing) {\n    renderers.push({\n      component: EditableValue,\n      props: {\n        path,\n        value,\n        enforceString,\n        parser,\n        normalization,\n        onPatch,\n        onPasteJson,\n        onSelect,\n        onFind,\n        findNextInside,\n        focus\n      }\n    })\n  }\n\n  if (!isEditing) {\n    renderers.push({\n      component: ReadonlyValue,\n      props: { path, value, readOnly, parser, normalization, searchResultItems, onSelect }\n    })\n  }\n\n  if (!isEditing && isTimestamp(value)) {\n    renderers.push({\n      component: TimestampTag,\n      props: { value }\n    })\n  }\n\n  return renderers\n}\n","import type { QueryLanguageOptions } from '$lib/types.js'\n\nexport interface TransformModalState {\n  queryLanguageId: string\n  queryOptions: QueryLanguageOptions\n  query: string\n  isManual: boolean\n}\n\nexport const transformModalStates: Record<string, TransformModalState> = {}\n\nexport interface TransformModalStateShared {\n  showWizard: boolean\n  showOriginal: boolean\n}\n\nexport const transformModalStateShared: TransformModalStateShared = {\n  showWizard: true,\n  showOriginal: true\n}\n","/**\n * Custom positioning reference element.\n * @see https://floating-ui.com/docs/virtual-elements\n */\n\nconst sides = ['top', 'right', 'bottom', 'left'];\nconst alignments = ['start', 'end'];\nconst placements = /*#__PURE__*/sides.reduce((acc, side) => acc.concat(side, side + \"-\" + alignments[0], side + \"-\" + alignments[1]), []);\nconst min = Math.min;\nconst max = Math.max;\nconst round = Math.round;\nconst floor = Math.floor;\nconst createCoords = v => ({\n  x: v,\n  y: v\n});\nconst oppositeSideMap = {\n  left: 'right',\n  right: 'left',\n  bottom: 'top',\n  top: 'bottom'\n};\nconst oppositeAlignmentMap = {\n  start: 'end',\n  end: 'start'\n};\nfunction clamp(start, value, end) {\n  return max(start, min(value, end));\n}\nfunction evaluate(value, param) {\n  return typeof value === 'function' ? value(param) : value;\n}\nfunction getSide(placement) {\n  return placement.split('-')[0];\n}\nfunction getAlignment(placement) {\n  return placement.split('-')[1];\n}\nfunction getOppositeAxis(axis) {\n  return axis === 'x' ? 'y' : 'x';\n}\nfunction getAxisLength(axis) {\n  return axis === 'y' ? 'height' : 'width';\n}\nfunction getSideAxis(placement) {\n  return ['top', 'bottom'].includes(getSide(placement)) ? 'y' : 'x';\n}\nfunction getAlignmentAxis(placement) {\n  return getOppositeAxis(getSideAxis(placement));\n}\nfunction getAlignmentSides(placement, rects, rtl) {\n  if (rtl === void 0) {\n    rtl = false;\n  }\n  const alignment = getAlignment(placement);\n  const alignmentAxis = getAlignmentAxis(placement);\n  const length = getAxisLength(alignmentAxis);\n  let mainAlignmentSide = alignmentAxis === 'x' ? alignment === (rtl ? 'end' : 'start') ? 'right' : 'left' : alignment === 'start' ? 'bottom' : 'top';\n  if (rects.reference[length] > rects.floating[length]) {\n    mainAlignmentSide = getOppositePlacement(mainAlignmentSide);\n  }\n  return [mainAlignmentSide, getOppositePlacement(mainAlignmentSide)];\n}\nfunction getExpandedPlacements(placement) {\n  const oppositePlacement = getOppositePlacement(placement);\n  return [getOppositeAlignmentPlacement(placement), oppositePlacement, getOppositeAlignmentPlacement(oppositePlacement)];\n}\nfunction getOppositeAlignmentPlacement(placement) {\n  return placement.replace(/start|end/g, alignment => oppositeAlignmentMap[alignment]);\n}\nfunction getSideList(side, isStart, rtl) {\n  const lr = ['left', 'right'];\n  const rl = ['right', 'left'];\n  const tb = ['top', 'bottom'];\n  const bt = ['bottom', 'top'];\n  switch (side) {\n    case 'top':\n    case 'bottom':\n      if (rtl) return isStart ? rl : lr;\n      return isStart ? lr : rl;\n    case 'left':\n    case 'right':\n      return isStart ? tb : bt;\n    default:\n      return [];\n  }\n}\nfunction getOppositeAxisPlacements(placement, flipAlignment, direction, rtl) {\n  const alignment = getAlignment(placement);\n  let list = getSideList(getSide(placement), direction === 'start', rtl);\n  if (alignment) {\n    list = list.map(side => side + \"-\" + alignment);\n    if (flipAlignment) {\n      list = list.concat(list.map(getOppositeAlignmentPlacement));\n    }\n  }\n  return list;\n}\nfunction getOppositePlacement(placement) {\n  return placement.replace(/left|right|bottom|top/g, side => oppositeSideMap[side]);\n}\nfunction expandPaddingObject(padding) {\n  return {\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0,\n    ...padding\n  };\n}\nfunction getPaddingObject(padding) {\n  return typeof padding !== 'number' ? expandPaddingObject(padding) : {\n    top: padding,\n    right: padding,\n    bottom: padding,\n    left: padding\n  };\n}\nfunction rectToClientRect(rect) {\n  return {\n    ...rect,\n    top: rect.y,\n    left: rect.x,\n    right: rect.x + rect.width,\n    bottom: rect.y + rect.height\n  };\n}\n\nexport { alignments, clamp, createCoords, evaluate, expandPaddingObject, floor, getAlignment, getAlignmentAxis, getAlignmentSides, getAxisLength, getExpandedPlacements, getOppositeAlignmentPlacement, getOppositeAxis, getOppositeAxisPlacements, getOppositePlacement, getPaddingObject, getSide, getSideAxis, max, min, placements, rectToClientRect, round, sides };\n","import { getSideAxis, getAlignmentAxis, getAxisLength, getSide, getAlignment, evaluate, getPaddingObject, rectToClientRect, min, clamp, placements, getAlignmentSides, getOppositeAlignmentPlacement, getOppositePlacement, getExpandedPlacements, getOppositeAxisPlacements, sides, max, getOppositeAxis } from '@floating-ui/utils';\nexport { rectToClientRect } from '@floating-ui/utils';\n\nfunction computeCoordsFromPlacement(_ref, placement, rtl) {\n  let {\n    reference,\n    floating\n  } = _ref;\n  const sideAxis = getSideAxis(placement);\n  const alignmentAxis = getAlignmentAxis(placement);\n  const alignLength = getAxisLength(alignmentAxis);\n  const side = getSide(placement);\n  const isVertical = sideAxis === 'y';\n  const commonX = reference.x + reference.width / 2 - floating.width / 2;\n  const commonY = reference.y + reference.height / 2 - floating.height / 2;\n  const commonAlign = reference[alignLength] / 2 - floating[alignLength] / 2;\n  let coords;\n  switch (side) {\n    case 'top':\n      coords = {\n        x: commonX,\n        y: reference.y - floating.height\n      };\n      break;\n    case 'bottom':\n      coords = {\n        x: commonX,\n        y: reference.y + reference.height\n      };\n      break;\n    case 'right':\n      coords = {\n        x: reference.x + reference.width,\n        y: commonY\n      };\n      break;\n    case 'left':\n      coords = {\n        x: reference.x - floating.width,\n        y: commonY\n      };\n      break;\n    default:\n      coords = {\n        x: reference.x,\n        y: reference.y\n      };\n  }\n  switch (getAlignment(placement)) {\n    case 'start':\n      coords[alignmentAxis] -= commonAlign * (rtl && isVertical ? -1 : 1);\n      break;\n    case 'end':\n      coords[alignmentAxis] += commonAlign * (rtl && isVertical ? -1 : 1);\n      break;\n  }\n  return coords;\n}\n\n/**\n * Computes the `x` and `y` coordinates that will place the floating element\n * next to a given reference element.\n *\n * This export does not have any `platform` interface logic. You will need to\n * write one for the platform you are using Floating UI with.\n */\nconst computePosition = async (reference, floating, config) => {\n  const {\n    placement = 'bottom',\n    strategy = 'absolute',\n    middleware = [],\n    platform\n  } = config;\n  const validMiddleware = middleware.filter(Boolean);\n  const rtl = await (platform.isRTL == null ? void 0 : platform.isRTL(floating));\n  let rects = await platform.getElementRects({\n    reference,\n    floating,\n    strategy\n  });\n  let {\n    x,\n    y\n  } = computeCoordsFromPlacement(rects, placement, rtl);\n  let statefulPlacement = placement;\n  let middlewareData = {};\n  let resetCount = 0;\n  for (let i = 0; i < validMiddleware.length; i++) {\n    const {\n      name,\n      fn\n    } = validMiddleware[i];\n    const {\n      x: nextX,\n      y: nextY,\n      data,\n      reset\n    } = await fn({\n      x,\n      y,\n      initialPlacement: placement,\n      placement: statefulPlacement,\n      strategy,\n      middlewareData,\n      rects,\n      platform,\n      elements: {\n        reference,\n        floating\n      }\n    });\n    x = nextX != null ? nextX : x;\n    y = nextY != null ? nextY : y;\n    middlewareData = {\n      ...middlewareData,\n      [name]: {\n        ...middlewareData[name],\n        ...data\n      }\n    };\n    if (reset && resetCount <= 50) {\n      resetCount++;\n      if (typeof reset === 'object') {\n        if (reset.placement) {\n          statefulPlacement = reset.placement;\n        }\n        if (reset.rects) {\n          rects = reset.rects === true ? await platform.getElementRects({\n            reference,\n            floating,\n            strategy\n          }) : reset.rects;\n        }\n        ({\n          x,\n          y\n        } = computeCoordsFromPlacement(rects, statefulPlacement, rtl));\n      }\n      i = -1;\n      continue;\n    }\n  }\n  return {\n    x,\n    y,\n    placement: statefulPlacement,\n    strategy,\n    middlewareData\n  };\n};\n\n/**\n * Resolves with an object of overflow side offsets that determine how much the\n * element is overflowing a given clipping boundary on each side.\n * - positive = overflowing the boundary by that number of pixels\n * - negative = how many pixels left before it will overflow\n * - 0 = lies flush with the boundary\n * @see https://floating-ui.com/docs/detectOverflow\n */\nasync function detectOverflow(state, options) {\n  var _await$platform$isEle;\n  if (options === void 0) {\n    options = {};\n  }\n  const {\n    x,\n    y,\n    platform,\n    rects,\n    elements,\n    strategy\n  } = state;\n  const {\n    boundary = 'clippingAncestors',\n    rootBoundary = 'viewport',\n    elementContext = 'floating',\n    altBoundary = false,\n    padding = 0\n  } = evaluate(options, state);\n  const paddingObject = getPaddingObject(padding);\n  const altContext = elementContext === 'floating' ? 'reference' : 'floating';\n  const element = elements[altBoundary ? altContext : elementContext];\n  const clippingClientRect = rectToClientRect(await platform.getClippingRect({\n    element: ((_await$platform$isEle = await (platform.isElement == null ? void 0 : platform.isElement(element))) != null ? _await$platform$isEle : true) ? element : element.contextElement || (await (platform.getDocumentElement == null ? void 0 : platform.getDocumentElement(elements.floating))),\n    boundary,\n    rootBoundary,\n    strategy\n  }));\n  const rect = elementContext === 'floating' ? {\n    ...rects.floating,\n    x,\n    y\n  } : rects.reference;\n  const offsetParent = await (platform.getOffsetParent == null ? void 0 : platform.getOffsetParent(elements.floating));\n  const offsetScale = (await (platform.isElement == null ? void 0 : platform.isElement(offsetParent))) ? (await (platform.getScale == null ? void 0 : platform.getScale(offsetParent))) || {\n    x: 1,\n    y: 1\n  } : {\n    x: 1,\n    y: 1\n  };\n  const elementClientRect = rectToClientRect(platform.convertOffsetParentRelativeRectToViewportRelativeRect ? await platform.convertOffsetParentRelativeRectToViewportRelativeRect({\n    rect,\n    offsetParent,\n    strategy\n  }) : rect);\n  return {\n    top: (clippingClientRect.top - elementClientRect.top + paddingObject.top) / offsetScale.y,\n    bottom: (elementClientRect.bottom - clippingClientRect.bottom + paddingObject.bottom) / offsetScale.y,\n    left: (clippingClientRect.left - elementClientRect.left + paddingObject.left) / offsetScale.x,\n    right: (elementClientRect.right - clippingClientRect.right + paddingObject.right) / offsetScale.x\n  };\n}\n\n/**\n * Provides data to position an inner element of the floating element so that it\n * appears centered to the reference element.\n * @see https://floating-ui.com/docs/arrow\n */\nconst arrow = options => ({\n  name: 'arrow',\n  options,\n  async fn(state) {\n    const {\n      x,\n      y,\n      placement,\n      rects,\n      platform,\n      elements,\n      middlewareData\n    } = state;\n    // Since `element` is required, we don't Partial<> the type.\n    const {\n      element,\n      padding = 0\n    } = evaluate(options, state) || {};\n    if (element == null) {\n      return {};\n    }\n    const paddingObject = getPaddingObject(padding);\n    const coords = {\n      x,\n      y\n    };\n    const axis = getAlignmentAxis(placement);\n    const length = getAxisLength(axis);\n    const arrowDimensions = await platform.getDimensions(element);\n    const isYAxis = axis === 'y';\n    const minProp = isYAxis ? 'top' : 'left';\n    const maxProp = isYAxis ? 'bottom' : 'right';\n    const clientProp = isYAxis ? 'clientHeight' : 'clientWidth';\n    const endDiff = rects.reference[length] + rects.reference[axis] - coords[axis] - rects.floating[length];\n    const startDiff = coords[axis] - rects.reference[axis];\n    const arrowOffsetParent = await (platform.getOffsetParent == null ? void 0 : platform.getOffsetParent(element));\n    let clientSize = arrowOffsetParent ? arrowOffsetParent[clientProp] : 0;\n\n    // DOM platform can return `window` as the `offsetParent`.\n    if (!clientSize || !(await (platform.isElement == null ? void 0 : platform.isElement(arrowOffsetParent)))) {\n      clientSize = elements.floating[clientProp] || rects.floating[length];\n    }\n    const centerToReference = endDiff / 2 - startDiff / 2;\n\n    // If the padding is large enough that it causes the arrow to no longer be\n    // centered, modify the padding so that it is centered.\n    const largestPossiblePadding = clientSize / 2 - arrowDimensions[length] / 2 - 1;\n    const minPadding = min(paddingObject[minProp], largestPossiblePadding);\n    const maxPadding = min(paddingObject[maxProp], largestPossiblePadding);\n\n    // Make sure the arrow doesn't overflow the floating element if the center\n    // point is outside the floating element's bounds.\n    const min$1 = minPadding;\n    const max = clientSize - arrowDimensions[length] - maxPadding;\n    const center = clientSize / 2 - arrowDimensions[length] / 2 + centerToReference;\n    const offset = clamp(min$1, center, max);\n\n    // If the reference is small enough that the arrow's padding causes it to\n    // to point to nothing for an aligned placement, adjust the offset of the\n    // floating element itself. To ensure `shift()` continues to take action,\n    // a single reset is performed when this is true.\n    const shouldAddOffset = !middlewareData.arrow && getAlignment(placement) != null && center != offset && rects.reference[length] / 2 - (center < min$1 ? minPadding : maxPadding) - arrowDimensions[length] / 2 < 0;\n    const alignmentOffset = shouldAddOffset ? center < min$1 ? center - min$1 : center - max : 0;\n    return {\n      [axis]: coords[axis] + alignmentOffset,\n      data: {\n        [axis]: offset,\n        centerOffset: center - offset - alignmentOffset,\n        ...(shouldAddOffset && {\n          alignmentOffset\n        })\n      },\n      reset: shouldAddOffset\n    };\n  }\n});\n\nfunction getPlacementList(alignment, autoAlignment, allowedPlacements) {\n  const allowedPlacementsSortedByAlignment = alignment ? [...allowedPlacements.filter(placement => getAlignment(placement) === alignment), ...allowedPlacements.filter(placement => getAlignment(placement) !== alignment)] : allowedPlacements.filter(placement => getSide(placement) === placement);\n  return allowedPlacementsSortedByAlignment.filter(placement => {\n    if (alignment) {\n      return getAlignment(placement) === alignment || (autoAlignment ? getOppositeAlignmentPlacement(placement) !== placement : false);\n    }\n    return true;\n  });\n}\n/**\n * Optimizes the visibility of the floating element by choosing the placement\n * that has the most space available automatically, without needing to specify a\n * preferred placement. Alternative to `flip`.\n * @see https://floating-ui.com/docs/autoPlacement\n */\nconst autoPlacement = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    name: 'autoPlacement',\n    options,\n    async fn(state) {\n      var _middlewareData$autoP, _middlewareData$autoP2, _placementsThatFitOnE;\n      const {\n        rects,\n        middlewareData,\n        placement,\n        platform,\n        elements\n      } = state;\n      const {\n        crossAxis = false,\n        alignment,\n        allowedPlacements = placements,\n        autoAlignment = true,\n        ...detectOverflowOptions\n      } = evaluate(options, state);\n      const placements$1 = alignment !== undefined || allowedPlacements === placements ? getPlacementList(alignment || null, autoAlignment, allowedPlacements) : allowedPlacements;\n      const overflow = await detectOverflow(state, detectOverflowOptions);\n      const currentIndex = ((_middlewareData$autoP = middlewareData.autoPlacement) == null ? void 0 : _middlewareData$autoP.index) || 0;\n      const currentPlacement = placements$1[currentIndex];\n      if (currentPlacement == null) {\n        return {};\n      }\n      const alignmentSides = getAlignmentSides(currentPlacement, rects, await (platform.isRTL == null ? void 0 : platform.isRTL(elements.floating)));\n\n      // Make `computeCoords` start from the right place.\n      if (placement !== currentPlacement) {\n        return {\n          reset: {\n            placement: placements$1[0]\n          }\n        };\n      }\n      const currentOverflows = [overflow[getSide(currentPlacement)], overflow[alignmentSides[0]], overflow[alignmentSides[1]]];\n      const allOverflows = [...(((_middlewareData$autoP2 = middlewareData.autoPlacement) == null ? void 0 : _middlewareData$autoP2.overflows) || []), {\n        placement: currentPlacement,\n        overflows: currentOverflows\n      }];\n      const nextPlacement = placements$1[currentIndex + 1];\n\n      // There are more placements to check.\n      if (nextPlacement) {\n        return {\n          data: {\n            index: currentIndex + 1,\n            overflows: allOverflows\n          },\n          reset: {\n            placement: nextPlacement\n          }\n        };\n      }\n      const placementsSortedByMostSpace = allOverflows.map(d => {\n        const alignment = getAlignment(d.placement);\n        return [d.placement, alignment && crossAxis ?\n        // Check along the mainAxis and main crossAxis side.\n        d.overflows.slice(0, 2).reduce((acc, v) => acc + v, 0) :\n        // Check only the mainAxis.\n        d.overflows[0], d.overflows];\n      }).sort((a, b) => a[1] - b[1]);\n      const placementsThatFitOnEachSide = placementsSortedByMostSpace.filter(d => d[2].slice(0,\n      // Aligned placements should not check their opposite crossAxis\n      // side.\n      getAlignment(d[0]) ? 2 : 3).every(v => v <= 0));\n      const resetPlacement = ((_placementsThatFitOnE = placementsThatFitOnEachSide[0]) == null ? void 0 : _placementsThatFitOnE[0]) || placementsSortedByMostSpace[0][0];\n      if (resetPlacement !== placement) {\n        return {\n          data: {\n            index: currentIndex + 1,\n            overflows: allOverflows\n          },\n          reset: {\n            placement: resetPlacement\n          }\n        };\n      }\n      return {};\n    }\n  };\n};\n\n/**\n * Optimizes the visibility of the floating element by flipping the `placement`\n * in order to keep it in view when the preferred placement(s) will overflow the\n * clipping boundary. Alternative to `autoPlacement`.\n * @see https://floating-ui.com/docs/flip\n */\nconst flip = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    name: 'flip',\n    options,\n    async fn(state) {\n      var _middlewareData$arrow, _middlewareData$flip;\n      const {\n        placement,\n        middlewareData,\n        rects,\n        initialPlacement,\n        platform,\n        elements\n      } = state;\n      const {\n        mainAxis: checkMainAxis = true,\n        crossAxis: checkCrossAxis = true,\n        fallbackPlacements: specifiedFallbackPlacements,\n        fallbackStrategy = 'bestFit',\n        fallbackAxisSideDirection = 'none',\n        flipAlignment = true,\n        ...detectOverflowOptions\n      } = evaluate(options, state);\n\n      // If a reset by the arrow was caused due to an alignment offset being\n      // added, we should skip any logic now since `flip()` has already done its\n      // work.\n      // https://github.com/floating-ui/floating-ui/issues/2549#issuecomment-1719601643\n      if ((_middlewareData$arrow = middlewareData.arrow) != null && _middlewareData$arrow.alignmentOffset) {\n        return {};\n      }\n      const side = getSide(placement);\n      const isBasePlacement = getSide(initialPlacement) === initialPlacement;\n      const rtl = await (platform.isRTL == null ? void 0 : platform.isRTL(elements.floating));\n      const fallbackPlacements = specifiedFallbackPlacements || (isBasePlacement || !flipAlignment ? [getOppositePlacement(initialPlacement)] : getExpandedPlacements(initialPlacement));\n      if (!specifiedFallbackPlacements && fallbackAxisSideDirection !== 'none') {\n        fallbackPlacements.push(...getOppositeAxisPlacements(initialPlacement, flipAlignment, fallbackAxisSideDirection, rtl));\n      }\n      const placements = [initialPlacement, ...fallbackPlacements];\n      const overflow = await detectOverflow(state, detectOverflowOptions);\n      const overflows = [];\n      let overflowsData = ((_middlewareData$flip = middlewareData.flip) == null ? void 0 : _middlewareData$flip.overflows) || [];\n      if (checkMainAxis) {\n        overflows.push(overflow[side]);\n      }\n      if (checkCrossAxis) {\n        const sides = getAlignmentSides(placement, rects, rtl);\n        overflows.push(overflow[sides[0]], overflow[sides[1]]);\n      }\n      overflowsData = [...overflowsData, {\n        placement,\n        overflows\n      }];\n\n      // One or more sides is overflowing.\n      if (!overflows.every(side => side <= 0)) {\n        var _middlewareData$flip2, _overflowsData$filter;\n        const nextIndex = (((_middlewareData$flip2 = middlewareData.flip) == null ? void 0 : _middlewareData$flip2.index) || 0) + 1;\n        const nextPlacement = placements[nextIndex];\n        if (nextPlacement) {\n          // Try next placement and re-run the lifecycle.\n          return {\n            data: {\n              index: nextIndex,\n              overflows: overflowsData\n            },\n            reset: {\n              placement: nextPlacement\n            }\n          };\n        }\n\n        // First, find the candidates that fit on the mainAxis side of overflow,\n        // then find the placement that fits the best on the main crossAxis side.\n        let resetPlacement = (_overflowsData$filter = overflowsData.filter(d => d.overflows[0] <= 0).sort((a, b) => a.overflows[1] - b.overflows[1])[0]) == null ? void 0 : _overflowsData$filter.placement;\n\n        // Otherwise fallback.\n        if (!resetPlacement) {\n          switch (fallbackStrategy) {\n            case 'bestFit':\n              {\n                var _overflowsData$map$so;\n                const placement = (_overflowsData$map$so = overflowsData.map(d => [d.placement, d.overflows.filter(overflow => overflow > 0).reduce((acc, overflow) => acc + overflow, 0)]).sort((a, b) => a[1] - b[1])[0]) == null ? void 0 : _overflowsData$map$so[0];\n                if (placement) {\n                  resetPlacement = placement;\n                }\n                break;\n              }\n            case 'initialPlacement':\n              resetPlacement = initialPlacement;\n              break;\n          }\n        }\n        if (placement !== resetPlacement) {\n          return {\n            reset: {\n              placement: resetPlacement\n            }\n          };\n        }\n      }\n      return {};\n    }\n  };\n};\n\nfunction getSideOffsets(overflow, rect) {\n  return {\n    top: overflow.top - rect.height,\n    right: overflow.right - rect.width,\n    bottom: overflow.bottom - rect.height,\n    left: overflow.left - rect.width\n  };\n}\nfunction isAnySideFullyClipped(overflow) {\n  return sides.some(side => overflow[side] >= 0);\n}\n/**\n * Provides data to hide the floating element in applicable situations, such as\n * when it is not in the same clipping context as the reference element.\n * @see https://floating-ui.com/docs/hide\n */\nconst hide = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    name: 'hide',\n    options,\n    async fn(state) {\n      const {\n        rects\n      } = state;\n      const {\n        strategy = 'referenceHidden',\n        ...detectOverflowOptions\n      } = evaluate(options, state);\n      switch (strategy) {\n        case 'referenceHidden':\n          {\n            const overflow = await detectOverflow(state, {\n              ...detectOverflowOptions,\n              elementContext: 'reference'\n            });\n            const offsets = getSideOffsets(overflow, rects.reference);\n            return {\n              data: {\n                referenceHiddenOffsets: offsets,\n                referenceHidden: isAnySideFullyClipped(offsets)\n              }\n            };\n          }\n        case 'escaped':\n          {\n            const overflow = await detectOverflow(state, {\n              ...detectOverflowOptions,\n              altBoundary: true\n            });\n            const offsets = getSideOffsets(overflow, rects.floating);\n            return {\n              data: {\n                escapedOffsets: offsets,\n                escaped: isAnySideFullyClipped(offsets)\n              }\n            };\n          }\n        default:\n          {\n            return {};\n          }\n      }\n    }\n  };\n};\n\nfunction getBoundingRect(rects) {\n  const minX = min(...rects.map(rect => rect.left));\n  const minY = min(...rects.map(rect => rect.top));\n  const maxX = max(...rects.map(rect => rect.right));\n  const maxY = max(...rects.map(rect => rect.bottom));\n  return {\n    x: minX,\n    y: minY,\n    width: maxX - minX,\n    height: maxY - minY\n  };\n}\nfunction getRectsByLine(rects) {\n  const sortedRects = rects.slice().sort((a, b) => a.y - b.y);\n  const groups = [];\n  let prevRect = null;\n  for (let i = 0; i < sortedRects.length; i++) {\n    const rect = sortedRects[i];\n    if (!prevRect || rect.y - prevRect.y > prevRect.height / 2) {\n      groups.push([rect]);\n    } else {\n      groups[groups.length - 1].push(rect);\n    }\n    prevRect = rect;\n  }\n  return groups.map(rect => rectToClientRect(getBoundingRect(rect)));\n}\n/**\n * Provides improved positioning for inline reference elements that can span\n * over multiple lines, such as hyperlinks or range selections.\n * @see https://floating-ui.com/docs/inline\n */\nconst inline = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    name: 'inline',\n    options,\n    async fn(state) {\n      const {\n        placement,\n        elements,\n        rects,\n        platform,\n        strategy\n      } = state;\n      // A MouseEvent's client{X,Y} coords can be up to 2 pixels off a\n      // ClientRect's bounds, despite the event listener being triggered. A\n      // padding of 2 seems to handle this issue.\n      const {\n        padding = 2,\n        x,\n        y\n      } = evaluate(options, state);\n      const nativeClientRects = Array.from((await (platform.getClientRects == null ? void 0 : platform.getClientRects(elements.reference))) || []);\n      const clientRects = getRectsByLine(nativeClientRects);\n      const fallback = rectToClientRect(getBoundingRect(nativeClientRects));\n      const paddingObject = getPaddingObject(padding);\n      function getBoundingClientRect() {\n        // There are two rects and they are disjoined.\n        if (clientRects.length === 2 && clientRects[0].left > clientRects[1].right && x != null && y != null) {\n          // Find the first rect in which the point is fully inside.\n          return clientRects.find(rect => x > rect.left - paddingObject.left && x < rect.right + paddingObject.right && y > rect.top - paddingObject.top && y < rect.bottom + paddingObject.bottom) || fallback;\n        }\n\n        // There are 2 or more connected rects.\n        if (clientRects.length >= 2) {\n          if (getSideAxis(placement) === 'y') {\n            const firstRect = clientRects[0];\n            const lastRect = clientRects[clientRects.length - 1];\n            const isTop = getSide(placement) === 'top';\n            const top = firstRect.top;\n            const bottom = lastRect.bottom;\n            const left = isTop ? firstRect.left : lastRect.left;\n            const right = isTop ? firstRect.right : lastRect.right;\n            const width = right - left;\n            const height = bottom - top;\n            return {\n              top,\n              bottom,\n              left,\n              right,\n              width,\n              height,\n              x: left,\n              y: top\n            };\n          }\n          const isLeftSide = getSide(placement) === 'left';\n          const maxRight = max(...clientRects.map(rect => rect.right));\n          const minLeft = min(...clientRects.map(rect => rect.left));\n          const measureRects = clientRects.filter(rect => isLeftSide ? rect.left === minLeft : rect.right === maxRight);\n          const top = measureRects[0].top;\n          const bottom = measureRects[measureRects.length - 1].bottom;\n          const left = minLeft;\n          const right = maxRight;\n          const width = right - left;\n          const height = bottom - top;\n          return {\n            top,\n            bottom,\n            left,\n            right,\n            width,\n            height,\n            x: left,\n            y: top\n          };\n        }\n        return fallback;\n      }\n      const resetRects = await platform.getElementRects({\n        reference: {\n          getBoundingClientRect\n        },\n        floating: elements.floating,\n        strategy\n      });\n      if (rects.reference.x !== resetRects.reference.x || rects.reference.y !== resetRects.reference.y || rects.reference.width !== resetRects.reference.width || rects.reference.height !== resetRects.reference.height) {\n        return {\n          reset: {\n            rects: resetRects\n          }\n        };\n      }\n      return {};\n    }\n  };\n};\n\n// For type backwards-compatibility, the `OffsetOptions` type was also\n// Derivable.\n\nasync function convertValueToCoords(state, options) {\n  const {\n    placement,\n    platform,\n    elements\n  } = state;\n  const rtl = await (platform.isRTL == null ? void 0 : platform.isRTL(elements.floating));\n  const side = getSide(placement);\n  const alignment = getAlignment(placement);\n  const isVertical = getSideAxis(placement) === 'y';\n  const mainAxisMulti = ['left', 'top'].includes(side) ? -1 : 1;\n  const crossAxisMulti = rtl && isVertical ? -1 : 1;\n  const rawValue = evaluate(options, state);\n\n  // eslint-disable-next-line prefer-const\n  let {\n    mainAxis,\n    crossAxis,\n    alignmentAxis\n  } = typeof rawValue === 'number' ? {\n    mainAxis: rawValue,\n    crossAxis: 0,\n    alignmentAxis: null\n  } : {\n    mainAxis: 0,\n    crossAxis: 0,\n    alignmentAxis: null,\n    ...rawValue\n  };\n  if (alignment && typeof alignmentAxis === 'number') {\n    crossAxis = alignment === 'end' ? alignmentAxis * -1 : alignmentAxis;\n  }\n  return isVertical ? {\n    x: crossAxis * crossAxisMulti,\n    y: mainAxis * mainAxisMulti\n  } : {\n    x: mainAxis * mainAxisMulti,\n    y: crossAxis * crossAxisMulti\n  };\n}\n\n/**\n * Modifies the placement by translating the floating element along the\n * specified axes.\n * A number (shorthand for `mainAxis` or distance), or an axes configuration\n * object may be passed.\n * @see https://floating-ui.com/docs/offset\n */\nconst offset = function (options) {\n  if (options === void 0) {\n    options = 0;\n  }\n  return {\n    name: 'offset',\n    options,\n    async fn(state) {\n      var _middlewareData$offse, _middlewareData$arrow;\n      const {\n        x,\n        y,\n        placement,\n        middlewareData\n      } = state;\n      const diffCoords = await convertValueToCoords(state, options);\n\n      // If the placement is the same and the arrow caused an alignment offset\n      // then we don't need to change the positioning coordinates.\n      if (placement === ((_middlewareData$offse = middlewareData.offset) == null ? void 0 : _middlewareData$offse.placement) && (_middlewareData$arrow = middlewareData.arrow) != null && _middlewareData$arrow.alignmentOffset) {\n        return {};\n      }\n      return {\n        x: x + diffCoords.x,\n        y: y + diffCoords.y,\n        data: {\n          ...diffCoords,\n          placement\n        }\n      };\n    }\n  };\n};\n\n/**\n * Optimizes the visibility of the floating element by shifting it in order to\n * keep it in view when it will overflow the clipping boundary.\n * @see https://floating-ui.com/docs/shift\n */\nconst shift = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    name: 'shift',\n    options,\n    async fn(state) {\n      const {\n        x,\n        y,\n        placement\n      } = state;\n      const {\n        mainAxis: checkMainAxis = true,\n        crossAxis: checkCrossAxis = false,\n        limiter = {\n          fn: _ref => {\n            let {\n              x,\n              y\n            } = _ref;\n            return {\n              x,\n              y\n            };\n          }\n        },\n        ...detectOverflowOptions\n      } = evaluate(options, state);\n      const coords = {\n        x,\n        y\n      };\n      const overflow = await detectOverflow(state, detectOverflowOptions);\n      const crossAxis = getSideAxis(getSide(placement));\n      const mainAxis = getOppositeAxis(crossAxis);\n      let mainAxisCoord = coords[mainAxis];\n      let crossAxisCoord = coords[crossAxis];\n      if (checkMainAxis) {\n        const minSide = mainAxis === 'y' ? 'top' : 'left';\n        const maxSide = mainAxis === 'y' ? 'bottom' : 'right';\n        const min = mainAxisCoord + overflow[minSide];\n        const max = mainAxisCoord - overflow[maxSide];\n        mainAxisCoord = clamp(min, mainAxisCoord, max);\n      }\n      if (checkCrossAxis) {\n        const minSide = crossAxis === 'y' ? 'top' : 'left';\n        const maxSide = crossAxis === 'y' ? 'bottom' : 'right';\n        const min = crossAxisCoord + overflow[minSide];\n        const max = crossAxisCoord - overflow[maxSide];\n        crossAxisCoord = clamp(min, crossAxisCoord, max);\n      }\n      const limitedCoords = limiter.fn({\n        ...state,\n        [mainAxis]: mainAxisCoord,\n        [crossAxis]: crossAxisCoord\n      });\n      return {\n        ...limitedCoords,\n        data: {\n          x: limitedCoords.x - x,\n          y: limitedCoords.y - y\n        }\n      };\n    }\n  };\n};\n/**\n * Built-in `limiter` that will stop `shift()` at a certain point.\n */\nconst limitShift = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    options,\n    fn(state) {\n      const {\n        x,\n        y,\n        placement,\n        rects,\n        middlewareData\n      } = state;\n      const {\n        offset = 0,\n        mainAxis: checkMainAxis = true,\n        crossAxis: checkCrossAxis = true\n      } = evaluate(options, state);\n      const coords = {\n        x,\n        y\n      };\n      const crossAxis = getSideAxis(placement);\n      const mainAxis = getOppositeAxis(crossAxis);\n      let mainAxisCoord = coords[mainAxis];\n      let crossAxisCoord = coords[crossAxis];\n      const rawOffset = evaluate(offset, state);\n      const computedOffset = typeof rawOffset === 'number' ? {\n        mainAxis: rawOffset,\n        crossAxis: 0\n      } : {\n        mainAxis: 0,\n        crossAxis: 0,\n        ...rawOffset\n      };\n      if (checkMainAxis) {\n        const len = mainAxis === 'y' ? 'height' : 'width';\n        const limitMin = rects.reference[mainAxis] - rects.floating[len] + computedOffset.mainAxis;\n        const limitMax = rects.reference[mainAxis] + rects.reference[len] - computedOffset.mainAxis;\n        if (mainAxisCoord < limitMin) {\n          mainAxisCoord = limitMin;\n        } else if (mainAxisCoord > limitMax) {\n          mainAxisCoord = limitMax;\n        }\n      }\n      if (checkCrossAxis) {\n        var _middlewareData$offse, _middlewareData$offse2;\n        const len = mainAxis === 'y' ? 'width' : 'height';\n        const isOriginSide = ['top', 'left'].includes(getSide(placement));\n        const limitMin = rects.reference[crossAxis] - rects.floating[len] + (isOriginSide ? ((_middlewareData$offse = middlewareData.offset) == null ? void 0 : _middlewareData$offse[crossAxis]) || 0 : 0) + (isOriginSide ? 0 : computedOffset.crossAxis);\n        const limitMax = rects.reference[crossAxis] + rects.reference[len] + (isOriginSide ? 0 : ((_middlewareData$offse2 = middlewareData.offset) == null ? void 0 : _middlewareData$offse2[crossAxis]) || 0) - (isOriginSide ? computedOffset.crossAxis : 0);\n        if (crossAxisCoord < limitMin) {\n          crossAxisCoord = limitMin;\n        } else if (crossAxisCoord > limitMax) {\n          crossAxisCoord = limitMax;\n        }\n      }\n      return {\n        [mainAxis]: mainAxisCoord,\n        [crossAxis]: crossAxisCoord\n      };\n    }\n  };\n};\n\n/**\n * Provides data that allows you to change the size of the floating element \n * for instance, prevent it from overflowing the clipping boundary or match the\n * width of the reference element.\n * @see https://floating-ui.com/docs/size\n */\nconst size = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    name: 'size',\n    options,\n    async fn(state) {\n      const {\n        placement,\n        rects,\n        platform,\n        elements\n      } = state;\n      const {\n        apply = () => {},\n        ...detectOverflowOptions\n      } = evaluate(options, state);\n      const overflow = await detectOverflow(state, detectOverflowOptions);\n      const side = getSide(placement);\n      const alignment = getAlignment(placement);\n      const isYAxis = getSideAxis(placement) === 'y';\n      const {\n        width,\n        height\n      } = rects.floating;\n      let heightSide;\n      let widthSide;\n      if (side === 'top' || side === 'bottom') {\n        heightSide = side;\n        widthSide = alignment === ((await (platform.isRTL == null ? void 0 : platform.isRTL(elements.floating))) ? 'start' : 'end') ? 'left' : 'right';\n      } else {\n        widthSide = side;\n        heightSide = alignment === 'end' ? 'top' : 'bottom';\n      }\n      const overflowAvailableHeight = height - overflow[heightSide];\n      const overflowAvailableWidth = width - overflow[widthSide];\n      const noShift = !state.middlewareData.shift;\n      let availableHeight = overflowAvailableHeight;\n      let availableWidth = overflowAvailableWidth;\n      if (isYAxis) {\n        const maximumClippingWidth = width - overflow.left - overflow.right;\n        availableWidth = alignment || noShift ? min(overflowAvailableWidth, maximumClippingWidth) : maximumClippingWidth;\n      } else {\n        const maximumClippingHeight = height - overflow.top - overflow.bottom;\n        availableHeight = alignment || noShift ? min(overflowAvailableHeight, maximumClippingHeight) : maximumClippingHeight;\n      }\n      if (noShift && !alignment) {\n        const xMin = max(overflow.left, 0);\n        const xMax = max(overflow.right, 0);\n        const yMin = max(overflow.top, 0);\n        const yMax = max(overflow.bottom, 0);\n        if (isYAxis) {\n          availableWidth = width - 2 * (xMin !== 0 || xMax !== 0 ? xMin + xMax : max(overflow.left, overflow.right));\n        } else {\n          availableHeight = height - 2 * (yMin !== 0 || yMax !== 0 ? yMin + yMax : max(overflow.top, overflow.bottom));\n        }\n      }\n      await apply({\n        ...state,\n        availableWidth,\n        availableHeight\n      });\n      const nextDimensions = await platform.getDimensions(elements.floating);\n      if (width !== nextDimensions.width || height !== nextDimensions.height) {\n        return {\n          reset: {\n            rects: true\n          }\n        };\n      }\n      return {};\n    }\n  };\n};\n\nexport { arrow, autoPlacement, computePosition, detectOverflow, flip, hide, inline, limitShift, offset, shift, size };\n","function getNodeName(node) {\n  if (isNode(node)) {\n    return (node.nodeName || '').toLowerCase();\n  }\n  // Mocked nodes in testing environments may not be instances of Node. By\n  // returning `#document` an infinite loop won't occur.\n  // https://github.com/floating-ui/floating-ui/issues/2317\n  return '#document';\n}\nfunction getWindow(node) {\n  var _node$ownerDocument;\n  return (node == null || (_node$ownerDocument = node.ownerDocument) == null ? void 0 : _node$ownerDocument.defaultView) || window;\n}\nfunction getDocumentElement(node) {\n  var _ref;\n  return (_ref = (isNode(node) ? node.ownerDocument : node.document) || window.document) == null ? void 0 : _ref.documentElement;\n}\nfunction isNode(value) {\n  return value instanceof Node || value instanceof getWindow(value).Node;\n}\nfunction isElement(value) {\n  return value instanceof Element || value instanceof getWindow(value).Element;\n}\nfunction isHTMLElement(value) {\n  return value instanceof HTMLElement || value instanceof getWindow(value).HTMLElement;\n}\nfunction isShadowRoot(value) {\n  // Browsers without `ShadowRoot` support.\n  if (typeof ShadowRoot === 'undefined') {\n    return false;\n  }\n  return value instanceof ShadowRoot || value instanceof getWindow(value).ShadowRoot;\n}\nfunction isOverflowElement(element) {\n  const {\n    overflow,\n    overflowX,\n    overflowY,\n    display\n  } = getComputedStyle(element);\n  return /auto|scroll|overlay|hidden|clip/.test(overflow + overflowY + overflowX) && !['inline', 'contents'].includes(display);\n}\nfunction isTableElement(element) {\n  return ['table', 'td', 'th'].includes(getNodeName(element));\n}\nfunction isContainingBlock(element) {\n  const webkit = isWebKit();\n  const css = getComputedStyle(element);\n\n  // https://developer.mozilla.org/en-US/docs/Web/CSS/Containing_block#identifying_the_containing_block\n  return css.transform !== 'none' || css.perspective !== 'none' || (css.containerType ? css.containerType !== 'normal' : false) || !webkit && (css.backdropFilter ? css.backdropFilter !== 'none' : false) || !webkit && (css.filter ? css.filter !== 'none' : false) || ['transform', 'perspective', 'filter'].some(value => (css.willChange || '').includes(value)) || ['paint', 'layout', 'strict', 'content'].some(value => (css.contain || '').includes(value));\n}\nfunction getContainingBlock(element) {\n  let currentNode = getParentNode(element);\n  while (isHTMLElement(currentNode) && !isLastTraversableNode(currentNode)) {\n    if (isContainingBlock(currentNode)) {\n      return currentNode;\n    } else {\n      currentNode = getParentNode(currentNode);\n    }\n  }\n  return null;\n}\nfunction isWebKit() {\n  if (typeof CSS === 'undefined' || !CSS.supports) return false;\n  return CSS.supports('-webkit-backdrop-filter', 'none');\n}\nfunction isLastTraversableNode(node) {\n  return ['html', 'body', '#document'].includes(getNodeName(node));\n}\nfunction getComputedStyle(element) {\n  return getWindow(element).getComputedStyle(element);\n}\nfunction getNodeScroll(element) {\n  if (isElement(element)) {\n    return {\n      scrollLeft: element.scrollLeft,\n      scrollTop: element.scrollTop\n    };\n  }\n  return {\n    scrollLeft: element.pageXOffset,\n    scrollTop: element.pageYOffset\n  };\n}\nfunction getParentNode(node) {\n  if (getNodeName(node) === 'html') {\n    return node;\n  }\n  const result =\n  // Step into the shadow DOM of the parent of a slotted node.\n  node.assignedSlot ||\n  // DOM Element detected.\n  node.parentNode ||\n  // ShadowRoot detected.\n  isShadowRoot(node) && node.host ||\n  // Fallback.\n  getDocumentElement(node);\n  return isShadowRoot(result) ? result.host : result;\n}\nfunction getNearestOverflowAncestor(node) {\n  const parentNode = getParentNode(node);\n  if (isLastTraversableNode(parentNode)) {\n    return node.ownerDocument ? node.ownerDocument.body : node.body;\n  }\n  if (isHTMLElement(parentNode) && isOverflowElement(parentNode)) {\n    return parentNode;\n  }\n  return getNearestOverflowAncestor(parentNode);\n}\nfunction getOverflowAncestors(node, list, traverseIframes) {\n  var _node$ownerDocument2;\n  if (list === void 0) {\n    list = [];\n  }\n  if (traverseIframes === void 0) {\n    traverseIframes = true;\n  }\n  const scrollableAncestor = getNearestOverflowAncestor(node);\n  const isBody = scrollableAncestor === ((_node$ownerDocument2 = node.ownerDocument) == null ? void 0 : _node$ownerDocument2.body);\n  const win = getWindow(scrollableAncestor);\n  if (isBody) {\n    return list.concat(win, win.visualViewport || [], isOverflowElement(scrollableAncestor) ? scrollableAncestor : [], win.frameElement && traverseIframes ? getOverflowAncestors(win.frameElement) : []);\n  }\n  return list.concat(scrollableAncestor, getOverflowAncestors(scrollableAncestor, [], traverseIframes));\n}\n\nexport { getComputedStyle, getContainingBlock, getDocumentElement, getNearestOverflowAncestor, getNodeName, getNodeScroll, getOverflowAncestors, getParentNode, getWindow, isContainingBlock, isElement, isHTMLElement, isLastTraversableNode, isNode, isOverflowElement, isShadowRoot, isTableElement, isWebKit };\n","import { rectToClientRect, autoPlacement as autoPlacement$1, shift as shift$1, flip as flip$1, size as size$1, hide as hide$1, arrow as arrow$1, inline as inline$1, limitShift as limitShift$1, computePosition as computePosition$1 } from '@floating-ui/core';\nexport { detectOverflow, offset } from '@floating-ui/core';\nimport { round, createCoords, max, min, floor } from '@floating-ui/utils';\nimport { getComputedStyle, isHTMLElement, isElement, getWindow, isWebKit, getDocumentElement, getNodeName, isOverflowElement, getNodeScroll, getOverflowAncestors, getParentNode, isLastTraversableNode, isContainingBlock, isTableElement, getContainingBlock } from '@floating-ui/utils/dom';\nexport { getOverflowAncestors } from '@floating-ui/utils/dom';\n\nfunction getCssDimensions(element) {\n  const css = getComputedStyle(element);\n  // In testing environments, the `width` and `height` properties are empty\n  // strings for SVG elements, returning NaN. Fallback to `0` in this case.\n  let width = parseFloat(css.width) || 0;\n  let height = parseFloat(css.height) || 0;\n  const hasOffset = isHTMLElement(element);\n  const offsetWidth = hasOffset ? element.offsetWidth : width;\n  const offsetHeight = hasOffset ? element.offsetHeight : height;\n  const shouldFallback = round(width) !== offsetWidth || round(height) !== offsetHeight;\n  if (shouldFallback) {\n    width = offsetWidth;\n    height = offsetHeight;\n  }\n  return {\n    width,\n    height,\n    $: shouldFallback\n  };\n}\n\nfunction unwrapElement(element) {\n  return !isElement(element) ? element.contextElement : element;\n}\n\nfunction getScale(element) {\n  const domElement = unwrapElement(element);\n  if (!isHTMLElement(domElement)) {\n    return createCoords(1);\n  }\n  const rect = domElement.getBoundingClientRect();\n  const {\n    width,\n    height,\n    $\n  } = getCssDimensions(domElement);\n  let x = ($ ? round(rect.width) : rect.width) / width;\n  let y = ($ ? round(rect.height) : rect.height) / height;\n\n  // 0, NaN, or Infinity should always fallback to 1.\n\n  if (!x || !Number.isFinite(x)) {\n    x = 1;\n  }\n  if (!y || !Number.isFinite(y)) {\n    y = 1;\n  }\n  return {\n    x,\n    y\n  };\n}\n\nconst noOffsets = /*#__PURE__*/createCoords(0);\nfunction getVisualOffsets(element) {\n  const win = getWindow(element);\n  if (!isWebKit() || !win.visualViewport) {\n    return noOffsets;\n  }\n  return {\n    x: win.visualViewport.offsetLeft,\n    y: win.visualViewport.offsetTop\n  };\n}\nfunction shouldAddVisualOffsets(element, isFixed, floatingOffsetParent) {\n  if (isFixed === void 0) {\n    isFixed = false;\n  }\n  if (!floatingOffsetParent || isFixed && floatingOffsetParent !== getWindow(element)) {\n    return false;\n  }\n  return isFixed;\n}\n\nfunction getBoundingClientRect(element, includeScale, isFixedStrategy, offsetParent) {\n  if (includeScale === void 0) {\n    includeScale = false;\n  }\n  if (isFixedStrategy === void 0) {\n    isFixedStrategy = false;\n  }\n  const clientRect = element.getBoundingClientRect();\n  const domElement = unwrapElement(element);\n  let scale = createCoords(1);\n  if (includeScale) {\n    if (offsetParent) {\n      if (isElement(offsetParent)) {\n        scale = getScale(offsetParent);\n      }\n    } else {\n      scale = getScale(element);\n    }\n  }\n  const visualOffsets = shouldAddVisualOffsets(domElement, isFixedStrategy, offsetParent) ? getVisualOffsets(domElement) : createCoords(0);\n  let x = (clientRect.left + visualOffsets.x) / scale.x;\n  let y = (clientRect.top + visualOffsets.y) / scale.y;\n  let width = clientRect.width / scale.x;\n  let height = clientRect.height / scale.y;\n  if (domElement) {\n    const win = getWindow(domElement);\n    const offsetWin = offsetParent && isElement(offsetParent) ? getWindow(offsetParent) : offsetParent;\n    let currentIFrame = win.frameElement;\n    while (currentIFrame && offsetParent && offsetWin !== win) {\n      const iframeScale = getScale(currentIFrame);\n      const iframeRect = currentIFrame.getBoundingClientRect();\n      const css = getComputedStyle(currentIFrame);\n      const left = iframeRect.left + (currentIFrame.clientLeft + parseFloat(css.paddingLeft)) * iframeScale.x;\n      const top = iframeRect.top + (currentIFrame.clientTop + parseFloat(css.paddingTop)) * iframeScale.y;\n      x *= iframeScale.x;\n      y *= iframeScale.y;\n      width *= iframeScale.x;\n      height *= iframeScale.y;\n      x += left;\n      y += top;\n      currentIFrame = getWindow(currentIFrame).frameElement;\n    }\n  }\n  return rectToClientRect({\n    width,\n    height,\n    x,\n    y\n  });\n}\n\nfunction convertOffsetParentRelativeRectToViewportRelativeRect(_ref) {\n  let {\n    rect,\n    offsetParent,\n    strategy\n  } = _ref;\n  const isOffsetParentAnElement = isHTMLElement(offsetParent);\n  const documentElement = getDocumentElement(offsetParent);\n  if (offsetParent === documentElement) {\n    return rect;\n  }\n  let scroll = {\n    scrollLeft: 0,\n    scrollTop: 0\n  };\n  let scale = createCoords(1);\n  const offsets = createCoords(0);\n  if (isOffsetParentAnElement || !isOffsetParentAnElement && strategy !== 'fixed') {\n    if (getNodeName(offsetParent) !== 'body' || isOverflowElement(documentElement)) {\n      scroll = getNodeScroll(offsetParent);\n    }\n    if (isHTMLElement(offsetParent)) {\n      const offsetRect = getBoundingClientRect(offsetParent);\n      scale = getScale(offsetParent);\n      offsets.x = offsetRect.x + offsetParent.clientLeft;\n      offsets.y = offsetRect.y + offsetParent.clientTop;\n    }\n  }\n  return {\n    width: rect.width * scale.x,\n    height: rect.height * scale.y,\n    x: rect.x * scale.x - scroll.scrollLeft * scale.x + offsets.x,\n    y: rect.y * scale.y - scroll.scrollTop * scale.y + offsets.y\n  };\n}\n\nfunction getClientRects(element) {\n  return Array.from(element.getClientRects());\n}\n\nfunction getWindowScrollBarX(element) {\n  // If <html> has a CSS width greater than the viewport, then this will be\n  // incorrect for RTL.\n  return getBoundingClientRect(getDocumentElement(element)).left + getNodeScroll(element).scrollLeft;\n}\n\n// Gets the entire size of the scrollable document area, even extending outside\n// of the `<html>` and `<body>` rect bounds if horizontally scrollable.\nfunction getDocumentRect(element) {\n  const html = getDocumentElement(element);\n  const scroll = getNodeScroll(element);\n  const body = element.ownerDocument.body;\n  const width = max(html.scrollWidth, html.clientWidth, body.scrollWidth, body.clientWidth);\n  const height = max(html.scrollHeight, html.clientHeight, body.scrollHeight, body.clientHeight);\n  let x = -scroll.scrollLeft + getWindowScrollBarX(element);\n  const y = -scroll.scrollTop;\n  if (getComputedStyle(body).direction === 'rtl') {\n    x += max(html.clientWidth, body.clientWidth) - width;\n  }\n  return {\n    width,\n    height,\n    x,\n    y\n  };\n}\n\nfunction getViewportRect(element, strategy) {\n  const win = getWindow(element);\n  const html = getDocumentElement(element);\n  const visualViewport = win.visualViewport;\n  let width = html.clientWidth;\n  let height = html.clientHeight;\n  let x = 0;\n  let y = 0;\n  if (visualViewport) {\n    width = visualViewport.width;\n    height = visualViewport.height;\n    const visualViewportBased = isWebKit();\n    if (!visualViewportBased || visualViewportBased && strategy === 'fixed') {\n      x = visualViewport.offsetLeft;\n      y = visualViewport.offsetTop;\n    }\n  }\n  return {\n    width,\n    height,\n    x,\n    y\n  };\n}\n\n// Returns the inner client rect, subtracting scrollbars if present.\nfunction getInnerBoundingClientRect(element, strategy) {\n  const clientRect = getBoundingClientRect(element, true, strategy === 'fixed');\n  const top = clientRect.top + element.clientTop;\n  const left = clientRect.left + element.clientLeft;\n  const scale = isHTMLElement(element) ? getScale(element) : createCoords(1);\n  const width = element.clientWidth * scale.x;\n  const height = element.clientHeight * scale.y;\n  const x = left * scale.x;\n  const y = top * scale.y;\n  return {\n    width,\n    height,\n    x,\n    y\n  };\n}\nfunction getClientRectFromClippingAncestor(element, clippingAncestor, strategy) {\n  let rect;\n  if (clippingAncestor === 'viewport') {\n    rect = getViewportRect(element, strategy);\n  } else if (clippingAncestor === 'document') {\n    rect = getDocumentRect(getDocumentElement(element));\n  } else if (isElement(clippingAncestor)) {\n    rect = getInnerBoundingClientRect(clippingAncestor, strategy);\n  } else {\n    const visualOffsets = getVisualOffsets(element);\n    rect = {\n      ...clippingAncestor,\n      x: clippingAncestor.x - visualOffsets.x,\n      y: clippingAncestor.y - visualOffsets.y\n    };\n  }\n  return rectToClientRect(rect);\n}\nfunction hasFixedPositionAncestor(element, stopNode) {\n  const parentNode = getParentNode(element);\n  if (parentNode === stopNode || !isElement(parentNode) || isLastTraversableNode(parentNode)) {\n    return false;\n  }\n  return getComputedStyle(parentNode).position === 'fixed' || hasFixedPositionAncestor(parentNode, stopNode);\n}\n\n// A \"clipping ancestor\" is an `overflow` element with the characteristic of\n// clipping (or hiding) child elements. This returns all clipping ancestors\n// of the given element up the tree.\nfunction getClippingElementAncestors(element, cache) {\n  const cachedResult = cache.get(element);\n  if (cachedResult) {\n    return cachedResult;\n  }\n  let result = getOverflowAncestors(element, [], false).filter(el => isElement(el) && getNodeName(el) !== 'body');\n  let currentContainingBlockComputedStyle = null;\n  const elementIsFixed = getComputedStyle(element).position === 'fixed';\n  let currentNode = elementIsFixed ? getParentNode(element) : element;\n\n  // https://developer.mozilla.org/en-US/docs/Web/CSS/Containing_block#identifying_the_containing_block\n  while (isElement(currentNode) && !isLastTraversableNode(currentNode)) {\n    const computedStyle = getComputedStyle(currentNode);\n    const currentNodeIsContaining = isContainingBlock(currentNode);\n    if (!currentNodeIsContaining && computedStyle.position === 'fixed') {\n      currentContainingBlockComputedStyle = null;\n    }\n    const shouldDropCurrentNode = elementIsFixed ? !currentNodeIsContaining && !currentContainingBlockComputedStyle : !currentNodeIsContaining && computedStyle.position === 'static' && !!currentContainingBlockComputedStyle && ['absolute', 'fixed'].includes(currentContainingBlockComputedStyle.position) || isOverflowElement(currentNode) && !currentNodeIsContaining && hasFixedPositionAncestor(element, currentNode);\n    if (shouldDropCurrentNode) {\n      // Drop non-containing blocks.\n      result = result.filter(ancestor => ancestor !== currentNode);\n    } else {\n      // Record last containing block for next iteration.\n      currentContainingBlockComputedStyle = computedStyle;\n    }\n    currentNode = getParentNode(currentNode);\n  }\n  cache.set(element, result);\n  return result;\n}\n\n// Gets the maximum area that the element is visible in due to any number of\n// clipping ancestors.\nfunction getClippingRect(_ref) {\n  let {\n    element,\n    boundary,\n    rootBoundary,\n    strategy\n  } = _ref;\n  const elementClippingAncestors = boundary === 'clippingAncestors' ? getClippingElementAncestors(element, this._c) : [].concat(boundary);\n  const clippingAncestors = [...elementClippingAncestors, rootBoundary];\n  const firstClippingAncestor = clippingAncestors[0];\n  const clippingRect = clippingAncestors.reduce((accRect, clippingAncestor) => {\n    const rect = getClientRectFromClippingAncestor(element, clippingAncestor, strategy);\n    accRect.top = max(rect.top, accRect.top);\n    accRect.right = min(rect.right, accRect.right);\n    accRect.bottom = min(rect.bottom, accRect.bottom);\n    accRect.left = max(rect.left, accRect.left);\n    return accRect;\n  }, getClientRectFromClippingAncestor(element, firstClippingAncestor, strategy));\n  return {\n    width: clippingRect.right - clippingRect.left,\n    height: clippingRect.bottom - clippingRect.top,\n    x: clippingRect.left,\n    y: clippingRect.top\n  };\n}\n\nfunction getDimensions(element) {\n  const {\n    width,\n    height\n  } = getCssDimensions(element);\n  return {\n    width,\n    height\n  };\n}\n\nfunction getRectRelativeToOffsetParent(element, offsetParent, strategy) {\n  const isOffsetParentAnElement = isHTMLElement(offsetParent);\n  const documentElement = getDocumentElement(offsetParent);\n  const isFixed = strategy === 'fixed';\n  const rect = getBoundingClientRect(element, true, isFixed, offsetParent);\n  let scroll = {\n    scrollLeft: 0,\n    scrollTop: 0\n  };\n  const offsets = createCoords(0);\n  if (isOffsetParentAnElement || !isOffsetParentAnElement && !isFixed) {\n    if (getNodeName(offsetParent) !== 'body' || isOverflowElement(documentElement)) {\n      scroll = getNodeScroll(offsetParent);\n    }\n    if (isOffsetParentAnElement) {\n      const offsetRect = getBoundingClientRect(offsetParent, true, isFixed, offsetParent);\n      offsets.x = offsetRect.x + offsetParent.clientLeft;\n      offsets.y = offsetRect.y + offsetParent.clientTop;\n    } else if (documentElement) {\n      offsets.x = getWindowScrollBarX(documentElement);\n    }\n  }\n  return {\n    x: rect.left + scroll.scrollLeft - offsets.x,\n    y: rect.top + scroll.scrollTop - offsets.y,\n    width: rect.width,\n    height: rect.height\n  };\n}\n\nfunction getTrueOffsetParent(element, polyfill) {\n  if (!isHTMLElement(element) || getComputedStyle(element).position === 'fixed') {\n    return null;\n  }\n  if (polyfill) {\n    return polyfill(element);\n  }\n  return element.offsetParent;\n}\n\n// Gets the closest ancestor positioned element. Handles some edge cases,\n// such as table ancestors and cross browser bugs.\nfunction getOffsetParent(element, polyfill) {\n  const window = getWindow(element);\n  if (!isHTMLElement(element)) {\n    return window;\n  }\n  let offsetParent = getTrueOffsetParent(element, polyfill);\n  while (offsetParent && isTableElement(offsetParent) && getComputedStyle(offsetParent).position === 'static') {\n    offsetParent = getTrueOffsetParent(offsetParent, polyfill);\n  }\n  if (offsetParent && (getNodeName(offsetParent) === 'html' || getNodeName(offsetParent) === 'body' && getComputedStyle(offsetParent).position === 'static' && !isContainingBlock(offsetParent))) {\n    return window;\n  }\n  return offsetParent || getContainingBlock(element) || window;\n}\n\nconst getElementRects = async function (_ref) {\n  let {\n    reference,\n    floating,\n    strategy\n  } = _ref;\n  const getOffsetParentFn = this.getOffsetParent || getOffsetParent;\n  const getDimensionsFn = this.getDimensions;\n  return {\n    reference: getRectRelativeToOffsetParent(reference, await getOffsetParentFn(floating), strategy),\n    floating: {\n      x: 0,\n      y: 0,\n      ...(await getDimensionsFn(floating))\n    }\n  };\n};\n\nfunction isRTL(element) {\n  return getComputedStyle(element).direction === 'rtl';\n}\n\nconst platform = {\n  convertOffsetParentRelativeRectToViewportRelativeRect,\n  getDocumentElement,\n  getClippingRect,\n  getOffsetParent,\n  getElementRects,\n  getClientRects,\n  getDimensions,\n  getScale,\n  isElement,\n  isRTL\n};\n\n// https://samthor.au/2021/observing-dom/\nfunction observeMove(element, onMove) {\n  let io = null;\n  let timeoutId;\n  const root = getDocumentElement(element);\n  function cleanup() {\n    clearTimeout(timeoutId);\n    io && io.disconnect();\n    io = null;\n  }\n  function refresh(skip, threshold) {\n    if (skip === void 0) {\n      skip = false;\n    }\n    if (threshold === void 0) {\n      threshold = 1;\n    }\n    cleanup();\n    const {\n      left,\n      top,\n      width,\n      height\n    } = element.getBoundingClientRect();\n    if (!skip) {\n      onMove();\n    }\n    if (!width || !height) {\n      return;\n    }\n    const insetTop = floor(top);\n    const insetRight = floor(root.clientWidth - (left + width));\n    const insetBottom = floor(root.clientHeight - (top + height));\n    const insetLeft = floor(left);\n    const rootMargin = -insetTop + \"px \" + -insetRight + \"px \" + -insetBottom + \"px \" + -insetLeft + \"px\";\n    const options = {\n      rootMargin,\n      threshold: max(0, min(1, threshold)) || 1\n    };\n    let isFirstUpdate = true;\n    function handleObserve(entries) {\n      const ratio = entries[0].intersectionRatio;\n      if (ratio !== threshold) {\n        if (!isFirstUpdate) {\n          return refresh();\n        }\n        if (!ratio) {\n          timeoutId = setTimeout(() => {\n            refresh(false, 1e-7);\n          }, 100);\n        } else {\n          refresh(false, ratio);\n        }\n      }\n      isFirstUpdate = false;\n    }\n\n    // Older browsers don't support a `document` as the root and will throw an\n    // error.\n    try {\n      io = new IntersectionObserver(handleObserve, {\n        ...options,\n        // Handle <iframe>s\n        root: root.ownerDocument\n      });\n    } catch (e) {\n      io = new IntersectionObserver(handleObserve, options);\n    }\n    io.observe(element);\n  }\n  refresh(true);\n  return cleanup;\n}\n\n/**\n * Automatically updates the position of the floating element when necessary.\n * Should only be called when the floating element is mounted on the DOM or\n * visible on the screen.\n * @returns cleanup function that should be invoked when the floating element is\n * removed from the DOM or hidden from the screen.\n * @see https://floating-ui.com/docs/autoUpdate\n */\nfunction autoUpdate(reference, floating, update, options) {\n  if (options === void 0) {\n    options = {};\n  }\n  const {\n    ancestorScroll = true,\n    ancestorResize = true,\n    elementResize = typeof ResizeObserver === 'function',\n    layoutShift = typeof IntersectionObserver === 'function',\n    animationFrame = false\n  } = options;\n  const referenceEl = unwrapElement(reference);\n  const ancestors = ancestorScroll || ancestorResize ? [...(referenceEl ? getOverflowAncestors(referenceEl) : []), ...getOverflowAncestors(floating)] : [];\n  ancestors.forEach(ancestor => {\n    ancestorScroll && ancestor.addEventListener('scroll', update, {\n      passive: true\n    });\n    ancestorResize && ancestor.addEventListener('resize', update);\n  });\n  const cleanupIo = referenceEl && layoutShift ? observeMove(referenceEl, update) : null;\n  let reobserveFrame = -1;\n  let resizeObserver = null;\n  if (elementResize) {\n    resizeObserver = new ResizeObserver(_ref => {\n      let [firstEntry] = _ref;\n      if (firstEntry && firstEntry.target === referenceEl && resizeObserver) {\n        // Prevent update loops when using the `size` middleware.\n        // https://github.com/floating-ui/floating-ui/issues/1740\n        resizeObserver.unobserve(floating);\n        cancelAnimationFrame(reobserveFrame);\n        reobserveFrame = requestAnimationFrame(() => {\n          resizeObserver && resizeObserver.observe(floating);\n        });\n      }\n      update();\n    });\n    if (referenceEl && !animationFrame) {\n      resizeObserver.observe(referenceEl);\n    }\n    resizeObserver.observe(floating);\n  }\n  let frameId;\n  let prevRefRect = animationFrame ? getBoundingClientRect(reference) : null;\n  if (animationFrame) {\n    frameLoop();\n  }\n  function frameLoop() {\n    const nextRefRect = getBoundingClientRect(reference);\n    if (prevRefRect && (nextRefRect.x !== prevRefRect.x || nextRefRect.y !== prevRefRect.y || nextRefRect.width !== prevRefRect.width || nextRefRect.height !== prevRefRect.height)) {\n      update();\n    }\n    prevRefRect = nextRefRect;\n    frameId = requestAnimationFrame(frameLoop);\n  }\n  update();\n  return () => {\n    ancestors.forEach(ancestor => {\n      ancestorScroll && ancestor.removeEventListener('scroll', update);\n      ancestorResize && ancestor.removeEventListener('resize', update);\n    });\n    cleanupIo && cleanupIo();\n    resizeObserver && resizeObserver.disconnect();\n    resizeObserver = null;\n    if (animationFrame) {\n      cancelAnimationFrame(frameId);\n    }\n  };\n}\n\n/**\n * Optimizes the visibility of the floating element by choosing the placement\n * that has the most space available automatically, without needing to specify a\n * preferred placement. Alternative to `flip`.\n * @see https://floating-ui.com/docs/autoPlacement\n */\nconst autoPlacement = autoPlacement$1;\n\n/**\n * Optimizes the visibility of the floating element by shifting it in order to\n * keep it in view when it will overflow the clipping boundary.\n * @see https://floating-ui.com/docs/shift\n */\nconst shift = shift$1;\n\n/**\n * Optimizes the visibility of the floating element by flipping the `placement`\n * in order to keep it in view when the preferred placement(s) will overflow the\n * clipping boundary. Alternative to `autoPlacement`.\n * @see https://floating-ui.com/docs/flip\n */\nconst flip = flip$1;\n\n/**\n * Provides data that allows you to change the size of the floating element \n * for instance, prevent it from overflowing the clipping boundary or match the\n * width of the reference element.\n * @see https://floating-ui.com/docs/size\n */\nconst size = size$1;\n\n/**\n * Provides data to hide the floating element in applicable situations, such as\n * when it is not in the same clipping context as the reference element.\n * @see https://floating-ui.com/docs/hide\n */\nconst hide = hide$1;\n\n/**\n * Provides data to position an inner element of the floating element so that it\n * appears centered to the reference element.\n * @see https://floating-ui.com/docs/arrow\n */\nconst arrow = arrow$1;\n\n/**\n * Provides improved positioning for inline reference elements that can span\n * over multiple lines, such as hyperlinks or range selections.\n * @see https://floating-ui.com/docs/inline\n */\nconst inline = inline$1;\n\n/**\n * Built-in `limiter` that will stop `shift()` at a certain point.\n */\nconst limitShift = limitShift$1;\n\n/**\n * Computes the `x` and `y` coordinates that will place the floating element\n * next to a given reference element.\n */\nconst computePosition = (reference, floating, options) => {\n  // This caches the expensive `getClippingElementAncestors` function so that\n  // multiple lifecycle resets re-use the same result. It only lives for a\n  // single call. If other functions become expensive, we can add them as well.\n  const cache = new Map();\n  const mergedOptions = {\n    platform,\n    ...options\n  };\n  const platformWithCache = {\n    ...mergedOptions.platform,\n    _c: cache\n  };\n  return computePosition$1(reference, floating, {\n    ...mergedOptions,\n    platform: platformWithCache\n  });\n};\n\nexport { arrow, autoPlacement, autoUpdate, computePosition, flip, hide, inline, limitShift, platform, shift, size };\n","export default function filter({\n    loadOptions,\n    filterText,\n    items,\n    multiple,\n    value,\n    itemId,\n    groupBy,\n    filterSelectedItems,\n    itemFilter,\n    convertStringItemsToObjects,\n    filterGroupedItems,\n    label,\n}) {\n    if (items && loadOptions) return items;\n    if (!items) return [];\n\n    if (items && items.length > 0 && typeof items[0] !== 'object') {\n        items = convertStringItemsToObjects(items);\n    }\n\n    let filterResults = items.filter((item) => {\n        let matchesFilter = itemFilter(item[label], filterText, item);\n        if (matchesFilter && multiple && value?.length) {\n            matchesFilter = !value.some((x) => {\n                return filterSelectedItems ? x[itemId] === item[itemId] : false;\n            });\n        }\n\n        return matchesFilter;\n    });\n\n    if (groupBy) {\n        filterResults = filterGroupedItems(filterResults);\n    }\n\n    return filterResults;\n}\n","export default async function getItems({ dispatch, loadOptions, convertStringItemsToObjects, filterText }) {\n    let res = await loadOptions(filterText).catch((err) => {\n        console.warn('svelte-select loadOptions error :>> ', err);\n        dispatch('error', { type: 'loadOptions', details: err });\n    });\n\n    if (res && !res.cancelled) {        \n        if (res) {\n            if (res && res.length > 0 && typeof res[0] !== 'object') {\n                res = convertStringItemsToObjects(res);\n            }\n            \n            dispatch('loaded', { items: res });\n        } else {\n            res = [];\n        }\n\n        return {\n            filteredItems: res,\n            loading: false,\n            focused: true,\n            listOpen: true,\n        };\n    }\n}\n","<svg\n    width=\"100%\"\n    height=\"100%\"\n    viewBox=\"0 0 20 20\"\n    focusable=\"false\"\n    aria-hidden=\"true\">\n    <path\n    fill=\"currentColor\"\n        d=\"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747\n          3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0\n          1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502\n          0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0\n          0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z\" />\n</svg>\n\n<style>\n  svg {\n      width: var(--chevron-icon-width, 20px);\n      height: var(--chevron-icon-width, 20px);\n      color: var(--chevron-icon-colour, currentColor);\n  }\n</style>","<svg\n    width=\"100%\"\n    height=\"100%\"\n    viewBox=\"-2 -2 50 50\"\n    focusable=\"false\"\n    aria-hidden=\"true\"\n    role=\"presentation\"\n>\n    <path\n        fill=\"currentColor\"\n        d=\"M34.923,37.251L24,26.328L13.077,37.251L9.436,33.61l10.923-10.923L9.436,11.765l3.641-3.641L24,19.047L34.923,8.124\n    l3.641,3.641L27.641,22.688L38.564,33.61L34.923,37.251z\"\n    />\n</svg>\n\n<style>\n    svg {\n        width: var(--clear-icon-width, 20px);\n        height: var(--clear-icon-width, 20px);\n        color: var(--clear-icon-color, currentColor);\n    }\n</style>","<svg class=\"loading\" viewBox=\"25 25 50 50\">\n    <circle\n        class=\"circle_path\"\n        cx=\"50\"\n        cy=\"50\"\n        r=\"20\"\n        fill=\"none\"\n        stroke=\"currentColor\"\n        stroke-width=\"5\"\n        stroke-miterlimit=\"10\" />\n</svg>\n\n<style>\n    .loading {\n        width: var(--spinner-width, 20px);\n        height: var(--spinner-height, 20px);\n        color: var(--spinner-color, var(--icons-color));\n        animation: rotate 0.75s linear infinite;\n        transform-origin: center center;\n        transform: none;\n    }\n\n    .circle_path {\n        stroke-dasharray: 90;\n        stroke-linecap: round;\n    }\n\n    @keyframes rotate {\n        100% {\n            transform: rotate(360deg);\n        }\n    }\n</style>","<script>\n    import { beforeUpdate, createEventDispatcher, onDestroy, onMount } from 'svelte';\n    import { offset, flip, shift } from 'svelte-floating-ui/dom';\n    import { createFloatingActions } from 'svelte-floating-ui';\n\n    const dispatch = createEventDispatcher();\n\n    import _filter from './filter';\n    import _getItems from './get-items';\n\n    import ChevronIcon from './ChevronIcon.svelte';\n    import ClearIcon from './ClearIcon.svelte';\n    import LoadingIcon from './LoadingIcon.svelte';\n\n    export let justValue = null; // read-only\n\n    export let filter = _filter;\n    export let getItems = _getItems;\n\n    export let id = null;\n    export let name = null;\n    export let container = undefined;\n    export let input = undefined;\n    export let multiple = false;\n    export let multiFullItemClearable = false;\n    export let disabled = false;\n    export let focused = false;\n    export let value = null;\n    export let filterText = '';\n    export let placeholder = 'Please select';\n    export let placeholderAlwaysShow = false;\n    export let items = null;\n    export let label = 'label';\n    export let itemFilter = (label, filterText, option) => `${label}`.toLowerCase().includes(filterText.toLowerCase());\n    export let groupBy = undefined;\n    export let groupFilter = (groups) => groups;\n    export let groupHeaderSelectable = false;\n    export let itemId = 'value';\n    export let loadOptions = undefined;\n    export let containerStyles = '';\n    export let hasError = false;\n    export let filterSelectedItems = true;\n    export let required = false;\n    export let closeListOnChange = true;\n    export let clearFilterTextOnBlur = true;\n\n    export let createGroupHeaderItem = (groupValue, item) => {\n        return {\n            value: groupValue,\n            [label]: groupValue,\n        };\n    };\n\n    export const getFilteredItems = () => {\n        return filteredItems;\n    };\n\n    export let searchable = true;\n    export let inputStyles = '';\n    export let clearable = true;\n    export let loading = false;\n    export let listOpen = false;\n\n    let timeout;\n    export let debounce = (fn, wait = 1) => {\n        clearTimeout(timeout);\n        timeout = setTimeout(fn, wait);\n    };\n\n    export let debounceWait = 300;\n    export let hideEmptyState = false;\n    export let inputAttributes = {};\n    export let listAutoWidth = true;\n    export let showChevron = false;\n    export let listOffset = 5;\n    export let hoverItemIndex = 0;\n    export let floatingConfig = {};\n\n    export { containerClasses as class };\n\n    let containerClasses = '';\n    let activeValue;\n    let prev_value;\n    let prev_filterText;\n    let prev_multiple;\n\n    function setValue() {\n        if (typeof value === 'string') {\n            let item = (items || []).find((item) => item[itemId] === value);\n            value = item || {\n                [itemId]: value,\n                label: value,\n            };\n        } else if (multiple && Array.isArray(value) && value.length > 0) {\n            value = value.map((item) => (typeof item === 'string' ? { value: item, label: item } : item));\n        }\n    }\n\n    let _inputAttributes;\n    function assignInputAttributes() {\n        _inputAttributes = Object.assign(\n            {\n                autocapitalize: 'none',\n                autocomplete: 'off',\n                autocorrect: 'off',\n                spellcheck: false,\n                tabindex: 0,\n                type: 'text',\n                'aria-autocomplete': 'list',\n            },\n            inputAttributes\n        );\n\n        if (id) {\n            _inputAttributes['id'] = id;\n        }\n\n        if (!searchable) {\n            _inputAttributes['readonly'] = true;\n        }\n    }\n\n    function convertStringItemsToObjects(_items) {\n        return _items.map((item, index) => {\n            return {\n                index,\n                value: item,\n                label: `${item}`,\n            };\n        });\n    }\n\n    function filterGroupedItems(_items) {\n        const groupValues = [];\n        const groups = {};\n\n        _items.forEach((item) => {\n            const groupValue = groupBy(item);\n\n            if (!groupValues.includes(groupValue)) {\n                groupValues.push(groupValue);\n                groups[groupValue] = [];\n\n                if (groupValue) {\n                    groups[groupValue].push(\n                        Object.assign(createGroupHeaderItem(groupValue, item), {\n                            id: groupValue,\n                            groupHeader: true,\n                            selectable: groupHeaderSelectable,\n                        })\n                    );\n                }\n            }\n\n            groups[groupValue].push(Object.assign({ groupItem: !!groupValue }, item));\n        });\n\n        const sortedGroupedItems = [];\n\n        groupFilter(groupValues).forEach((groupValue) => {\n            if (groups[groupValue]) sortedGroupedItems.push(...groups[groupValue]);\n        });\n\n        return sortedGroupedItems;\n    }\n\n    function dispatchSelectedItem() {\n        if (multiple) {\n            if (JSON.stringify(value) !== JSON.stringify(prev_value)) {\n                if (checkValueForDuplicates()) {\n                    dispatch('input', value);\n                }\n            }\n            return;\n        }\n\n        if (!prev_value || JSON.stringify(value[itemId]) !== JSON.stringify(prev_value[itemId])) {\n            dispatch('input', value);\n        }\n    }\n\n    function setupMulti() {\n        if (value) {\n            if (Array.isArray(value)) {\n                value = [...value];\n            } else {\n                value = [value];\n            }\n        }\n    }\n\n    function setupSingle() {\n        if (value) value = null;\n    }\n\n    $: if ((items, value)) setValue();\n    $: if (inputAttributes || !searchable) assignInputAttributes();\n    $: if (multiple) setupMulti();\n    $: if (prev_multiple && !multiple) setupSingle();\n    $: if (multiple && value && value.length > 1) checkValueForDuplicates();\n    $: if (value) dispatchSelectedItem();\n    $: if (!value && multiple && prev_value) dispatch('input', value);\n    $: if (!focused && input) closeList();\n    $: if (filterText !== prev_filterText) setupFilterText();\n    $: if (!multiple && listOpen && value && filteredItems) setValueIndexAsHoverIndex();\n    $: dispatchHover(hoverItemIndex);\n\n    function setValueIndexAsHoverIndex() {\n        const valueIndex = filteredItems.findIndex((i) => {\n            return i[itemId] === value[itemId];\n        });\n\n        checkHoverSelectable(valueIndex, true);\n    }\n\n    function dispatchHover(i) {\n        dispatch('hoverItem', i);\n    }\n\n    function checkHoverSelectable(startingIndex = 0, ignoreGroup) {\n        hoverItemIndex = startingIndex < 0 ? 0 : startingIndex;\n        if (!ignoreGroup && groupBy && filteredItems[hoverItemIndex] && !filteredItems[hoverItemIndex].selectable) {\n            setHoverIndex(1);\n        }\n    }\n\n    function setupFilterText() {\n        if (!loadOptions && filterText.length === 0) return;\n\n        if (loadOptions) {\n            debounce(async function () {\n                loading = true;\n                let res = await getItems({\n                    dispatch,\n                    loadOptions,\n                    convertStringItemsToObjects,\n                    filterText,\n                });\n\n                if (res) {\n                    loading = res.loading;\n                    listOpen = listOpen ? res.listOpen : filterText.length > 0 ? true : false;\n                    focused = listOpen && res.focused;\n                    items = groupBy ? filterGroupedItems(res.filteredItems) : res.filteredItems;\n                } else {\n                    loading = false;\n                    focused = true;\n                    listOpen = true;\n                }\n            }, debounceWait);\n        } else {\n            listOpen = true;\n\n            if (multiple) {\n                activeValue = undefined;\n            }\n        }\n    }\n\n    $: hasValue = multiple ? value && value.length > 0 : value;\n    $: hideSelectedItem = hasValue && filterText.length > 0;\n    $: showClear = hasValue && clearable && !disabled && !loading;\n    $: placeholderText =\n        placeholderAlwaysShow && multiple\n            ? placeholder\n            : multiple && value?.length === 0\n            ? placeholder\n            : value\n            ? ''\n            : placeholder;\n    $: ariaSelection = value ? handleAriaSelection(multiple) : '';\n    $: ariaContext = handleAriaContent({ filteredItems, hoverItemIndex, focused, listOpen });\n    $: updateValueDisplay(items);\n    $: justValue = computeJustValue(multiple, value, itemId);\n    $: if (!multiple && prev_value && !value) dispatch('input', value);\n    $: filteredItems = filter({\n        loadOptions,\n        filterText,\n        items,\n        multiple,\n        value,\n        itemId,\n        groupBy,\n        label,\n        filterSelectedItems,\n        itemFilter,\n        convertStringItemsToObjects,\n        filterGroupedItems,\n    });\n    $: if (listOpen && filteredItems && !multiple && !value) checkHoverSelectable();\n    $: handleFilterEvent(filteredItems);\n    $: if (container && floatingConfig) floatingUpdate(Object.assign(_floatingConfig, floatingConfig));\n    $: listDom = !!list;\n    $: listMounted(list, listOpen);\n    $: if (listOpen && container && list) setListWidth();\n    $: scrollToHoverItem = hoverItemIndex;\n    $: if (listOpen && multiple) hoverItemIndex = 0;\n    $: if (input && listOpen && !focused) handleFocus();\n    $: if (filterText) hoverItemIndex = 0;\n\n    function handleFilterEvent(items) {\n        if (listOpen) dispatch('filter', items);\n    }\n\n    beforeUpdate(async () => {\n        prev_value = value;\n        prev_filterText = filterText;\n        prev_multiple = multiple;\n    });\n\n    function computeJustValue() {\n        if (multiple) return value ? value.map((item) => item[itemId]) : null;\n        return value ? value[itemId] : value;\n    }\n\n    function checkValueForDuplicates() {\n        let noDuplicates = true;\n        if (value) {\n            const ids = [];\n            const uniqueValues = [];\n\n            value.forEach((val) => {\n                if (!ids.includes(val[itemId])) {\n                    ids.push(val[itemId]);\n                    uniqueValues.push(val);\n                } else {\n                    noDuplicates = false;\n                }\n            });\n\n            if (!noDuplicates) value = uniqueValues;\n        }\n        return noDuplicates;\n    }\n\n    function findItem(selection) {\n        let matchTo = selection ? selection[itemId] : value[itemId];\n        return items.find((item) => item[itemId] === matchTo);\n    }\n\n    function updateValueDisplay(items) {\n        if (!items || items.length === 0 || items.some((item) => typeof item !== 'object')) return;\n        if (!value || (multiple ? value.some((selection) => !selection || !selection[itemId]) : !value[itemId])) return;\n\n        if (Array.isArray(value)) {\n            value = value.map((selection) => findItem(selection) || selection);\n        } else {\n            value = findItem() || value;\n        }\n    }\n\n    async function handleMultiItemClear(i) {\n        const itemToRemove = value[i];\n\n        if (value.length === 1) {\n            value = undefined;\n        } else {\n            value = value.filter((item) => {\n                return item !== itemToRemove;\n            });\n        }\n\n        dispatch('clear', itemToRemove);\n    }\n\n    function handleKeyDown(e) {\n        if (!focused) return;\n        e.stopPropagation();\n        switch (e.key) {\n            case 'Escape':\n                e.preventDefault();\n                closeList();\n                break;\n            case 'Enter':\n                e.preventDefault();\n\n                if (listOpen) {\n                    if (filteredItems.length === 0) break;\n                    const hoverItem = filteredItems[hoverItemIndex];\n\n                    if (value && !multiple && value[itemId] === hoverItem[itemId]) {\n                        closeList();\n                        break;\n                    } else {\n                        handleSelect(filteredItems[hoverItemIndex]);\n                    }\n                }\n\n                break;\n            case 'ArrowDown':\n                e.preventDefault();\n\n                if (listOpen) {\n                    setHoverIndex(1);\n                } else {\n                    listOpen = true;\n                    activeValue = undefined;\n                }\n\n                break;\n            case 'ArrowUp':\n                e.preventDefault();\n\n                if (listOpen) {\n                    setHoverIndex(-1);\n                } else {\n                    listOpen = true;\n                    activeValue = undefined;\n                }\n\n                break;\n            case 'Tab':\n                if (listOpen && focused) {\n                    if (\n                        filteredItems.length === 0 ||\n                        (value && value[itemId] === filteredItems[hoverItemIndex][itemId])\n                    )\n                        return closeList();\n\n                    e.preventDefault();\n                    handleSelect(filteredItems[hoverItemIndex]);\n                    closeList();\n                }\n\n                break;\n            case 'Backspace':\n                if (!multiple || filterText.length > 0) return;\n\n                if (multiple && value && value.length > 0) {\n                    handleMultiItemClear(activeValue !== undefined ? activeValue : value.length - 1);\n                    if (activeValue === 0 || activeValue === undefined) break;\n                    activeValue = value.length > activeValue ? activeValue - 1 : undefined;\n                }\n\n                break;\n            case 'ArrowLeft':\n                if (!value || !multiple || filterText.length > 0) return;\n                if (activeValue === undefined) {\n                    activeValue = value.length - 1;\n                } else if (value.length > activeValue && activeValue !== 0) {\n                    activeValue -= 1;\n                }\n                break;\n            case 'ArrowRight':\n                if (!value || !multiple || filterText.length > 0 || activeValue === undefined) return;\n                if (activeValue === value.length - 1) {\n                    activeValue = undefined;\n                } else if (activeValue < value.length - 1) {\n                    activeValue += 1;\n                }\n                break;\n        }\n    }\n\n    function handleFocus(e) {\n        if (focused && input === document?.activeElement) return;\n        if (e) dispatch('focus', e);\n        input?.focus();\n        focused = true;\n    }\n\n    async function handleBlur(e) {\n        if (isScrolling) return;\n        if (listOpen || focused) {\n            dispatch('blur', e);\n            closeList();\n            focused = false;\n            activeValue = undefined;\n            input?.blur();\n        }\n    }\n\n    function handleClick() {\n        if (disabled) return;\n        if (filterText.length > 0) return listOpen = true;\n        listOpen = !listOpen;\n    }\n\n    export function handleClear() {\n        dispatch('clear', value);\n        value = undefined;\n        closeList();\n        handleFocus();\n    }\n\n    onMount(() => {\n        if (listOpen) focused = true;\n        if (focused && input) input.focus();\n    });\n\n    function itemSelected(selection) {\n        if (selection) {\n            filterText = '';\n            const item = Object.assign({}, selection);\n\n            if (item.groupHeader && !item.selectable) return;\n            value = multiple ? (value ? value.concat([item]) : [item]) : (value = item);\n\n            setTimeout(() => {\n                if (closeListOnChange) closeList();\n                activeValue = undefined;\n                dispatch('change', value);\n                dispatch('select', selection);\n            });\n        }\n    }\n\n    function closeList() {\n        if (clearFilterTextOnBlur) {\n            filterText = '';\n        }\n        listOpen = false;\n    }\n\n    export let ariaValues = (values) => {\n        return `Option ${values}, selected.`;\n    };\n\n    export let ariaListOpen = (label, count) => {\n        return `You are currently focused on option ${label}. There are ${count} results available.`;\n    };\n\n    export let ariaFocused = () => {\n        return `Select is focused, type to refine list, press down to open the menu.`;\n    };\n\n    function handleAriaSelection(_multiple) {\n        let selected = undefined;\n\n        if (_multiple && value.length > 0) {\n            selected = value.map((v) => v[label]).join(', ');\n        } else {\n            selected = value[label];\n        }\n\n        return ariaValues(selected);\n    }\n\n    function handleAriaContent() {\n        if (!filteredItems || filteredItems.length === 0) return '';\n        let _item = filteredItems[hoverItemIndex];\n        if (listOpen && _item) {\n            let count = filteredItems ? filteredItems.length : 0;\n            return ariaListOpen(_item[label], count);\n        } else {\n            return ariaFocused();\n        }\n    }\n\n    let list = null;\n\n    let isScrollingTimer;\n    function handleListScroll() {\n        clearTimeout(isScrollingTimer);\n        isScrollingTimer = setTimeout(() => {\n            isScrolling = false;\n        }, 100);\n    }\n\n    function handleClickOutside(event) {\n        if (!listOpen && !focused && container && !container.contains(event.target) && !list?.contains(event.target)) {\n            handleBlur();\n        }\n    }\n\n    onDestroy(() => {\n        list?.remove();\n    });\n\n    let isScrolling = false;\n\n    function handleSelect(item) {\n        if (!item || item.selectable === false) return;\n        itemSelected(item);\n    }\n\n    function handleHover(i) {\n        if (isScrolling) return;\n        hoverItemIndex = i;\n    }\n\n    function handleItemClick(args) {\n        const { item, i } = args;\n        if (item?.selectable === false) return;\n        if (value && !multiple && value[itemId] === item[itemId]) return closeList();\n        if (isItemSelectable(item)) {\n            hoverItemIndex = i;\n            handleSelect(item);\n        }\n    }\n\n    function setHoverIndex(increment) {\n        let selectableFilteredItems = filteredItems.filter(\n            (item) => !Object.hasOwn(item, 'selectable') || item.selectable === true\n        );\n\n        if (selectableFilteredItems.length === 0) {\n            return (hoverItemIndex = 0);\n        }\n\n        if (increment > 0 && hoverItemIndex === filteredItems.length - 1) {\n            hoverItemIndex = 0;\n        } else if (increment < 0 && hoverItemIndex === 0) {\n            hoverItemIndex = filteredItems.length - 1;\n        } else {\n            hoverItemIndex = hoverItemIndex + increment;\n        }\n\n        const hover = filteredItems[hoverItemIndex];\n\n        if (hover && hover.selectable === false) {\n            if (increment === 1 || increment === -1) setHoverIndex(increment);\n            return;\n        }\n    }\n\n    function isItemActive(item, value, itemId) {\n        if (multiple) return;\n        return value && value[itemId] === item[itemId];\n    }\n\n    function isItemFirst(itemIndex) {\n        return itemIndex === 0;\n    }\n\n    function isItemSelectable(item) {\n        return (item.groupHeader && item.selectable) || item.selectable || !item.hasOwnProperty('selectable');\n    }\n\n    const activeScroll = scrollAction;\n    const hoverScroll = scrollAction;\n\n    function scrollAction(node) {\n        return {\n            update(args) {\n                if (args.scroll) {\n                    handleListScroll();\n                    node.scrollIntoView({ behavior: 'auto', block: 'nearest' });\n                }\n            },\n        };\n    }\n\n    function setListWidth() {\n        const { width } = container.getBoundingClientRect();\n        list.style.width = listAutoWidth ? width + 'px' : 'auto';\n    }\n\n    let _floatingConfig = {\n        strategy: 'absolute',\n        placement: 'bottom-start',\n        middleware: [offset(listOffset), flip(), shift()],\n        autoUpdate: false,\n    };\n\n    const [floatingRef, floatingContent, floatingUpdate] = createFloatingActions(_floatingConfig);\n\n    $: if (container && floatingConfig?.autoUpdate === undefined) {\n        _floatingConfig.autoUpdate = true;\n    }\n\n    let prefloat = true;\n    function listMounted(list, listOpen) {\n        if (!list || !listOpen) return (prefloat = true);\n        setTimeout(() => {\n            prefloat = false;\n        }, 0);\n    }\n</script>\n\n<svelte:window on:click={handleClickOutside} on:keydown={handleKeyDown} />\n\n<div\n    class=\"svelte-select {containerClasses}\"\n    class:multi={multiple}\n    class:disabled\n    class:focused\n    class:list-open={listOpen}\n    class:show-chevron={showChevron}\n    class:error={hasError}\n    style={containerStyles}\n    on:pointerup|preventDefault={handleClick}\n    bind:this={container}\n    use:floatingRef\n    role=\"none\">\n    {#if listOpen}\n        <div\n            use:floatingContent\n            bind:this={list}\n            class=\"svelte-select-list\"\n            class:prefloat\n            on:scroll={handleListScroll}\n            on:pointerup|preventDefault|stopPropagation\n            on:mousedown|preventDefault|stopPropagation\n\t\t\trole=\"none\">\n            {#if $$slots['list-prepend']}<slot name=\"list-prepend\" />{/if}\n            {#if $$slots.list}<slot name=\"list\" {filteredItems} />\n            {:else if filteredItems.length > 0}\n                {#each filteredItems as item, i}\n                    <div\n                        on:mouseover={() => handleHover(i)}\n                        on:focus={() => handleHover(i)}\n                        on:click|stopPropagation={() => handleItemClick({ item, i })}\n                        on:keydown|preventDefault|stopPropagation\n                        class=\"list-item\"\n                        tabindex=\"-1\"\n                        role=\"none\">\n                        <div\n                            use:activeScroll={{ scroll: isItemActive(item, value, itemId), listDom }}\n                            use:hoverScroll={{ scroll: scrollToHoverItem === i, listDom }}\n                            class=\"item\"\n                            class:list-group-title={item.groupHeader}\n                            class:active={isItemActive(item, value, itemId)}\n                            class:first={isItemFirst(i)}\n                            class:hover={hoverItemIndex === i}\n                            class:group-item={item.groupItem}\n                            class:not-selectable={item?.selectable === false}>\n                            <slot name=\"item\" {item} index={i}>\n                                {item?.[label]}\n                            </slot>\n                        </div>\n                    </div>\n                {/each}\n            {:else if !hideEmptyState}\n                <slot name=\"empty\">\n                    <div class=\"empty\">No options</div>\n                </slot>\n            {/if}\n            {#if $$slots['list-append']}<slot name=\"list-append\" />{/if}\n        </div>\n    {/if}\n\n    <span aria-live=\"polite\" aria-atomic=\"false\" aria-relevant=\"additions text\" class=\"a11y-text\">\n        {#if focused}\n            <span id=\"aria-selection\">{ariaSelection}</span>\n            <span id=\"aria-context\">\n                {ariaContext}\n            </span>\n        {/if}\n    </span>\n\n    <div class=\"prepend\">\n        <slot name=\"prepend\" />\n    </div>\n\n    <div class=\"value-container\">\n        {#if hasValue}\n            {#if multiple}\n                {#each value as item, i}\n                    <div\n                        class=\"multi-item\"\n                        class:active={activeValue === i}\n                        class:disabled\n                        on:click|preventDefault={() => (multiFullItemClearable ? handleMultiItemClear(i) : {})}\n                        on:keydown|preventDefault|stopPropagation\n                        role=\"none\">\n                        <span class=\"multi-item-text\">\n                            <slot name=\"selection\" selection={item} index={i}>\n                                {item[label]}\n                            </slot>\n                        </span>\n\n                        {#if !disabled && !multiFullItemClearable && ClearIcon}\n                            <div\n                                class=\"multi-item-clear\"\n                                on:pointerup|preventDefault|stopPropagation={() => handleMultiItemClear(i)}>\n                                <slot name=\"multi-clear-icon\">\n                                    <ClearIcon />\n                                </slot>\n                            </div>\n                        {/if}\n                    </div>\n                {/each}\n            {:else}\n                <div class=\"selected-item\" class:hide-selected-item={hideSelectedItem}>\n                    <slot name=\"selection\" selection={value}>\n                        {value[label]}\n                    </slot>\n                </div>\n            {/if}\n        {/if}\n\n        <input\n            on:keydown={handleKeyDown}\n            on:blur={handleBlur}\n            on:focus={handleFocus}\n            readOnly={!searchable}\n            {..._inputAttributes}\n            bind:this={input}\n            bind:value={filterText}\n            placeholder={placeholderText}\n            style={inputStyles}\n            {disabled} />\n    </div>\n\n    <div class=\"indicators\">\n        {#if loading}\n            <div class=\"icon loading\" aria-hidden=\"true\">\n                <slot name=\"loading-icon\">\n                    <LoadingIcon />\n                </slot>\n            </div>\n        {/if}\n\n        {#if showClear}\n            <button type=\"button\" class=\"icon clear-select\" on:click={handleClear}>\n                <slot name=\"clear-icon\">\n                    <ClearIcon />\n                </slot>\n            </button>\n        {/if}\n\n        {#if showChevron}\n            <div class=\"icon chevron\" aria-hidden=\"true\">\n                <slot name=\"chevron-icon\" {listOpen}>\n                    <ChevronIcon />\n                </slot>\n            </div>\n        {/if}\n    </div>\n\n    <slot name=\"input-hidden\" {value}>\n        <input {name} type=\"hidden\" value={value ? JSON.stringify(value) : null} />\n    </slot>\n\n    {#if required && (!value || value.length === 0)}\n        <slot name=\"required\" {value}>\n            <select class=\"required\" required tabindex=\"-1\" aria-hidden=\"true\" />\n        </slot>\n    {/if}\n</div>\n\n<style>\n    .svelte-select {\n        /* deprecating camelCase custom props in favour of kebab-case for v5 */\n        --borderRadius: var(--border-radius);\n        --clearSelectColor: var(--clear-select-color);\n        --clearSelectWidth: var(--clear-select-width);\n        --disabledBackground: var(--disabled-background);\n        --disabledBorderColor: var(--disabled-border-color);\n        --disabledColor: var(--disabled-color);\n        --disabledPlaceholderColor: var(--disabled-placeholder-color);\n        --disabledPlaceholderOpacity: var(--disabled-placeholder-opacity);\n        --errorBackground: var(--error-background);\n        --errorBorder: var(--error-border);\n        --groupItemPaddingLeft: var(--group-item-padding-left);\n        --groupTitleColor: var(--group-title-color);\n        --groupTitleFontSize: var(--group-title-font-size);\n        --groupTitleFontWeight: var(--group-title-font-weight);\n        --groupTitlePadding: var(--group-title-padding);\n        --groupTitleTextTransform: var(--group-title-text-transform);\n        --groupTitleBorderColor: var(--group-title-border-color);\n        --groupTitleBorderWidth: var(--group-title-border-width);\n        --groupTitleBorderStyle: var(--group-title-border-style);\n        --indicatorColor: var(--chevron-color);\n        --indicatorHeight: var(--chevron-height);\n        --indicatorWidth: var(--chevron-width);\n        --inputColor: var(--input-color);\n        --inputLeft: var(--input-left);\n        --inputLetterSpacing: var(--input-letter-spacing);\n        --inputMargin: var(--input-margin);\n        --inputPadding: var(--input-padding);\n        --itemActiveBackground: var(--item-active-background);\n        --itemColor: var(--item-color);\n        --itemFirstBorderRadius: var(--item-first-border-radius);\n        --itemHoverBG: var(--item-hover-bg);\n        --itemHoverColor: var(--item-hover-color);\n        --itemIsActiveBG: var(--item-is-active-bg);\n        --itemIsActiveColor: var(--item-is-active-color);\n        --itemIsNotSelectableColor: var(--item-is-not-selectable-color);\n        --itemPadding: var(--item-padding);\n        --listBackground: var(--list-background);\n        --listBorder: var(--list-border);\n        --listBorderRadius: var(--list-border-radius);\n        --listEmptyColor: var(--list-empty-color);\n        --listEmptyPadding: var(--list-empty-padding);\n        --listEmptyTextAlign: var(--list-empty-text-align);\n        --listMaxHeight: var(--list-max-height);\n        --listPosition: var(--list-position);\n        --listShadow: var(--list-shadow);\n        --listZIndex: var(--list-z-index);\n        --multiItemBG: var(--multi-item-bg);\n        --multiItemBorderRadius: var(--multi-item-border-radius);\n        --multiItemDisabledHoverBg: var(--multi-item-disabled-hover-bg);\n        --multiItemDisabledHoverColor: var(--multi-item-disabled-hover-color);\n        --multiItemHeight: var(--multi-item-height);\n        --multiItemMargin: var(--multi-item-margin);\n        --multiItemPadding: var(--multi-item-padding);\n        --multiSelectInputMargin: var(--multi-select-input-margin);\n        --multiSelectInputPadding: var(--multi-select-input-padding);\n        --multiSelectPadding: var(--multi-select-padding);\n        --placeholderColor: var(--placeholder-color);\n        --placeholderOpacity: var(--placeholder-opacity);\n        --selectedItemPadding: var(--selected-item-padding);\n        --spinnerColor: var(--spinner-color);\n        --spinnerHeight: var(--spinner-height);\n        --spinnerWidth: var(--spinner-width);\n\n        --internal-padding: 0 0 0 16px;\n\n        border: var(--border, 1px solid #d8dbdf);\n        border-radius: var(--border-radius, 6px);\n        min-height: var(--height, 42px);\n        position: relative;\n        display: flex;\n        align-items: stretch;\n        padding: var(--padding, var(--internal-padding));\n        background: var(--background, #fff);\n        margin: var(--margin, 0);\n        width: var(--width, 100%);\n        font-size: var(--font-size, 16px);\n        max-height: var(--max-height);\n    }\n\n    * {\n        box-sizing: var(--box-sizing, border-box);\n    }\n\n    .svelte-select:hover {\n        border: var(--border-hover, 1px solid #b2b8bf);\n    }\n\n    .value-container {\n        display: flex;\n        flex: 1 1 0%;\n        flex-wrap: wrap;\n        align-items: center;\n        gap: 5px 10px;\n        padding: var(--value-container-padding, 5px 0);\n        position: relative;\n        overflow: var(--value-container-overflow, hidden);\n        align-self: stretch;\n    }\n\n    .prepend,\n    .indicators {\n        display: flex;\n        flex-shrink: 0;\n        align-items: center;\n    }\n\n    .indicators {\n        position: var(--indicators-position);\n        top: var(--indicators-top);\n        right: var(--indicators-right);\n        bottom: var(--indicators-bottom);\n    }\n\n    input {\n        position: absolute;\n        cursor: default;\n        border: none;\n        color: var(--input-color, var(--item-color));\n        padding: var(--input-padding, 0);\n        letter-spacing: var(--input-letter-spacing, inherit);\n        margin: var(--input-margin, 0);\n        min-width: 10px;\n        top: 0;\n        right: 0;\n        bottom: 0;\n        left: 0;\n        background: transparent;\n        font-size: var(--font-size, 16px);\n    }\n\n    :not(.multi) > .value-container > input {\n        width: 100%;\n        height: 100%;\n    }\n\n    input::placeholder {\n        color: var(--placeholder-color, #78848f);\n        opacity: var(--placeholder-opacity, 1);\n    }\n\n    input:focus {\n        outline: none;\n    }\n\n    .svelte-select.focused {\n        border: var(--border-focused, 1px solid #006fe8);\n        border-radius: var(--border-radius-focused, var(--border-radius, 6px));\n    }\n\n    .disabled {\n        background: var(--disabled-background, #ebedef);\n        border-color: var(--disabled-border-color, #ebedef);\n        color: var(--disabled-color, #c1c6cc);\n    }\n\n    .disabled input::placeholder {\n        color: var(--disabled-placeholder-color, #c1c6cc);\n        opacity: var(--disabled-placeholder-opacity, 1);\n    }\n\n    .selected-item {\n        position: relative;\n        overflow: var(--selected-item-overflow, hidden);\n        padding: var(--selected-item-padding, 0 20px 0 0);\n        text-overflow: ellipsis;\n        white-space: nowrap;\n        color: var(--selected-item-color, inherit);\n        font-size: var(--font-size, 16px);\n    }\n\n    .multi .selected-item {\n        position: absolute;\n        line-height: var(--height, 42px);\n        height: var(--height, 42px);\n    }\n\n    .selected-item:focus {\n        outline: none;\n    }\n\n    .hide-selected-item {\n        opacity: 0;\n    }\n\n    .icon {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n    }\n\n    .clear-select {\n        all: unset;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        width: var(--clear-select-width, 40px);\n        height: var(--clear-select-height, 100%);\n        color: var(--clear-select-color, var(--icons-color));\n        margin: var(--clear-select-margin, 0);\n        pointer-events: all;\n        flex-shrink: 0;\n    }\n\n    .clear-select:focus {\n        outline: var(--clear-select-focus-outline, 1px solid #006fe8);\n    }\n\n    .loading {\n        width: var(--loading-width, 40px);\n        height: var(--loading-height);\n        color: var(--loading-color, var(--icons-color));\n        margin: var(--loading--margin, 0);\n        flex-shrink: 0;\n    }\n\n    .chevron {\n        width: var(--chevron-width, 40px);\n        height: var(--chevron-height, 40px);\n        background: var(--chevron-background, transparent);\n        pointer-events: var(--chevron-pointer-events, none);\n        color: var(--chevron-color, var(--icons-color));\n        border: var(--chevron-border, 0 0 0 1px solid #d8dbdf);\n        flex-shrink: 0;\n    }\n\n    .multi {\n        padding: var(--multi-select-padding, var(--internal-padding));\n    }\n\n    .multi input {\n        padding: var(--multi-select-input-padding, 0);\n        position: relative;\n        margin: var(--multi-select-input-margin, 5px 0);\n        flex: 1 1 40px;\n    }\n\n    .svelte-select.error {\n        border: var(--error-border, 1px solid #ff2d55);\n        background: var(--error-background, #fff);\n    }\n\n    .a11y-text {\n        z-index: 9999;\n        border: 0px;\n        clip: rect(1px, 1px, 1px, 1px);\n        height: 1px;\n        width: 1px;\n        position: absolute;\n        overflow: hidden;\n        padding: 0px;\n        white-space: nowrap;\n    }\n\n    .multi-item {\n        background: var(--multi-item-bg, #ebedef);\n        margin: var(--multi-item-margin, 0);\n        outline: var(--multi-item-outline, 1px solid #ddd);\n        border-radius: var(--multi-item-border-radius, 4px);\n        height: var(--multi-item-height, 25px);\n        line-height: var(--multi-item-height, 25px);\n        display: flex;\n        cursor: default;\n        padding: var(--multi-item-padding, 0 5px);\n        overflow: hidden;\n        gap: var(--multi-item-gap, 4px);\n        outline-offset: -1px;\n        max-width: var(--multi-max-width, none);\n        color: var(--multi-item-color, var(--item-color));\n    }\n\n    .multi-item.disabled:hover {\n        background: var(--multi-item-disabled-hover-bg, #ebedef);\n        color: var(--multi-item-disabled-hover-color, #c1c6cc);\n    }\n\n    .multi-item-text {\n        overflow: hidden;\n        text-overflow: ellipsis;\n        white-space: nowrap;\n    }\n\n    .multi-item-clear {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        --clear-icon-color: var(--multi-item-clear-icon-color, #000);\n    }\n\n    .multi-item.active {\n        outline: var(--multi-item-active-outline, 1px solid #006fe8);\n    }\n\n    .svelte-select-list {\n        box-shadow: var(--list-shadow, 0 2px 3px 0 rgba(44, 62, 80, 0.24));\n        border-radius: var(--list-border-radius, 4px);\n        max-height: var(--list-max-height, 252px);\n        overflow-y: auto;\n        background: var(--list-background, #fff);\n        position: var(--list-position, absolute);\n        z-index: var(--list-z-index, 2);\n        border: var(--list-border);\n    }\n\n    .prefloat {\n        opacity: 0;\n        pointer-events: none;\n    }\n\n    .list-group-title {\n        color: var(--group-title-color, #8f8f8f);\n        cursor: default;\n        font-size: var(--group-title-font-size, 16px);\n        font-weight: var(--group-title-font-weight, 600);\n        height: var(--height, 42px);\n        line-height: var(--height, 42px);\n        padding: var(--group-title-padding, 0 20px);\n        text-overflow: ellipsis;\n        overflow-x: hidden;\n        white-space: nowrap;\n        text-transform: var(--group-title-text-transform, uppercase);\n        border-width: var(--group-title-border-width, medium);\n        border-style: var(--group-title-border-style, none);\n        border-color: var(--group-title-border-color, color);\n    }\n\n    .empty {\n        text-align: var(--list-empty-text-align, center);\n        padding: var(--list-empty-padding, 20px 0);\n        color: var(--list-empty-color, #78848f);\n    }\n\n    .item {\n        cursor: default;\n        height: var(--item-height, var(--height, 42px));\n        line-height: var(--item-line-height, var(--height, 42px));\n        padding: var(--item-padding, 0 20px);\n        color: var(--item-color, inherit);\n        text-overflow: ellipsis;\n        overflow: hidden;\n        white-space: nowrap;\n        transition: var(--item-transition, all 0.2s);\n        align-items: center;\n        width: 100%;\n    }\n\n    .item.group-item {\n        padding-left: var(--group-item-padding-left, 40px);\n    }\n\n    .item:active {\n        background: var(--item-active-background, #b9daff);\n    }\n\n    .item.active {\n        background: var(--item-is-active-bg, #007aff);\n        color: var(--item-is-active-color, #fff);\n    }\n\n    .item.first {\n        border-radius: var(--item-first-border-radius, 4px 4px 0 0);\n    }\n\n    .item.hover:not(.active) {\n        background: var(--item-hover-bg, #e7f2ff);\n        color: var(--item-hover-color, inherit);\n    }\n\n    .item.not-selectable,\n    .item.hover.item.not-selectable,\n    .item.active.item.not-selectable,\n    .item.not-selectable:active {\n        color: var(--item-is-not-selectable-color, #999);\n        background: transparent;\n    }\n\n    .required {\n        opacity: 0;\n        z-index: -1;\n        position: absolute;\n        top: 0;\n        left: 0;\n        bottom: 0;\n        right: 0;\n    }\n</style>\n","//@ts-ignore\nimport { arrow as arrowCore } from \"./core\";\nimport { autoUpdate as _autoUpdate, computePosition } from \"./dom/index.js\";\nimport { get } from \"svelte/store\";\nimport { onDestroy, tick } from 'svelte';\nexport function createFloatingActions(initOptions) {\n    let referenceElement;\n    let floatingElement;\n    const defaultOptions = {\n        autoUpdate: true\n    };\n    let options = initOptions;\n    const getOptions = (mixin) => {\n        return { ...defaultOptions, ...(initOptions || {}), ...(mixin || {}) };\n    };\n    const updatePosition = (updateOptions) => {\n        if (referenceElement && floatingElement) {\n            options = getOptions(updateOptions);\n            computePosition(referenceElement, floatingElement, options)\n                .then(v => {\n                Object.assign(floatingElement.style, {\n                    position: v.strategy,\n                    left: `${v.x}px`,\n                    top: `${v.y}px`,\n                });\n                options?.onComputed && options.onComputed(v);\n            });\n        }\n    };\n    const referenceAction = node => {\n        if ('subscribe' in node) {\n            setupVirtualElementObserver(node);\n            return {};\n        }\n        else {\n            referenceElement = node;\n            updatePosition();\n        }\n    };\n    const contentAction = (node, contentOptions) => {\n        let autoUpdateDestroy;\n        floatingElement = node;\n        options = getOptions(contentOptions);\n        setTimeout(() => updatePosition(contentOptions), 0); //tick doesn't work\n        updatePosition(contentOptions);\n        const destroyAutoUpdate = () => {\n            if (autoUpdateDestroy) {\n                autoUpdateDestroy();\n                autoUpdateDestroy = undefined;\n            }\n        };\n        const initAutoUpdate = ({ autoUpdate } = options || {}) => {\n            destroyAutoUpdate();\n            if (autoUpdate !== false) {\n                tick().then(() => {\n                    return _autoUpdate(referenceElement, floatingElement, () => updatePosition(options), (autoUpdate === true ? {} : autoUpdate));\n                });\n            }\n            return;\n        };\n        autoUpdateDestroy = initAutoUpdate();\n        return {\n            update(contentOptions) {\n                updatePosition(contentOptions);\n                autoUpdateDestroy = initAutoUpdate(contentOptions);\n            },\n            destroy() {\n                destroyAutoUpdate();\n            }\n        };\n    };\n    const setupVirtualElementObserver = (node) => {\n        const unsubscribe = node.subscribe(($node) => {\n            if (referenceElement === undefined) {\n                referenceElement = $node;\n                updatePosition();\n            }\n            else {\n                // Preserve the reference to the virtual element.\n                Object.assign(referenceElement, $node);\n                updatePosition();\n            }\n        });\n        onDestroy(unsubscribe);\n    };\n    return [\n        referenceAction,\n        contentAction,\n        updatePosition\n    ];\n}\nexport function arrow(options) {\n    return {\n        name: \"arrow\",\n        options,\n        fn(args) {\n            const element = get(options.element);\n            if (element) {\n                return arrowCore({\n                    element,\n                    padding: options.padding\n                }).fn(args);\n            }\n            return {};\n        }\n    };\n}\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import Select from 'svelte-select'\n  import { getNestedPaths } from '$lib/utils/arrayUtils.js'\n  import { pathToOption } from '$lib/utils/pathUtils.js'\n  import { createDebug } from '$lib/utils/debug.js'\n  import { isEqual } from 'lodash-es'\n  import type { JSONPath } from 'immutable-json-patch'\n  import { setIn } from 'immutable-json-patch'\n  import type { PathOption, QueryLanguageOptions } from '$lib/types.js'\n\n  const debug = createDebug('jsoneditor:TransformWizard')\n\n  export let json: unknown\n  export let queryOptions: QueryLanguageOptions = {}\n  export let onChange: (queryOptions: QueryLanguageOptions) => void\n\n  // options\n  $: jsonIsArray = Array.isArray(json)\n  $: paths = jsonIsArray ? getNestedPaths(json) : []\n  $: pathsIncludingObjects = jsonIsArray ? getNestedPaths(json, true) : []\n  $: fieldOptions = paths.map(pathToOption)\n  $: projectionOptions = pathsIncludingObjects ? pathsIncludingObjects.map(pathToOption) : []\n\n  const filterRelationOptions = ['==', '!=', '<', '<=', '>', '>='].map((relation) => ({\n    value: relation,\n    label: relation\n  }))\n\n  const sortDirectionOptions = [\n    { value: 'asc', label: 'ascending' },\n    { value: 'desc', label: 'descending' }\n  ]\n\n  // TODO: the binding with the select boxes is very cumbersome. Can we simplify this?\n  let filterPath = queryOptions?.filter?.path ? pathToOption(queryOptions.filter.path) : null\n  let filterRelation = queryOptions?.filter?.relation\n    ? filterRelationOptions.find((option) => option.value === queryOptions.filter?.relation)\n    : null\n  let filterValue = queryOptions?.filter?.value || ''\n  let sortPath = queryOptions?.sort?.path ? pathToOption(queryOptions.sort.path) : null\n  let sortDirection = queryOptions?.sort?.direction\n    ? sortDirectionOptions.find((option) => option.value === queryOptions.sort?.direction)\n    : null\n\n  $: projectionPaths =\n    queryOptions?.projection?.paths && projectionOptions\n      ? (queryOptions.projection.paths\n          .map((path) => projectionOptions.find((option) => isEqual(option.value, path)))\n          .filter((option) => !!option) as PathOption[])\n      : null\n\n  function changeFilterPath(path: JSONPath | undefined) {\n    if (!isEqual(queryOptions?.filter?.path, path)) {\n      debug('changeFilterPath', path)\n      queryOptions = setIn(queryOptions, ['filter', 'path'], path, true)\n      onChange(queryOptions)\n    }\n  }\n\n  function changeFilterRelation(relation: string | undefined) {\n    if (!isEqual(queryOptions?.filter?.relation, relation)) {\n      debug('changeFilterRelation', relation)\n      queryOptions = setIn(queryOptions, ['filter', 'relation'], relation, true)\n      onChange(queryOptions)\n    }\n  }\n\n  function changeFilterValue(value: string | undefined) {\n    if (!isEqual(queryOptions?.filter?.value, value)) {\n      debug('changeFilterValue', value)\n      queryOptions = setIn(queryOptions, ['filter', 'value'], value, true)\n      onChange(queryOptions)\n    }\n  }\n\n  function changeSortPath(path: JSONPath | undefined) {\n    if (!isEqual(queryOptions?.sort?.path, path)) {\n      debug('changeSortPath', path)\n      queryOptions = setIn(queryOptions, ['sort', 'path'], path, true)\n      onChange(queryOptions)\n    }\n  }\n\n  function changeSortDirection(direction: string | undefined) {\n    if (!isEqual(queryOptions?.sort?.direction, direction)) {\n      debug('changeSortDirection', direction)\n      queryOptions = setIn(queryOptions, ['sort', 'direction'], direction, true)\n      onChange(queryOptions)\n    }\n  }\n\n  function changeProjectionPaths(paths: JSONPath[] | unknown) {\n    if (!isEqual(queryOptions?.projection?.paths, paths)) {\n      debug('changeProjectionPaths', paths)\n      queryOptions = setIn(queryOptions, ['projection', 'paths'], paths, true)\n      onChange(queryOptions)\n    }\n  }\n\n  $: changeFilterPath(filterPath?.value)\n  $: changeFilterRelation(filterRelation?.value)\n  $: changeFilterValue(filterValue)\n  $: changeSortPath(sortPath?.value)\n  $: changeSortDirection(sortDirection?.value)\n  $: changeProjectionPaths(projectionPaths ? projectionPaths.map((item) => item.value) : undefined)\n</script>\n\n<table class=\"jse-transform-wizard\">\n  <tr>\n    <th>Filter</th>\n    <td>\n      <div class=\"jse-horizontal\">\n        <Select class=\"jse-filter-path\" showChevron items={fieldOptions} bind:value={filterPath} />\n        <Select\n          class=\"jse-filter-relation\"\n          showChevron\n          items={filterRelationOptions}\n          bind:value={filterRelation}\n        />\n        <input class=\"jse-filter-value\" bind:value={filterValue} />\n      </div>\n    </td>\n  </tr>\n  <tr>\n    <th>Sort</th>\n    <td>\n      <div class=\"jse-horizontal\">\n        <Select class=\"jse-sort-path\" showChevron items={fieldOptions} bind:value={sortPath} />\n        <Select\n          class=\"jse-sort-direction\"\n          showChevron\n          items={sortDirectionOptions}\n          bind:value={sortDirection}\n        />\n      </div>\n    </td>\n  </tr>\n  <tr>\n    <th>Pick</th>\n    <td>\n      <div class=\"jse-horizontal\">\n        <Select\n          class=\"jse-projection-paths\"\n          multiple\n          showChevron\n          items={projectionOptions}\n          bind:value={projectionPaths}\n        />\n      </div>\n    </td>\n  </tr>\n</table>\n\n<style src=\"./TransformWizard.scss\"></style>\n","<script lang=\"ts\">\n  import Icon from 'svelte-awesome'\n  import { faCheckSquare, faSquare } from '@fortawesome/free-regular-svg-icons'\n  import type { QueryLanguage, OnChangeQueryLanguage } from '$lib/types.js'\n\n  export let queryLanguages: QueryLanguage[]\n  export let queryLanguageId: string\n  export let onChangeQueryLanguage: OnChangeQueryLanguage\n\n  function handleChangeQueryLanguage(newQueryLanguageId: string) {\n    queryLanguageId = newQueryLanguageId\n    onChangeQueryLanguage(newQueryLanguageId)\n  }\n</script>\n\n<div class=\"jse-select-query-language\">\n  <div class=\"jse-select-query-language-container\">\n    {#each queryLanguages as queryLanguage}\n      <button\n        type=\"button\"\n        on:click={() => handleChangeQueryLanguage(queryLanguage.id)}\n        class=\"jse-query-language\"\n        class:selected={queryLanguage.id === queryLanguageId}\n        title={`Select ${queryLanguage.name} as query language`}\n      >\n        {#if queryLanguage.id === queryLanguageId}\n          <Icon data={faCheckSquare} />\n        {:else}\n          <Icon data={faSquare} />\n        {/if}\n        {queryLanguage.name}\n      </button>\n    {/each}\n  </div>\n</div>\n\n<style src=\"./SelectQueryLanguage.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { getContext } from 'svelte'\n  import Icon from 'svelte-awesome'\n  import {\n    faDownLeftAndUpRightToCenter,\n    faTimes,\n    faUpRightAndDownLeftFromCenter\n  } from '@fortawesome/free-solid-svg-icons'\n  import type { Context } from 'svelte-simple-modal'\n\n  export let title = 'Modal'\n  export let fullScreenButton: boolean = false\n  export let fullscreen: boolean = false\n  export let onClose: (() => void) | undefined = undefined\n\n  const { close } = getContext<Context>('simple-modal')\n</script>\n\n<div class=\"jse-header\">\n  <div class=\"jse-title\">\n    {title}\n  </div>\n  <slot name=\"actions\" />\n  {#if fullScreenButton}\n    <button\n      type=\"button\"\n      class=\"jse-fullscreen\"\n      title=\"Toggle fullscreen\"\n      on:click={() => (fullscreen = !fullscreen)}\n    >\n      <Icon data={fullscreen ? faDownLeftAndUpRightToCenter : faUpRightAndDownLeftFromCenter} />\n    </button>\n  {/if}\n  <button\n    type=\"button\"\n    class=\"jse-close\"\n    on:click={() => {\n      if (onClose) {\n        onClose()\n      } else {\n        close()\n      }\n    }}\n  >\n    <Icon data={faTimes} />\n  </button>\n</div>\n\n<style src=\"./Header.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { getContext } from 'svelte'\n  import Icon from 'svelte-awesome'\n  import { faCog } from '@fortawesome/free-solid-svg-icons'\n  import SelectQueryLanguage from '../controls/selectQueryLanguage/SelectQueryLanguage.svelte'\n  import type { AbsolutePopupContext, OnChangeQueryLanguage, QueryLanguage } from '$lib/types.js'\n  import type { Context } from 'svelte-simple-modal'\n  import Header from './Header.svelte'\n\n  export let queryLanguages: QueryLanguage[]\n  export let queryLanguageId: string\n  export let onChangeQueryLanguage: OnChangeQueryLanguage\n  export let fullscreen: boolean\n\n  let refConfigButton: HTMLButtonElement | undefined\n  let popupId: number | undefined\n\n  const { close } = getContext<Context>('simple-modal')\n  const { openAbsolutePopup, closeAbsolutePopup } =\n    getContext<AbsolutePopupContext>('absolute-popup')\n\n  function openConfig() {\n    const props = {\n      queryLanguages,\n      queryLanguageId,\n      onChangeQueryLanguage: (queryLanguageId: string) => {\n        closeAbsolutePopup(popupId)\n        onChangeQueryLanguage(queryLanguageId)\n      }\n    }\n\n    popupId = openAbsolutePopup(SelectQueryLanguage, props, {\n      offsetTop: -2,\n      offsetLeft: 0,\n      anchor: refConfigButton,\n      closeOnOuterClick: true\n    })\n  }\n</script>\n\n<Header title=\"Transform\" fullScreenButton={true} bind:fullscreen onClose={close}>\n  <button\n    slot=\"actions\"\n    type=\"button\"\n    bind:this={refConfigButton}\n    class=\"jse-config\"\n    class:hide={queryLanguages.length <= 1}\n    on:click={openConfig}\n    title=\"Select a query language\"\n  >\n    <Icon data={faCog} />\n  </button>\n</Header>\n\n<style src=\"./TransformModalHeader.scss\"></style>\n","import { createDebug } from '$lib/utils/debug.js'\nimport {\n  AUTO_SCROLL_INTERVAL,\n  AUTO_SCROLL_SPEED_FAST,\n  AUTO_SCROLL_SPEED_NORMAL,\n  AUTO_SCROLL_SPEED_SLOW\n} from '$lib/constants.js'\n\nconst debug = createDebug('jsoneditor:AutoScrollHandler')\n\nexport function createAutoScrollHandler(scrollableElement: Element) {\n  debug('createAutoScrollHandler', scrollableElement)\n\n  let autoScrollSpeed: number | undefined // pixels per second\n  let autoScrollTimer: number | undefined\n\n  function calculateSpeed(diff: number) {\n    return diff < 20\n      ? AUTO_SCROLL_SPEED_SLOW\n      : diff < 50\n        ? AUTO_SCROLL_SPEED_NORMAL\n        : AUTO_SCROLL_SPEED_FAST\n  }\n\n  function autoScrollCallback() {\n    if (scrollableElement) {\n      // debug('auto scroll...')\n      const diff = (autoScrollSpeed || 0) * (AUTO_SCROLL_INTERVAL / 1000)\n\n      scrollableElement.scrollTop += diff\n    }\n  }\n\n  function startAutoScroll(speed: number) {\n    if (!autoScrollTimer || speed !== autoScrollSpeed) {\n      stopAutoScroll()\n\n      debug('startAutoScroll', speed)\n      autoScrollSpeed = speed\n      autoScrollTimer = setInterval(autoScrollCallback, AUTO_SCROLL_INTERVAL) as unknown as number\n    }\n  }\n\n  function stopAutoScroll() {\n    if (autoScrollTimer) {\n      debug('stopAutoScroll')\n\n      clearInterval(autoScrollTimer)\n      autoScrollTimer = undefined\n      autoScrollSpeed = undefined\n    }\n  }\n\n  function onDrag(event: MouseEvent) {\n    if (scrollableElement) {\n      const y = event.clientY\n      const { top, bottom } = scrollableElement.getBoundingClientRect()\n\n      if (y < top) {\n        const speed = calculateSpeed(top - y)\n        startAutoScroll(-speed)\n      } else if (y > bottom) {\n        const speed = calculateSpeed(y - bottom)\n        startAutoScroll(speed)\n      } else {\n        stopAutoScroll()\n      }\n    }\n  }\n\n  function onDragEnd() {\n    stopAutoScroll()\n  }\n\n  return {\n    onDrag,\n    onDragEnd\n  }\n}\n","// Robert Penner's easeInOutQuad\n\n// find the rest of his easing functions here: http://robertpenner.com/easing/\n// find them exported for ES6 consumption here: https://github.com/jaxgeller/ez.js\n\nexport default (t: number, b: number, c: number, d: number): number => {\n  t /= d / 2\n  if (t < 1) {\n    return (c / 2) * t * t + b\n  }\n  t--\n  return (-c / 2) * (t * (t - 2) - 1) + b\n}\n","import easeInOutQuad from './easing.js'\n\ntype Easing = (t: number, b: number, c: number, d: number) => number\ntype Duration = number | ((distance: number) => number)\n\ninterface JumpOptions {\n  duration?: Duration\n  offset?: number\n  callback?: () => void\n  easing?: Easing\n  a11y?: boolean\n  container?: Element | string\n}\n\nexport const createJump = () => {\n  // private variable cache\n  // no variables are created during a jump, preventing memory leaks\n\n  let container: Element // container element to be scrolled       (node)\n  let element: Element | undefined // element to scroll to                   (node)\n\n  let start: number // where scroll starts                    (px)\n  let stop: number // where scroll stops                     (px)\n\n  let offset // adjustment from the stop position      (px)\n  let easing: Easing // easing function                        (function)\n  let a11y: boolean // accessibility support flag             (boolean)\n\n  let distance: number // distance of scroll                     (px)\n  let duration: number // scroll duration                        (ms)\n\n  let timeStart: number // time scroll started                    (ms)\n  let timeElapsed: number // time spent scrolling thus far          (ms)\n\n  let next: number // next scroll position                   (px)\n\n  let callback: (() => void) | undefined // to call when done scrolling            (function)\n\n  let scrolling: boolean // true whilst scrolling                  (boolean)\n\n  // scroll position helper\n\n  function location() {\n    return container.scrollTop\n  }\n\n  // element offset helper\n\n  function top(element: Element) {\n    const elementTop = element.getBoundingClientRect().top\n    const containerTop = container.getBoundingClientRect ? container.getBoundingClientRect().top : 0\n\n    return elementTop - containerTop + start\n  }\n\n  // scrollTo helper\n\n  function scrollTo(top: number) {\n    container.scrollTo\n      ? container.scrollTo(container.scrollLeft, top) // window\n      : (container.scrollTop = top) // custom container\n  }\n\n  // rAF loop helper\n\n  function loop(timeCurrent: number) {\n    // store time scroll started, if not started already\n    if (!timeStart) {\n      timeStart = timeCurrent\n    }\n\n    // determine time spent scrolling so far\n    timeElapsed = timeCurrent - timeStart\n\n    // calculate next scroll position\n    next = easing(timeElapsed, start, distance, duration)\n\n    // scroll to it\n    scrollTo(next)\n\n    scrolling = true\n\n    // check progress\n    timeElapsed < duration\n      ? requestAnimationFrame(loop) // continue scroll loop\n      : done() // scrolling is done\n  }\n\n  // scroll finished helper\n\n  function done() {\n    // account for rAF time rounding inaccuracies\n    scrollTo(start + distance)\n\n    // if scrolling to an element, and accessibility is enabled\n    if (element && a11y) {\n      // add tabindex indicating programmatic focus\n      element.setAttribute('tabindex', '-1')\n\n      // focus the element\n      const htmlElement = element as HTMLElement\n      htmlElement.focus()\n    }\n\n    // if it exists, fire the callback\n    if (typeof callback === 'function') {\n      callback()\n    }\n\n    // reset time for next jump\n    timeStart = 0\n\n    // we're done scrolling\n    scrolling = false\n  }\n\n  // API\n\n  function jump(target: Element | number | string, options: JumpOptions = {}) {\n    // resolve options, or use defaults\n    duration = 1000\n    offset = options.offset || 0\n    callback = options.callback // \"undefined\" is a suitable default, and won't be called\n    easing = options.easing || easeInOutQuad\n    a11y = options.a11y || false\n\n    // resolve container\n    switch (typeof options.container) {\n      case 'object':\n        // we assume container is an HTML element (Node)\n        container = options.container\n        break\n\n      case 'string':\n        container = document.querySelector(options.container) as Element\n        break\n\n      default:\n        container = window.document.documentElement\n    }\n\n    // cache starting position\n    start = location()\n\n    // resolve target\n    switch (typeof target) {\n      // scroll from current position\n      case 'number':\n        element = undefined // no element to scroll to\n        a11y = false // make sure accessibility is off\n        stop = start + target\n        break\n\n      // scroll to element (node)\n      // bounding rect is relative to the viewport\n      case 'object':\n        element = target\n        stop = top(element)\n        break\n\n      // scroll to element (selector)\n      // bounding rect is relative to the viewport\n      case 'string':\n        element = document.querySelector(target) as unknown as Element\n        stop = top(element)\n        break\n\n      default:\n    }\n\n    // resolve scroll distance, accounting for offset\n    distance = stop - start + offset\n\n    // resolve duration\n    switch (typeof options.duration) {\n      // number in ms\n      case 'number':\n        duration = options.duration\n        break\n\n      // function passed the distance of the scroll\n      case 'function':\n        duration = options.duration(distance)\n        break\n\n      default:\n    }\n\n    // start the loop if we're not already scrolling\n    if (!scrolling) {\n      requestAnimationFrame(loop)\n    } else {\n      // reset time for next jump\n      timeStart = 0\n    }\n  }\n\n  // expose only the jump method\n  return jump\n}\n\n// export singleton\n\nconst singleton = createJump()\n\nexport default singleton\n","import { createDebug } from '../utils/debug.js'\n\nconst MAX_HISTORY_ITEMS = 1000\n\nconst debug = createDebug('jsoneditor:History')\n\n/**\n * @typedef {*} HistoryItem\n * @property {Object} undo\n * @property {Object} redo\n */\n\nexport interface HistoryOptions {\n  maxItems?: number\n  onChange?: (props: { canUndo: boolean; canRedo: boolean; length: number }) => void\n}\n\nexport interface HistoryState {\n  canUndo: boolean\n  canRedo: boolean\n  length: number\n}\n\nexport interface History<T> {\n  add: (item: T) => void\n  clear: () => void\n  getState: () => HistoryState\n  undo: () => T | undefined\n  redo: () => T | undefined\n}\n\nexport function createHistory<T>(options: HistoryOptions = {}): History<T> {\n  const maxItems = options.maxItems || MAX_HISTORY_ITEMS\n\n  /**\n   * items in history are sorted from newest first to oldest last\n   */\n  let items: T[] = []\n\n  let index = 0\n\n  function canUndo(): boolean {\n    return index < items.length\n  }\n\n  function canRedo(): boolean {\n    return index > 0\n  }\n\n  function getState(): HistoryState {\n    return {\n      canUndo: canUndo(),\n      canRedo: canRedo(),\n      length: items.length\n    }\n  }\n\n  function handleChange() {\n    if (options.onChange) {\n      options.onChange(getState())\n    }\n  }\n\n  function add(item: T) {\n    debug('add', item)\n\n    items = [item].concat(items.slice(index)).slice(0, maxItems)\n\n    index = 0\n\n    handleChange()\n  }\n\n  function clear() {\n    debug('clear')\n\n    items = []\n    index = 0\n\n    handleChange()\n  }\n\n  function undo(): T | undefined {\n    if (canUndo()) {\n      const item = items[index]\n      index += 1\n\n      debug('undo', item)\n\n      handleChange()\n\n      return item\n    }\n\n    return undefined\n  }\n\n  function redo(): T | undefined {\n    if (canRedo()) {\n      index -= 1\n\n      debug('redo', items[index])\n\n      handleChange()\n\n      return items[index]\n    }\n\n    return undefined\n  }\n\n  return {\n    add,\n    clear,\n    getState,\n    undo,\n    redo\n  }\n}\n","/**\n * Measure how long a callback takes to execute.\n * Returns the response from the callback\n * The measured duration is returned via the onDuration callback\n */\nexport function measure<T>(callback: () => T, onDuration: (duration: number) => void): T {\n  const start = Date.now()\n  const result = callback()\n  const end = Date.now()\n\n  onDuration(end - start)\n\n  return result\n}\n","import { initial, isEmpty } from 'lodash-es'\nimport type {\n  ContentErrors,\n  JSONParser,\n  JSONPointerMap,\n  NestedValidationError,\n  ValidationError,\n  Validator\n} from '$lib/types.js'\nimport { ValidationSeverity } from '$lib/types.js'\nimport { compileJSONPointer, type JSONPointer } from 'immutable-json-patch'\nimport { MAX_AUTO_REPAIRABLE_SIZE, MAX_VALIDATABLE_SIZE } from '../constants.js'\nimport { measure } from '../utils/timeUtils.js'\nimport { normalizeJsonParseError } from '../utils/jsonUtils.js'\nimport { createDebug } from '../utils/debug.js'\nimport { jsonrepair } from 'jsonrepair'\n\nconst debug = createDebug('validation')\n\n/**\n * Create a flat map with validation errors, where the key is the stringified path\n * and also create error messages for the parent nodes of the nodes having an error.\n *\n * Returns a nested object containing the validation errors\n */\nexport function mapValidationErrors(\n  validationErrors: ValidationError[]\n): JSONPointerMap<NestedValidationError> {\n  const map: Record<JSONPointer, ValidationError | NestedValidationError> = {}\n\n  // first generate a map with the errors themselves\n  validationErrors.forEach((validationError) => {\n    map[compileJSONPointer(validationError.path)] = validationError\n  })\n\n  // create error entries for all parent nodes (displayed when the node is collapsed)\n  validationErrors.forEach((validationError) => {\n    let parentPath = validationError.path\n\n    while (parentPath.length > 0) {\n      parentPath = initial(parentPath)\n      const parentPointer: JSONPointer = compileJSONPointer(parentPath)\n\n      if (!(parentPointer in map)) {\n        map[parentPointer] = {\n          isChildError: true,\n          path: parentPath,\n          message: 'Contains invalid data',\n          severity: ValidationSeverity.warning\n        }\n      }\n    }\n  })\n\n  return map\n}\n\nexport function validateJSON(\n  json: unknown,\n  validator: Validator | null,\n  parser: JSONParser,\n  validationParser: JSONParser\n): ValidationError[] {\n  debug('validateJSON')\n\n  if (!validator) {\n    return []\n  }\n\n  if (parser !== validationParser) {\n    // if needed, convert for example Lossless JSON to native JSON\n    // (like replace bigint or LosslessNumber into regular numbers)\n    const text = parser.stringify(json)\n    const convertedJSON = text !== undefined ? validationParser.parse(text) : undefined\n    return validator(convertedJSON)\n  } else {\n    return validator(json)\n  }\n}\n\nexport function validateText(\n  text: string,\n  validator: Validator | null,\n  parser: JSONParser,\n  validationParser: JSONParser\n): ContentErrors | null {\n  debug('validateText')\n\n  if (text.length > MAX_VALIDATABLE_SIZE) {\n    const validationError: ValidationError = {\n      path: [],\n      message: 'Validation turned off: the document is too large',\n      severity: ValidationSeverity.info\n    }\n\n    return {\n      validationErrors: [validationError]\n    }\n  }\n\n  if (text.length === 0) {\n    // new, empty document, do not try to parse\n    return null\n  }\n\n  try {\n    // parse with the \"main\" parser (not the validation parser) to get parse errors\n    // (like syntax errors and duplicate keys errors)\n    const json = measure(\n      () => parser.parse(text),\n      (duration) => debug(`validate: parsed json in ${duration} ms`)\n    )\n\n    if (!validator) {\n      return null\n    }\n\n    // if needed, parse with the validationParser to be able to feed the json to the validator\n    const convertedJSON =\n      parser === validationParser\n        ? json\n        : measure(\n            () => validationParser.parse(text),\n            (duration) => debug(`validate: parsed json with the validationParser in ${duration} ms`)\n          )\n\n    // actually validate the json\n    const validationErrors = measure(\n      () => validator(convertedJSON),\n      (duration) => debug(`validate: validated json in ${duration} ms`)\n    )\n\n    return !isEmpty(validationErrors) ? { validationErrors } : null\n  } catch (err) {\n    const isRepairable = measure(\n      () => canAutoRepair(text, parser),\n      (duration) => debug(`validate: checked whether repairable in ${duration} ms`)\n    )\n\n    const parseError = normalizeJsonParseError(\n      text,\n      (err as Error).message || (err as Error).toString()\n    )\n\n    return {\n      parseError,\n      isRepairable\n    }\n  }\n}\n\nfunction canAutoRepair(text: string, parser: JSONParser): boolean {\n  if (text.length > MAX_AUTO_REPAIRABLE_SIZE) {\n    return false\n  }\n\n  try {\n    parser.parse(jsonrepair(text))\n\n    return true\n  } catch (err) {\n    return false\n  }\n}\n","import { createDebug } from '$lib/utils/debug.js'\n\nconst debug = createDebug('jsoneditor:FocusTracker')\n\nexport interface FocusTrackerProps {\n  onMount: (callback: () => void) => void\n  onDestroy: (callback: () => void) => void\n  getWindow: () => Window | null\n  hasFocus: () => boolean\n  onFocus: () => void\n  onBlur: () => void\n}\n\nexport function createFocusTracker({\n  onMount,\n  onDestroy,\n  getWindow,\n  hasFocus,\n  onFocus,\n  onBlur\n}: FocusTrackerProps) {\n  let blurTimeoutHandle: number | undefined\n  let focus = false\n\n  function handleFocusIn() {\n    const newFocus = hasFocus()\n\n    if (newFocus) {\n      clearTimeout(blurTimeoutHandle)\n      if (!focus) {\n        debug('focus')\n        onFocus()\n        focus = newFocus\n      }\n    }\n  }\n\n  function handleFocusOut() {\n    if (focus) {\n      // We set focus to false after timeout. Often, you get a blur and directly\n      // another focus when moving focus from one button to another.\n      // The focusIn handler will cancel any pending blur timer in those cases\n      clearTimeout(blurTimeoutHandle)\n      blurTimeoutHandle = setTimeout(() => {\n        if (!hasFocus()) {\n          debug('blur')\n          focus = false\n          onBlur()\n        }\n      }) as unknown as number\n    }\n  }\n\n  onMount(() => {\n    debug('mount FocusTracker')\n    const window = getWindow()\n    if (window) {\n      window.addEventListener('focusin', handleFocusIn, true)\n      window.addEventListener('focusout', handleFocusOut, true)\n    }\n  })\n\n  onDestroy(() => {\n    debug('destroy FocusTracker')\n    const window = getWindow()\n    if (window) {\n      window.removeEventListener('focusin', handleFocusIn, true)\n      window.removeEventListener('focusout', handleFocusOut, true)\n    }\n  })\n}\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import Icon from 'svelte-awesome'\n  import type { MessageAction } from '$lib/types'\n  import type { IconDefinition } from '@fortawesome/free-solid-svg-icons'\n  import { onDestroy } from 'svelte'\n\n  export let type: 'success' | 'error' | 'warning' | 'info' = 'success'\n  export let icon: IconDefinition | undefined = undefined\n  export let message: string | undefined = undefined\n  export let actions: MessageAction[] = []\n  export let onClick: (() => void) | undefined = undefined\n  export let onClose: (() => void) | undefined = undefined\n\n  if (onClose) {\n    onDestroy(onClose)\n  }\n\n  function handleClick() {\n    if (onClick) {\n      onClick()\n    }\n  }\n</script>\n\n<div class=\"jse-message jse-{type}\">\n  <!-- svelte-ignore a11y-click-events-have-key-events -->\n  <div\n    role=\"button\"\n    tabindex=\"-1\"\n    class=\"jse-text\"\n    class:jse-clickable={!!onClick}\n    on:click={handleClick}\n  >\n    <div class=\"jse-text-centered\">\n      {#if icon}\n        <Icon data={icon} />\n      {/if}\n      {message}\n    </div>\n  </div>\n  <div class=\"jse-actions\">\n    {#each actions as action}\n      <button\n        type=\"button\"\n        on:click={() => {\n          if (action.onClick) {\n            action.onClick()\n          }\n        }}\n        on:mousedown={() => {\n          if (action.onMouseDown) {\n            action.onMouseDown()\n          }\n        }}\n        class=\"jse-button jse-action jse-primary\"\n        title={action.title}\n        disabled={action.disabled}\n      >\n        {#if action.icon}\n          <Icon data={action.icon} />\n        {/if}\n        {action.text}\n      </button>\n    {/each}\n  </div>\n</div>\n\n<style src=\"./Message.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import {\n    faAngleDown,\n    faAngleRight,\n    faExclamationTriangle\n  } from '@fortawesome/free-solid-svg-icons'\n  import { isEmpty } from 'lodash-es'\n  import Icon from 'svelte-awesome'\n  import { stringifyJSONPath } from '$lib/utils/pathUtils.js'\n  import { ValidationSeverity, type ValidationError } from '$lib/types.js'\n  import { MAX_VALIDATION_ERRORS } from '$lib/constants.js'\n  import { limit } from '$lib/utils/arrayUtils.js'\n\n  export let validationErrors: ValidationError[]\n  export let selectError: (error: ValidationError) => void\n\n  $: count = validationErrors.length\n\n  let expanded = true\n\n  function collapse() {\n    expanded = false\n  }\n\n  function expand() {\n    expanded = true\n  }\n\n  function getMaxSeverity(errors: ValidationError[]): ValidationSeverity | undefined {\n    const severities = [\n      ValidationSeverity.error,\n      ValidationSeverity.warning,\n      ValidationSeverity.info\n    ]\n\n    return severities.find((severity) => errors.some((error) => error.severity === severity))\n  }\n</script>\n\n{#if !isEmpty(validationErrors)}\n  <div class=\"jse-validation-errors-overview\">\n    {#if expanded || count === 1}\n      <table class=\"jse-validation-errors-overview-expanded\">\n        <tbody>\n          {#each limit(validationErrors, MAX_VALIDATION_ERRORS) as validationError, index}\n            <tr\n              class=\"jse-validation-{validationError.severity}\"\n              on:click={() => {\n                // trigger on the next tick to prevent the editor not getting focus\n                setTimeout(() => selectError(validationError))\n              }}\n            >\n              <td class=\"jse-validation-error-icon\">\n                <Icon data={faExclamationTriangle} />\n              </td>\n              <td class=\"jse-validation-error-path\">\n                {stringifyJSONPath(validationError.path)}\n              </td>\n              <td class=\"jse-validation-error-message\">\n                {validationError.message}\n              </td>\n              <td class=\"jse-validation-error-action\">\n                {#if index === 0 && validationErrors.length > 1}\n                  <button\n                    type=\"button\"\n                    class=\"jse-validation-errors-collapse\"\n                    on:click|stopPropagation={collapse}\n                    title=\"Collapse validation errors\"\n                  >\n                    <Icon data={faAngleDown} />\n                  </button>\n                {/if}\n              </td>\n            </tr>\n          {/each}\n\n          {#if count > MAX_VALIDATION_ERRORS}\n            <tr class=\"jse-validation-error\">\n              <td />\n              <td />\n              <td>(and {count - MAX_VALIDATION_ERRORS} more errors)</td>\n              <td />\n            </tr>\n          {/if}\n        </tbody>\n      </table>\n    {:else}\n      <table class=\"jse-validation-errors-overview-collapsed\">\n        <tbody>\n          <tr class=\"jse-validation-{getMaxSeverity(validationErrors)}\" on:click={expand}>\n            <td class=\"jse-validation-error-icon\">\n              <Icon data={faExclamationTriangle} />\n            </td>\n            <td class=\"jse-validation-error-count\">\n              {count} validation errors\n              <div class=\"jse-validation-errors-expand\">\n                <Icon data={faAngleRight} />\n              </div>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    {/if}\n  </div>\n{/if}\n\n<style src=\"./ValidationErrorsOverview.scss\"></style>\n","export const IS_MAC =\n  typeof navigator !== 'undefined' ? navigator.platform.toUpperCase().indexOf('MAC') >= 0 : false\n","import { isEmpty, last } from 'lodash-es'\n\ntype Callback = () => void\n\n// singleton stack with callbacks\nlet callbacks: Callback[] = []\n\nfunction handleKeyDown(event: KeyboardEvent) {\n  if (event.key === 'Escape') {\n    const callback = last(callbacks)\n    if (callback) {\n      callback()\n    }\n  }\n}\n\n/**\n * The provided callback is invoked when the user presses Escape,\n * but only the callback of the last registered component is invoked.\n *\n * This is useful for example when opening a model on top of another modal:\n * you only want the top modal to close on Escape, and not the second modal.\n */\nexport function onEscape(element: Element | null, callback: Callback) {\n  if (isEmpty(callbacks)) {\n    window.addEventListener('keydown', handleKeyDown)\n  }\n\n  callbacks.push(callback)\n\n  return {\n    destroy: () => {\n      callbacks = callbacks.filter((c) => c !== callback)\n\n      if (isEmpty(callbacks)) {\n        window.removeEventListener('keydown', handleKeyDown)\n      }\n    }\n  }\n}\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { getContext } from 'svelte'\n  import { IS_MAC } from '$lib/utils/navigatorUtils.js'\n  import { onEscape } from '$lib/actions/onEscape.js'\n  import Header from './Header.svelte'\n  import type { Context } from 'svelte-simple-modal'\n\n  const { close } = getContext<Context>('simple-modal')\n\n  const ctrl = IS_MAC ? '' : 'Ctrl'\n</script>\n\n<div class=\"jse-modal jse-copy-paste\" use:onEscape={() => close()}>\n  <Header title=\"Copying and pasting\" />\n\n  <div class=\"jse-modal-contents\">\n    <div>These actions are unavailable via the menu. Please use:</div>\n\n    <div class=\"jse-shortcuts\">\n      <div class=\"jse-shortcut\">\n        <div class=\"jse-key\">\n          {ctrl}+C\n        </div>\n        for copy\n      </div>\n      <div class=\"jse-shortcut\">\n        <div class=\"jse-key\">\n          {ctrl}+X\n        </div>\n        for cut\n      </div>\n      <div class=\"jse-shortcut\">\n        <div class=\"jse-key\">\n          {ctrl}+V\n        </div>\n        for paste\n      </div>\n    </div>\n\n    <div class=\"jse-actions\">\n      <button type=\"button\" class=\"jse-primary\" on:click={() => close()}> Close </button>\n    </div>\n  </div>\n</div>\n\n<style src=\"./CopyPasteModal.scss\"></style>\n","import type {\n  ContentParseError,\n  ContentValidationErrors,\n  ContextMenuColumn,\n  ContextMenuRow,\n  MenuButton,\n  MenuDropDownButton,\n  MenuLabel,\n  MenuSeparator,\n  MenuSpace,\n  ValidationError,\n  NestedValidationError,\n  SvelteActionRenderer,\n  SvelteComponentRenderer\n} from './types.js'\nimport { isObject } from '$lib/utils/typeUtils.js'\n\nexport function isMenuSpace(item: unknown): item is MenuSpace {\n  // checking the .space property is for backward compatibility\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore\n  return item ? item['type'] === 'space' || item['space'] === true : false\n}\n\nexport function isMenuSeparator(item: unknown): item is MenuSeparator {\n  // checking the .separator property is for backward compatibility\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore\n  return item ? item['type'] === 'separator' || item['separator'] === true : false\n}\n\nexport function isMenuLabel(item: unknown): item is MenuLabel {\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore\n  return item ? item['type'] === 'label' && typeof item['text'] === 'string' : false\n}\n\nexport function isMenuButton(item: unknown): item is MenuButton {\n  // for backward compatibility, we only check .onClick here and not item['type'] === 'button'\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore\n  return item ? typeof item['onClick'] === 'function' : false\n}\n\nexport function isMenuDropDownButton(item: unknown): item is MenuDropDownButton {\n  return item\n    ? // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      item['type'] === 'dropdown-button' &&\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        isMenuButton(item['main']) &&\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        Array.isArray(item['items'])\n    : false\n}\n\nexport function isContextMenuRow(item: unknown): item is ContextMenuRow {\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore\n  return item ? item['type'] === 'row' && Array.isArray(item['items']) : false\n}\n\nexport function isContextMenuColumn(item: unknown): item is ContextMenuColumn {\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore\n  return item ? item['type'] === 'column' && Array.isArray(item['items']) : false\n}\n\nexport function isContentParseError(contentErrors: unknown): contentErrors is ContentParseError {\n  return isObject(contentErrors) && isObject(contentErrors['parseError'])\n}\n\nexport function isContentValidationErrors(\n  contentErrors: unknown\n): contentErrors is ContentValidationErrors {\n  return isObject(contentErrors) && Array.isArray(contentErrors['validationErrors'])\n}\n\nexport function isValidationError(value: unknown): value is ValidationError {\n  return (\n    isObject(value) &&\n    Array.isArray(value.path) &&\n    typeof value.message === 'string' &&\n    'severity' in value\n  )\n}\n\nexport function isNestedValidationError(value: unknown): value is NestedValidationError {\n  return isObject(value) && isValidationError(value) && typeof value.isChildError === 'boolean'\n}\n\nexport function isSvelteComponentRenderer(value: unknown): value is SvelteComponentRenderer {\n  return isObject(value) && 'component' in value && isObject(value.props)\n}\n\nexport function isSvelteActionRenderer(value: unknown): value is SvelteActionRenderer {\n  return isObject(value) && typeof value.action === 'function' && isObject(value.props)\n}\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import Icon from 'svelte-awesome'\n  import type { MenuItem } from '$lib/types'\n  import { isMenuButton, isMenuSeparator, isMenuSpace } from '$lib/typeguards.js'\n\n  export let items: MenuItem[] = []\n\n  function unknownMenuItem(item: MenuItem): string {\n    console.error('Unknown type of menu item', item)\n    return '???'\n  }\n</script>\n\n<div class=\"jse-menu\">\n  <slot name=\"left\" />\n\n  {#each items as item}\n    {#if isMenuSeparator(item)}\n      <div class=\"jse-separator\" />\n    {:else if isMenuSpace(item)}\n      <div class=\"jse-space\" />\n    {:else if isMenuButton(item)}\n      <button\n        type=\"button\"\n        class=\"jse-button {item.className}\"\n        on:click={item.onClick}\n        title={item.title}\n        disabled={item.disabled || false}\n      >\n        {#if item.icon}\n          <Icon data={item.icon} />\n        {/if}\n        {#if item.text}\n          {item.text}\n        {/if}\n      </button>\n    {:else}\n      {unknownMenuItem(item)}\n    {/if}\n  {/each}\n\n  <slot name=\"right\" />\n</div>\n\n<style src=\"./Menu.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import {\n    faArrowDown,\n    faCheck,\n    faExclamationTriangle,\n    faTimes,\n    faWrench\n  } from '@fortawesome/free-solid-svg-icons'\n  import { createDebug } from '$lib/utils/debug.js'\n  import Message from '../../controls/Message.svelte'\n  import { normalizeJsonParseError } from '$lib/utils/jsonUtils.js'\n  import Menu from '../../controls/Menu.svelte'\n  import type { MenuItem } from '$lib/types.js'\n\n  export let text = ''\n  export let readOnly = false\n  export let onParse: (text: string) => void\n  export let onRepair: (text: string) => string\n  export let onChange: ((updatedText: string) => void) | null = null\n  export let onApply: (repairedText: string) => void\n  export let onCancel: () => void\n\n  const debug = createDebug('jsoneditor:JSONRepair')\n\n  let domTextArea: HTMLTextAreaElement\n\n  $: error = getErrorMessage(text)\n  $: repairable = isRepairable(text)\n\n  $: debug('error', error)\n\n  function getErrorMessage(jsonText: string) {\n    try {\n      onParse(jsonText)\n      return null\n    } catch (err) {\n      return normalizeJsonParseError(jsonText, (err as Error).message)\n    }\n  }\n\n  function isRepairable(jsonText: string) {\n    try {\n      onRepair(jsonText)\n      return true\n    } catch (err) {\n      return false\n    }\n  }\n\n  function goToError() {\n    if (domTextArea && error) {\n      const position = error.position != null ? error.position : 0\n      domTextArea.setSelectionRange(position, position)\n      domTextArea.focus()\n    }\n  }\n\n  function handleChange(event: Event & { currentTarget: EventTarget & HTMLTextAreaElement }) {\n    debug('handleChange')\n\n    const value = (event.target as HTMLTextAreaElement).value\n\n    if (text === value) {\n      return\n    }\n\n    text = value\n\n    if (onChange) {\n      onChange(text)\n    }\n  }\n\n  function handleApply() {\n    onApply(text)\n  }\n\n  function handleRepair() {\n    try {\n      // TODO: simpleJsonRepair should also partially apply fixes. Now it's all or nothing\n      text = onRepair(text)\n\n      if (onChange) {\n        onChange(text)\n      }\n    } catch (err) {\n      // no need to do something with the error\n    }\n  }\n\n  let items: MenuItem[]\n  $: items = [\n    {\n      type: 'space'\n    },\n    {\n      type: 'button',\n      icon: faTimes,\n      title: 'Cancel repair',\n      className: 'jse-cancel',\n      onClick: onCancel\n    }\n  ]\n\n  $: gotoAction = {\n    icon: faArrowDown,\n    text: 'Show me',\n    title: 'Scroll to the error location',\n    onClick: goToError\n  }\n\n  $: repairAction = {\n    icon: faWrench,\n    text: 'Auto repair',\n    title: 'Automatically repair JSON',\n    onClick: handleRepair\n  }\n\n  $: errorActions = repairable ? [gotoAction, repairAction] : [gotoAction]\n\n  $: successActions = [\n    {\n      icon: faCheck,\n      text: 'Apply',\n      title: 'Apply fixed JSON',\n      disabled: readOnly,\n      onClick: handleApply\n    }\n  ]\n</script>\n\n<div class=\"jse-json-repair-component\">\n  <Menu {items}>\n    <div slot=\"left\" class=\"jse-info\">Repair invalid JSON, then click apply</div>\n  </Menu>\n\n  {#if error}\n    <Message\n      type=\"error\"\n      icon={faExclamationTriangle}\n      message={`Cannot parse JSON: ${error.message}`}\n      actions={errorActions}\n    />\n  {:else}\n    <Message\n      type=\"success\"\n      message=\"JSON is valid now and can be parsed.\"\n      actions={successActions}\n    />\n  {/if}\n  <textarea\n    bind:this={domTextArea}\n    on:input={handleChange}\n    readonly={readOnly}\n    class=\"jse-json-text\"\n    autocomplete=\"off\"\n    autocapitalize=\"off\"\n    spellcheck=\"false\">{text}</textarea\n  >\n</div>\n\n<style src=\"./JSONRepairComponent.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { getContext } from 'svelte'\n  import JSONRepairComponent from './repair/JSONRepairComponent.svelte'\n  import { onEscape } from '$lib/actions/onEscape.js'\n  import type { Context } from 'svelte-simple-modal'\n\n  export let text: string\n  export let onParse: (text: string) => void\n  export let onRepair: (text: string) => string\n  export let onApply: (repairedText: string) => void\n\n  const { close } = getContext<Context>('simple-modal')\n\n  function handleApply(repairedText: string) {\n    close()\n    onApply(repairedText)\n  }\n\n  function handleCancel() {\n    close()\n  }\n</script>\n\n<div class=\"jse-modal jse-repair\" use:onEscape={close}>\n  <JSONRepairComponent\n    bind:text\n    {onParse}\n    {onRepair}\n    onApply={handleApply}\n    onCancel={handleCancel}\n  />\n</div>\n\n<style src=\"./JSONRepairModal.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { getExpandItemsSections } from '$lib/logic/expandItemsSections.js'\n  import type { JSONSelection, Section, VisibleSection, JSONEditorContext } from '$lib/types.js'\n  import type { JSONPath } from 'immutable-json-patch'\n  import { pathInSelection } from '$lib/logic/selection.js'\n\n  export let visibleSections: VisibleSection[]\n  export let sectionIndex: number\n  export let total: number\n  export let path: JSONPath\n  export let selection: JSONSelection | null\n  export let onExpandSection: (path: JSONPath, section: Section) => void\n  export let context: JSONEditorContext\n\n  $: visibleSection = visibleSections[sectionIndex]\n\n  $: startIndex = visibleSection.end\n  $: endIndex = visibleSections[sectionIndex + 1] ? visibleSections[sectionIndex + 1].start : total\n\n  $: selected = pathInSelection(context.getJson(), selection, path.concat(String(startIndex)))\n\n  $: expandItemsSections = getExpandItemsSections(startIndex, endIndex)\n\n  function handleMouseMove(event: MouseEvent) {\n    // prevent the whole array from being selected whilst dragging over\n    // a section with collapsed items\n    event.stopPropagation()\n  }\n</script>\n\n<div\n  role=\"none\"\n  class=\"jse-collapsed-items\"\n  class:jse-selected={selected}\n  on:mousemove={handleMouseMove}\n  style:--level={path.length + 2}\n>\n  <div>\n    <div class=\"jse-text\">Items {startIndex}-{endIndex}</div>\n    {#each expandItemsSections as expandItemsSection}<button\n        type=\"button\"\n        class=\"jse-expand-items\"\n        on:click={() => onExpandSection(path, expandItemsSection)}\n      >\n        show {expandItemsSection.start}-{expandItemsSection.end}\n      </button>\n    {/each}\n  </div>\n</div>\n\n<style src=\"./CollapsedItems.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { faCaretDown } from '@fortawesome/free-solid-svg-icons'\n  import Icon from 'svelte-awesome'\n  import {\n    CONTEXT_MENU_EXPLANATION,\n    CONTEXT_MENU_HEIGHT,\n    CONTEXT_MENU_WIDTH\n  } from '$lib/constants.js'\n  import type { OnContextMenu } from '$lib/types'\n\n  export let selected: boolean\n  export let onContextMenu: OnContextMenu\n\n  function handleClick(event: MouseEvent & { currentTarget: EventTarget & HTMLButtonElement }) {\n    let buttonElem: Element | null = event.target as HTMLButtonElement\n    while (buttonElem && buttonElem.nodeName !== 'BUTTON') {\n      buttonElem = buttonElem.parentNode as Element\n    }\n\n    if (buttonElem) {\n      onContextMenu({\n        anchor: buttonElem,\n        left: 0,\n        top: 0,\n        width: CONTEXT_MENU_WIDTH,\n        height: CONTEXT_MENU_HEIGHT,\n        offsetTop: 2,\n        offsetLeft: 0,\n        showTip: true\n      })\n    }\n  }\n</script>\n\n<button\n  type=\"button\"\n  class=\"jse-context-menu-pointer\"\n  class:jse-selected={selected}\n  title={CONTEXT_MENU_EXPLANATION}\n  on:click={handleClick}\n>\n  <Icon data={faCaretDown} />\n</button>\n\n<style src=\"./ContextMenuPointer.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { initial, isEqual } from 'lodash-es'\n  import {\n    createKeySelection,\n    createValueSelection,\n    isEditingSelection,\n    isKeySelection\n  } from '$lib/logic/selection.js'\n  import SearchResultHighlighter from './highlight/SearchResultHighlighter.svelte'\n  import EditableDiv from '../../controls/EditableDiv.svelte'\n  import { addNewLineSuffix } from '$lib/utils/domUtils.js'\n  import type { ExtendedSearchResultItem, JSONSelection, TreeModeContext } from '$lib/types.js'\n  import { UpdateSelectionAfterChange } from '$lib/types.js'\n  import type { JSONPath } from 'immutable-json-patch'\n  import ContextMenuPointer from '../../../components/controls/contextmenu/ContextMenuPointer.svelte'\n  import { classnames } from '$lib/utils/cssUtils.js'\n\n  export let path: JSONPath\n  export let key: string\n  export let selection: JSONSelection | null\n  export let searchResultItems: ExtendedSearchResultItem[] | undefined\n  export let onUpdateKey: (oldKey: string, newKey: string) => string\n\n  export let context: TreeModeContext\n\n  $: isKeySelected = selection ? isKeySelection(selection) && isEqual(selection.path, path) : false\n  $: isEditingKey = isKeySelected && isEditingSelection(selection)\n\n  function handleKeyDoubleClick(\n    event: MouseEvent & { currentTarget: EventTarget & HTMLDivElement }\n  ) {\n    if (!isEditingKey && !context.readOnly) {\n      event.preventDefault()\n      context.onSelect(createKeySelection(path, true))\n    }\n  }\n\n  function getKeyClass(key: string) {\n    return classnames('jse-key', {\n      'jse-empty': key === ''\n    })\n  }\n\n  function handleChangeValue(newKey: string, updateSelection: UpdateSelectionAfterChange) {\n    const updatedKey = onUpdateKey(key, context.normalization.unescapeValue(newKey))\n    const updatedPath = initial(path).concat(updatedKey)\n\n    context.onSelect(\n      updateSelection === UpdateSelectionAfterChange.nextInside\n        ? createValueSelection(updatedPath, false)\n        : createKeySelection(updatedPath, false)\n    )\n\n    if (updateSelection !== UpdateSelectionAfterChange.self) {\n      context.focus()\n    }\n  }\n\n  function handleCancelChange() {\n    context.onSelect(createKeySelection(path, false))\n    context.focus()\n  }\n</script>\n\n{#if !context.readOnly && isEditingKey}\n  <EditableDiv\n    value={context.normalization.escapeValue(key)}\n    shortText\n    onChange={handleChangeValue}\n    onCancel={handleCancelChange}\n    onFind={context.onFind}\n  />\n{:else}\n  <div\n    role=\"none\"\n    data-type=\"selectable-key\"\n    class={getKeyClass(key)}\n    on:dblclick={handleKeyDoubleClick}\n  >\n    {#if searchResultItems}\n      <SearchResultHighlighter text={context.normalization.escapeValue(key)} {searchResultItems} />\n    {:else}\n      {addNewLineSuffix(context.normalization.escapeValue(key))}\n    {/if}\n  </div>\n{/if}\n{#if !context.readOnly && isKeySelected && !isEditingKey}\n  <ContextMenuPointer selected={true} onContextMenu={context.onContextMenu} />\n{/if}\n\n<style src=\"./JSONKey.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import type { JSONEditorContext, JSONSelection, SearchResultItem } from '$lib/types.js'\n  import type { JSONPath } from 'immutable-json-patch'\n  import { isEditingSelection, isValueSelection } from '$lib/logic/selection.js'\n  import { isSvelteActionRenderer } from '$lib/typeguards.js'\n\n  export let path: JSONPath\n  export let value: unknown\n  export let context: JSONEditorContext\n  export let enforceString: boolean\n  export let selection: JSONSelection | null\n  export let searchResultItems: SearchResultItem[] | undefined\n\n  $: isEditing = isValueSelection(selection) && isEditingSelection(selection)\n\n  $: renderers = context.onRenderValue({\n    path,\n    value,\n    readOnly: context.readOnly,\n    enforceString,\n    isEditing,\n    parser: context.parser,\n    normalization: context.normalization,\n    selection,\n    searchResultItems,\n    onPatch: context.onPatch,\n    onPasteJson: context.onPasteJson,\n    onSelect: context.onSelect,\n    onFind: context.onFind,\n    findNextInside: context.findNextInside,\n    focus: context.focus\n  })\n</script>\n\n{#each renderers as renderer}\n  {#if isSvelteActionRenderer(renderer)}\n    {@const action = renderer.action}\n    {#key renderer.action}\n      <div\n        role=\"button\"\n        tabindex=\"-1\"\n        class=\"jse-value jse-readonly-password\"\n        data-type=\"selectable-value\"\n        use:action={renderer.props}\n      />\n    {/key}\n  {:else}\n    {#key renderer.component}\n      <svelte:component this={renderer.component} {...renderer.props} />\n    {/key}\n  {/if}\n{/each}\n","// used by JSONNode during dragging\nimport type { JSONPath } from 'immutable-json-patch'\n\nexport const singleton: Singleton = {\n  selecting: false,\n  selectionAnchor: null, // Path\n  selectionAnchorType: null, // Selection type\n  selectionFocus: null, // Path\n\n  dragging: false\n}\n\ninterface Singleton {\n  selecting: boolean\n  selectionAnchor: JSONPath | null\n  selectionAnchorType: string | null\n  selectionFocus: JSONPath | null\n\n  dragging: boolean\n}\n","import { createMultiSelection, getEndPath, getStartPath } from './selection.js'\nimport { initial, isEqual } from 'lodash-es'\nimport type { JSONPatchDocument } from 'immutable-json-patch'\nimport { getIn } from 'immutable-json-patch'\nimport { moveInsideParent } from './operations.js'\nimport type {\n  DocumentState,\n  DragInsideAction,\n  DragInsideProps,\n  JSONSelection,\n  MultiSelection,\n  RenderedItem\n} from '$lib/types'\n\nexport interface MoveSelectionProps {\n  json: unknown\n  documentState: DocumentState\n  deltaY: number\n  items: RenderedItem[]\n}\n\nexport interface MoveSelectionResult {\n  operations: JSONPatchDocument | undefined\n  updatedSelection: JSONSelection | null\n  offset: number\n}\n\nexport function onMoveSelection({\n  json,\n  documentState,\n  deltaY,\n  items\n}: MoveSelectionProps): MoveSelectionResult {\n  if (!documentState.selection) {\n    return {\n      operations: undefined,\n      updatedSelection: null,\n      offset: 0\n    }\n  }\n\n  const selection = documentState.selection\n  const dragInsideAction =\n    deltaY < 0\n      ? findSwapPathUp({ json, selection, deltaY, items })\n      : findSwapPathDown({ json, selection, deltaY, items })\n\n  if (!dragInsideAction || dragInsideAction.offset === 0) {\n    return {\n      operations: undefined,\n      updatedSelection: null,\n      offset: 0\n    }\n  }\n\n  const operations = moveInsideParent(json, selection, dragInsideAction)\n\n  const path = initial(getStartPath(json, selection))\n  const value = getIn(json, path)\n  if (Array.isArray(value)) {\n    const updatedSelection = createUpdatedArraySelection({\n      items,\n      json,\n      selection,\n      offset: dragInsideAction.offset\n    })\n\n    return {\n      operations,\n      updatedSelection,\n      offset: dragInsideAction.offset\n    }\n  } else {\n    // object\n    return {\n      operations,\n      updatedSelection: null,\n      offset: dragInsideAction.offset\n    }\n  }\n}\n\nfunction findSwapPathUp({\n  json,\n  items,\n  selection,\n  deltaY\n}: DragInsideProps): DragInsideAction | undefined {\n  const initialPath = getStartPath(json, selection)\n  const initialIndex = items.findIndex((item) => isEqual(item.path, initialPath))\n\n  const prevHeight = () => items[index - 1]?.height\n\n  let index = initialIndex\n  let cumulativeHeight = 0\n\n  while (prevHeight() !== undefined && Math.abs(deltaY) > cumulativeHeight + prevHeight() / 2) {\n    cumulativeHeight += prevHeight()\n    index -= 1\n  }\n\n  const beforePath = items[index].path\n  const offset = index - initialIndex\n\n  return index !== initialIndex && items[index] !== undefined ? { beforePath, offset } : undefined\n}\n\nfunction findSwapPathDown({\n  json,\n  items,\n  selection,\n  deltaY\n}: DragInsideProps): DragInsideAction | undefined {\n  const initialPath = getEndPath(json, selection)\n  const initialIndex = items.findIndex((item) => isEqual(item.path, initialPath))\n\n  let cumulativeHeight = 0\n  let index = initialIndex\n\n  const nextHeight = () => items[index + 1]?.height\n\n  while (nextHeight() !== undefined && Math.abs(deltaY) > cumulativeHeight + nextHeight() / 2) {\n    cumulativeHeight += nextHeight()\n    index += 1\n  }\n\n  const parentPath = initial(initialPath)\n  const parent = getIn(json, parentPath)\n  const isArray = Array.isArray(parent)\n  const beforeIndex = isArray ? index : index + 1\n  const beforePath = items[beforeIndex]?.path\n  const offset = index - initialIndex\n\n  return beforePath ? { beforePath, offset } : { append: true, offset }\n}\n\ninterface UpdatedArraySelectionProps {\n  items: RenderedItem[]\n  json: unknown\n  selection: JSONSelection\n  offset: number\n}\n\nfunction createUpdatedArraySelection({\n  items,\n  json,\n  selection,\n  offset\n}: UpdatedArraySelectionProps): MultiSelection {\n  const startPath = getStartPath(json, selection)\n  const endPath = getEndPath(json, selection)\n\n  const startIndex = items.findIndex((item) => isEqual(item.path, startPath))\n  const endIndex = items.findIndex((item) => isEqual(item.path, endPath))\n\n  const anchorPath = items[startIndex + offset]?.path\n  const focusPath = items[endIndex + offset]?.path\n\n  return createMultiSelection(anchorPath, focusPath)\n}\n","import type { JSONPointerMap } from '$lib/types'\nimport type { JSONPointer } from 'immutable-json-patch'\nimport { startsWithJSONPointer } from 'immutable-json-patch'\n\n// TODO: write unit tests\nexport function filterMapOrUndefined<T>(\n  map: JSONPointerMap<T> | undefined,\n  filter: (pointer: JSONPointer, value: T) => boolean\n): JSONPointerMap<T> | undefined {\n  if (!map) {\n    return undefined\n  }\n\n  const filteredMap: JSONPointerMap<T> = {}\n\n  for (const p of Object.keys(map)) {\n    if (filter(p, map[p])) {\n      filteredMap[p] = map[p]\n    }\n  }\n\n  return Object.keys(filteredMap).length > 0 ? filteredMap : undefined\n}\n\n// TODO: write unit tests\nexport function filterPointerOrUndefined<T>(\n  map: JSONPointerMap<T> | undefined,\n  pointer: JSONPointer\n): JSONPointerMap<T> | undefined {\n  return filterMapOrUndefined(map, (p) => startsWithJSONPointer(p, pointer))\n}\n","<script lang=\"ts\">\n  import { faExclamationTriangle } from '@fortawesome/free-solid-svg-icons'\n  import Icon from 'svelte-awesome'\n  import { getContext } from 'svelte'\n  import { tooltip } from '../../controls/tooltip/tooltip.js'\n  import type { AbsolutePopupContext, NestedValidationError, ValidationError } from '$lib/types.js'\n  import { isNestedValidationError } from '$lib/typeguards.js'\n\n  const absolutePopupContext = getContext<AbsolutePopupContext>('absolute-popup')\n\n  export let validationError: NestedValidationError | ValidationError\n  export let onExpand: (event: MouseEvent) => void\n\n  $: text =\n    isNestedValidationError(validationError) && validationError.isChildError\n      ? 'Contains invalid data'\n      : validationError.message\n</script>\n\n<button\n  type=\"button\"\n  class=\"jse-validation-{validationError.severity}\"\n  on:click={onExpand}\n  use:tooltip={{ text, ...absolutePopupContext }}\n>\n  <Icon data={faExclamationTriangle} />\n</button>\n\n<style src=\"./ValidationErrorIcon.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { faCaretDown, faCaretRight } from '@fortawesome/free-solid-svg-icons'\n  import type { JSONPath, JSONPointer } from 'immutable-json-patch'\n  import { appendToJSONPointer, compileJSONPointer, parseJSONPointer } from 'immutable-json-patch'\n  import { initial, isEqual, last } from 'lodash-es'\n  import Icon from 'svelte-awesome'\n  import {\n    DEFAULT_VISIBLE_SECTIONS,\n    HOVER_COLLECTION,\n    HOVER_INSERT_AFTER,\n    HOVER_INSERT_INSIDE,\n    INSERT_EXPLANATION\n  } from '$lib/constants.js'\n  import { getEnforceString, getVisibleCaretPositions } from '$lib/logic/documentState.js'\n  import { rename } from '$lib/logic/operations.js'\n  import {\n    createAfterSelection,\n    createInsideSelection,\n    createMultiSelection,\n    fromCaretPosition,\n    fromSelectionType,\n    getAnchorPath,\n    getEndPath,\n    getFocusPath,\n    getSelectionPaths,\n    getStartPath,\n    isAfterSelection,\n    isInsideSelection,\n    isKeySelection,\n    isMultiSelection,\n    isValueSelection,\n    pathInSelection,\n    isEditingSelection,\n    selectionIfOverlapping\n  } from '$lib/logic/selection.js'\n  import {\n    encodeDataPath,\n    getDataPathFromTarget,\n    getSelectionTypeFromTarget,\n    isChildOfAttribute,\n    isChildOfNodeName,\n    isContentEditableDiv\n  } from '$lib/utils/domUtils.js'\n  import CollapsedItems from './CollapsedItems.svelte'\n  import ContextMenuPointer from '../../../components/controls/contextmenu/ContextMenuPointer.svelte'\n  import JSONKey from './JSONKey.svelte'\n  import JSONValue from './JSONValue.svelte'\n  import { singleton } from './singleton.js'\n  import { createDebug } from '$lib/utils/debug.js'\n  import { onMoveSelection } from '$lib/logic/dragging.js'\n  import { forEachIndex, moveItems } from '$lib/utils/arrayUtils.js'\n  import type {\n    AbsolutePopupOptions,\n    CaretPosition,\n    DraggingState,\n    ExtendedSearchResultItem,\n    JSONNodeItem,\n    JSONNodeProp,\n    JSONPointerMap,\n    JSONSelection,\n    NestedValidationError,\n    RenderedItem,\n    TreeModeContext,\n    VisibleSection\n  } from '$lib/types'\n  import { SelectionType } from '$lib/types.js'\n  import { filterPointerOrUndefined } from '$lib/utils/jsonPointer.js'\n  import { filterKeySearchResults, filterValueSearchResults } from '$lib/logic/search.js'\n  import { createMemoizePath } from '$lib/utils/pathUtils.js'\n  import ValidationErrorIcon from './ValidationErrorIcon.svelte'\n  import { isObject } from '$lib/utils/typeUtils.js'\n  import { classnames } from '$lib/utils/cssUtils.js'\n\n  export let value: unknown\n  export let path: JSONPath\n  export let expandedMap: JSONPointerMap<boolean> | undefined\n  export let enforceStringMap: JSONPointerMap<boolean> | undefined\n  export let visibleSectionsMap: JSONPointerMap<VisibleSection[]> | undefined\n  export let validationErrorsMap: JSONPointerMap<NestedValidationError> | undefined\n  export let searchResultItemsMap: JSONPointerMap<ExtendedSearchResultItem[]> | undefined\n  export let selection: JSONSelection | null\n  export let context: TreeModeContext\n  export let onDragSelectionStart: (\n    event: MouseEvent & { currentTarget: EventTarget & HTMLDivElement }\n  ) => void\n\n  const debug = createDebug('jsoneditor:JSONNode')\n\n  let hover: string | undefined = undefined\n  let hoverTimer: number | undefined = undefined\n  let dragging: DraggingState | undefined = undefined\n\n  // important to prevent creating a new path for all children with every re-render,\n  // that would force all children to re-render\n  const memoizePath = createMemoizePath()\n\n  let pointer: JSONPointer\n  $: pointer = compileJSONPointer(path)\n\n  let expanded: boolean\n  $: expanded = expandedMap ? expandedMap[pointer] === true : false\n\n  let enforceString: boolean | undefined\n  $: enforceString = getEnforceString(value, enforceStringMap, pointer, context.parser)\n\n  let visibleSections: VisibleSection[] | undefined\n  $: visibleSections = visibleSectionsMap ? visibleSectionsMap[pointer] : undefined\n\n  let validationError: NestedValidationError | undefined\n  $: validationError = validationErrorsMap ? validationErrorsMap[pointer] : undefined\n\n  let isNodeSelected: boolean\n  $: isNodeSelected = pathInSelection(context.getJson(), selection, path)\n\n  $: root = path.length === 0\n\n  // TODO: extract getProps into a separate function\n  function getProps(\n    path: JSONPath,\n    object: Record<string, unknown>,\n    expandedMap: JSONPointerMap<boolean> | undefined,\n    enforceStringMap: JSONPointerMap<boolean> | undefined,\n    visibleSectionsMap: JSONPointerMap<VisibleSection[]> | undefined,\n    validationErrorsMap: JSONPointerMap<NestedValidationError> | undefined,\n    searchResultItemsMap: JSONPointerMap<ExtendedSearchResultItem[]> | undefined,\n    selection: JSONSelection | null,\n    dragging: DraggingState | undefined\n  ): JSONNodeProp[] {\n    let props = Object.keys(object).map((key) => {\n      const keyPath = memoizePath(path.concat(key))\n      const keyPointer = appendToJSONPointer(pointer, key)\n      return {\n        key,\n        value: object[key],\n        path: keyPath,\n        expandedMap: filterPointerOrUndefined(expandedMap, keyPointer),\n        enforceStringMap: filterPointerOrUndefined(enforceStringMap, keyPointer),\n        visibleSectionsMap: filterPointerOrUndefined(visibleSectionsMap, keyPointer),\n        validationErrorsMap: filterPointerOrUndefined(validationErrorsMap, keyPointer),\n        keySearchResultItemsMap: filterKeySearchResults(searchResultItemsMap, keyPointer),\n        valueSearchResultItemsMap: filterPointerOrUndefined(searchResultItemsMap, keyPointer),\n        selection: selectionIfOverlapping(context.getJson(), selection, keyPath)\n      }\n    })\n\n    // reorder the props when dragging\n    if (dragging && dragging.offset !== 0) {\n      props = moveItems(\n        props,\n        dragging.selectionStartIndex,\n        dragging.selectionItemsCount,\n        dragging.offset\n      )\n    }\n\n    return props\n  }\n\n  // TODO: extract getItems into a separate function\n  function getItems(\n    path: JSONPath,\n    array: Array<unknown>,\n    visibleSection: VisibleSection,\n    expandedMap: JSONPointerMap<boolean> | undefined,\n    enforceStringMap: JSONPointerMap<boolean> | undefined,\n    visibleSectionsMap: JSONPointerMap<VisibleSection[]> | undefined,\n    validationErrorsMap: JSONPointerMap<NestedValidationError> | undefined,\n    searchResultItemsMap: JSONPointerMap<ExtendedSearchResultItem[]> | undefined,\n    selection: JSONSelection | null,\n    dragging: DraggingState | undefined\n  ): JSONNodeItem[] {\n    const start = visibleSection.start\n    const end = Math.min(visibleSection.end, array.length)\n    let items: JSONNodeItem[] = []\n\n    for (let index = start; index < end; index++) {\n      const itemPath = memoizePath(path.concat(String(index)))\n      const itemPointer = appendToJSONPointer(pointer, index)\n\n      items.push({\n        index,\n        value: array[index],\n        path: itemPath,\n        expandedMap: filterPointerOrUndefined(expandedMap, itemPointer),\n        enforceStringMap: filterPointerOrUndefined(enforceStringMap, itemPointer),\n        visibleSectionsMap: filterPointerOrUndefined(visibleSectionsMap, itemPointer),\n        validationErrorsMap: filterPointerOrUndefined(validationErrorsMap, itemPointer),\n        searchResultItemsMap: filterPointerOrUndefined(searchResultItemsMap, itemPointer),\n        selection: selectionIfOverlapping(context.getJson(), selection, itemPath)\n      })\n    }\n\n    // reorder the items when dragging\n    if (dragging && dragging.offset !== 0) {\n      const originalIndexes = items.map((item) => item.index)\n\n      items = moveItems(\n        items,\n        dragging.selectionStartIndex,\n        dragging.selectionItemsCount,\n        dragging.offset\n      )\n\n      // maintain the original indexes. Indexes must keep the same order,\n      // note that the indexes can be a visible section from 200-300 for example\n      for (let i = 0; i < items.length; i++) {\n        items[i].index = originalIndexes[i]\n      }\n    }\n\n    return items\n  }\n\n  function toggleExpand(event: MouseEvent) {\n    event.stopPropagation()\n\n    const recursive = event.ctrlKey\n    context.onExpand(path, !expanded, recursive)\n  }\n\n  function handleExpand(event: MouseEvent) {\n    event.stopPropagation()\n\n    context.onExpand(path, true)\n  }\n\n  function handleUpdateKey(oldKey: string, newKey: string): string {\n    const operations = rename(path, Object.keys(value as Record<string, unknown>), oldKey, newKey)\n    context.onPatch(operations)\n\n    // It is possible that the applied key differs from newKey,\n    // to prevent duplicate keys. Here we figure out the actually applied key\n    return last(parseJSONPointer(operations[0].path)) as string\n  }\n\n  function handleMouseDown(event: MouseEvent & { currentTarget: EventTarget & HTMLDivElement }) {\n    // check if the mouse down is not happening in the key or value input fields or on a button\n    if (\n      isContentEditableDiv(event.target as HTMLElement) ||\n      (event.which === 1 && isChildOfNodeName(event.target as Element, 'BUTTON')) // left mouse on a button\n    ) {\n      return\n    }\n\n    event.stopPropagation()\n    event.preventDefault()\n\n    // due to event.stopPropagation here and there, the focus tracker does not receive this mouse event.\n    // make sure the editor has focus\n    context.focus()\n\n    // we attach the mousemove and mouseup event listeners to the global document,\n    // so we will not miss if the mouse events happen outside the editor\n    document.addEventListener('mousemove', handleMouseMoveGlobal, true)\n    document.addEventListener('mouseup', handleMouseUpGlobal)\n\n    const anchorType = getSelectionTypeFromTarget(event.target as Element)\n    const json = context.getJson()\n    const documentState = context.getDocumentState()\n\n    if (\n      selection &&\n      anchorType !== SelectionType.after &&\n      anchorType !== SelectionType.inside &&\n      (selection.type === anchorType || selection.type === SelectionType.multi) &&\n      pathInSelection(json, selection, path)\n    ) {\n      // when right-clicking inside the current selection, do nothing: context menu will open\n      // when left-clicking inside the current selection, do nothing: it can be the start of dragging\n      if (event.button === 0) {\n        onDragSelectionStart(event)\n      }\n\n      return\n    }\n\n    // TODO: refactor dragging, there are now two separate mechanisms handling mouse movement: with dragging.* and with singleton.*\n    singleton.selecting = true\n    singleton.selectionAnchor = path\n    singleton.selectionAnchorType = anchorType\n    singleton.selectionFocus = path\n\n    if (event.shiftKey) {\n      // Shift+Click will select multiple entries\n      const fullSelection = context.getDocumentState().selection\n      if (fullSelection) {\n        context.onSelect(createMultiSelection(getAnchorPath(fullSelection), path))\n      }\n    } else {\n      if (anchorType === SelectionType.multi) {\n        if (root && (event.target as Element).hasAttribute('data-path')) {\n          const lastCaretPosition = last(\n            getVisibleCaretPositions(value, documentState)\n          ) as CaretPosition\n          context.onSelect(fromCaretPosition(lastCaretPosition))\n        } else {\n          context.onSelect(createMultiSelection(path, path))\n        }\n      } else if (json !== undefined) {\n        context.onSelect(fromSelectionType(json, anchorType, path))\n      }\n    }\n  }\n\n  function handleMouseMove(event: MouseEvent & { currentTarget: EventTarget & HTMLDivElement }) {\n    if (singleton.selecting) {\n      event.preventDefault()\n      event.stopPropagation()\n\n      if (singleton.selectionFocus == null) {\n        // First move event, no selection yet.\n        // Clear the default selection of the browser\n        if (window.getSelection) {\n          // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n          // @ts-ignore\n          window.getSelection().empty()\n        }\n      }\n\n      const selectionType = getSelectionTypeFromTarget(event.target as Element)\n\n      if (\n        !isEqual(path, singleton.selectionFocus) ||\n        selectionType !== singleton.selectionAnchorType\n      ) {\n        singleton.selectionFocus = path\n        singleton.selectionAnchorType = selectionType // TODO: this is a bit ugly\n\n        context.onSelect(\n          createMultiSelection(\n            singleton.selectionAnchor || singleton.selectionFocus,\n            singleton.selectionFocus\n          )\n        )\n      }\n    }\n  }\n\n  function handleMouseMoveGlobal(event: MouseEvent) {\n    context.onDrag(event)\n  }\n\n  function handleMouseUpGlobal(event: Event) {\n    if (singleton.selecting) {\n      singleton.selecting = false\n\n      event.stopPropagation()\n    }\n\n    context.onDragEnd()\n\n    document.removeEventListener('mousemove', handleMouseMoveGlobal, true)\n    document.removeEventListener('mouseup', handleMouseUpGlobal)\n  }\n\n  function findContentTop() {\n    return context.findElement([])?.getBoundingClientRect()?.top || 0\n  }\n\n  function calculateDeltaY(dragging: DraggingState, event: MouseEvent) {\n    // calculate the contentOffset, this changes when scrolling\n    const contentTop = findContentTop()\n    const contentOffset = contentTop - dragging.initialContentTop\n\n    // calculate the vertical mouse movement\n    const clientOffset = event.clientY - dragging.initialClientY\n\n    return clientOffset - contentOffset\n  }\n\n  function handleDragSelectionStart(\n    event: MouseEvent & { currentTarget: EventTarget & HTMLDivElement }\n  ) {\n    if (context.readOnly || !selection) {\n      return\n    }\n\n    const selectionParentPath = initial(getFocusPath(selection))\n    if (!isEqual(path, selectionParentPath)) {\n      // pass to parent\n      onDragSelectionStart(event)\n\n      return\n    }\n\n    // note that the returned items will be of one section only,\n    // and when the selection is spread over multiple sections,\n    // no items will be returned: this is not (yet) supported\n    const items = getVisibleItemsWithHeights(selection, visibleSections || DEFAULT_VISIBLE_SECTIONS)\n\n    debug('dragSelectionStart', { selection, items })\n\n    if (!items) {\n      debug('Cannot drag the current selection (probably spread over multiple sections)')\n      return\n    }\n\n    const json = context.getJson()\n    if (json === undefined) {\n      return\n    }\n    const initialPath = getStartPath(json, selection)\n    const selectionStartIndex = items.findIndex((item) => isEqual(item.path, initialPath))\n    const documentState = context.getDocumentState()\n    const { offset } = onMoveSelection({\n      json,\n      documentState,\n      deltaY: 0,\n      items\n    })\n\n    dragging = {\n      initialTarget: event.target as Element,\n      initialClientY: event.clientY,\n      initialContentTop: findContentTop(),\n      selectionStartIndex,\n      selectionItemsCount: getSelectionPaths(json, selection).length,\n      items,\n      offset,\n      didMoveItems: false // whether items have been moved during dragging or not\n    }\n    singleton.dragging = true\n\n    document.addEventListener('mousemove', handleDragSelection, true)\n    document.addEventListener('mouseup', handleDragSelectionEnd)\n  }\n\n  function handleDragSelection(event: MouseEvent) {\n    if (dragging) {\n      const json = context.getJson()\n      if (json === undefined) {\n        return\n      }\n      const documentState = context.getDocumentState()\n\n      const deltaY = calculateDeltaY(dragging, event)\n      const { offset } = onMoveSelection({\n        json,\n        documentState,\n        deltaY,\n        items: dragging.items\n      })\n\n      if (offset !== dragging.offset) {\n        debug('drag selection', offset, deltaY)\n\n        dragging = {\n          ...dragging,\n          offset,\n          didMoveItems: true\n        }\n      }\n    }\n  }\n\n  function handleDragSelectionEnd(event: MouseEvent) {\n    if (dragging) {\n      const json = context.getJson()\n      if (json === undefined) {\n        return\n      }\n      const documentState = context.getDocumentState()\n      const deltaY = calculateDeltaY(dragging, event)\n      const { operations, updatedSelection } = onMoveSelection({\n        json,\n        documentState,\n        deltaY,\n        items: dragging.items\n      })\n\n      if (operations) {\n        context.onPatch(operations, (_, patchedState) => ({\n          state: {\n            ...patchedState,\n            selection: updatedSelection || selection\n          }\n        }))\n      } else {\n        // the user did click inside the selection and no contents have been dragged,\n        // select the clicked item\n        if (event.target === dragging.initialTarget && !dragging.didMoveItems) {\n          const selectionType = getSelectionTypeFromTarget(event.target as Element)\n          const path = getDataPathFromTarget(event.target as Element)\n          if (path) {\n            context.onSelect(fromSelectionType(json, selectionType, path))\n          }\n        }\n      }\n\n      dragging = undefined\n      singleton.dragging = false\n\n      document.removeEventListener('mousemove', handleDragSelection, true)\n      document.removeEventListener('mouseup', handleDragSelectionEnd)\n    }\n  }\n\n  /**\n   * Get a list with all visible items and their rendered heights inside\n   * this object or array\n   */\n  // TODO: extract and unit test getVisibleItemsWithHeights\n  function getVisibleItemsWithHeights(\n    selection: JSONSelection,\n    visibleSections: VisibleSection[]\n  ): RenderedItem[] | null {\n    const items: RenderedItem[] = []\n\n    function addHeight(prop: string) {\n      const itemPath = path.concat(prop)\n      const element = context.findElement(itemPath)\n      if (element != null) {\n        items.push({\n          path: itemPath,\n          height: element.clientHeight\n        })\n      }\n    }\n\n    if (Array.isArray(value)) {\n      const json = context.getJson()\n      if (json === undefined) {\n        return null\n      }\n      const startPath = getStartPath(json, selection)\n      const endPath = getEndPath(json, selection)\n      const startIndex = parseInt(last(startPath) as string, 10)\n      const endIndex = parseInt(last(endPath) as string, 10)\n\n      // find the section where the selection is\n      // if the selection is spread over multiple visible sections,\n      // we will not return any items, so dragging will not work there.\n      // We do this to keep things simple for now.\n      const currentSection = visibleSections.find((visibleSection) => {\n        return startIndex >= visibleSection.start && endIndex <= visibleSection.end\n      })\n\n      if (!currentSection) {\n        return null\n      }\n\n      const { start, end } = currentSection\n      forEachIndex(start, Math.min(value.length, end), (index) => addHeight(String(index)))\n    } else {\n      // value is Object\n      Object.keys(value as Record<string, unknown>).forEach(addHeight)\n    }\n\n    return items\n  }\n\n  function handleMouseOver(event: MouseEvent & { currentTarget: EventTarget & HTMLDivElement }) {\n    if (singleton.selecting || singleton.dragging) {\n      return\n    }\n\n    event.stopPropagation()\n\n    if (isChildOfAttribute(event.target as Element, 'data-type', 'selectable-value')) {\n      hover = HOVER_COLLECTION\n    } else if (\n      isChildOfAttribute(event.target as Element, 'data-type', 'insert-selection-area-inside')\n    ) {\n      hover = HOVER_INSERT_INSIDE\n    } else if (\n      isChildOfAttribute(event.target as Element, 'data-type', 'insert-selection-area-after')\n    ) {\n      hover = HOVER_INSERT_AFTER\n    }\n\n    clearTimeout(hoverTimer)\n  }\n\n  function handleMouseOut(event: MouseEvent & { currentTarget: EventTarget & HTMLDivElement }) {\n    event.stopPropagation()\n\n    // to prevent \"flickering\" in the hovering state when hovering on the edge\n    // of the insert area context menu button: it's visibility toggles when\n    // `hover` toggles, which will alternating mouseout and mouseover events\n    hoverTimer = window.setTimeout(() => (hover = undefined))\n  }\n\n  function handleInsertInside(event: MouseEvent) {\n    if (!event.shiftKey) {\n      event.stopPropagation()\n      event.preventDefault()\n\n      context.onSelect(createInsideSelection(path))\n    }\n  }\n\n  function handleInsertAfter(event: MouseEvent) {\n    if (!event.shiftKey) {\n      event.stopPropagation()\n      event.preventDefault()\n\n      context.onSelect(createAfterSelection(path))\n    }\n  }\n\n  function handleInsertInsideOpenContextMenu(contextMenuProps: AbsolutePopupOptions) {\n    context.onSelect(createInsideSelection(path))\n    context.onContextMenu(contextMenuProps)\n  }\n\n  function handleInsertAfterOpenContextMenu(contextMenuProps: AbsolutePopupOptions) {\n    context.onSelect(createAfterSelection(path))\n    context.onContextMenu(contextMenuProps)\n  }\n</script>\n\n<div\n  role=\"treeitem\"\n  tabindex=\"-1\"\n  class={classnames(\n    'jse-json-node',\n    { 'jse-expanded': expanded },\n    context.onClassName(path, value)\n  )}\n  data-path={encodeDataPath(path)}\n  aria-selected={isNodeSelected}\n  style:--level={path.length}\n  class:jse-root={root}\n  class:jse-selected={isNodeSelected && isMultiSelection(selection)}\n  class:jse-selected-key={isNodeSelected && isKeySelection(selection)}\n  class:jse-selected-value={isNodeSelected && isValueSelection(selection)}\n  class:jse-readonly={context.readOnly}\n  class:jse-hovered={hover === HOVER_COLLECTION}\n  on:mousedown={handleMouseDown}\n  on:mousemove={handleMouseMove}\n  on:mouseover={handleMouseOver}\n  on:mouseout={handleMouseOut}\n  on:focus={undefined}\n  on:blur={undefined}\n>\n  {#if Array.isArray(value)}\n    <div class=\"jse-header-outer\">\n      <div class=\"jse-header\">\n        <button\n          type=\"button\"\n          class=\"jse-expand\"\n          on:click={toggleExpand}\n          title=\"Expand or collapse this array (Ctrl+Click to expand/collapse recursively)\"\n        >\n          {#if expanded}\n            <Icon data={faCaretDown} />\n          {:else}\n            <Icon data={faCaretRight} />\n          {/if}\n        </button>\n        <slot name=\"identifier\" />\n        {#if !root}\n          <div class=\"jse-separator\">:</div>\n        {/if}\n        <div class=\"jse-meta\">\n          <div class=\"jse-meta-inner\" data-type=\"selectable-value\">\n            {#if expanded}\n              <div class=\"jse-bracket\">[</div>\n              <span class=\"jse-tag jse-expanded\">\n                {value.length}\n                {value.length === 1 ? 'item' : 'items'}\n              </span>\n              &nbsp;\n            {:else}\n              <div class=\"jse-bracket\">[</div>\n              <button type=\"button\" class=\"jse-tag\" on:click={handleExpand}>\n                {value.length}\n                {value.length === 1 ? 'item' : 'items'}\n              </button>\n              <div class=\"jse-bracket\">]</div>\n            {/if}\n          </div>\n        </div>\n        {#if !context.readOnly && isNodeSelected && selection && (isValueSelection(selection) || isMultiSelection(selection)) && !isEditingSelection(selection) && isEqual(getFocusPath(selection), path)}\n          <div class=\"jse-context-menu-pointer-anchor\">\n            <ContextMenuPointer selected={true} onContextMenu={context.onContextMenu} />\n          </div>\n        {/if}\n      </div>\n      {#if validationError && (!expanded || !validationError.isChildError)}\n        <ValidationErrorIcon {validationError} onExpand={handleExpand} />\n      {/if}\n      {#if expanded}\n        <div\n          role=\"none\"\n          class=\"jse-insert-selection-area jse-inside\"\n          data-type=\"insert-selection-area-inside\"\n          on:click={handleInsertInside}\n        />\n      {:else}\n        <div\n          role=\"none\"\n          class=\"jse-insert-selection-area jse-after\"\n          data-type=\"insert-selection-area-after\"\n          on:click={handleInsertAfter}\n        />\n      {/if}\n    </div>\n    {#if expanded}\n      <div class=\"jse-items\">\n        {#if !context.readOnly && (hover === HOVER_INSERT_INSIDE || (isNodeSelected && isInsideSelection(selection)))}\n          <div\n            class=\"jse-insert-area jse-inside\"\n            class:jse-hovered={hover === HOVER_INSERT_INSIDE}\n            class:jse-selected={isNodeSelected && isInsideSelection(selection)}\n            data-type=\"insert-selection-area-inside\"\n            style:--level={path.length + 1}\n            title={INSERT_EXPLANATION}\n          >\n            <ContextMenuPointer\n              selected={isNodeSelected && isInsideSelection(selection)}\n              onContextMenu={handleInsertInsideOpenContextMenu}\n            />\n          </div>\n        {/if}\n        {#each visibleSections || DEFAULT_VISIBLE_SECTIONS as visibleSection, sectionIndex (sectionIndex)}\n          {#each getItems(path, value, visibleSection, expandedMap, enforceStringMap, visibleSectionsMap, validationErrorsMap, searchResultItemsMap, selection, dragging) as item (item.index)}\n            <svelte:self\n              value={item.value}\n              path={item.path}\n              expandedMap={item.expandedMap}\n              enforceStringMap={item.enforceStringMap}\n              visibleSectionsMap={item.visibleSectionsMap}\n              validationErrorsMap={item.validationErrorsMap}\n              searchResultItemsMap={item.searchResultItemsMap}\n              selection={item.selection}\n              {context}\n              onDragSelectionStart={handleDragSelectionStart}\n            >\n              <div slot=\"identifier\" class=\"jse-identifier\">\n                <div class=\"jse-index\">{item.index}</div>\n              </div>\n            </svelte:self>\n          {/each}\n          {#if visibleSection.end < value.length}\n            <CollapsedItems\n              visibleSections={visibleSections || DEFAULT_VISIBLE_SECTIONS}\n              {sectionIndex}\n              total={value.length}\n              {path}\n              onExpandSection={context.onExpandSection}\n              {selection}\n              {context}\n            />\n          {/if}\n        {/each}\n      </div>\n      <div class=\"jse-footer-outer\">\n        <div data-type=\"selectable-value\" class=\"jse-footer\">\n          <span class=\"jse-bracket\">]</span>\n        </div>\n        {#if !root}\n          <div\n            role=\"none\"\n            class=\"jse-insert-selection-area jse-after\"\n            data-type=\"insert-selection-area-after\"\n            on:click={handleInsertAfter}\n          />\n        {/if}\n      </div>\n    {/if}\n  {:else if isObject(value)}\n    <div class=\"jse-header-outer\">\n      <div class=\"jse-header\">\n        <button\n          type=\"button\"\n          class=\"jse-expand\"\n          on:click={toggleExpand}\n          title=\"Expand or collapse this object (Ctrl+Click to expand/collapse recursively)\"\n        >\n          {#if expanded}\n            <Icon data={faCaretDown} />\n          {:else}\n            <Icon data={faCaretRight} />\n          {/if}\n        </button>\n        <slot name=\"identifier\" />\n        {#if !root}\n          <div class=\"jse-separator\">:</div>\n        {/if}\n        <div class=\"jse-meta\" data-type=\"selectable-value\">\n          <div class=\"jse-meta-inner\">\n            {#if expanded}\n              <div class=\"jse-bracket jse-expanded\">&lbrace;</div>\n            {:else}\n              <div class=\"jse-bracket\">&lbrace;</div>\n              <button type=\"button\" class=\"jse-tag\" on:click={handleExpand}>\n                {Object.keys(value).length}\n                {Object.keys(value).length === 1 ? 'prop' : 'props'}\n              </button>\n              <div class=\"jse-bracket\">&rbrace;</div>\n            {/if}\n          </div>\n        </div>\n        {#if !context.readOnly && isNodeSelected && selection && (isValueSelection(selection) || isMultiSelection(selection)) && !isEditingSelection(selection) && isEqual(getFocusPath(selection), path)}\n          <div class=\"jse-context-menu-pointer-anchor\">\n            <ContextMenuPointer selected={true} onContextMenu={context.onContextMenu} />\n          </div>\n        {/if}\n      </div>\n      {#if validationError && (!expanded || !validationError.isChildError)}\n        <ValidationErrorIcon {validationError} onExpand={handleExpand} />\n      {/if}\n      {#if expanded}\n        <div\n          role=\"none\"\n          class=\"jse-insert-selection-area jse-inside\"\n          data-type=\"insert-selection-area-inside\"\n          on:click={handleInsertInside}\n        />\n      {:else if !root}\n        <div\n          role=\"none\"\n          class=\"jse-insert-selection-area jse-after\"\n          data-type=\"insert-selection-area-after\"\n          on:click={handleInsertAfter}\n        />\n      {/if}\n    </div>\n    {#if expanded}\n      <div class=\"jse-props\">\n        {#if !context.readOnly && (hover === HOVER_INSERT_INSIDE || (isNodeSelected && isInsideSelection(selection)))}\n          <div\n            class=\"jse-insert-area jse-inside\"\n            class:jse-hovered={hover === HOVER_INSERT_INSIDE}\n            class:jse-selected={isNodeSelected && isInsideSelection(selection)}\n            data-type=\"insert-selection-area-inside\"\n            style:--level={path.length + 1}\n            title={INSERT_EXPLANATION}\n          >\n            <ContextMenuPointer\n              selected={isNodeSelected && isInsideSelection(selection)}\n              onContextMenu={handleInsertInsideOpenContextMenu}\n            />\n          </div>\n        {/if}\n        {#each getProps(path, value, expandedMap, enforceStringMap, visibleSectionsMap, validationErrorsMap, searchResultItemsMap, selection, dragging) as prop}\n          <svelte:self\n            value={prop.value}\n            path={prop.path}\n            expandedMap={prop.expandedMap}\n            enforceStringMap={prop.enforceStringMap}\n            visibleSectionsMap={prop.visibleSectionsMap}\n            validationErrorsMap={prop.validationErrorsMap}\n            searchResultItemsMap={prop.valueSearchResultItemsMap}\n            selection={prop.selection}\n            {context}\n            onDragSelectionStart={handleDragSelectionStart}\n          >\n            <div slot=\"identifier\" class=\"jse-identifier\">\n              <JSONKey\n                path={prop.path}\n                key={prop.key}\n                selection={prop.selection}\n                searchResultItems={prop.keySearchResultItemsMap}\n                {context}\n                onUpdateKey={handleUpdateKey}\n              />\n            </div>\n          </svelte:self>\n        {/each}\n      </div>\n      <div class=\"jse-footer-outer\">\n        <div data-type=\"selectable-value\" class=\"jse-footer\">\n          <div class=\"jse-bracket\">&rbrace;</div>\n        </div>\n        {#if !root}\n          <div\n            role=\"none\"\n            class=\"jse-insert-selection-area jse-after\"\n            data-type=\"insert-selection-area-after\"\n            on:click={handleInsertAfter}\n          />\n        {/if}\n      </div>\n    {/if}\n  {:else}\n    <div class=\"jse-contents-outer\">\n      <div class=\"jse-contents\">\n        <slot name=\"identifier\" />\n        {#if !root}\n          <div class=\"jse-separator\">:</div>\n        {/if}\n        <JSONValue\n          {path}\n          {value}\n          enforceString={enforceString || false}\n          selection={isNodeSelected ? selection : null}\n          searchResultItems={filterValueSearchResults(searchResultItemsMap, pointer)}\n          {context}\n        />\n        {#if !context.readOnly && isNodeSelected && selection && (isValueSelection(selection) || isMultiSelection(selection)) && !isEditingSelection(selection) && isEqual(getFocusPath(selection), path)}\n          <div class=\"jse-context-menu-pointer-anchor\">\n            <ContextMenuPointer selected={true} onContextMenu={context.onContextMenu} />\n          </div>\n        {/if}\n      </div>\n      {#if validationError}\n        <ValidationErrorIcon {validationError} onExpand={handleExpand} />\n      {/if}\n      {#if !root}\n        <div\n          role=\"none\"\n          class=\"jse-insert-selection-area jse-after\"\n          data-type=\"insert-selection-area-after\"\n          on:click={handleInsertAfter}\n        />\n      {/if}\n    </div>\n  {/if}\n  {#if !context.readOnly && (hover === HOVER_INSERT_AFTER || (isNodeSelected && isAfterSelection(selection)))}\n    <div\n      class=\"jse-insert-area jse-after\"\n      class:jse-hovered={hover === HOVER_INSERT_AFTER}\n      class:jse-selected={isNodeSelected && isAfterSelection(selection)}\n      data-type=\"insert-selection-area-after\"\n      title={INSERT_EXPLANATION}\n    >\n      <ContextMenuPointer\n        selected={isNodeSelected && isAfterSelection(selection)}\n        onContextMenu={handleInsertAfterOpenContextMenu}\n      />\n    </div>\n  {/if}\n</div>\n\n<style src=\"./JSONNode.scss\"></style>\n","import type { IconDefinition } from '@fortawesome/free-solid-svg-icons'\nimport type { IconName } from '@fortawesome/fontawesome-common-types'\n\nexport const faJSONEditorExpand: IconDefinition = {\n  prefix: 'fas',\n  iconName: 'jsoneditor-expand' as IconName,\n  icon: [\n    512,\n    512,\n    [],\n    '',\n    'M 0,448 V 512 h 512 v -64 z ' +\n      'M 0,0 V 64 H 512 V 0 Z ' +\n      'M 256,96 128,224 h 256 z ' +\n      'M 256,416 384,288 H 128 Z'\n  ]\n}\n\nexport const faJSONEditorCollapse: IconDefinition = {\n  prefix: 'fas',\n  iconName: 'jsoneditor-collapse' as IconName,\n  icon: [\n    512,\n    512,\n    [],\n    '',\n    'm 0,224 v 64 h 512 v -64 z ' + 'M 256,192 384,64 H 128 Z ' + 'M 256,320 128,448 h 256 z'\n  ]\n}\n\nexport const faJSONEditorFormat: IconDefinition = {\n  prefix: 'fas',\n  iconName: 'jsoneditor-format' as IconName,\n  icon: [\n    512,\n    512,\n    [],\n    '',\n    'M 0,32 v 64 h 416 v -64 z ' +\n      'M 160,160 v 64 h 352 v -64 z ' +\n      'M 160,288 v 64 h 288 v -64 z ' +\n      'M 0,416 v 64 h 320 v -64 z'\n  ]\n}\n\nexport const faJSONEditorCompact: IconDefinition = {\n  prefix: 'fas',\n  iconName: 'jsoneditor-compact' as IconName,\n  icon: [\n    512,\n    512,\n    [],\n    '',\n    'M 0,32 v 64 h 512 v -64 z ' + 'M 0,160 v 64 h 512 v -64 z ' + 'M 0,288 v 64 h 352 v -64 z'\n  ]\n}\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import {\n    faCopy,\n    faEllipsisV,\n    faFilter,\n    faRedo,\n    faSearch,\n    faSortAmountDownAlt,\n    faUndo\n  } from '@fortawesome/free-solid-svg-icons'\n  import { CONTEXT_MENU_EXPLANATION } from '$lib/constants.js'\n  import { faJSONEditorCollapse, faJSONEditorExpand } from '$lib/img/customFontawesomeIcons.js'\n  import { isObjectOrArray } from '$lib/utils/typeUtils.js'\n  import Menu from '../../../controls/Menu.svelte'\n  import type { JSONSelection, MenuItem, OnRenderMenuInternal } from '$lib/types'\n  import { isKeySelection, isMultiSelection, isValueSelection } from '$lib/logic/selection.js'\n  import type { HistoryState } from '$lib/logic/history.js'\n\n  export let json: unknown\n  export let selection: JSONSelection | null\n\n  export let readOnly: boolean\n  export let showSearch = false\n  export let historyState: HistoryState\n\n  export let onExpandAll: () => void\n  export let onCollapseAll: () => void\n  export let onUndo: () => void\n  export let onRedo: () => void\n  export let onSort: () => void\n  export let onTransform: () => void\n  export let onContextMenu: (event: MouseEvent) => void\n  export let onCopy: () => void\n  export let onRenderMenu: OnRenderMenuInternal\n\n  function handleToggleSearch() {\n    showSearch = !showSearch\n  }\n\n  $: hasJson = json !== undefined\n  $: hasSelectionContents =\n    hasJson &&\n    (isMultiSelection(selection) || isKeySelection(selection) || isValueSelection(selection))\n\n  let expandMenuItem: MenuItem\n  $: expandMenuItem = {\n    type: 'button',\n    icon: faJSONEditorExpand,\n    title: 'Expand all',\n    className: 'jse-expand-all',\n    onClick: onExpandAll,\n    disabled: !isObjectOrArray(json)\n  }\n\n  let collapseMenuItem: MenuItem\n  $: collapseMenuItem = {\n    type: 'button',\n    icon: faJSONEditorCollapse,\n    title: 'Collapse all',\n    className: 'jse-collapse-all',\n    onClick: onCollapseAll,\n    disabled: !isObjectOrArray(json)\n  }\n\n  let searchMenuItem: MenuItem\n  $: searchMenuItem = {\n    type: 'button',\n    icon: faSearch,\n    title: 'Search (Ctrl+F)',\n    className: 'jse-search',\n    onClick: handleToggleSearch,\n    disabled: json === undefined\n  }\n\n  let defaultItems: MenuItem[]\n  $: defaultItems = !readOnly\n    ? [\n        expandMenuItem,\n        collapseMenuItem,\n        {\n          type: 'separator'\n        },\n        {\n          type: 'button',\n          icon: faSortAmountDownAlt,\n          title: 'Sort',\n          className: 'jse-sort',\n          onClick: onSort,\n          disabled: readOnly || json === undefined\n        },\n        {\n          type: 'button',\n          icon: faFilter,\n          title: 'Transform contents (filter, sort, project)',\n          className: 'jse-transform',\n          onClick: onTransform,\n          disabled: readOnly || json === undefined\n        },\n        searchMenuItem,\n        {\n          type: 'button',\n          icon: faEllipsisV,\n          title: CONTEXT_MENU_EXPLANATION,\n          className: 'jse-contextmenu',\n          onClick: onContextMenu\n        },\n        {\n          type: 'separator'\n        },\n        {\n          type: 'button',\n          icon: faUndo,\n          title: 'Undo (Ctrl+Z)',\n          className: 'jse-undo',\n          onClick: onUndo,\n          disabled: !historyState.canUndo\n        },\n        {\n          type: 'button',\n          icon: faRedo,\n          title: 'Redo (Ctrl+Shift+Z)',\n          className: 'jse-redo',\n          onClick: onRedo,\n          disabled: !historyState.canRedo\n        },\n        {\n          type: 'space'\n        }\n      ]\n    : [\n        expandMenuItem,\n        collapseMenuItem,\n        {\n          type: 'separator'\n        },\n        {\n          type: 'button',\n          icon: faCopy,\n          title: 'Copy (Ctrl+C)',\n          className: 'jse-copy',\n          onClick: onCopy,\n          disabled: !hasSelectionContents\n        },\n        {\n          type: 'separator'\n        },\n        searchMenuItem,\n        {\n          type: 'space'\n        }\n      ]\n\n  $: items = onRenderMenu(defaultItems)\n</script>\n\n<Menu {items} />\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  export let readOnly: boolean\n  export let onCreateArray: () => void\n  export let onCreateObject: () => void\n  export let onClick: () => void\n</script>\n\n<div class=\"jse-welcome\" on:click={() => onClick()} role=\"none\">\n  <div class=\"jse-space jse-before\" />\n  <div class=\"jse-contents\">\n    <div class=\"jse-welcome-title\">Empty document</div>\n    {#if !readOnly}\n      <div class=\"jse-welcome-info\">\n        You can paste clipboard data using <b>Ctrl+V</b>, or use the following options:\n      </div>\n      <button\n        title={\"Create an empty JSON object (press '{')\"}\n        on:click|stopPropagation={() => onCreateObject()}>Create object</button\n      >\n      <button\n        title={\"Create an empty JSON array (press '[')\"}\n        on:click|stopPropagation={() => onCreateArray()}>Create array</button\n      >\n    {/if}\n  </div>\n  <div class=\"jse-space jse-after\" />\n</div>\n\n<style src=\"./Welcome.scss\"></style>\n","import diffSequence from '../generated/diffSequence.js'\nimport type { JSONPatchDocument, JSONPatchOperation, JSONPath } from 'immutable-json-patch'\nimport {\n  compileJSONPointer,\n  getIn,\n  isJSONArray,\n  isJSONPatchCopy,\n  isJSONPatchMove,\n  parseFrom,\n  parsePath,\n  setIn\n} from 'immutable-json-patch'\nimport { first, initial, isEmpty, isEqual, last } from 'lodash-es'\nimport naturalCompare from 'natural-compare-lite'\nimport { int } from '../utils/numberUtils.js'\nimport { isObject } from '../utils/typeUtils.js'\n\nexport function caseInsensitiveNaturalCompare(a: unknown, b: unknown) {\n  const aLower = typeof a === 'string' ? a.toLowerCase() : a\n  const bLower = typeof b === 'string' ? b.toLowerCase() : b\n\n  return naturalCompare(aLower, bLower)\n}\n\n/**\n * Sort a JSON object or array\n * @param json           The the JSON containing the (optionally nested)\n *                       object to be sorted\n * @param [rootPath=[]]  Relative path when the array was located\n * @param [itemPath=[]]  Item path by which to sort items in case of an array\n * @param [direction=1]  Pass 1 to sort ascending, -1 to sort descending\n * @return               Returns a JSONPatch document with move operation\n *                       to get the array sorted.\n */\nexport function sortJson(\n  json: unknown,\n  rootPath: JSONPath = [],\n  itemPath: JSONPath = [],\n  direction: 1 | -1 = 1\n): JSONPatchDocument {\n  if (isJSONArray(getIn(json, rootPath))) {\n    if (itemPath === undefined) {\n      throw new Error('Cannot sort: no property selected by which to sort the array')\n    }\n\n    return sortArray(json, rootPath, itemPath, direction)\n  }\n\n  if (isObject(json)) {\n    return sortObjectKeys(json, rootPath, direction)\n  }\n\n  throw new Error('Cannot sort: no array or object')\n}\n\n/**\n * Sort the keys of an object\n * @param json           The the JSON containing the (optionally nested)\n *                       object to be sorted\n * @param [rootPath=[]]  Relative path when the array was located\n * @param [direction=1]  Pass 1 to sort ascending, -1 to sort descending\n * @return               Returns a JSONPatch document with move operation\n *                       to get the array sorted.\n */\nexport function sortObjectKeys(\n  json: unknown,\n  rootPath: JSONPath = [],\n  direction: 1 | -1 = 1\n): JSONPatchDocument {\n  const object = getIn(json, rootPath)\n  const keys = Object.keys(object as unknown as Record<string, unknown>)\n  const sortedKeys = keys.slice()\n\n  sortedKeys.sort((keyA, keyB) => {\n    return direction * caseInsensitiveNaturalCompare(keyA, keyB)\n  })\n\n  // TODO: can we make this more efficient? check if the first couple of keys are already in order and if so ignore them\n  const operations: JSONPatchDocument = []\n  for (let i = 0; i < sortedKeys.length; i++) {\n    const key = sortedKeys[i]\n    const path = compileJSONPointer(rootPath.concat(key))\n    operations.push({\n      op: 'move',\n      from: path,\n      path\n    })\n  }\n\n  return operations\n}\n\n/**\n * Sort the items of an array\n * @param json               The document containing (optionally nested)\n *                           the array to be sorted.\n * @param [rootPath=[]]      Relative path when the array was located\n * @param [propertyPath=[]]  Nested path to the property on which to sort the contents\n * @param [direction=1]      Pass 1 to sort ascending, -1 to sort descending\n * @return                   Returns a JSONPatch document with move operation\n *                           to get the array sorted.\n */\nexport function sortArray(\n  json: unknown,\n  rootPath: JSONPath = [],\n  propertyPath: JSONPath = [],\n  direction: 1 | -1 = 1\n): JSONPatchDocument {\n  const comparator = createObjectComparator(propertyPath, direction)\n\n  // TODO: make the mechanism to sort configurable? Like use sortOperationsMove and sortOperationsMoveAdvanced\n  const array = getIn(json, rootPath) as Array<unknown>\n  return [\n    {\n      op: 'replace',\n      path: compileJSONPointer(rootPath),\n      value: array.slice(0).sort(comparator)\n    }\n  ]\n}\n\n/**\n * Create a comparator function to compare nested properties in an array\n */\nfunction createObjectComparator(propertyPath: JSONPath, direction: 1 | -1) {\n  return function comparator(a: unknown, b: unknown) {\n    const valueA = getIn(a, propertyPath)\n    const valueB = getIn(b, propertyPath)\n\n    if (valueA === undefined) {\n      return direction\n    }\n    if (valueB === undefined) {\n      return -direction\n    }\n\n    if (typeof valueA !== 'string' && typeof valueB !== 'string') {\n      // both values are a number, boolean, or null -> use simple, fast sorting\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      return valueA > valueB ? direction : valueA < valueB ? -direction : 0\n    }\n\n    return direction * caseInsensitiveNaturalCompare(valueA, valueB)\n  }\n}\n\n/**\n * Create a list with JSON Patch move operations\n * needed to sort the array contents.\n */\nexport function sortOperationsMove<T>(\n  array: T[],\n  comparator: (a: T, b: T) => number\n): JSONPatchOperation[] {\n  const operations: JSONPatchOperation[] = []\n  const sorted = []\n\n  // TODO: rewrite the function to pass a callback instead of returning an array?\n  for (let i = 0; i < array.length; i++) {\n    // TODO: can we simplify the following code?\n    const item = array[i]\n    if (i > 0 && comparator(sorted[i - 1], item) > 0) {\n      let j = i - 1\n      while (j > 0 && comparator(sorted[j - 1], item) > 0) {\n        j--\n      }\n\n      operations.push({\n        op: 'move',\n        from: '/' + i,\n        path: '/' + j\n      })\n\n      sorted.splice(j, 0, item)\n    } else {\n      sorted.push(item)\n    }\n  }\n\n  return operations\n}\n\n/**\n * Create an array containing all move operations\n * needed to sort the array contents.\n */\nexport function sortOperationsMoveAdvanced<T>(\n  array: T[],\n  comparator: (a: T, b: T) => number\n): JSONPatchOperation[] {\n  const moves: { from: number; to: number }[] = []\n\n  const sortedIndices = array\n    .map((item, index) => ({ item, index }))\n    .sort((a, b) => comparator(a.item, b.item))\n    .map((entry) => entry.index)\n\n  let bIndex = 0\n\n  function foundSubsequence(nCommon: number, aCommon: number, bCommon: number) {\n    for (let b = bIndex; b < bCommon; b++) {\n      moves.push({\n        from: sortedIndices[b],\n        to: aCommon\n      })\n    }\n\n    bIndex = bCommon + nCommon\n  }\n\n  const size = array.length\n\n  function isCommon(aIndex: number, bIndex: number) {\n    return aIndex === sortedIndices[bIndex]\n  }\n\n  diffSequence(size, size, isCommon, foundSubsequence)\n  foundSubsequence(0, size, size)\n\n  // every move will change the actual indices, so we've to adjust for that\n  // in all moves that still have to be executed\n  for (let i = 0; i < moves.length; i++) {\n    if (moves[i].to > moves[i].from) {\n      moves[i].to--\n    }\n\n    const { from, to } = moves[i]\n\n    for (let j = i + 1; j < moves.length; j++) {\n      const other = moves[j]\n      if (other.from >= from) {\n        other.from--\n      }\n      if (other.to >= from) {\n        other.to--\n      }\n      if (other.from >= to) {\n        other.from++\n      }\n      if (other.to >= to) {\n        other.to++\n      }\n    }\n  }\n\n  return moves.map(({ from, to }) => {\n    return {\n      op: 'move',\n      from: '/' + from,\n      path: '/' + to\n    }\n  })\n}\n\n/**\n * Fast solution to apply many JSON patch move operations inside a single array,\n * like applying all moves needed to sort an array.\n *\n * Throws an error when not all operations are move operation inside the same\n * array.\n */\n// TODO: write unit tests\nexport function fastPatchSort(json: unknown, operations: JSONPatchDocument): unknown {\n  if (isEmpty(operations)) {\n    // nothing to do :)\n    return json\n  }\n\n  // validate whether all operations are \"move\" operations\n  const invalidOp = operations.find((operation) => {\n    return operation.op !== 'move'\n  })\n  if (invalidOp) {\n    throw new Error(\n      'Cannot apply fastPatchSort: not a \"move\" operation ' +\n        '(actual: ' +\n        JSON.stringify(invalidOp) +\n        ')'\n    )\n  }\n\n  // parse all paths\n  const parsedOperations: Array<{ from: JSONPath | undefined; path: JSONPath }> = operations.map(\n    (operation) => ({\n      from:\n        isJSONPatchCopy(operation) || isJSONPatchMove(operation)\n          ? parseFrom(operation.from)\n          : undefined,\n      path: parsePath(json, operation.path)\n    })\n  )\n\n  // validate whether the move actions take place in an array\n  const arrayPath = initial(first(parsedOperations)?.path)\n  const array = getIn(json, arrayPath)\n  if (!Array.isArray(array)) {\n    throw new Error(\n      'Cannot apply fastPatchSort: not an Array ' + '(path: ' + JSON.stringify(arrayPath) + ')'\n    )\n  }\n\n  // validate whether all paths are in the same array\n  const invalidPath = parsedOperations.find((parsedOperation) => {\n    return (\n      !isEqual(arrayPath, initial(parsedOperation.path)) ||\n      !isEqual(arrayPath, initial(parsedOperation.from))\n    )\n  })\n  if (invalidPath) {\n    throw new Error(\n      'Cannot apply fastPatchSort: not all move operations are in the same array ' +\n        '(expected: ' +\n        JSON.stringify(arrayPath) +\n        ', actual: ' +\n        JSON.stringify(invalidPath) +\n        ')'\n    )\n  }\n\n  // apply the actual operations on the same array. Only copy the only array once\n  const updatedArray = array.slice(0)\n  parsedOperations.forEach((parsedOperation) => {\n    const toIndex = int(last(parsedOperation.path) || '-1')\n    const fromIndex = int(last(parsedOperation.from) || '-1')\n\n    const value = updatedArray.splice(fromIndex, 1)[0]\n    updatedArray.splice(toIndex, 0, value)\n  })\n\n  return setIn(json, arrayPath, updatedArray)\n}\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { limit } from '$lib/utils/arrayUtils.js'\n  import { truncate } from '$lib/utils/stringUtils.js'\n\n  export let items: (string | number)[]\n  export let selectedItem: string | number\n  export let onSelect: (item: string | number) => void\n\n  const MAX_ITEMS = 100\n  const MAX_ITEM_CHARACTERS = 30\n</script>\n\n<div class=\"jse-navigation-bar-dropdown\">\n  {#each limit(items, MAX_ITEMS) as item (item)}\n    <button\n      type=\"button\"\n      class=\"jse-navigation-bar-dropdown-item\"\n      class:jse-selected={item === selectedItem}\n      on:click|stopPropagation={() => onSelect(item)}\n      title={item.toString()}\n    >\n      {truncate(item.toString(), MAX_ITEM_CHARACTERS)}\n    </button>\n  {/each}\n  {#if items.length > MAX_ITEMS}\n    <button\n      type=\"button\"\n      class=\"jse-navigation-bar-dropdown-item\"\n      title=\"Limited to {MAX_ITEMS} items\"\n    >\n      ...\n    </button>\n  {/if}\n</div>\n\n<style src=\"./NavigationBarDropdown.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import Icon from 'svelte-awesome'\n  import { faAngleRight } from '@fortawesome/free-solid-svg-icons'\n  import NavigationBarDropdown from '../../../components/controls/navigationBar/NavigationBarDropdown.svelte'\n  import { getContext } from 'svelte'\n  import type { JSONPath } from 'immutable-json-patch'\n  import type { AbsolutePopupContext } from '$lib/types'\n\n  const { openAbsolutePopup, closeAbsolutePopup } =\n    getContext<AbsolutePopupContext>('absolute-popup')\n\n  export let path: JSONPath\n  export let index: number\n  export let onSelect: (path: JSONPath) => void\n  export let getItems: (path: JSONPath) => string[]\n\n  let refNavigationBarItem: Element | undefined\n  let open = false\n  let popupId: number | undefined\n\n  $: itemPath = path.slice(0, index)\n  $: selectedItem = path[index]\n\n  function handleSelectItem(item: string) {\n    closeAbsolutePopup(popupId)\n    onSelect(itemPath.concat(item))\n  }\n\n  function openDropdown() {\n    if (refNavigationBarItem) {\n      open = true\n\n      const props = {\n        items: getItems(itemPath),\n        selectedItem,\n        onSelect: handleSelectItem\n      }\n\n      popupId = openAbsolutePopup(NavigationBarDropdown, props, {\n        anchor: refNavigationBarItem,\n        closeOnOuterClick: true,\n        onClose: () => {\n          open = false\n        }\n      })\n    }\n  }\n</script>\n\n<div class=\"jse-navigation-bar-item\" bind:this={refNavigationBarItem}>\n  <button\n    type=\"button\"\n    class=\"jse-navigation-bar-button jse-navigation-bar-arrow\"\n    class:jse-open={open}\n    on:click={openDropdown}\n  >\n    <Icon data={faAngleRight} />\n  </button>\n  {#if selectedItem !== undefined}\n    <button\n      type=\"button\"\n      class=\"jse-navigation-bar-button\"\n      on:click={() => handleSelectItem(selectedItem)}\n    >\n      {selectedItem}\n    </button>\n  {/if}\n</div>\n\n<style src=\"./NavigationBarItem.scss\"></style>\n","export default function copyToClipBoard(text: string): Promise<void> | void {\n  if (navigator.clipboard) {\n    return navigator.clipboard.writeText(text)\n  }\n  // Compatible with old browsers such as Chrome <=65, Edge <=18 & IE\n  // Compatible with HTTP\n  else if (document.queryCommandSupported?.('copy')) {\n    const textarea = document.createElement('textarea')\n    textarea.value = text\n\n    textarea.style.position = 'fixed' // Avoid scrolling to bottom\n    textarea.style.opacity = '0'\n\n    document.body.appendChild(textarea)\n    textarea.select()\n\n    // Security exception may be thrown by some browsers\n    try {\n      document.execCommand('copy')\n    } catch (e) {\n      console.error(e)\n    } finally {\n      document.body.removeChild(textarea)\n    }\n  } else {\n    console.error('Copy failed.')\n  }\n}\n","<script lang=\"ts\">\n  import type { JSONPath } from 'immutable-json-patch'\n  import { getContext, onDestroy, onMount } from 'svelte'\n  import copyToClipBoard from '$lib/utils/copyToClipboard.js'\n  import { faCopy, faExclamationTriangle } from '@fortawesome/free-solid-svg-icons'\n  import Icon from 'svelte-awesome'\n  import { keyComboFromEvent } from '$lib/utils/keyBindings.js'\n  import { tooltip } from '../../controls/tooltip/tooltip.js'\n  import type { AbsolutePopupContext, JSONPathParser, OnError } from '$lib/types.js'\n\n  const absolutePopupContext = getContext<AbsolutePopupContext>('absolute-popup')\n\n  export let path: JSONPath\n  export let pathParser: JSONPathParser\n  export let onChange: (updatedPath: JSONPath) => void\n  export let onClose: () => void\n  export let onError: OnError\n  export let pathExists: (path: JSONPath) => boolean\n\n  let inputRef: HTMLInputElement\n  let inputPath: string\n  let validationActive = false\n  $: inputPath = pathParser.stringify(path)\n  $: inputValidationError = validationActive ? parseAndValidate(inputPath).error : undefined\n\n  let copiedTimer: number | undefined = undefined\n  let copied = false\n  const copiedDelay = 1000 // ms\n\n  onMount(() => {\n    focus()\n  })\n\n  onDestroy(() => {\n    clearTimeout(copiedTimer)\n  })\n\n  function focus() {\n    inputRef.focus()\n  }\n\n  function parseAndValidate(pathStr: string): {\n    path: JSONPath | undefined\n    error: Error | undefined\n  } {\n    try {\n      const path = pathParser.parse(pathStr)\n      validatePathExists(path)\n      return {\n        path,\n        error: undefined\n      }\n    } catch (error) {\n      return {\n        path: undefined,\n        error: error as Error\n      }\n    }\n  }\n\n  function validatePathExists(path: JSONPath) {\n    if (!pathExists(path)) {\n      throw new Error('Path does not exist in current document')\n    }\n  }\n\n  function handleInput(event: Event & { currentTarget: EventTarget & HTMLInputElement }) {\n    inputPath = event.currentTarget.value\n  }\n\n  function handleKeyDown(event: KeyboardEvent) {\n    const combo = keyComboFromEvent(event)\n\n    if (combo === 'Escape') {\n      onClose()\n    }\n\n    if (combo === 'Enter') {\n      validationActive = true\n      const result = parseAndValidate(inputPath)\n      if (result.path !== undefined) {\n        onChange(result.path)\n      } else {\n        onError(result.error as Error)\n      }\n    }\n  }\n\n  function handleCopy() {\n    copyToClipBoard(inputPath)\n    copied = true\n    copiedTimer = window.setTimeout(() => (copied = false), copiedDelay)\n    focus()\n  }\n</script>\n\n<div class=\"jse-navigation-bar-path-editor\" class:error={inputValidationError}>\n  <input\n    type=\"text\"\n    class=\"jse-navigation-bar-text\"\n    value={inputPath}\n    bind:this={inputRef}\n    on:keydown|stopPropagation={handleKeyDown}\n    on:input={handleInput}\n  />\n  {#if inputValidationError}\n    <button\n      type=\"button\"\n      class=\"jse-navigation-bar-validation-error\"\n      use:tooltip={{\n        text: String(inputValidationError || ''),\n        ...absolutePopupContext\n      }}\n    >\n      <Icon data={faExclamationTriangle} />\n    </button>\n  {/if}\n  {#if copied}\n    <div class=\"jse-copied-text\">Copied!</div>\n  {/if}\n  <button\n    type=\"button\"\n    class=\"jse-navigation-bar-copy\"\n    class:copied\n    title=\"Copy selected path to the clipboard\"\n    on:click={handleCopy}\n  >\n    <Icon data={faCopy} />\n  </button>\n</div>\n\n<style src=\"./NavigationBarPathEditor.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import type { JSONPath } from 'immutable-json-patch'\n  import { existsIn, getIn } from 'immutable-json-patch'\n  import { range } from 'lodash-es'\n  import { isObject, isObjectOrArray } from '$lib/utils/typeUtils.js'\n  import { createMultiSelection, getFocusPath } from '$lib/logic/selection.js'\n  import { createDebug } from '$lib/utils/debug.js'\n  import { caseInsensitiveNaturalCompare } from '$lib/logic/sort.js'\n  import type { JSONPathParser, JSONSelection, OnError, OnJSONSelect } from '$lib/types.js'\n  import Icon from 'svelte-awesome'\n  import { faClose, faEdit } from '@fortawesome/free-solid-svg-icons'\n  import NavigationBarItem from './NavigationBarItem.svelte'\n  import NavigationBarPathEditor from './NavigationBarPathEditor.svelte'\n\n  const debug = createDebug('jsoneditor:NavigationBar')\n\n  export let json: unknown\n  export let selection: JSONSelection | null\n  export let onSelect: OnJSONSelect\n  export let onError: OnError\n  export let pathParser: JSONPathParser\n\n  let refNavigationBar: Element | undefined\n  let editing = false\n\n  $: path = selection ? getFocusPath(selection) : []\n  $: hasNextItem = isObjectOrArray(getIn(json, path))\n\n  // we have an unused parameter path to trigger scrollToLastItem when path changes,\n  // see $: scrollToLastItem(path)\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  function scrollToLastItem(path: JSONPath) {\n    setTimeout(() => {\n      if (refNavigationBar && refNavigationBar.scrollTo) {\n        const left = refNavigationBar.scrollWidth - refNavigationBar.clientWidth\n        if (left > 0) {\n          debug('scrollTo ', left)\n          refNavigationBar.scrollTo({ left, behavior: 'smooth' })\n        }\n      }\n    })\n  }\n\n  // trigger scrollToLastItem when path changes\n  $: scrollToLastItem(path)\n\n  function getItems(path: JSONPath): string[] {\n    debug('get items for path', path)\n\n    const node = getIn(json, path)\n    if (Array.isArray(node)) {\n      return range(0, node.length).map(String)\n    } else if (isObject(node)) {\n      const keys = Object.keys(node)\n\n      const sortedKeys = keys.slice(0)\n      sortedKeys.sort(caseInsensitiveNaturalCompare)\n\n      return sortedKeys\n    } else {\n      // never happens but just for robustness...\n      return []\n    }\n  }\n\n  function pathExists(path: JSONPath): boolean {\n    return existsIn(json, path)\n  }\n\n  function handleSelect(path: JSONPath) {\n    debug('select path', JSON.stringify(path))\n\n    onSelect(createMultiSelection(path, path))\n  }\n\n  function toggleEditing() {\n    editing = !editing\n  }\n\n  function handleCloseEditor() {\n    editing = false\n  }\n\n  function handleChangePath(path: JSONPath) {\n    handleCloseEditor()\n    handleSelect(path)\n  }\n</script>\n\n<div class=\"jse-navigation-bar\" bind:this={refNavigationBar}>\n  {#if !editing}\n    <!-- eslint-disable-next-line @typescript-eslint/no-unused-vars -->\n    {#each path as item, index (index)}\n      <NavigationBarItem {getItems} {path} {index} onSelect={handleSelect} />\n    {/each}\n    {#if hasNextItem}\n      <NavigationBarItem {getItems} {path} index={path.length} onSelect={handleSelect} />\n    {/if}\n  {:else}\n    <NavigationBarPathEditor\n      {path}\n      onClose={handleCloseEditor}\n      onChange={handleChangePath}\n      {onError}\n      {pathExists}\n      {pathParser}\n    />\n  {/if}\n\n  <button\n    type=\"button\"\n    class=\"jse-navigation-bar-edit\"\n    class:flex={!editing}\n    class:editing\n    title={editing ? 'Cancel editing the selected path' : 'Edit the selected path'}\n    on:click={toggleEditing}\n  >\n    <span class=\"jse-navigation-bar-space\">\n      <!-- ensure the right height (arrows have less height than the text) -->\n      {!isObjectOrArray(json) && !editing ? 'Navigation bar' : '\\u00A0'}\n    </span>\n\n    <Icon data={editing ? faClose : faEdit} />\n  </button>\n</div>\n\n<style src=\"./NavigationBar.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { debounce } from 'lodash-es'\n  import Icon from 'svelte-awesome'\n  import {\n    faCaretDown,\n    faCaretRight,\n    faChevronDown,\n    faChevronUp,\n    faCircleNotch,\n    faSearch,\n    faTimes\n  } from '@fortawesome/free-solid-svg-icons'\n  import { DEBOUNCE_DELAY, MAX_SEARCH_RESULTS } from '$lib/constants.js'\n  import { keyComboFromEvent } from '$lib/utils/keyBindings.js'\n  import { createDebug } from '$lib/utils/debug.js'\n  import type { DocumentState, JSONParser, OnPatch, SearchResult } from '$lib/types.js'\n  import {\n    createSearchAndReplaceOperations,\n    createSearchAndReplaceAllOperations,\n    searchNext,\n    searchPrevious,\n    search,\n    updateSearchResult\n  } from '$lib/logic/search.js'\n  import type { JSONPath } from 'immutable-json-patch'\n  import { tick } from 'svelte'\n\n  const debug = createDebug('jsoneditor:SearchBox')\n\n  export let json: unknown\n  export let documentState: DocumentState\n  export let parser: JSONParser\n  export let showSearch: boolean\n  export let showReplace: boolean\n  export let readOnly: boolean\n  export let columns: JSONPath[] | undefined\n  export let onSearch: (result: SearchResult | undefined) => void\n  export let onFocus: (path: JSONPath) => Promise<void>\n  export let onPatch: OnPatch\n  export let onClose: () => void\n\n  let text = ''\n  let previousText = ''\n  let replaceText = ''\n  let searching = false\n  let searchResult: SearchResult | undefined\n\n  $: resultCount = searchResult?.items?.length || 0\n  $: activeIndex = searchResult?.activeIndex || 0\n  $: formattedResultCount =\n    resultCount >= MAX_SEARCH_RESULTS ? `${MAX_SEARCH_RESULTS - 1}+` : String(resultCount)\n\n  $: onSearch(searchResult)\n\n  $: applyChangedShowSearch(showSearch)\n\n  const applyChangedSearchTextDebounced = debounce(applyChangedSearchText, DEBOUNCE_DELAY)\n  $: applyChangedSearchTextDebounced(text)\n\n  const applyChangedJsonDebounced = debounce(applyChangedJson, DEBOUNCE_DELAY)\n  $: applyChangedJsonDebounced(json)\n\n  function toggleShowReplace() {\n    showReplace = !showReplace && !readOnly\n  }\n\n  function handleKeyDown(event: KeyboardEvent) {\n    // key events must not be handled by the generic keydown handler of the\n    // whole JSONEditor.\n    event.stopPropagation()\n    const combo = keyComboFromEvent(event)\n\n    if (combo === 'Enter') {\n      event.preventDefault()\n\n      const pendingChanges = text !== previousText\n      if (pendingChanges) {\n        applyChangedSearchTextDebounced.flush()\n        previousText = text\n      } else {\n        handleNext()\n      }\n    }\n\n    if (combo === 'Shift+Enter') {\n      event.preventDefault()\n      handlePrevious()\n    }\n\n    if (combo === 'Ctrl+Enter') {\n      event.preventDefault()\n\n      if (showReplace) {\n        handleReplace()\n      } else {\n        handleNext()\n        // TODO: move focus to the active element so you can start editing?\n      }\n    }\n\n    if (combo === 'Ctrl+H') {\n      event.preventDefault()\n      toggleShowReplace()\n    }\n\n    if (combo === 'Escape') {\n      event.preventDefault()\n\n      handleClose()\n    }\n  }\n\n  function handleReplaceKeyDown(event: KeyboardEvent) {\n    const combo = keyComboFromEvent(event)\n\n    if (combo === 'Enter') {\n      event.preventDefault()\n      event.stopPropagation()\n\n      handleReplace()\n    }\n  }\n\n  async function handlePaste() {\n    await tick()\n    setTimeout(() => applyChangedSearchTextDebounced.flush())\n  }\n\n  async function handleReplace() {\n    if (readOnly) {\n      return\n    }\n\n    const activeItem = searchResult?.activeItem\n    debug('handleReplace', { replaceText, activeItem })\n\n    if (!searchResult || !activeItem || json === undefined) {\n      return\n    }\n\n    // move to the next search result *before* applying the replacement\n    searchResult = {\n      ...searchNext(searchResult),\n      activeIndex // trick to prevent shortly flickering of index from 1 to 2 and then to 1 again after the next search\n    }\n\n    const { operations, newSelection } = createSearchAndReplaceOperations(\n      json,\n      documentState,\n      replaceText,\n      activeItem,\n      parser\n    )\n\n    onPatch(operations, (_, patchedState) => ({\n      state: { ...patchedState, selection: newSelection }\n    }))\n\n    // immediately trigger updating the search results\n    await tick()\n    await applyChangedJsonDebounced.flush()\n\n    // focus to the next search result\n    await handleFocus()\n  }\n\n  async function handleReplaceAll() {\n    if (readOnly) {\n      return\n    }\n\n    debug('handleReplaceAll', { text, replaceText })\n\n    const { operations, newSelection } = createSearchAndReplaceAllOperations(\n      json,\n      documentState,\n      text,\n      replaceText,\n      parser\n    )\n\n    onPatch(operations, (_, patchedState) => ({\n      state: { ...patchedState, selection: newSelection }\n    }))\n\n    await handleFocus()\n  }\n\n  function initSearchInput(element: HTMLInputElement) {\n    element.select()\n  }\n\n  async function handleNext() {\n    searchResult = searchResult ? searchNext(searchResult) : undefined\n\n    await handleFocus()\n  }\n\n  async function handlePrevious() {\n    searchResult = searchResult ? searchPrevious(searchResult) : undefined\n\n    await handleFocus()\n  }\n\n  async function handleFocus() {\n    debug('handleFocus', searchResult)\n\n    const activeItem = searchResult?.activeItem\n    if (activeItem && json !== undefined) {\n      await onFocus(activeItem.path)\n    }\n  }\n\n  async function applyChangedShowSearch(showSearch: boolean) {\n    await applySearch(showSearch, text, json)\n  }\n\n  async function applyChangedSearchText(text: string) {\n    await applySearch(showSearch, text, json)\n    await handleFocus()\n  }\n\n  async function applyChangedJson(json: unknown) {\n    await applySearch(showSearch, text, json)\n  }\n\n  // we pass searchText and json as argument to trigger search when these variables change,\n  // via various listeners like applyChangedSearchText\n  async function applySearch(showSearch: boolean, text: string, json: unknown) {\n    if (!showSearch) {\n      if (searchResult) {\n        searchResult = undefined\n      }\n\n      return\n    }\n\n    debug('applySearch', { showSearch, text })\n\n    if (text === '') {\n      debug('clearing search result')\n\n      if (searchResult !== undefined) {\n        searchResult = undefined\n      }\n\n      return\n    }\n\n    searching = true\n\n    return new Promise<void>((resolve) => {\n      setTimeout(() => {\n        // wait until the search icon has been rendered\n        const newResultItems = search(text, json, { maxResults: MAX_SEARCH_RESULTS, columns })\n        searchResult = updateSearchResult(json, newResultItems, searchResult)\n\n        searching = false\n        resolve()\n      })\n    })\n  }\n\n  function handleClose() {\n    debug('handleClose')\n    applyChangedSearchTextDebounced.cancel()\n    applyChangedJsonDebounced.cancel()\n    applySearch(false, text, json) // will clear the search results\n    onClose()\n  }\n</script>\n\n{#if showSearch}\n  <div class=\"jse-search-box\">\n    <!-- svelte-ignore a11y-no-noninteractive-element-interactions -->\n    <form class=\"jse-search-form\" on:keydown={handleKeyDown}>\n      {#if !readOnly}\n        <button\n          type=\"button\"\n          class=\"jse-replace-toggle\"\n          title=\"Toggle visibility of replace options (Ctrl+H)\"\n          on:click={toggleShowReplace}\n        >\n          <Icon data={showReplace ? faCaretDown : faCaretRight} />\n        </button>\n      {/if}\n      <div class=\"jse-search-contents\">\n        <div class=\"jse-search-section\">\n          <div class=\"jse-search-icon\">\n            {#if searching}\n              <Icon data={faCircleNotch} spin />\n            {:else}\n              <Icon data={faSearch} />\n            {/if}\n          </div>\n          <label class=\"jse-search-input-label\" about=\"jse-search input\">\n            <input\n              class=\"jse-search-input\"\n              title=\"Enter text to search\"\n              type=\"text\"\n              placeholder=\"Find\"\n              bind:value={text}\n              use:initSearchInput\n              on:paste={handlePaste}\n            />\n          </label>\n          <div class=\"jse-search-count\" class:jse-visible={text !== ''}>\n            {activeIndex !== -1 && activeIndex < resultCount\n              ? `${activeIndex + 1}/`\n              : ''}{formattedResultCount}\n          </div>\n          <button\n            type=\"button\"\n            class=\"jse-search-next\"\n            title=\"Go to next search result (Enter)\"\n            on:click={handleNext}\n          >\n            <Icon data={faChevronDown} />\n          </button>\n          <button\n            type=\"button\"\n            class=\"jse-search-previous\"\n            title=\"Go to previous search result (Shift+Enter)\"\n            on:click={handlePrevious}\n          >\n            <Icon data={faChevronUp} />\n          </button>\n          <button\n            type=\"button\"\n            class=\"jse-search-clear\"\n            title=\"Close search box (Esc)\"\n            on:click={handleClose}\n          >\n            <Icon data={faTimes} />\n          </button>\n        </div>\n        {#if showReplace && !readOnly}\n          <div class=\"jse-replace-section\">\n            <input\n              class=\"jse-replace-input\"\n              title=\"Enter replacement text\"\n              type=\"text\"\n              placeholder=\"Replace\"\n              bind:value={replaceText}\n              on:keydown={handleReplaceKeyDown}\n            />\n            <button\n              type=\"button\"\n              title=\"Replace current occurrence (Ctrl+Enter)\"\n              on:click={handleReplace}>Replace</button\n            >\n            <button type=\"button\" title=\"Replace all occurrences\" on:click={handleReplaceAll}\n              >All</button\n            >\n          </div>\n        {/if}\n      </div>\n    </form>\n  </div>\n{/if}\n\n<style src=\"./SearchBox.scss\"></style>\n","import type { JSONPatchOperation, JSONPath } from 'immutable-json-patch'\nimport {\n  compileJSONPointer,\n  isJSONArray,\n  isJSONObject,\n  parseJSONPointer\n} from 'immutable-json-patch'\nimport { groupBy, isEmpty, isEqual, mapValues, partition } from 'lodash-es'\nimport type {\n  DocumentState,\n  JSONSelection,\n  SortedColumn,\n  TableCellIndex,\n  ValidationError\n} from '$lib/types.js'\nimport { ValidationSeverity } from '$lib/types.js'\nimport { createValueSelection, getFocusPath, pathStartsWith } from './selection.js'\nimport { isNumber } from '../utils/numberUtils.js'\nimport type { Dictionary } from 'lodash'\nimport { stringifyJSONPath } from '$lib/utils/pathUtils.js'\nimport { forEachSample } from '$lib/utils/arrayUtils.js'\nimport { isObject } from '$lib/utils/typeUtils.js'\n\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\ntype NestedObject = Record<string, NestedObject>\n\nconst endOfPath = Symbol('path')\n\nexport function getColumns(\n  array: Array<unknown>,\n  flatten: boolean,\n  maxSampleCount = Infinity\n): JSONPath[] {\n  const merged: NestedObject = {}\n\n  if (Array.isArray(array)) {\n    // We read samples spread through the whole array, from begin to end.\n    // When the array is sorted, and a specific field is present only at the last\n    // couple of items of the array or in the middle, we want to pick that up too.\n    forEachSample(array, maxSampleCount, (item) => {\n      if (isObject(item)) {\n        _recurseObject(item, merged, flatten)\n      } else {\n        merged[endOfPath] = true\n      }\n    })\n  }\n\n  const paths: JSONPath[] = []\n  if (endOfPath in merged) {\n    paths.push([])\n  }\n  _collectPaths(merged, [], paths, flatten)\n\n  return paths\n}\n\n// internal function for getColumns\n// mutates the argument merged\nfunction _recurseObject(object: NestedObject, merged: NestedObject, flatten: boolean): void {\n  for (const key in object) {\n    const value = object[key]\n    const valueMerged = merged[key] || (merged[key] = {})\n\n    if (isObject(value) && flatten) {\n      _recurseObject(value, valueMerged, flatten)\n    } else {\n      if (valueMerged[endOfPath] === undefined) {\n        valueMerged[endOfPath] = true\n      }\n    }\n  }\n}\n\n// internal function for getColumns\n// mutates the argument paths\nfunction _collectPaths(\n  object: NestedObject,\n  parentPath: JSONPath,\n  paths: JSONPath[],\n  flatten: boolean\n): void {\n  for (const key in object) {\n    const path = parentPath.concat(key)\n    const value = object[key]\n\n    if (value && value[endOfPath] === true) {\n      paths.push(path)\n    }\n\n    if (isJSONObject(value) && flatten) {\n      _collectPaths(value, path, paths, flatten)\n    }\n  }\n}\n\nexport function maintainColumnOrder(\n  newColumns: JSONPath[],\n  previousColumns: JSONPath[]\n): JSONPath[] {\n  const orderedColumns = new Set(previousColumns.map(compileJSONPointer))\n  const newColumnsSet = new Set(newColumns.map(compileJSONPointer))\n\n  // delete the columns that are gone now\n  for (const column of orderedColumns) {\n    if (!newColumnsSet.has(column)) {\n      orderedColumns.delete(column)\n    }\n  }\n\n  // append the new columns to the end\n  for (const column of newColumnsSet) {\n    if (!orderedColumns.has(column)) {\n      orderedColumns.add(column)\n    }\n  }\n\n  return [...orderedColumns].map(parseJSONPointer)\n}\n\nexport function getShallowKeys(value: unknown): JSONPath[] {\n  return isJSONObject(value) ? Object.keys(value).map((key) => [key]) : [[]]\n}\n\nexport function getRecursiveKeys(value: unknown): JSONPath[] {\n  const paths: JSONPath[] = []\n\n  function recurse(value: unknown, path: JSONPath) {\n    if (isJSONObject(value)) {\n      Object.keys(value).forEach((key) => {\n        recurse(value[key], path.concat(key))\n      })\n    } else {\n      // array or primitive value like string or number\n      paths.push(path)\n    }\n  }\n\n  recurse(value, [])\n\n  return paths\n}\n\nexport interface VisibleSection {\n  startIndex: number\n  endIndex: number\n  startHeight: number\n  visibleHeight: number\n  endHeight: number\n  averageItemHeight: number\n  visibleItems: Array<unknown>\n}\n\n// TODO: write unit tests\nexport function calculateVisibleSection(\n  scrollTop: number,\n  viewPortHeight: number,\n  json: unknown | undefined,\n  itemHeights: Record<number, number>,\n  defaultItemHeight: number,\n  searchBoxOffset: number,\n  margin = 80\n): VisibleSection {\n  const itemCount = isJSONArray(json) ? json.length : 0\n  const averageItemHeight = calculateAverageItemHeight(itemHeights, defaultItemHeight)\n  const viewPortTop = scrollTop - margin\n  const viewPortBottom = viewPortHeight + 2 * margin\n\n  const getItemHeight = (index: number) => itemHeights[index] || defaultItemHeight\n\n  let startIndex = 0\n  let startHeight = searchBoxOffset\n  while (startHeight < viewPortTop && startIndex < itemCount) {\n    startHeight += getItemHeight(startIndex)\n    startIndex++\n  }\n  if (startIndex > 0) {\n    // go one item back, else there is white space at the top for up to 1 missing item\n    startIndex--\n    startHeight -= getItemHeight(startIndex)\n  }\n\n  let endIndex = startIndex\n  let visibleHeight = 0\n  while (visibleHeight < viewPortBottom && endIndex < itemCount) {\n    visibleHeight += getItemHeight(endIndex)\n    endIndex++\n  }\n\n  let endHeight = 0\n  for (let i = endIndex; i < itemCount; i++) {\n    endHeight += getItemHeight(i)\n  }\n\n  const visibleItems = isJSONArray(json) ? json.slice(startIndex, endIndex) : []\n\n  return {\n    startIndex,\n    endIndex,\n    startHeight,\n    endHeight,\n    averageItemHeight,\n    visibleHeight,\n    visibleItems\n  }\n}\n\n// TODO: cleanup if we will not use it in the end\n// TODO: write unit tests\nexport function calculateVisibleSectionApprox(\n  scrollTop: number,\n  viewPortHeight: number,\n  json: unknown | undefined,\n  defaultItemHeight: number\n): VisibleSection {\n  const itemCount = isJSONArray(json) ? json.length : 0\n  const averageItemHeight = defaultItemHeight\n\n  const viewPortTop = scrollTop\n  const startIndex = Math.floor(viewPortTop / defaultItemHeight)\n  const startHeight = startIndex * defaultItemHeight\n  const endIndex = Math.ceil((viewPortTop + viewPortHeight) / defaultItemHeight)\n  const visibleHeight = (endIndex - startIndex) * defaultItemHeight\n  const endHeight = (itemCount - endIndex) * defaultItemHeight\n\n  const visibleItems = isJSONArray(json) ? json.slice(startIndex, endIndex) : []\n\n  return {\n    startIndex,\n    endIndex,\n    startHeight,\n    endHeight,\n    averageItemHeight,\n    visibleHeight,\n    visibleItems\n  }\n}\n\n// TODO: write unit tests\nexport function calculateAbsolutePosition(\n  path: JSONPath,\n  columns: JSONPath[],\n  itemHeights: Record<number, number>,\n  defaultItemHeight: number\n): number {\n  const { rowIndex } = toTableCellPosition(path, columns)\n\n  let top = 0\n  for (let currentIndex = 0; currentIndex < rowIndex; currentIndex++) {\n    top += itemHeights[currentIndex] || defaultItemHeight\n  }\n\n  // TODO: also calculate left\n  return top\n}\n\nfunction calculateAverageItemHeight(\n  itemHeights: Record<number, number>,\n  defaultItemHeight: number\n): number {\n  const values = Object.values(itemHeights) // warning: itemHeights is mutated and not updated itself, we can't watch it!\n  if (isEmpty(values)) {\n    return defaultItemHeight\n  }\n\n  const add = (a: number, b: number) => a + b\n  const total = values.reduce(add)\n  return total / values.length\n}\n\nexport function selectPreviousRow(columns: JSONPath[], selection: JSONSelection): JSONSelection {\n  const { rowIndex, columnIndex } = toTableCellPosition(getFocusPath(selection), columns)\n\n  if (rowIndex > 0) {\n    const previousPosition = { rowIndex: rowIndex - 1, columnIndex }\n    const previousPath = fromTableCellPosition(previousPosition, columns)\n    return createValueSelection(previousPath, false)\n  }\n\n  return selection\n}\n\nexport function selectNextRow(\n  json: unknown,\n  columns: JSONPath[],\n  selection: JSONSelection\n): JSONSelection {\n  const { rowIndex, columnIndex } = toTableCellPosition(getFocusPath(selection), columns)\n\n  if (rowIndex < (json as Array<unknown>).length - 1) {\n    const nextPosition = { rowIndex: rowIndex + 1, columnIndex }\n    const nextPath = fromTableCellPosition(nextPosition, columns)\n    return createValueSelection(nextPath, false)\n  }\n\n  return selection\n}\n\nexport function selectPreviousColumn(columns: JSONPath[], selection: JSONSelection): JSONSelection {\n  const { rowIndex, columnIndex } = toTableCellPosition(getFocusPath(selection), columns)\n\n  if (columnIndex > 0) {\n    const previousPosition = { rowIndex, columnIndex: columnIndex - 1 }\n    const previousPath = fromTableCellPosition(previousPosition, columns)\n    return createValueSelection(previousPath, false)\n  }\n\n  return selection\n}\n\nexport function selectNextColumn(columns: JSONPath[], selection: JSONSelection): JSONSelection {\n  const { rowIndex, columnIndex } = toTableCellPosition(getFocusPath(selection), columns)\n\n  if (columnIndex < columns.length - 1) {\n    const nextPosition = { rowIndex, columnIndex: columnIndex + 1 }\n    const nextPath = fromTableCellPosition(nextPosition, columns)\n    return createValueSelection(nextPath, false)\n  }\n\n  return selection\n}\n\nexport function toTableCellPosition(path: JSONPath, columns: JSONPath[]): TableCellIndex {\n  const [index, ...column] = path\n\n  const rowIndex = parseInt(index, 10)\n\n  return {\n    rowIndex: !isNaN(rowIndex) ? rowIndex : -1,\n    columnIndex: columns.findIndex((c) => pathStartsWith(column, c))\n  }\n}\n\nexport function fromTableCellPosition(position: TableCellIndex, columns: JSONPath[]): JSONPath {\n  const { rowIndex, columnIndex } = position\n\n  return [String(rowIndex), ...columns[columnIndex]]\n}\n\nexport function stringifyTableCellPosition(position: TableCellIndex): string {\n  const { rowIndex, columnIndex } = position\n\n  return `${rowIndex}:${columnIndex}`\n}\n\ninterface GroupedValidationErrorsByRow {\n  row: ValidationError[]\n  columns: Dictionary<ValidationError[]>\n}\n\nexport interface GroupedValidationErrors {\n  root: ValidationError[]\n  rows: Dictionary<GroupedValidationErrorsByRow>\n}\n\n/**\n * Group validation errors for use in the Table view: per column, and a group for the row as a whole\n */\nexport function groupValidationErrors(\n  validationErrors: ValidationError[],\n  columns: JSONPath[]\n): GroupedValidationErrors {\n  const [arrayErrors, rootErrors] = partition(validationErrors, (validationError) =>\n    isNumber(validationError.path[0])\n  )\n\n  const errorsByRow: Dictionary<ValidationError[]> = groupBy(arrayErrors, findRowIndex)\n\n  const groupedErrorsByRow = mapValues(errorsByRow, (errors) => {\n    const groupByRow: GroupedValidationErrorsByRow = {\n      row: [],\n      columns: {}\n    }\n\n    errors.forEach((error) => {\n      const columnIndex = findColumnIndex(error, columns)\n\n      if (columnIndex !== -1) {\n        if (groupByRow.columns[columnIndex] === undefined) {\n          groupByRow.columns[columnIndex] = []\n        }\n        groupByRow.columns[columnIndex].push(error)\n      } else {\n        groupByRow.row.push(error)\n      }\n    })\n\n    return groupByRow\n  })\n\n  return {\n    root: rootErrors,\n    rows: groupedErrorsByRow\n  }\n}\n\nexport function mergeValidationErrors(\n  path: JSONPath,\n  validationErrors: ValidationError[] | undefined\n): ValidationError | undefined {\n  if (!validationErrors || validationErrors.length === 0) {\n    return undefined\n  }\n\n  if (validationErrors.length === 1) {\n    return validationErrors[0]\n  }\n\n  return {\n    path,\n    message:\n      'Multiple validation issues: ' +\n      validationErrors\n        .map((error) => {\n          return stringifyJSONPath(error.path) + ' ' + error.message\n        })\n        .join(', '),\n    severity: ValidationSeverity.warning\n  }\n}\n\nfunction findRowIndex(error: ValidationError): number {\n  return parseInt(error.path[0], 10)\n}\n\nfunction findColumnIndex(error: ValidationError, columns: JSONPath[]): number {\n  const position = toTableCellPosition(error.path, columns)\n\n  if (position.columnIndex !== -1) {\n    return position.columnIndex\n  }\n\n  return -1\n}\n\n/**\n * Clear the sorted column from the documentState when it is affected by the operations\n */\nexport function clearSortedColumnWhenAffectedByOperations(\n  documentState: DocumentState,\n  operations: JSONPatchOperation[],\n  columms: JSONPath[]\n): DocumentState {\n  const mustBeCleared = operations.some((operation) =>\n    operationAffectsSortedColumn(documentState.sortedColumn, operation, columms)\n  )\n\n  if (mustBeCleared) {\n    return {\n      ...documentState,\n      sortedColumn: null\n    }\n  }\n\n  return documentState\n}\n\nexport function operationAffectsSortedColumn(\n  sortedColumn: SortedColumn | null,\n  operation: JSONPatchOperation,\n  columns: JSONPath[]\n): boolean {\n  if (!sortedColumn) {\n    return false\n  }\n\n  // an operation of replacing a value in a different column does not affect the currently sorted order\n  if (operation.op === 'replace') {\n    const path = parseJSONPointer(operation.path)\n    const { rowIndex, columnIndex } = toTableCellPosition(path, columns)\n    const selectedColumnIndex = columns.findIndex((column) => isEqual(column, sortedColumn.path))\n\n    if (rowIndex !== -1 && columnIndex !== -1 && columnIndex !== selectedColumnIndex) {\n      return false\n    }\n  }\n\n  // TODO: there are more cases where we can known an operation does not affect the sorted order, improve this\n  //  For example adding a nested value in a different column, or removing a full row.\n\n  return true\n}\n\n/**\n * Find nested arrays inside a JSON object\n */\nexport function findNestedArrays(json: unknown, maxLevel = 2): JSONPath[] {\n  const props: JSONPath[] = []\n\n  function recurse(value: unknown, path: JSONPath) {\n    if (isJSONObject(value) && path.length < maxLevel) {\n      Object.keys(value).forEach((key) => {\n        recurse(value[key], path.concat(key))\n      })\n    }\n\n    if (isJSONArray(value)) {\n      props.push(path)\n    }\n  }\n\n  recurse(json, [])\n\n  return props\n}\n","import {\n  createInsideSelection,\n  createKeySelection,\n  createMultiSelection,\n  createValueSelection,\n  getFocusPath,\n  hasSelectionContents,\n  isEditingSelection,\n  isKeySelection,\n  isValueSelection,\n  selectionToPartialJson\n} from '$lib/logic/selection.js'\nimport copyToClipboard from '$lib/utils/copyToClipboard.js'\nimport {\n  append,\n  createNewValue,\n  createRemoveOperations,\n  duplicate,\n  insert,\n  insertBefore,\n  removeAll\n} from '$lib/logic/operations.js'\nimport type {\n  AfterPatchCallback,\n  DocumentState,\n  InsertType,\n  JSONParser,\n  JSONSelection,\n  OnChange,\n  OnChangeText,\n  OnJSONSelect,\n  OnPatch\n} from '$lib/types'\nimport { createDebug } from '$lib/utils/debug.js'\nimport {\n  getIn,\n  isJSONObject,\n  isJSONPatchAdd,\n  isJSONPatchReplace,\n  type JSONPath,\n  parsePath\n} from 'immutable-json-patch'\nimport { isObject, isObjectOrArray } from '$lib/utils/typeUtils.js'\nimport {\n  expandAll,\n  expandPath,\n  expandRecursive,\n  expandWithCallback\n} from '$lib/logic/documentState.js'\nimport { initial, isEmpty, last } from 'lodash-es'\nimport { insertActiveElementContents } from '$lib/utils/domUtils.js'\nimport { fromTableCellPosition, toTableCellPosition } from '$lib/logic/table.js'\n\nconst debug = createDebug('jsoneditor:actions')\n\nexport interface OnCutAction {\n  json: unknown | undefined\n  documentState: DocumentState\n  indentation: string | number | undefined\n  readOnly: boolean\n  parser: JSONParser\n  onPatch: OnPatch\n}\n\n// TODO: write unit tests\nexport async function onCut({\n  json,\n  documentState,\n  indentation,\n  readOnly,\n  parser,\n  onPatch\n}: OnCutAction) {\n  if (\n    readOnly ||\n    json === undefined ||\n    !documentState.selection ||\n    !hasSelectionContents(documentState.selection)\n  ) {\n    return\n  }\n\n  const clipboard = selectionToPartialJson(json, documentState.selection, indentation, parser)\n  if (clipboard == null) {\n    return\n  }\n\n  debug('cut', { selection: documentState.selection, clipboard, indentation })\n\n  await copyToClipboard(clipboard)\n\n  const { operations, newSelection } = createRemoveOperations(json, documentState.selection)\n\n  onPatch(operations, (patchedJson, patchedState) => ({\n    state: {\n      ...patchedState,\n      selection: newSelection\n    }\n  }))\n}\n\nexport interface OnCopyAction {\n  json: unknown\n  documentState: DocumentState\n  indentation: string | number | undefined\n  parser: JSONParser\n}\n\n// TODO: write unit tests\nexport async function onCopy({ json, documentState, indentation, parser }: OnCopyAction) {\n  const clipboard = selectionToPartialJson(json, documentState.selection, indentation, parser)\n  if (clipboard == null) {\n    return\n  }\n\n  debug('copy', { clipboard, indentation })\n\n  await copyToClipboard(clipboard)\n}\n\ntype RepairModalCallback = (text: string, onApply: (repairedText: string) => void) => void\n\ninterface OnPasteAction {\n  clipboardText: string\n  json: unknown | undefined\n  selection: JSONSelection | null\n  readOnly: boolean\n  parser: JSONParser\n  onPatch: OnPatch\n  onChangeText: OnChangeText\n  openRepairModal: RepairModalCallback\n}\n\n// TODO: write unit tests\nexport function onPaste({\n  clipboardText,\n  json,\n  selection,\n  readOnly,\n  parser,\n  onPatch,\n  onChangeText,\n  openRepairModal\n}: OnPasteAction) {\n  if (readOnly) {\n    return\n  }\n\n  function doPaste(pastedText: string) {\n    if (json !== undefined) {\n      const selectionNonNull = selection || createValueSelection([], false)\n\n      const operations = insert(json, selectionNonNull, pastedText, parser)\n\n      debug('paste', { pastedText, operations, selectionNonNull })\n\n      onPatch(operations, (patchedJson, patchedState) => {\n        let updatedState = patchedState\n\n        // expand newly inserted object/array\n        operations\n          .filter(\n            (operation) =>\n              (isJSONPatchAdd(operation) || isJSONPatchReplace(operation)) &&\n              isObjectOrArray(operation.value)\n          )\n          .forEach((operation) => {\n            const path = parsePath(json, operation.path)\n            updatedState = expandRecursive(patchedJson, updatedState, path)\n          })\n\n        return {\n          state: updatedState\n        }\n      })\n    } else {\n      // no json: empty document, or the contents is invalid text\n      debug('paste text', { pastedText })\n\n      onChangeText(clipboardText, (patchedJson, patchedState) => {\n        if (patchedJson) {\n          const path: JSONPath = []\n          return {\n            state: expandRecursive(patchedJson, patchedState, path) as DocumentState\n          }\n        }\n      })\n    }\n  }\n\n  try {\n    doPaste(clipboardText)\n  } catch (err) {\n    openRepairModal(clipboardText, (repairedText) => {\n      debug('repaired pasted text: ', repairedText)\n      doPaste(repairedText)\n    })\n  }\n}\n\nexport interface OnRemoveAction {\n  json: unknown | undefined\n  text: string | undefined\n  documentState: DocumentState\n  keepSelection: boolean\n  readOnly: boolean\n  onChange: OnChange\n  onPatch: OnPatch\n}\n\n// TODO: write unit tests\nexport function onRemove({\n  json,\n  text,\n  documentState,\n  keepSelection,\n  readOnly,\n  onChange,\n  onPatch\n}: OnRemoveAction) {\n  if (readOnly || !documentState.selection) {\n    return\n  }\n\n  // in case of a selected key or value, we change the selection to the whole\n  // entry to remove this, we do not want to clear a key or value only.\n  const removeSelection =\n    json !== undefined &&\n    (isKeySelection(documentState.selection) || isValueSelection(documentState.selection))\n      ? createMultiSelection(documentState.selection.path, documentState.selection.path)\n      : documentState.selection\n\n  if (isEmpty(getFocusPath(documentState.selection))) {\n    // root selected -> clear complete document\n    debug('remove root', { selection: documentState.selection })\n\n    if (onChange) {\n      onChange(\n        { text: '', json: undefined },\n        json !== undefined ? { text: undefined, json } : { text: text || '', json },\n        {\n          contentErrors: null,\n          patchResult: null\n        }\n      )\n    }\n  } else {\n    // remove selection\n    if (json !== undefined) {\n      const { operations, newSelection } = createRemoveOperations(json, removeSelection)\n\n      debug('remove', { operations, selection: documentState.selection, newSelection })\n\n      onPatch(operations, (patchedJson, patchedState) => ({\n        state: {\n          ...patchedState,\n          selection: keepSelection ? documentState.selection : newSelection\n        }\n      }))\n    }\n  }\n}\n\nexport interface OnDuplicateRowAction {\n  json: unknown | undefined\n  documentState: DocumentState\n  columns: JSONPath[]\n  readOnly: boolean\n  onPatch: OnPatch\n}\n\n/**\n * This function assumes that the json holds the Array that we're duplicating a row for,\n * it cannot duplicate something in some nested array\n */\n// TODO: write unit tests\nexport function onDuplicateRow({\n  json,\n  documentState,\n  columns,\n  readOnly,\n  onPatch\n}: OnDuplicateRowAction) {\n  if (\n    readOnly ||\n    json === undefined ||\n    !documentState.selection ||\n    !hasSelectionContents(documentState.selection)\n  ) {\n    return\n  }\n\n  const { rowIndex, columnIndex } = toTableCellPosition(\n    getFocusPath(documentState.selection),\n    columns\n  )\n\n  debug('duplicate row', { rowIndex })\n\n  const rowPath = [String(rowIndex)]\n  const operations = duplicate(json, [rowPath])\n\n  onPatch(operations, (patchedJson, patchedState) => {\n    const newRowIndex = rowIndex < (json as Array<unknown>).length ? rowIndex + 1 : rowIndex\n    const newPath = fromTableCellPosition({ rowIndex: newRowIndex, columnIndex }, columns)\n    const newSelection = createValueSelection(newPath, false)\n\n    return {\n      state: {\n        ...patchedState,\n        selection: newSelection\n      }\n    }\n  })\n}\n\nexport interface OnInsertBeforeRowAction {\n  json: unknown | undefined\n  documentState: DocumentState\n  columns: JSONPath[]\n  readOnly: boolean\n  onPatch: OnPatch\n}\n\n/**\n * This function assumes that the json holds the Array that we're duplicating a row for,\n * it cannot duplicate something in some nested array\n */\n// TODO: write unit tests\nexport function onInsertBeforeRow({\n  json,\n  documentState,\n  columns,\n  readOnly,\n  onPatch\n}: OnInsertBeforeRowAction) {\n  if (\n    readOnly ||\n    json === undefined ||\n    !documentState.selection ||\n    !hasSelectionContents(documentState.selection)\n  ) {\n    return\n  }\n\n  const { rowIndex } = toTableCellPosition(getFocusPath(documentState.selection), columns)\n\n  debug('insert before row', { rowIndex })\n\n  const rowPath = [String(rowIndex)]\n  const newValue = isJSONObject((json as Array<unknown>)[0]) ? {} : ''\n  const values = [{ key: '', value: newValue }]\n  const operations = insertBefore(json, rowPath, values)\n\n  onPatch(operations)\n}\n\nexport interface OnInsertAfterRowAction {\n  json: unknown | undefined\n  documentState: DocumentState\n  columns: JSONPath[]\n  readOnly: boolean\n  onPatch: OnPatch\n}\n\n/**\n * This function assumes that the json holds the Array that we're duplicating a row for,\n * it cannot duplicate something in some nested array\n */\n// TODO: write unit tests\nexport function onInsertAfterRow({\n  json,\n  documentState,\n  columns,\n  readOnly,\n  onPatch\n}: OnInsertAfterRowAction) {\n  if (\n    readOnly ||\n    json === undefined ||\n    !documentState.selection ||\n    !hasSelectionContents(documentState.selection)\n  ) {\n    return\n  }\n\n  const { rowIndex, columnIndex } = toTableCellPosition(\n    getFocusPath(documentState.selection),\n    columns\n  )\n\n  debug('insert after row', { rowIndex })\n\n  const nextRowIndex = rowIndex + 1\n  const nextRowPath = [String(nextRowIndex)]\n  const newValue = isJSONObject((json as Array<unknown>)[0]) ? {} : ''\n  const values = [{ key: '', value: newValue }]\n\n  const operations =\n    nextRowIndex < (json as Array<unknown>).length\n      ? insertBefore(json, nextRowPath, values)\n      : append(json, [], values)\n\n  onPatch(operations, (patchedJson, patchedState) => {\n    const nextPath = fromTableCellPosition({ rowIndex: nextRowIndex, columnIndex }, columns)\n    const newSelection = createValueSelection(nextPath, false)\n\n    return {\n      state: {\n        ...patchedState,\n        selection: newSelection\n      }\n    }\n  })\n}\n\nexport interface OnRemoveRowAction {\n  json: unknown | undefined\n  documentState: DocumentState\n  columns: JSONPath[]\n  readOnly: boolean\n  onPatch: OnPatch\n}\n\n/**\n * This function assumes that the json holds the Array that we're duplicating a row for,\n * it cannot duplicate something in some nested array\n */\n// TODO: write unit tests\nexport function onRemoveRow({\n  json,\n  documentState,\n  columns,\n  readOnly,\n  onPatch\n}: OnRemoveRowAction) {\n  if (\n    readOnly ||\n    json === undefined ||\n    !documentState.selection ||\n    !hasSelectionContents(documentState.selection)\n  ) {\n    return\n  }\n\n  const { rowIndex, columnIndex } = toTableCellPosition(\n    getFocusPath(documentState.selection),\n    columns\n  )\n\n  debug('remove row', { rowIndex })\n\n  const rowPath = [String(rowIndex)]\n  const operations = removeAll([rowPath])\n\n  onPatch(operations, (patchedJson, patchedState) => {\n    const newRowIndex =\n      rowIndex < (patchedJson as Array<unknown>).length\n        ? rowIndex\n        : rowIndex > 0\n          ? rowIndex - 1\n          : undefined\n\n    const newSelection =\n      newRowIndex !== undefined\n        ? createValueSelection(\n            fromTableCellPosition({ rowIndex: newRowIndex, columnIndex }, columns),\n            false\n          )\n        : null\n\n    debug('remove row new selection', { rowIndex, newRowIndex, newSelection })\n\n    return {\n      state: {\n        ...patchedState,\n        selection: newSelection\n      }\n    }\n  })\n}\n\nexport interface OnInsert {\n  insertType: InsertType\n  selectInside: boolean\n  refJsonEditor: HTMLElement\n  json: unknown | undefined\n  selection: JSONSelection | null\n  readOnly: boolean\n  parser: JSONParser\n  onPatch: OnPatch\n  onReplaceJson: (updatedJson: unknown, afterPatch: AfterPatchCallback) => void\n}\n\n// TODO: write unit tests\nexport function onInsert({\n  insertType,\n  selectInside,\n  refJsonEditor,\n  json,\n  selection,\n  readOnly,\n  parser,\n  onPatch,\n  onReplaceJson\n}: OnInsert): void {\n  if (readOnly) {\n    return\n  }\n\n  const newValue = createNewValue(json, selection, insertType)\n\n  if (json !== undefined) {\n    const data = parser.stringify(newValue) as string\n    const operations = insert(json, selection, data, parser)\n    debug('onInsert', { insertType, operations, newValue, data })\n\n    const operation = last(\n      operations.filter((operation) => operation.op === 'add' || operation.op === 'replace')\n    )\n\n    onPatch(operations, (patchedJson, patchedState) => {\n      // TODO: extract determining the newSelection in a separate function\n      if (operation) {\n        const path = parsePath(patchedJson, operation.path)\n\n        if (isObjectOrArray(newValue)) {\n          return {\n            state: {\n              ...expandWithCallback(patchedJson, patchedState, path, expandAll),\n              selection: selectInside ? createInsideSelection(path) : patchedState.selection\n            }\n          }\n        }\n\n        if (newValue === '') {\n          // open the newly inserted value in edit mode\n          const parent = !isEmpty(path) ? getIn(patchedJson, initial(path)) : null\n\n          return {\n            // expandPath is invoked to make sure that visibleSections is extended when needed\n            state: expandPath(\n              patchedJson,\n              {\n                ...patchedState,\n                selection: isObject(parent)\n                  ? createKeySelection(path, true)\n                  : createValueSelection(path, true)\n              },\n              path\n            )\n          }\n        }\n\n        return undefined\n      }\n    })\n\n    debug('after patch')\n\n    if (operation) {\n      if (newValue === '') {\n        // open the newly inserted value in edit mode (can be cancelled via ESC this way)\n        tick2(() => insertActiveElementContents(refJsonEditor, '', true, refreshEditableDiv))\n      }\n    }\n  } else {\n    // document is empty or invalid (in that case it has text but no json)\n    debug('onInsert', { insertType, newValue })\n\n    const path: JSONPath = []\n    onReplaceJson(newValue, (patchedJson, patchedState) => ({\n      state: {\n        ...expandRecursive(patchedJson, patchedState, path),\n        selection: isObjectOrArray(newValue)\n          ? createInsideSelection(path)\n          : createValueSelection(path, true)\n      }\n    }))\n  }\n}\n\nexport interface OnInsertCharacter {\n  char: string\n  selectInside: boolean\n  refJsonEditor: HTMLElement\n  json: unknown | undefined\n  selection: JSONSelection | null\n  readOnly: boolean\n  parser: JSONParser\n  onPatch: OnPatch\n  onReplaceJson: (updatedJson: unknown, afterPatch: AfterPatchCallback) => void\n  onSelect: OnJSONSelect\n}\n\n// TODO: write unit tests\nexport async function onInsertCharacter({\n  char,\n  selectInside,\n  refJsonEditor,\n  json,\n  selection,\n  readOnly,\n  parser,\n  onPatch,\n  onReplaceJson,\n  onSelect\n}: OnInsertCharacter) {\n  // a regular key like a, A, _, etc is entered.\n  // Replace selected contents with a new value having this first character as text\n  if (readOnly) {\n    return\n  }\n\n  if (isKeySelection(selection)) {\n    // only replace contents when not yet in edit mode (can happen when entering\n    // multiple characters very quickly after each other due to the async handling)\n    const replaceContents = !selection.edit\n\n    onSelect({ ...selection, edit: true })\n    tick2(() =>\n      // We use this way via insertActiveElementContents, so we can cancel via ESC\n      insertActiveElementContents(refJsonEditor, char, replaceContents, refreshEditableDiv)\n    )\n    return\n  }\n\n  if (char === '{') {\n    onInsert({\n      insertType: 'object',\n      selectInside,\n      refJsonEditor,\n      json,\n      selection,\n      readOnly,\n      parser,\n      onPatch,\n      onReplaceJson\n    })\n  } else if (char === '[') {\n    onInsert({\n      insertType: 'array',\n      selectInside,\n      refJsonEditor,\n      json,\n      selection,\n      readOnly,\n      parser,\n      onPatch,\n      onReplaceJson\n    })\n  } else {\n    if (isValueSelection(selection) && json !== undefined) {\n      if (!isObjectOrArray(getIn(json, selection.path))) {\n        // only replace contents when not yet in edit mode (can happen when entering\n        // multiple characters very quickly after each other due to the async handling)\n        const replaceContents = !selection.edit\n\n        onSelect({ ...selection, edit: true })\n        tick2(() =>\n          // We use this way via insertActiveElementContents, so we can cancel via ESC\n          insertActiveElementContents(refJsonEditor, char, replaceContents, refreshEditableDiv)\n        )\n      } else {\n        // TODO: replace the object/array with editing a text in edit mode?\n        //  (Ideally this this should not create an entry in history though,\n        //  which isn't really possible right now since we have to apply\n        //  a patch to change the object/array into a value)\n      }\n    } else {\n      debug('onInsertValueWithCharacter', { char })\n      await onInsertValueWithCharacter({\n        char,\n        refJsonEditor,\n        json,\n        selection,\n        readOnly,\n        parser,\n        onPatch,\n        onReplaceJson\n      })\n    }\n  }\n}\n\ninterface OnInsertValueWithCharacter {\n  char: string\n  refJsonEditor: HTMLElement\n  json: unknown | undefined\n  selection: JSONSelection | null\n  readOnly: boolean\n  parser: JSONParser\n  onPatch: OnPatch\n  onReplaceJson: (updatedJson: unknown, afterPatch: AfterPatchCallback) => void\n}\n\nasync function onInsertValueWithCharacter({\n  char,\n  refJsonEditor,\n  json,\n  selection,\n  readOnly,\n  parser,\n  onPatch,\n  onReplaceJson\n}: OnInsertValueWithCharacter) {\n  if (readOnly) {\n    return\n  }\n\n  // first insert a new value\n  onInsert({\n    insertType: 'value',\n    selectInside: false, // not relevant, we insert a value, not an object or array\n    refJsonEditor,\n    json,\n    selection,\n    readOnly,\n    parser,\n    onPatch,\n    onReplaceJson\n  })\n\n  // only replace contents when not yet in edit mode (can happen when entering\n  // multiple characters very quickly after each other due to the async handling)\n  const replaceContents = !isEditingSelection(selection)\n\n  tick2(() => insertActiveElementContents(refJsonEditor, char, replaceContents, refreshEditableDiv))\n}\n\n/**\n * set two timeouts, two ticks of delay.\n * This allows to perform some action in the DOM *after* Svelte has re-rendered the app for example\n * WARNING: try to avoid using this function, it is tricky to rely on it.\n */\nfunction tick2(callback: () => void) {\n  setTimeout(() => setTimeout(callback))\n}\n\nfunction refreshEditableDiv(element: HTMLElement) {\n  // We force a refresh because when changing the text of the editable div programmatically,\n  // the DIV doesn't get a trigger to update it's class\n  // TODO: come up with a better solution\n\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore\n  element?.refresh()\n}\n","<script lang=\"ts\">\n  import type { JSONParser } from '$lib/types'\n  import { truncate } from '$lib/utils/stringUtils.js'\n  import { getText } from '$lib/utils/jsonUtils.js'\n  import { MAX_CHARACTERS_TEXT_PREVIEW } from '$lib/constants.js'\n\n  export let text: string | undefined\n  export let json: unknown | undefined\n  export let indentation: number | string\n  export let parser: JSONParser\n\n  $: content = json !== undefined ? { json } : { text: text || '' }\n  $: truncated = truncate(getText(content, indentation, parser), MAX_CHARACTERS_TEXT_PREVIEW)\n</script>\n\n<div class=\"jse-json-preview\">\n  {truncated}\n</div>\n\n<style src=\"./JSONPreview.scss\"></style>\n","<script lang=\"ts\">\n  import type { MenuButton } from '$lib/types'\n  import Icon from 'svelte-awesome'\n  import { classnames } from '$lib/utils/cssUtils.js'\n\n  export let item: MenuButton\n  export let className: string | undefined = undefined\n  export let onRequestClose: () => void\n</script>\n\n<button\n  type=\"button\"\n  class={classnames('jse-context-menu-button', className, item.className)}\n  on:click={(event) => {\n    onRequestClose()\n    item.onClick(event)\n  }}\n  title={item.title}\n  disabled={item.disabled || false}\n>\n  {#if item.icon}\n    <Icon data={item.icon} />\n  {/if}\n  {#if item.text}\n    {item.text}\n  {/if}\n</button>\n\n<style src=\"./ContextMenuButton.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import Icon from 'svelte-awesome'\n  import { faCaretDown } from '@fortawesome/free-solid-svg-icons'\n  import { onDestroy, onMount } from 'svelte'\n  import { keyComboFromEvent } from '$lib/utils/keyBindings.js'\n  import type { MenuButton } from '$lib/types.js'\n\n  export let items: MenuButton[] = []\n  export let title: string | undefined = undefined\n  export let width = '120px'\n\n  let visible = false\n\n  $: allItemsDisabled = items.every((item) => item.disabled === true)\n\n  function toggleShow() {\n    const wasVisible = visible\n\n    // trigger *after* the handleClick which changes visibility to false\n    setTimeout(() => (visible = !wasVisible))\n  }\n\n  function handleClick() {\n    visible = false\n  }\n\n  function handleKeyDown(event: KeyboardEvent) {\n    const combo = keyComboFromEvent(event)\n    if (combo === 'Escape') {\n      event.preventDefault()\n      visible = false\n    }\n  }\n\n  onMount(() => {\n    document.addEventListener('click', handleClick)\n    document.addEventListener('keydown', handleKeyDown)\n  })\n\n  onDestroy(() => {\n    document.removeEventListener('click', handleClick)\n    document.removeEventListener('keydown', handleKeyDown)\n  })\n</script>\n\n<!-- svelte-ignore a11y-click-events-have-key-events -->\n<div role=\"button\" tabindex=\"0\" class=\"jse-dropdown-button\" {title} on:click={handleClick}>\n  <slot name=\"defaultItem\" />\n\n  <button\n    type=\"button\"\n    class=\"jse-open-dropdown\"\n    data-type=\"jse-open-dropdown\"\n    class:jse-visible={visible}\n    on:click={toggleShow}\n    disabled={allItemsDisabled}\n  >\n    <Icon data={faCaretDown} />\n  </button>\n\n  <div class=\"jse-dropdown-items\" class:jse-visible={visible} style=\"width: {width};\">\n    <ul>\n      {#each items as item}\n        <li>\n          <button\n            type=\"button\"\n            on:click={(event) => item.onClick(event)}\n            title={item.title}\n            disabled={item.disabled}\n            class={item.className}\n          >\n            {#if item.icon}\n              <Icon data={item.icon} />\n            {/if}\n            {item.text}\n          </button>\n        </li>\n      {/each}\n    </ul>\n  </div>\n</div>\n\n<style src=\"./DropdownButton.scss\"></style>\n","<script lang=\"ts\">\n  import type { MenuDropDownButton } from '$lib/types'\n  import DropdownButton from '../DropdownButton.svelte'\n  import Icon from 'svelte-awesome'\n  import { classnames } from '$lib/utils/cssUtils.js'\n\n  export let item: MenuDropDownButton\n  export let className: string | undefined = undefined\n  export let onRequestClose: () => void\n\n  $: items = item.items.map((item) => ({\n    ...item,\n    onClick: (event: MouseEvent) => {\n      onRequestClose()\n      item.onClick(event)\n    }\n  }))\n</script>\n\n<DropdownButton width={item.width} {items}>\n  <button\n    class={classnames('jse-context-menu-button', className, item.main.className)}\n    type=\"button\"\n    slot=\"defaultItem\"\n    title={item.main.title}\n    on:click={(event) => {\n      onRequestClose()\n      item.main.onClick(event)\n    }}\n    disabled={item.main.disabled || false}\n  >\n    {#if item.main.icon}\n      <Icon data={item.main.icon} />\n    {/if}\n    {item.main.text}\n  </button>\n</DropdownButton>\n\n<style src=\"./ContextMenuDropDownButton.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { onMount } from 'svelte'\n  import Icon from 'svelte-awesome'\n  import { keyComboFromEvent } from '$lib/utils/keyBindings.js'\n  import { faLightbulb } from '@fortawesome/free-regular-svg-icons'\n  import { findNearestElement } from '$lib/utils/domUtils.js'\n  import type { ContextMenuItem, MenuItem } from '$lib/types.js'\n  import {\n    isContextMenuColumn,\n    isContextMenuRow,\n    isMenuButton,\n    isMenuDropDownButton,\n    isMenuLabel,\n    isMenuSeparator\n  } from '$lib/typeguards.js'\n  import ContextMenuButton from './ContextMenuButton.svelte'\n  import ContextMenuDropDownButton from './ContextMenuDropDownButton.svelte'\n\n  export let items: ContextMenuItem[]\n  export let onRequestClose: () => void\n  export let tip: string | undefined\n\n  let refContextMenu: HTMLDivElement\n\n  onMount(() => {\n    const firstEnabledButton = Array.from(refContextMenu.querySelectorAll('button')).find(\n      (button) => !button.disabled\n    )\n\n    if (firstEnabledButton) {\n      firstEnabledButton.focus()\n    }\n  })\n\n  const directionByCombo: Record<string, 'Up' | 'Down' | 'Left' | 'Right'> = {\n    ArrowUp: 'Up',\n    ArrowDown: 'Down',\n    ArrowLeft: 'Left',\n    ArrowRight: 'Right'\n  }\n\n  function handleKeyDown(event: KeyboardEvent & { currentTarget: EventTarget & HTMLDivElement }) {\n    const combo = keyComboFromEvent(event)\n    const direction: 'Up' | 'Down' | 'Left' | 'Right' | undefined = directionByCombo[combo]\n\n    if (direction && event.target) {\n      event.preventDefault()\n\n      const buttons: HTMLButtonElement[] = Array.from(\n        refContextMenu.querySelectorAll('button:not([disabled])')\n      )\n      const nearest = findNearestElement<HTMLButtonElement>({\n        allElements: buttons,\n        currentElement: event.target as unknown as HTMLButtonElement,\n        direction,\n        hasPrio: (element: HTMLButtonElement) => {\n          return element.getAttribute('data-type') !== 'jse-open-dropdown'\n        }\n      })\n      if (nearest) {\n        nearest.focus()\n      }\n    }\n  }\n\n  function unknownMenuItem(item: MenuItem): string {\n    console.error('Unknown type of context menu item', item)\n    return '???'\n  }\n</script>\n\n<div\n  role=\"menu\"\n  tabindex=\"-1\"\n  class=\"jse-contextmenu\"\n  bind:this={refContextMenu}\n  on:keydown={handleKeyDown}\n>\n  {#each items as item}\n    {#if isMenuButton(item)}\n      <ContextMenuButton {item} {onRequestClose} />\n    {:else if isMenuDropDownButton(item)}\n      <ContextMenuDropDownButton {item} {onRequestClose} />\n    {:else if isContextMenuRow(item)}\n      <div class=\"jse-row\">\n        {#each item.items as rowItem}\n          {#if isMenuButton(rowItem)}\n            <ContextMenuButton item={rowItem} {onRequestClose} />\n          {:else if isMenuDropDownButton(rowItem)}\n            <ContextMenuDropDownButton item={rowItem} {onRequestClose} />\n          {:else if isContextMenuColumn(rowItem)}\n            <div class=\"jse-column\">\n              {#each rowItem.items as columnItem}\n                {#if isMenuButton(columnItem)}\n                  <ContextMenuButton className=\"left\" item={columnItem} {onRequestClose} />\n                {:else if isMenuDropDownButton(columnItem)}\n                  <ContextMenuDropDownButton className=\"left\" item={columnItem} {onRequestClose} />\n                {:else if isMenuSeparator(columnItem)}\n                  <div class=\"jse-separator\" />\n                {:else if isMenuLabel(columnItem)}\n                  <div class=\"jse-label\">\n                    {columnItem.text}\n                  </div>\n                {:else}\n                  {unknownMenuItem(columnItem)}\n                {/if}\n              {/each}\n            </div>\n          {:else if isMenuSeparator(rowItem)}\n            <div class=\"jse-separator\" />\n          {:else}\n            {unknownMenuItem(rowItem)}\n          {/if}\n        {/each}\n      </div>\n    {:else if isMenuSeparator(item)}\n      <div class=\"jse-separator\" />\n    {:else}\n      {unknownMenuItem(item)}\n    {/if}\n  {/each}\n\n  {#if tip}\n    <div class=\"jse-row\">\n      <div class=\"jse-tip\">\n        <div class=\"jse-tip-icon\">\n          <Icon data={faLightbulb} />\n        </div>\n        <div class=\"jse-tip-text\">{tip}</div>\n      </div>\n    </div>\n  {/if}\n</div>\n\n<style src=\"./ContextMenu.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { createAutoScrollHandler } from '../../controls/createAutoScrollHandler.js'\n  import { faCheck, faCode, faWrench } from '@fortawesome/free-solid-svg-icons'\n  import { createDebug } from '$lib/utils/debug.js'\n  import type { JSONPatchDocument, JSONPath } from 'immutable-json-patch'\n  import { compileJSONPointer, existsIn, getIn, immutableJSONPatch } from 'immutable-json-patch'\n  import { jsonrepair } from 'jsonrepair'\n  import { initial, isEmpty, isEqual, noop, uniqueId } from 'lodash-es'\n  import { getContext, onDestroy, onMount, tick } from 'svelte'\n  import { createJump } from '$lib/assets/jump.js/src/jump.js'\n  import {\n    CONTEXT_MENU_HEIGHT,\n    CONTEXT_MENU_WIDTH,\n    SCROLL_DURATION,\n    SEARCH_BOX_HEIGHT,\n    SIMPLE_MODAL_OPTIONS\n  } from '$lib/constants.js'\n  import {\n    collapsePath,\n    createDocumentState,\n    documentStatePatch,\n    expandAll,\n    expandMinimal,\n    expandPath,\n    expandRecursive,\n    expandSection,\n    expandSingleItem,\n    expandWithCallback,\n    getDefaultExpand,\n    getEnforceString,\n    setEnforceString\n  } from '$lib/logic/documentState.js'\n  import { createHistory } from '$lib/logic/history.js'\n  import { duplicate, extract, revertJSONPatchWithMoveOperations } from '$lib/logic/operations.js'\n  import {\n    canConvert,\n    createAfterSelection,\n    createInsideSelection,\n    createKeySelection,\n    createSelectionFromOperations,\n    createValueSelection,\n    findRootPath,\n    getAnchorPath,\n    getEndPath,\n    getFocusPath,\n    getInitialSelection,\n    getSelectionDown,\n    getSelectionLeft,\n    getSelectionNextInside,\n    getSelectionPaths,\n    getSelectionRight,\n    getSelectionUp,\n    hasSelectionContents,\n    isAfterSelection,\n    isEditingSelection,\n    isInsideSelection,\n    isJSONSelection,\n    isKeySelection,\n    isMultiSelection,\n    isMultiSelectionWithOneItem,\n    isSelectionInsidePath,\n    isValueSelection,\n    removeEditModeFromSelection,\n    selectAll,\n    updateSelectionInDocumentState\n  } from '$lib/logic/selection.js'\n  import { mapValidationErrors, validateJSON } from '$lib/logic/validation.js'\n  import {\n    activeElementIsChildOf,\n    createNormalizationFunctions,\n    encodeDataPath,\n    findParentWithNodeName,\n    getWindow,\n    isChildOf,\n    isChildOfNodeName,\n    isEditableDivRef\n  } from '$lib/utils/domUtils.js'\n  import {\n    convertValue,\n    isJSONContent,\n    isTextContent,\n    normalizeJsonParseError,\n    parseAndRepair,\n    parsePartialJson,\n    repairPartialJson\n  } from '$lib/utils/jsonUtils.js'\n  import { keyComboFromEvent } from '$lib/utils/keyBindings.js'\n  import { isObjectOrArray, isUrl, stringConvert } from '$lib/utils/typeUtils.js'\n  import { createFocusTracker } from '../../controls/createFocusTracker.js'\n  import Message from '../../controls/Message.svelte'\n  import ValidationErrorsOverview from '../../controls/ValidationErrorsOverview.svelte'\n  import CopyPasteModal from '../../modals/CopyPasteModal.svelte'\n  import JSONRepairModal from '../../modals/JSONRepairModal.svelte'\n  import JSONNode from './JSONNode.svelte'\n  import TreeMenu from './menu/TreeMenu.svelte'\n  import Welcome from './Welcome.svelte'\n  import NavigationBar from '../../controls/navigationBar/NavigationBar.svelte'\n  import SearchBox from '../../controls/SearchBox.svelte'\n  import type {\n    AbsolutePopupContext,\n    AbsolutePopupOptions,\n    AfterPatchCallback,\n    Content,\n    ContentErrors,\n    ContextMenuItem,\n    ConvertType,\n    DocumentState,\n    HistoryItem,\n    InsertType,\n    JSONEditorSelection,\n    JSONParser,\n    JSONPatchResult,\n    JSONPathParser,\n    JSONPointerMap,\n    JSONSelection,\n    NestedValidationError,\n    OnBlur,\n    OnChange,\n    OnChangeMode,\n    OnClassName,\n    OnError,\n    OnExpand,\n    OnFocus,\n    OnJSONEditorModal,\n    OnRenderContextMenuInternal,\n    OnRenderMenuInternal,\n    OnRenderValue,\n    OnSelect,\n    OnSortModal,\n    OnTransformModal,\n    ParseError,\n    PastedJson,\n    SearchResult,\n    Section,\n    TransformModalOptions,\n    TreeModeContext,\n    ValidationError,\n    Validator,\n    ValueNormalization\n  } from '$lib/types'\n  import { Mode, ValidationSeverity } from '$lib/types.js'\n  import memoizeOne from 'memoize-one'\n  import { measure } from '$lib/utils/timeUtils.js'\n  import {\n    onCopy,\n    onCut,\n    onInsert,\n    onInsertCharacter,\n    onPaste,\n    onRemove\n  } from '$lib/logic/actions.js'\n  import JSONPreview from '../../controls/JSONPreview.svelte'\n  import type { Context } from 'svelte-simple-modal'\n  import ContextMenu from '../../controls/contextmenu/ContextMenu.svelte'\n  import createTreeContextMenuItems from './contextmenu/createTreeContextMenuItems'\n\n  const debug = createDebug('jsoneditor:TreeMode')\n\n  const isSSR = typeof window === 'undefined'\n  debug('isSSR:', isSSR)\n\n  const { open } = getContext<Context>('simple-modal')\n  const sortModalId = uniqueId()\n  const transformModalId = uniqueId()\n\n  const { openAbsolutePopup, closeAbsolutePopup } =\n    getContext<AbsolutePopupContext>('absolute-popup')\n\n  let refContents: HTMLDivElement | undefined\n  let refHiddenInput: HTMLInputElement\n  let refJsonEditor: HTMLDivElement\n  let hasFocus = false\n  const jump = createJump()\n\n  export let readOnly: boolean\n  export let externalContent: Content\n  export let externalSelection: JSONEditorSelection | null\n  export let mainMenuBar: boolean\n  export let navigationBar: boolean\n  export let escapeControlCharacters: boolean\n  export let escapeUnicodeCharacters: boolean\n  export let parser: JSONParser\n  export let parseMemoizeOne: JSONParser['parse']\n  export let validator: Validator | null\n  export let validationParser: JSONParser\n  export let pathParser: JSONPathParser\n  export let indentation: number | string\n  export let onError: OnError\n  export let onChange: OnChange\n  export let onChangeMode: OnChangeMode\n  export let onSelect: OnSelect\n  export let onRenderValue: OnRenderValue\n  export let onRenderMenu: OnRenderMenuInternal\n  export let onRenderContextMenu: OnRenderContextMenuInternal\n  export let onClassName: OnClassName | undefined\n  export let onFocus: OnFocus\n  export let onBlur: OnBlur\n  export let onSortModal: OnSortModal\n  export let onTransformModal: OnTransformModal\n  export let onJSONEditorModal: OnJSONEditorModal\n\n  // modalOpen is true when one of the modals is open.\n  // This is used to track whether the editor still has focus\n  let modalOpen = false\n\n  createFocusTracker({\n    onMount,\n    onDestroy,\n    getWindow: () => getWindow(refJsonEditor),\n    hasFocus: () => (modalOpen && document.hasFocus()) || activeElementIsChildOf(refJsonEditor),\n    onFocus: () => {\n      hasFocus = true\n      if (onFocus) {\n        onFocus()\n      }\n    },\n    onBlur: () => {\n      hasFocus = false\n      if (onBlur) {\n        onBlur()\n      }\n    }\n  })\n\n  let json: unknown | undefined\n  let text: string | undefined\n  let parseError: ParseError | undefined = undefined\n\n  function updateSelection(\n    selection:\n      | JSONSelection\n      | null\n      | ((selection: JSONSelection | null) => JSONSelection | null | undefined | void)\n  ) {\n    debug('updateSelection', selection)\n\n    const updatedSelection =\n      typeof selection === 'function' ? selection(documentState.selection) || null : selection\n\n    if (!isEqual(updatedSelection, documentState.selection)) {\n      documentState = {\n        ...documentState,\n        selection: updatedSelection\n      }\n\n      onSelect(updatedSelection)\n    }\n  }\n\n  let documentStateInitialized = false\n  let documentState = createDocumentState()\n\n  let normalization: ValueNormalization\n  $: normalization = createNormalizationFunctions({\n    escapeControlCharacters,\n    escapeUnicodeCharacters\n  })\n\n  $: debug('selection', documentState.selection)\n\n  let pastedJson: PastedJson\n\n  let searchResult: SearchResult | undefined\n  let showSearch = false\n  let showReplace = false\n\n  $: applySearchBoxSpacing(showSearch)\n\n  function applySearchBoxSpacing(showSearch: boolean) {\n    if (!refContents) {\n      return\n    }\n\n    if (showSearch) {\n      const padding = parseInt(getComputedStyle(refContents).padding) ?? 0\n      refContents.style.overflowAnchor = 'none'\n      refContents.style.paddingTop = padding + SEARCH_BOX_HEIGHT + 'px'\n      refContents.scrollTop += SEARCH_BOX_HEIGHT\n      refContents.style.overflowAnchor = ''\n    } else {\n      refContents.style.overflowAnchor = 'none'\n      refContents.style.paddingTop = ''\n      refContents.scrollTop -= SEARCH_BOX_HEIGHT\n      refContents.style.overflowAnchor = ''\n    }\n  }\n\n  function handleSearch(result: SearchResult | undefined) {\n    searchResult = result\n  }\n\n  async function handleFocusSearch(path: JSONPath) {\n    documentState = {\n      ...expandPath(json, documentState, path),\n      selection: null // navigation path of current selection would be confusing\n    }\n    await scrollTo(path)\n  }\n\n  function handleCloseSearch() {\n    showSearch = false\n    showReplace = false\n    focus()\n  }\n\n  function handleSelectValidationError(error: ValidationError) {\n    debug('select validation error', error)\n\n    updateSelection(createValueSelection(error.path, false))\n    scrollTo(error.path)\n  }\n\n  const history = createHistory<HistoryItem>({\n    onChange: (state) => {\n      historyState = state\n    }\n  })\n  let historyState = history.getState()\n\n  export function expand(callback: OnExpand = expandAll) {\n    debug('expand')\n\n    // clear the expanded state and visible sections (else you can't collapse anything)\n    const cleanDocumentState = {\n      ...documentState,\n      expandedMap: {},\n      visibleSectionsMap: {}\n    }\n\n    documentState = expandWithCallback(json, cleanDocumentState, [], callback)\n  }\n\n  // two-way binding of externalContent and internal json and text (\n  // when receiving an updated prop, we have to update state for example\n  $: applyExternalContent(externalContent)\n\n  $: applyExternalSelection(externalSelection)\n\n  let textIsRepaired = false\n\n  let validationErrors: ValidationError[] = []\n  $: updateValidationErrors(json, validator, parser, validationParser)\n\n  let validationErrorsMap: JSONPointerMap<NestedValidationError>\n  $: validationErrorsMap = mapValidationErrors(validationErrors)\n\n  // because onChange returns the validation errors and there is also a separate listener,\n  // we would execute validation twice. Memoizing the last result solves this.\n  const memoizedValidate = memoizeOne(validateJSON)\n\n  function updateValidationErrors(\n    json: unknown,\n    validator: Validator | null,\n    parser: JSONParser,\n    validationParser: JSONParser\n  ) {\n    measure(\n      () => {\n        let newValidationErrors: ValidationError[]\n        try {\n          newValidationErrors = memoizedValidate(json, validator, parser, validationParser)\n        } catch (err) {\n          newValidationErrors = [\n            {\n              path: [],\n              message: 'Failed to validate: ' + (err as Error).message,\n              severity: ValidationSeverity.warning\n            }\n          ]\n        }\n\n        if (!isEqual(newValidationErrors, validationErrors)) {\n          debug('validationErrors changed:', newValidationErrors)\n          validationErrors = newValidationErrors\n        }\n      },\n      (duration) => debug(`validationErrors updated in ${duration} ms`)\n    )\n  }\n\n  export function validate(): ContentErrors | null {\n    debug('validate')\n\n    if (parseError) {\n      return {\n        parseError,\n        isRepairable: false // not applicable, if repairable, we will not have a parseError\n      }\n    }\n\n    // make sure the validation results are up-to-date\n    // normally, they are only updated on the next tick after the json is changed\n    updateValidationErrors(json, validator, parser, validationParser)\n    return !isEmpty(validationErrors) ? { validationErrors } : null\n  }\n\n  export function getJson() {\n    return json\n  }\n\n  function getDocumentState(): DocumentState {\n    return documentState\n  }\n\n  function applyExternalContent(updatedContent: Content) {\n    if (isJSONContent(updatedContent)) {\n      applyExternalJson(updatedContent.json)\n    } else if (isTextContent(updatedContent)) {\n      applyExternalText(updatedContent.text)\n    }\n  }\n\n  function applyExternalJson(updatedJson: unknown | undefined) {\n    if (updatedJson === undefined) {\n      return\n    }\n\n    // TODO: this is inefficient. Make an optional flag promising that the updates are immutable so we don't have to do a deep equality check? First do some profiling!\n    const isChanged = !isEqual(json, updatedJson)\n\n    debug('update external json', { isChanged, currentlyText: json === undefined })\n\n    if (!isChanged) {\n      // no actual change, don't do anything\n      return\n    }\n\n    const previousState = documentState\n    const previousJson = json\n    const previousText = text\n    const previousTextIsRepaired = textIsRepaired\n\n    json = updatedJson\n    expandWhenNotInitialized(json)\n    text = undefined\n    textIsRepaired = false\n    parseError = undefined\n    clearSelectionWhenNotExisting(json)\n\n    addHistoryItem({\n      previousJson,\n      previousState,\n      previousText,\n      previousTextIsRepaired\n    })\n  }\n\n  function applyExternalText(updatedText: string | undefined) {\n    if (updatedText === undefined || isJSONContent(externalContent)) {\n      return\n    }\n\n    const isChanged = updatedText !== text\n\n    debug('update external text', { isChanged })\n\n    if (!isChanged) {\n      // no actual change, don't do anything\n      return\n    }\n\n    const previousJson = json\n    const previousState = documentState\n    const previousText = text\n    const previousTextIsRepaired = textIsRepaired\n\n    try {\n      json = parseMemoizeOne(updatedText)\n      expandWhenNotInitialized(json)\n      text = updatedText\n      textIsRepaired = false\n      parseError = undefined\n    } catch (err) {\n      try {\n        json = parseMemoizeOne(jsonrepair(updatedText))\n        expandWhenNotInitialized(json)\n        text = updatedText\n        textIsRepaired = true\n        parseError = undefined\n        clearSelectionWhenNotExisting(json)\n      } catch (repairError) {\n        // no valid JSON, will show empty document or invalid json\n        json = undefined\n        text = externalContent['text']\n        textIsRepaired = false\n        parseError =\n          text !== undefined && text !== ''\n            ? normalizeJsonParseError(text, (err as Error).message || String(err))\n            : undefined\n      }\n    }\n\n    clearSelectionWhenNotExisting(json)\n\n    addHistoryItem({\n      previousJson,\n      previousState,\n      previousText,\n      previousTextIsRepaired\n    })\n  }\n\n  function applyExternalSelection(externalSelection: JSONEditorSelection | null) {\n    if (!isEqual(documentState.selection, externalSelection)) {\n      debug('applyExternalSelection', externalSelection)\n\n      if (isJSONSelection(externalSelection) || externalSelection === null) {\n        updateSelection(externalSelection)\n      }\n    }\n  }\n\n  function expandWhenNotInitialized(json: unknown) {\n    if (!documentStateInitialized) {\n      documentStateInitialized = true\n      documentState = expandWithCallback(json, documentState, [], getDefaultExpand(json))\n    }\n  }\n\n  function clearSelectionWhenNotExisting(json: unknown) {\n    if (!documentState.selection) {\n      return\n    }\n\n    if (\n      existsIn(json, getAnchorPath(documentState.selection)) &&\n      existsIn(json, getFocusPath(documentState.selection))\n    ) {\n      return\n    }\n\n    debug('clearing selection: path does not exist anymore', documentState.selection)\n    documentState = {\n      ...documentState,\n      selection: getInitialSelection(json, documentState)\n    }\n  }\n\n  function addHistoryItem({\n    previousJson,\n    previousState,\n    previousText,\n    previousTextIsRepaired\n  }: {\n    previousJson: unknown | undefined\n    previousText: string | undefined\n    previousState: DocumentState\n    previousTextIsRepaired: boolean\n  }) {\n    if (previousJson === undefined && previousText === undefined) {\n      // initialization -> do not create a history item\n      return\n    }\n\n    if (json !== undefined) {\n      if (previousJson !== undefined) {\n        // regular undo/redo with JSON patch\n        history.add({\n          undo: {\n            patch: [{ op: 'replace', path: '', value: previousJson }],\n            state: removeEditModeFromSelection(previousState),\n            json: undefined,\n            text: previousText,\n            textIsRepaired: previousTextIsRepaired\n          },\n          redo: {\n            patch: [{ op: 'replace', path: '', value: json }],\n            state: removeEditModeFromSelection(documentState),\n            json: undefined,\n            text,\n            textIsRepaired\n          }\n        })\n      } else {\n        history.add({\n          undo: {\n            patch: undefined,\n            json: undefined,\n            text: previousText,\n            state: removeEditModeFromSelection(previousState),\n            textIsRepaired: previousTextIsRepaired\n          },\n          redo: {\n            patch: undefined,\n            json,\n            state: removeEditModeFromSelection(documentState),\n            text,\n            textIsRepaired\n          }\n        })\n      }\n    } else {\n      if (previousJson !== undefined) {\n        history.add({\n          undo: {\n            patch: undefined,\n            json: previousJson,\n            state: removeEditModeFromSelection(previousState),\n            text: previousText,\n            textIsRepaired: previousTextIsRepaired\n          },\n          redo: {\n            patch: undefined,\n            json: undefined,\n            text,\n            textIsRepaired,\n            state: removeEditModeFromSelection(documentState)\n          }\n        })\n      } else {\n        // this cannot happen. Nothing to do, no change\n      }\n    }\n  }\n\n  function createDefaultSelection() {\n    debug('createDefaultSelection')\n\n    documentState = {\n      ...documentState,\n      selection: createValueSelection([], false)\n    }\n  }\n\n  export function patch(\n    operations: JSONPatchDocument,\n    afterPatch?: AfterPatchCallback\n  ): JSONPatchResult {\n    debug('patch', operations, afterPatch)\n\n    if (json === undefined) {\n      throw new Error('Cannot apply patch: no JSON')\n    }\n\n    const previousJson = json\n    const previousState = documentState\n    const previousText = text\n    const previousTextIsRepaired = textIsRepaired\n\n    // execute the patch operations\n    const undo: JSONPatchDocument = revertJSONPatchWithMoveOperations(\n      json,\n      operations\n    ) as JSONPatchDocument\n    const patched = documentStatePatch(json, documentState, operations)\n\n    // update the selection based on the operations\n    const updatedSelection = createSelectionFromOperations(json, operations)\n    const patchedDocumentState = updateSelectionInDocumentState(\n      patched.documentState,\n      updatedSelection,\n      false\n    )\n    debug('patch updatedSelection', updatedSelection)\n\n    const callback =\n      typeof afterPatch === 'function' ? afterPatch(patched.json, patchedDocumentState) : undefined\n\n    json = callback && callback.json !== undefined ? callback.json : patched.json\n    const newState =\n      callback && callback.state !== undefined ? callback.state : patchedDocumentState\n    documentState = newState\n    text = undefined\n    textIsRepaired = false\n    pastedJson = undefined\n    parseError = undefined\n\n    // ensure the selection is valid\n    clearSelectionWhenNotExisting(json)\n\n    history.add({\n      undo: {\n        patch: undo,\n        json: undefined,\n        text: previousText,\n        state: removeEditModeFromSelection(previousState),\n        textIsRepaired: previousTextIsRepaired\n      },\n      redo: {\n        patch: operations,\n        json: undefined,\n        state: removeEditModeFromSelection(newState),\n        text,\n        textIsRepaired\n      }\n    })\n\n    const patchResult = {\n      json,\n      previousJson,\n      undo,\n      redo: operations\n    }\n\n    return patchResult\n  }\n\n  // TODO: cleanup logging\n  // $: debug('json', json)\n  // $: debug('state', state)\n  // $: debug('selection', selection)\n\n  function handleEditKey() {\n    if (readOnly || !documentState.selection) {\n      return\n    }\n\n    updateSelection(createKeySelection(getFocusPath(documentState.selection), true))\n  }\n\n  function handleEditValue() {\n    if (readOnly || !documentState.selection) {\n      return\n    }\n\n    const path = getFocusPath(documentState.selection)\n    const value = getIn(json, path)\n    if (isObjectOrArray(value)) {\n      openJSONEditorModal(path, value)\n    } else {\n      updateSelection(createValueSelection(path, true))\n    }\n  }\n\n  function handleToggleEnforceString() {\n    if (readOnly || !isValueSelection(documentState.selection)) {\n      return\n    }\n\n    const path = getFocusPath(documentState.selection)\n    const pointer = compileJSONPointer(path)\n    const value = getIn(json, path)\n    const enforceString = !getEnforceString(value, documentState.enforceStringMap, pointer, parser)\n    const updatedValue = enforceString ? String(value) : stringConvert(String(value), parser)\n\n    debug('handleToggleEnforceString', { enforceString, value, updatedValue })\n\n    handlePatch(\n      [\n        {\n          op: 'replace',\n          path: pointer,\n          value: updatedValue\n        }\n      ],\n      (patchedJson, patchedState) => {\n        return {\n          state: setEnforceString(patchedState, pointer, enforceString)\n        }\n      }\n    )\n  }\n\n  export function acceptAutoRepair(): Content {\n    if (textIsRepaired && json !== undefined) {\n      handleReplaceJson(json)\n    }\n\n    return json !== undefined ? { json } : { text: text || '' }\n  }\n\n  async function handleCut(indent = true) {\n    await onCut({\n      json,\n      documentState,\n      indentation: indent ? indentation : undefined,\n      readOnly,\n      parser,\n      onPatch: handlePatch\n    })\n  }\n\n  async function handleCopy(indent = true) {\n    if (json === undefined) {\n      return\n    }\n\n    await onCopy({\n      json,\n      documentState,\n      indentation: indent ? indentation : undefined,\n      parser\n    })\n  }\n\n  function handlePaste(event: ClipboardEvent) {\n    event.preventDefault()\n\n    const clipboardText = event.clipboardData?.getData('text/plain') as string | undefined\n    if (clipboardText === undefined) {\n      return\n    }\n\n    onPaste({\n      clipboardText,\n      json,\n      selection: documentState.selection,\n      readOnly,\n      parser,\n      onPatch: handlePatch,\n      onChangeText: handleChangeText,\n      openRepairModal\n    })\n  }\n\n  function handlePasteFromMenu() {\n    open(\n      CopyPasteModal,\n      {},\n      {\n        ...SIMPLE_MODAL_OPTIONS,\n        styleWindow: {\n          width: '450px'\n        }\n      },\n      {\n        onClose: () => focus()\n      }\n    )\n  }\n\n  function openRepairModal(text: string, onApply: (repairedText: string) => void) {\n    open(\n      JSONRepairModal,\n      {\n        text,\n        onParse: (text: string) => parsePartialJson(text, (t) => parseAndRepair(t, parser)),\n        onRepair: repairPartialJson,\n        onApply\n      },\n      {\n        ...SIMPLE_MODAL_OPTIONS,\n        styleWindow: {\n          width: '600px',\n          height: '500px'\n        },\n        styleContent: {\n          padding: 0,\n          height: '100%'\n        }\n      },\n      {\n        onClose: () => focus()\n      }\n    )\n  }\n\n  function handleRemove() {\n    onRemove({\n      json,\n      text,\n      documentState,\n      keepSelection: false,\n      readOnly,\n      onChange,\n      onPatch: handlePatch\n    })\n  }\n\n  function handleDuplicate() {\n    if (\n      readOnly ||\n      json === undefined ||\n      !documentState.selection ||\n      !hasSelectionContents ||\n      isEmpty(getFocusPath(documentState.selection)) // root selected, cannot duplicate\n    ) {\n      return\n    }\n\n    debug('duplicate', { selection: documentState.selection })\n\n    const operations = duplicate(json, getSelectionPaths(json, documentState.selection))\n\n    handlePatch(operations)\n  }\n\n  function handleExtract() {\n    if (\n      readOnly ||\n      !documentState.selection ||\n      (!isMultiSelection(documentState.selection) && !isValueSelection(documentState.selection)) ||\n      isEmpty(getFocusPath(documentState.selection)) // root selected, cannot extract\n    ) {\n      return\n    }\n\n    debug('extract', { selection: documentState.selection })\n\n    const operations = extract(json, documentState.selection)\n\n    handlePatch(operations, (patchedJson, patchedState) => {\n      if (isObjectOrArray(patchedJson)) {\n        // expand extracted object/array\n        const path: JSONPath = []\n        return {\n          state: expandRecursive(patchedJson, patchedState, path)\n        }\n      }\n    })\n  }\n\n  function handleInsert(insertType: InsertType): void {\n    onInsert({\n      insertType,\n      selectInside: true,\n      refJsonEditor,\n      json,\n      selection: documentState.selection,\n      readOnly,\n      parser,\n      onPatch: handlePatch,\n      onReplaceJson: handleReplaceJson\n    })\n  }\n\n  function handleInsertFromContextMenu(type: InsertType) {\n    if (isKeySelection(documentState.selection)) {\n      // in this case, we do not want to rename the key, but replace the property\n      updateSelection(createValueSelection(documentState.selection.path, false))\n    }\n\n    if (!documentState.selection) {\n      updateSelection(getInitialSelection(json, documentState))\n    }\n\n    handleInsert(type)\n  }\n\n  function handleConvert(type: ConvertType) {\n    if (readOnly || !documentState.selection) {\n      return\n    }\n\n    if (!canConvert(documentState.selection)) {\n      onError(new Error(`Cannot convert current selection to ${type}`))\n      return\n    }\n\n    try {\n      const path = getAnchorPath(documentState.selection)\n      const currentValue: unknown = getIn(json, path)\n      const convertedValue = convertValue(\n        currentValue,\n        type as 'value' | 'object' | 'array',\n        parser\n      )\n      if (convertedValue === currentValue) {\n        // no change, do nothing\n        return\n      }\n\n      const operations: JSONPatchDocument = [\n        { op: 'replace', path: compileJSONPointer(path), value: convertedValue }\n      ]\n\n      debug('handleConvert', { selection: documentState.selection, path, type, operations })\n\n      handlePatch(operations, (patchedJson, patchedState) => {\n        // expand converted object/array\n        return {\n          state: documentState.selection\n            ? expandRecursive(patchedJson, patchedState, getFocusPath(documentState.selection))\n            : documentState\n        }\n      })\n    } catch (err) {\n      onError(err as Error)\n    }\n  }\n\n  function handleInsertBefore() {\n    if (!documentState.selection) {\n      return\n    }\n\n    const selectionBefore = getSelectionUp(json, documentState, false)\n    const parentPath = initial(getFocusPath(documentState.selection))\n\n    if (\n      selectionBefore &&\n      !isEmpty(getFocusPath(selectionBefore)) &&\n      isEqual(parentPath, initial(getFocusPath(selectionBefore)))\n    ) {\n      updateSelection(createAfterSelection(getFocusPath(selectionBefore)))\n    } else {\n      updateSelection(createInsideSelection(parentPath))\n    }\n\n    debug('insert before', { selection: documentState.selection, selectionBefore, parentPath })\n\n    tick().then(() => handleContextMenu())\n  }\n\n  function handleInsertAfter() {\n    if (!documentState.selection) {\n      return\n    }\n\n    const path = getEndPath(json, documentState.selection)\n\n    debug('insert after', path)\n\n    updateSelection(createAfterSelection(path))\n\n    tick().then(() => handleContextMenu())\n  }\n\n  async function handleInsertCharacter(char: string) {\n    await onInsertCharacter({\n      char,\n      selectInside: true,\n      refJsonEditor,\n      json,\n      selection: documentState.selection,\n      readOnly,\n      parser,\n      onPatch: handlePatch,\n      onReplaceJson: handleReplaceJson,\n      onSelect: updateSelection\n    })\n  }\n\n  function handleUndo() {\n    if (readOnly) {\n      return\n    }\n\n    if (!history.getState().canUndo) {\n      return\n    }\n\n    const item = history.undo()\n    if (!item) {\n      return\n    }\n\n    const previousContent = { json, text }\n\n    json = item.undo.patch ? immutableJSONPatch(json, item.undo.patch) : item.undo.json\n    documentState = item.undo.state\n    text = item.undo.text\n    textIsRepaired = item.undo.textIsRepaired\n    parseError = undefined\n\n    debug('undo', { item, json, documentState })\n\n    const patchResult =\n      item.undo.patch && item.redo.patch\n        ? {\n            json,\n            previousJson: previousContent.json,\n            redo: item.undo.patch,\n            undo: item.redo.patch\n          }\n        : null\n\n    emitOnChange(previousContent, patchResult)\n\n    focus()\n    if (documentState.selection) {\n      scrollTo(getFocusPath(documentState.selection), false)\n    }\n  }\n\n  function handleRedo() {\n    if (readOnly) {\n      return\n    }\n\n    if (!history.getState().canRedo) {\n      return\n    }\n\n    const item = history.redo()\n    if (!item) {\n      return\n    }\n\n    const previousContent = { json, text }\n\n    json = item.redo.patch ? immutableJSONPatch(json, item.redo.patch) : item.redo.json\n    documentState = item.redo.state\n    text = item.redo.text\n    textIsRepaired = item.redo.textIsRepaired\n    parseError = undefined\n\n    debug('redo', { item, json, documentState })\n\n    const patchResult =\n      item.undo.patch && item.redo.patch\n        ? {\n            json,\n            previousJson: previousContent.json,\n            redo: item.redo.patch,\n            undo: item.undo.patch\n          }\n        : null\n\n    emitOnChange(previousContent, patchResult)\n\n    focus()\n    if (documentState.selection) {\n      scrollTo(getFocusPath(documentState.selection), false)\n    }\n  }\n\n  function openSortModal(rootPath: JSONPath) {\n    if (readOnly || json === undefined) {\n      return\n    }\n\n    modalOpen = true\n\n    onSortModal({\n      id: sortModalId,\n      json,\n      rootPath,\n      onSort: async ({ operations }) => {\n        debug('onSort', rootPath, operations)\n\n        handlePatch(operations, (patchedJson, patchedState) => ({\n          // expand the newly replaced array and select it\n          state: {\n            ...expandRecursive(patchedJson, patchedState, rootPath),\n            selection: createValueSelection(rootPath, false)\n          }\n        }))\n      },\n      onClose: () => {\n        modalOpen = false\n        focus()\n      }\n    })\n  }\n\n  function handleSortSelection() {\n    if (!documentState.selection) {\n      return\n    }\n\n    const rootPath = findRootPath(json, documentState.selection)\n    openSortModal(rootPath)\n  }\n\n  function handleSortAll() {\n    const rootPath: JSONPath = []\n    openSortModal(rootPath)\n  }\n\n  /**\n   * This method is exposed via JSONEditor.transform\n   */\n  export function openTransformModal(options: TransformModalOptions) {\n    if (json === undefined) {\n      return\n    }\n\n    const { id, onTransform, onClose } = options\n    const rootPath = options.rootPath || []\n\n    modalOpen = true\n\n    onTransformModal({\n      id: id || transformModalId,\n      json,\n      rootPath,\n      onTransform: (operations) => {\n        if (onTransform) {\n          onTransform({\n            operations,\n            json,\n            transformedJson: immutableJSONPatch(json, operations)\n          })\n        } else {\n          debug('onTransform', rootPath, operations)\n\n          handlePatch(operations, (patchedJson, patchedState) => ({\n            // expand the newly replaced array and select it\n            state: {\n              ...expandRecursive(patchedJson, patchedState, rootPath),\n              selection: createValueSelection(rootPath, false)\n            }\n          }))\n        }\n      },\n      onClose: () => {\n        modalOpen = false\n        focus()\n        if (onClose) {\n          onClose()\n        }\n      }\n    })\n  }\n\n  function handleTransformSelection() {\n    if (!documentState.selection) {\n      return\n    }\n\n    const rootPath = findRootPath(json, documentState.selection)\n    openTransformModal({\n      rootPath\n    })\n  }\n\n  function handleTransformAll() {\n    openTransformModal({\n      rootPath: []\n    })\n  }\n\n  function openJSONEditorModal(path: JSONPath, value: unknown) {\n    debug('openJSONEditorModal', { path, value })\n\n    modalOpen = true\n\n    // open a popup where you can edit the nested object/array\n    onJSONEditorModal({\n      content: {\n        json: value\n      },\n      path,\n      onPatch: context.onPatch,\n      onClose: () => {\n        modalOpen = false\n        focus()\n      }\n    })\n  }\n\n  /**\n   * Scroll the window vertically to the node with given path.\n   * Expand the path when needed.\n   */\n  export async function scrollTo(path: JSONPath, scrollToWhenVisible = true): Promise<void> {\n    documentState = expandPath(json, documentState, path)\n    await tick() // await rerender (else the element we want to scroll to does not yet exist)\n\n    const elem = findElement(path)\n\n    debug('scrollTo', { path, elem, refContents })\n\n    if (!elem || !refContents) {\n      return Promise.resolve()\n    }\n\n    const viewPortRect = refContents.getBoundingClientRect()\n    const elemRect = elem.getBoundingClientRect()\n    if (!scrollToWhenVisible) {\n      if (elemRect.bottom > viewPortRect.top && elemRect.top < viewPortRect.bottom) {\n        // element is fully or partially visible, don't scroll to it\n        return Promise.resolve()\n      }\n    }\n\n    const offset = -(viewPortRect.height / 4)\n\n    return new Promise<void>((resolve) => {\n      jump(elem, {\n        container: refContents,\n        offset,\n        duration: SCROLL_DURATION,\n        callback: () => resolve()\n      })\n    })\n  }\n\n  /**\n   * Find the DOM element of a given path.\n   * Note that the path can only be found when the node is expanded.\n   */\n  export function findElement(path: JSONPath): Element | null {\n    return refContents\n      ? refContents.querySelector(`div[data-path=\"${encodeDataPath(path)}\"]`)\n      : null\n  }\n\n  /**\n   * If given path is outside the visible viewport, scroll up/down.\n   * When the path is already in view, nothing is done\n   */\n  function scrollIntoView(path: JSONPath) {\n    const elem = findElement(path)\n\n    if (!elem || !refContents) {\n      return\n    }\n\n    const viewPortRect = refContents.getBoundingClientRect()\n    const elemRect = elem.getBoundingClientRect()\n    const margin = 20\n    const elemHeight = isObjectOrArray(getIn(json, path))\n      ? margin // do not use real height when array or object\n      : elemRect.height\n\n    if (elemRect.top < viewPortRect.top + margin) {\n      // scroll down\n      jump(elem, {\n        container: refContents,\n        offset: -margin,\n        duration: 0\n      })\n    } else if (elemRect.top + elemHeight > viewPortRect.bottom - margin) {\n      // scroll up\n      jump(elem, {\n        container: refContents,\n        offset: -(viewPortRect.height - elemHeight - margin),\n        duration: 0\n      })\n    }\n  }\n\n  function emitOnChange(previousContent: Content, patchResult: JSONPatchResult | null) {\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    if (previousContent.json === undefined && previousContent?.text === undefined) {\n      // initialization -> do not fire an onChange event\n      return\n    }\n\n    // make sure we cannot send an invalid contents like having both\n    // json and text defined, or having none defined\n    if (text !== undefined) {\n      const content = { text, json: undefined }\n      onChange?.(content, previousContent, {\n        contentErrors: validate(),\n        patchResult\n      })\n    } else if (json !== undefined) {\n      const content = { text: undefined, json }\n      onChange?.(content, previousContent, {\n        contentErrors: validate(),\n        patchResult\n      })\n    }\n  }\n\n  function handlePatch(\n    operations: JSONPatchDocument,\n    afterPatch?: AfterPatchCallback\n  ): JSONPatchResult {\n    debug('handlePatch', operations, afterPatch)\n\n    const previousContent = { json, text }\n    const patchResult = patch(operations, afterPatch)\n\n    emitOnChange(previousContent, patchResult)\n\n    return patchResult\n  }\n\n  function handleReplaceJson(updatedJson: unknown, afterPatch?: AfterPatchCallback) {\n    const previousState = documentState\n    const previousJson = json\n    const previousText = text\n    const previousContent = { json, text }\n    const previousTextIsRepaired = textIsRepaired\n\n    const updatedState = expandWithCallback(json, documentState, [], expandMinimal)\n\n    const callback =\n      typeof afterPatch === 'function' ? afterPatch(updatedJson, updatedState) : undefined\n\n    json = callback && callback.json !== undefined ? callback.json : updatedJson\n    documentState = callback && callback.state !== undefined ? callback.state : updatedState\n    text = undefined\n    textIsRepaired = false\n    parseError = undefined\n\n    // make sure the selection is valid\n    clearSelectionWhenNotExisting(json)\n\n    addHistoryItem({\n      previousJson,\n      previousState,\n      previousText,\n      previousTextIsRepaired\n    })\n\n    // we could work out a patchResult, or use patch(), but only when the previous and new\n    // contents are both json and not text. We go for simplicity and consistency here and\n    // do _not_ return a patchResult ever.\n    const patchResult = null\n\n    emitOnChange(previousContent, patchResult)\n  }\n\n  function handleChangeText(updatedText: string, afterPatch?: AfterPatchCallback) {\n    debug('handleChangeText')\n\n    const previousState = documentState\n    const previousJson = json\n    const previousText = text\n    const previousContent = { json, text }\n    const previousTextIsRepaired = textIsRepaired\n\n    try {\n      json = parseMemoizeOne(updatedText)\n      documentState = expandWithCallback(json, documentState, [], expandMinimal)\n      text = undefined\n      textIsRepaired = false\n      parseError = undefined\n    } catch (err) {\n      try {\n        json = parseMemoizeOne(jsonrepair(updatedText))\n        documentState = expandWithCallback(json, documentState, [], expandMinimal)\n        text = updatedText\n        textIsRepaired = true\n        parseError = undefined\n      } catch (repairError) {\n        // no valid JSON, will show empty document or invalid json\n        json = undefined\n        documentState = createDocumentState({ json, expand: expandMinimal })\n        text = updatedText\n        textIsRepaired = false\n        parseError =\n          text !== ''\n            ? normalizeJsonParseError(text, (err as Error).message || String(err))\n            : undefined\n      }\n    }\n\n    if (typeof afterPatch === 'function') {\n      const callback = afterPatch(json, documentState)\n\n      json = callback && callback.json ? callback.json : json\n      documentState = callback && callback.state ? callback.state : documentState\n    }\n\n    // ensure the selection is valid\n    clearSelectionWhenNotExisting(json)\n\n    addHistoryItem({\n      previousJson,\n      previousState,\n      previousText,\n      previousTextIsRepaired\n    })\n\n    // no JSON patch actions available in text mode\n    const patchResult = null\n\n    emitOnChange(previousContent, patchResult)\n  }\n\n  /**\n   * Toggle expanded state of a node\n   * @param path The path to be expanded\n   * @param expanded  True to expand, false to collapse\n   * @param [recursive=false]  Only applicable when expanding\n   */\n  function handleExpand(path: JSONPath, expanded: boolean, recursive = false): void {\n    debug('expand', { path, expanded, recursive })\n\n    if (expanded) {\n      if (recursive) {\n        documentState = expandWithCallback(json, documentState, path, expandAll)\n      } else {\n        documentState = expandSingleItem(documentState, path)\n      }\n    } else {\n      documentState = collapsePath(documentState, path)\n    }\n\n    if (documentState.selection && !expanded) {\n      // check whether the selection is still visible and not collapsed\n      if (isSelectionInsidePath(documentState.selection, path)) {\n        // remove selection when not visible anymore\n        updateSelection(null)\n      }\n    }\n\n    // set focus to the hidden input, so we can capture quick keys like Ctrl+X, Ctrl+C, Ctrl+V\n    focus()\n  }\n\n  function handleExpandAll() {\n    handleExpand([], true, true)\n  }\n\n  function handleCollapseAll() {\n    handleExpand([], false, true)\n  }\n\n  function openFind(findAndReplace: boolean): void {\n    debug('openFind', { findAndReplace })\n\n    showSearch = false\n    showReplace = false\n\n    tick().then(() => {\n      // trick to make sure the focus goes to the search box\n      showSearch = true\n      showReplace = findAndReplace\n    })\n  }\n\n  function handleExpandSection(path: JSONPath, section: Section) {\n    debug('handleExpandSection', path, section)\n\n    const pointer = compileJSONPointer(path)\n    documentState = expandSection(json, documentState, pointer, section)\n  }\n\n  function handlePasteJson(newPastedJson: PastedJson) {\n    debug('pasted json as text', newPastedJson)\n\n    pastedJson = newPastedJson\n  }\n\n  function handleKeyDown(event: KeyboardEvent) {\n    const combo = keyComboFromEvent(event)\n    const keepAnchorPath = event.shiftKey\n    debug('keydown', { combo, key: event.key })\n\n    if (combo === 'Ctrl+X') {\n      // cut formatted\n      event.preventDefault()\n      handleCut(true)\n    }\n    if (combo === 'Ctrl+Shift+X') {\n      // cut compact\n      event.preventDefault()\n      handleCut(false)\n    }\n    if (combo === 'Ctrl+C') {\n      // copy formatted\n      event.preventDefault()\n      handleCopy(true)\n    }\n    if (combo === 'Ctrl+Shift+C') {\n      // copy compact\n      event.preventDefault()\n      handleCopy(false)\n    }\n    // Note: Ctrl+V (paste) is handled by the on:paste event\n\n    if (combo === 'Ctrl+D') {\n      event.preventDefault()\n      handleDuplicate()\n    }\n    if (combo === 'Delete' || combo === 'Backspace') {\n      event.preventDefault()\n      handleRemove()\n    }\n    if (combo === 'Insert') {\n      event.preventDefault()\n      handleInsert('structure')\n    }\n    if (combo === 'Ctrl+A') {\n      event.preventDefault()\n      updateSelection(selectAll())\n    }\n\n    if (combo === 'Ctrl+Q') {\n      handleContextMenu(event)\n    }\n\n    if (combo === 'ArrowUp' || combo === 'Shift+ArrowUp') {\n      event.preventDefault()\n\n      const newSelection = documentState.selection\n        ? getSelectionUp(json, documentState, keepAnchorPath) || documentState.selection\n        : getInitialSelection(json, documentState)\n\n      updateSelection(newSelection)\n      scrollIntoView(getFocusPath(newSelection))\n    }\n    if (combo === 'ArrowDown' || combo === 'Shift+ArrowDown') {\n      event.preventDefault()\n\n      const newSelection = documentState.selection\n        ? getSelectionDown(json, documentState, keepAnchorPath) || documentState.selection\n        : getInitialSelection(json, documentState)\n\n      updateSelection(newSelection)\n      scrollIntoView(getFocusPath(newSelection))\n    }\n    if (combo === 'ArrowLeft' || combo === 'Shift+ArrowLeft') {\n      event.preventDefault()\n\n      const newSelection = documentState.selection\n        ? getSelectionLeft(json, documentState, keepAnchorPath, !readOnly) ||\n          documentState.selection\n        : getInitialSelection(json, documentState)\n\n      updateSelection(newSelection)\n      scrollIntoView(getFocusPath(newSelection))\n    }\n    if (combo === 'ArrowRight' || combo === 'Shift+ArrowRight') {\n      event.preventDefault()\n\n      const newSelection =\n        documentState.selection && json !== undefined\n          ? getSelectionRight(json, documentState, keepAnchorPath, !readOnly) ||\n            documentState.selection\n          : getInitialSelection(json, documentState)\n\n      updateSelection(newSelection)\n      scrollIntoView(getFocusPath(newSelection))\n    }\n\n    if (combo === 'Enter' && documentState.selection) {\n      // when the selection consists of a single Array item, change selection to editing its value\n      if (isMultiSelectionWithOneItem(documentState.selection)) {\n        const path = documentState.selection.focusPath\n        const parent = getIn(json, initial(path))\n        if (Array.isArray(parent)) {\n          // change into selection of the value\n          updateSelection(createValueSelection(path, false))\n        }\n      }\n\n      if (isKeySelection(documentState.selection)) {\n        // go to key edit mode\n        event.preventDefault()\n        updateSelection({ ...documentState.selection, edit: true })\n      }\n\n      if (isValueSelection(documentState.selection)) {\n        event.preventDefault()\n\n        const value = getIn(json, documentState.selection.path)\n        if (isObjectOrArray(value)) {\n          // expand object/array\n          handleExpand(documentState.selection.path, true)\n        } else {\n          // go to value edit mode\n          updateSelection({ ...documentState.selection, edit: true })\n        }\n      }\n    }\n\n    const normalizedCombo = combo.replace(/^Shift\\+/, '') // replace 'Shift+A' with 'A'\n    if (normalizedCombo.length === 1 && documentState.selection) {\n      // a regular key like a, A, _, etc is entered.\n      // Replace selected contents with a new value having this first character as text\n      event.preventDefault()\n      handleInsertCharacter(event.key)\n      return\n    }\n\n    if (\n      combo === 'Enter' &&\n      (isAfterSelection(documentState.selection) || isInsideSelection(documentState.selection))\n    ) {\n      // Enter on an insert area -> open the area in edit mode\n      event.preventDefault()\n      handleInsertCharacter('')\n      return\n    }\n\n    if (combo === 'Ctrl+Enter' && isValueSelection(documentState.selection)) {\n      const value = getIn(json, documentState.selection.path)\n\n      if (isUrl(value)) {\n        // open url in new page\n        window.open(String(value), '_blank')\n      }\n    }\n\n    if (combo === 'Escape' && documentState.selection) {\n      event.preventDefault()\n      updateSelection(null)\n    }\n\n    if (combo === 'Ctrl+F') {\n      event.preventDefault()\n      openFind(false)\n    }\n\n    if (combo === 'Ctrl+H') {\n      event.preventDefault()\n      openFind(true)\n    }\n\n    if (combo === 'Ctrl+Z') {\n      event.preventDefault()\n      handleUndo()\n    }\n\n    if (combo === 'Ctrl+Shift+Z') {\n      event.preventDefault()\n      handleRedo()\n    }\n  }\n\n  function handleMouseDown(event: Event) {\n    debug('handleMouseDown', event)\n\n    const target = event.target as HTMLElement\n\n    if (!isChildOfNodeName(target, 'BUTTON') && !target.isContentEditable) {\n      // for example when clicking on the empty area in the main menu\n      focus()\n\n      if (!documentState.selection && json === undefined && (text === '' || text === undefined)) {\n        createDefaultSelection()\n      }\n    }\n  }\n\n  function openContextMenu({\n    anchor,\n    left,\n    top,\n    width,\n    height,\n    offsetTop,\n    offsetLeft,\n    showTip\n  }: AbsolutePopupOptions) {\n    const defaultItems: ContextMenuItem[] = createTreeContextMenuItems({\n      json,\n      documentState,\n      readOnly,\n      parser,\n\n      onEditKey: handleEditKey,\n      onEditValue: handleEditValue,\n      onToggleEnforceString: handleToggleEnforceString,\n\n      onCut: handleCut,\n      onCopy: handleCopy,\n      onPaste: handlePasteFromMenu,\n\n      onRemove: handleRemove,\n      onDuplicate: handleDuplicate,\n      onExtract: handleExtract,\n\n      onInsertBefore: handleInsertBefore,\n      onInsert: handleInsertFromContextMenu,\n      onInsertAfter: handleInsertAfter,\n      onConvert: handleConvert,\n\n      onSort: handleSortSelection,\n      onTransform: handleTransformSelection\n    })\n\n    const items = onRenderContextMenu(defaultItems)\n\n    if (items === false) {\n      return\n    }\n\n    const props = {\n      tip: showTip\n        ? 'Tip: you can open this context menu via right-click or with Ctrl+Q'\n        : undefined,\n      items,\n      onRequestClose: () => closeAbsolutePopup(popupId)\n    }\n\n    const options = {\n      left,\n      top,\n      offsetTop,\n      offsetLeft,\n      width,\n      height,\n      anchor,\n      closeOnOuterClick: true,\n      onClose: () => {\n        modalOpen = false\n        focus()\n      }\n    }\n\n    modalOpen = true\n\n    const popupId = openAbsolutePopup(ContextMenu, props, options)\n  }\n\n  function handleContextMenu(event?: Event) {\n    if (isEditingSelection(documentState.selection)) {\n      return\n    }\n\n    if (event) {\n      event.stopPropagation()\n      event.preventDefault()\n    }\n\n    if (event && event.type === 'contextmenu' && event.target !== refHiddenInput) {\n      // right mouse click to open context menu\n      openContextMenu({\n        left: (event as MouseEvent).clientX,\n        top: (event as MouseEvent).clientY,\n        width: CONTEXT_MENU_WIDTH,\n        height: CONTEXT_MENU_HEIGHT,\n        showTip: false\n      })\n    } else {\n      // type === 'keydown' (from the quick key Ctrl+Q)\n      // or target is hidden input -> context menu button on keyboard\n      const anchor = refContents?.querySelector('.jse-context-menu-pointer.jse-selected')\n      if (anchor) {\n        openContextMenu({\n          anchor,\n          offsetTop: 2,\n          width: CONTEXT_MENU_WIDTH,\n          height: CONTEXT_MENU_HEIGHT,\n          showTip: false\n        })\n      } else {\n        // fallback on just displaying the TreeContextMenu top left\n        const rect = refContents?.getBoundingClientRect()\n        if (rect) {\n          openContextMenu({\n            top: rect.top + 2,\n            left: rect.left + 2,\n            width: CONTEXT_MENU_WIDTH,\n            height: CONTEXT_MENU_HEIGHT,\n            showTip: false\n          })\n        }\n      }\n    }\n\n    return false\n  }\n\n  function handleContextMenuFromTreeMenu(event: MouseEvent) {\n    openContextMenu({\n      anchor: findParentWithNodeName(event.target as HTMLElement, 'BUTTON'),\n      offsetTop: 0,\n      width: CONTEXT_MENU_WIDTH,\n      height: CONTEXT_MENU_HEIGHT,\n      showTip: true\n    })\n  }\n\n  async function handleParsePastedJson() {\n    debug('apply pasted json', pastedJson)\n    if (!pastedJson) {\n      return\n    }\n\n    const { path, contents } = pastedJson\n    pastedJson = undefined\n\n    // exit edit mode\n    const refEditableDiv = refContents?.querySelector('.jse-editable-div') || null\n    if (isEditableDivRef(refEditableDiv)) {\n      refEditableDiv.cancel()\n    }\n\n    // replace the value with the JSON object/array\n    const operations: JSONPatchDocument = [\n      {\n        op: 'replace',\n        path: compileJSONPointer(path),\n        value: contents\n      }\n    ]\n\n    handlePatch(operations, (patchedJson, patchedState) => {\n      return {\n        state: expandRecursive(patchedJson, patchedState, path)\n      }\n    })\n\n    // TODO: get rid of the setTimeout here\n    setTimeout(focus)\n  }\n\n  function handleClearPastedJson() {\n    debug('clear pasted json')\n    pastedJson = undefined\n    focus()\n  }\n\n  function handleRequestRepair() {\n    onChangeMode(Mode.text)\n  }\n\n  function handleNavigationBarSelect(newSelection: JSONSelection) {\n    updateSelection(newSelection)\n\n    focus()\n    scrollTo(getFocusPath(newSelection))\n  }\n\n  export function focus() {\n    debug('focus')\n    // with just .focus(), sometimes the input doesn't react on onpaste events\n    // in Chrome when having a large document open and then doing cut/paste.\n    // Calling both .focus() and .select() did solve this issue.\n    if (refHiddenInput) {\n      refHiddenInput.focus()\n      refHiddenInput.select()\n    }\n  }\n\n  function handleWindowMouseDown(event: MouseEvent & { currentTarget: EventTarget & Window }) {\n    const outsideEditor = !isChildOf(\n      event.target as Element,\n      (element) => element === refJsonEditor\n    )\n    if (outsideEditor) {\n      if (isEditingSelection(documentState.selection)) {\n        debug('click outside the editor, stop edit mode')\n        updateSelection((selection) => {\n          if (isKeySelection(selection)) {\n            return { ...selection, edit: false }\n          } else if (isValueSelection(selection)) {\n            return { ...selection, edit: false }\n          } else {\n            return selection\n          }\n        })\n\n        if (hasFocus && refHiddenInput) {\n          refHiddenInput.focus()\n          refHiddenInput.blur()\n        }\n\n        debug('blur (outside editor)')\n        if (refHiddenInput) {\n          refHiddenInput.blur()\n        }\n      }\n    }\n  }\n\n  function findNextInside(path: JSONPath): JSONSelection | null {\n    return getSelectionNextInside(json, documentState, path)\n  }\n\n  $: autoScrollHandler = refContents ? createAutoScrollHandler(refContents) : undefined\n\n  function handleDrag(event: MouseEvent) {\n    if (autoScrollHandler) {\n      autoScrollHandler.onDrag(event)\n    }\n  }\n\n  function handleDragEnd() {\n    if (autoScrollHandler) {\n      autoScrollHandler.onDragEnd()\n    }\n  }\n\n  // Note that we want the context to change as little as possible since it forces all nodes to re-render,\n  // it should only change when a config option like readOnly or onClassName is changed\n  let context: TreeModeContext\n  $: context = {\n    readOnly,\n    parser,\n    normalization,\n    getJson,\n    getDocumentState,\n    findElement,\n    findNextInside,\n    focus,\n    onPatch: handlePatch,\n    onInsert: handleInsert,\n    onExpand: handleExpand,\n    onSelect: updateSelection,\n    onFind: openFind,\n    onExpandSection: handleExpandSection,\n    onPasteJson: handlePasteJson,\n    onRenderValue,\n    onContextMenu: openContextMenu,\n    onClassName: onClassName || (() => undefined),\n    onDrag: handleDrag,\n    onDragEnd: handleDragEnd\n  }\n\n  $: debug('context changed', context)\n</script>\n\n<svelte:window on:mousedown={handleWindowMouseDown} />\n\n<div\n  role=\"tree\"\n  tabindex=\"-1\"\n  class=\"jse-tree-mode\"\n  class:no-main-menu={!mainMenuBar}\n  on:keydown={handleKeyDown}\n  on:mousedown={handleMouseDown}\n  on:contextmenu={handleContextMenu}\n  bind:this={refJsonEditor}\n>\n  {#if mainMenuBar}\n    <TreeMenu\n      {json}\n      selection={documentState.selection}\n      {readOnly}\n      {historyState}\n      bind:showSearch\n      onExpandAll={handleExpandAll}\n      onCollapseAll={handleCollapseAll}\n      onUndo={handleUndo}\n      onRedo={handleRedo}\n      onSort={handleSortAll}\n      onTransform={handleTransformAll}\n      onContextMenu={handleContextMenuFromTreeMenu}\n      onCopy={handleCopy}\n      {onRenderMenu}\n    />\n  {/if}\n\n  {#if navigationBar}\n    <NavigationBar\n      {json}\n      selection={documentState.selection}\n      onSelect={handleNavigationBarSelect}\n      {onError}\n      {pathParser}\n    />\n  {/if}\n\n  {#if !isSSR}\n    <label class=\"jse-hidden-input-label\">\n      <input\n        type=\"text\"\n        readonly={true}\n        tabindex=\"-1\"\n        class=\"jse-hidden-input\"\n        bind:this={refHiddenInput}\n        on:paste={handlePaste}\n      />\n    </label>\n    {#if json === undefined}\n      {#if text === '' || text === undefined}\n        <Welcome\n          {readOnly}\n          onCreateObject={() => {\n            focus()\n            handleInsertCharacter('{')\n          }}\n          onCreateArray={() => {\n            focus()\n            handleInsertCharacter('[')\n          }}\n          onClick={() => {\n            // FIXME: this is a workaround for the editor not putting the focus on refHiddenInput\n            //  when clicking in the welcome screen so you cannot paste a document from clipboard.\n            focus()\n          }}\n        />\n      {:else}\n        <Message\n          type=\"error\"\n          message=\"The loaded JSON document is invalid and could not be repaired automatically.\"\n          actions={!readOnly\n            ? [\n                {\n                  icon: faCode,\n                  text: 'Repair manually',\n                  title: 'Open the document in \"code\" mode and repair it manually',\n                  onClick: handleRequestRepair\n                }\n              ]\n            : []}\n        />\n        <JSONPreview {text} {json} {indentation} {parser} />\n      {/if}\n    {:else}\n      <div class=\"jse-search-box-container\">\n        <SearchBox\n          {json}\n          {documentState}\n          {parser}\n          {showSearch}\n          {showReplace}\n          {readOnly}\n          columns={undefined}\n          onSearch={handleSearch}\n          onFocus={handleFocusSearch}\n          onPatch={handlePatch}\n          onClose={handleCloseSearch}\n        />\n      </div>\n      <div class=\"jse-contents\" data-jsoneditor-scrollable-contents={true} bind:this={refContents}>\n        <JSONNode\n          value={json}\n          path={[]}\n          expandedMap={documentState.expandedMap}\n          enforceStringMap={documentState.enforceStringMap}\n          visibleSectionsMap={documentState.visibleSectionsMap}\n          {validationErrorsMap}\n          searchResultItemsMap={searchResult?.itemsMap}\n          selection={documentState.selection}\n          {context}\n          onDragSelectionStart={noop}\n        />\n      </div>\n\n      {#if pastedJson}\n        <Message\n          type=\"info\"\n          message={`You pasted a JSON ${\n            Array.isArray(pastedJson.contents) ? 'array' : 'object'\n          } as text`}\n          actions={[\n            {\n              icon: faWrench,\n              text: 'Paste as JSON instead',\n              title: 'Replace the value with the pasted JSON',\n              // We use mousedown here instead of click: this message pops up\n              // whilst the user is editing a value. When clicking this button,\n              // the actual value is applied and the event is not propagated\n              // and an onClick on this button never happens.\n              onMouseDown: handleParsePastedJson\n            },\n            {\n              text: 'Leave as is',\n              title: 'Keep the JSON embedded in the value',\n              onClick: handleClearPastedJson\n            }\n          ]}\n        />\n      {/if}\n\n      {#if textIsRepaired}\n        <Message\n          type=\"success\"\n          message=\"The loaded JSON document was invalid but is successfully repaired.\"\n          actions={!readOnly\n            ? [\n                {\n                  icon: faCheck,\n                  text: 'Ok',\n                  title: 'Accept the repaired document',\n                  onClick: acceptAutoRepair\n                },\n                {\n                  icon: faCode,\n                  text: 'Repair manually instead',\n                  title: 'Leave the document unchanged and repair it manually instead',\n                  onClick: handleRequestRepair\n                }\n              ]\n            : []}\n          onClose={focus}\n        />\n      {/if}\n\n      <ValidationErrorsOverview {validationErrors} selectError={handleSelectValidationError} />\n    {/if}\n  {:else}\n    <div class=\"jse-contents\">\n      <div class=\"jse-loading-space\" />\n      <div class=\"jse-loading\">loading...</div>\n    </div>\n  {/if}\n</div>\n\n<style src=\"./TreeMode.scss\"></style>\n","import {\n  faArrowRightArrowLeft,\n  faCaretSquareDown,\n  faCaretSquareUp,\n  faCheckSquare,\n  faClone,\n  faCopy,\n  faCropAlt,\n  faCut,\n  faFilter,\n  faPaste,\n  faPen,\n  faPlus,\n  faSortAmountDownAlt,\n  faSquare,\n  faTrashCan\n} from '@fortawesome/free-solid-svg-icons'\nimport {\n  canConvert,\n  getFocusPath,\n  isKeySelection,\n  isMultiSelection,\n  isValueSelection,\n  singleItemSelected\n} from '$lib/logic/selection'\nimport type { ConvertType, DocumentState, InsertType, JSONParser } from '$lib/types'\nimport { initial, isEmpty } from 'lodash-es'\nimport { compileJSONPointer, getIn } from 'immutable-json-patch'\nimport { isObjectOrArray, isObject } from '$lib/utils/typeUtils'\nimport { getEnforceString } from '$lib/logic/documentState'\nimport type { ContextMenuItem } from 'svelte-jsoneditor'\n\nexport default function ({\n  json,\n  documentState,\n  readOnly,\n  parser,\n  onEditKey,\n  onEditValue,\n  onToggleEnforceString,\n  onCut,\n  onCopy,\n  onPaste,\n  onRemove,\n  onDuplicate,\n  onExtract,\n  onInsertBefore,\n  onInsert,\n  onConvert,\n  onInsertAfter,\n  onSort,\n  onTransform\n}: {\n  json: unknown\n  documentState: DocumentState\n  readOnly: boolean\n  parser: JSONParser\n  onEditKey: () => void\n  onEditValue: () => void\n  onToggleEnforceString: () => void\n  onCut: (indent: boolean) => void\n  onCopy: (indent: boolean) => void\n  onPaste: () => void\n  onRemove: () => void\n  onDuplicate: () => void\n  onExtract: () => void\n  onInsertBefore: () => void\n  onInsert: (type: InsertType) => void\n  onConvert: (type: ConvertType) => void\n  onInsertAfter: () => void\n  onSort: () => void\n  onTransform: () => void\n}): ContextMenuItem[] {\n  const selection = documentState.selection\n\n  const hasJson = json !== undefined\n  const hasSelection = !!selection\n  const rootSelected = selection ? isEmpty(getFocusPath(selection)) : false\n  const focusValue = selection ? getIn(json, getFocusPath(selection)) : undefined\n  const editValueText = Array.isArray(focusValue)\n    ? 'Edit array'\n    : isObject(focusValue)\n      ? 'Edit object'\n      : 'Edit value'\n\n  const hasSelectionContents =\n    hasJson &&\n    (isMultiSelection(selection) || isKeySelection(selection) || isValueSelection(selection))\n\n  const canEditKey =\n    !readOnly &&\n    hasJson &&\n    selection != null &&\n    singleItemSelected(selection) &&\n    !rootSelected &&\n    !Array.isArray(getIn(json, initial(getFocusPath(selection))))\n\n  const canEditValue = !readOnly && hasJson && selection != null && singleItemSelected(selection)\n  const canEnforceString = canEditValue && !isObjectOrArray(focusValue)\n\n  const canCut = !readOnly && hasSelectionContents\n  const canCopy = hasSelectionContents\n  const canPaste = !readOnly && hasSelection\n  const canDuplicate = !readOnly && hasJson && hasSelectionContents && !rootSelected // must not be root\n  const canExtract =\n    !readOnly &&\n    hasJson &&\n    selection != null &&\n    (isMultiSelection(selection) || isValueSelection(selection)) &&\n    !rootSelected // must not be root\n\n  const convertMode = hasSelectionContents\n  const insertOrConvertText = convertMode ? 'Convert to:' : 'Insert:'\n\n  const canInsertOrConvertStructure = readOnly || convertMode ? false : hasSelection\n  const canInsertOrConvertObject =\n    !readOnly && (convertMode ? canConvert(selection) && !isObject(focusValue) : hasSelection)\n  const canInsertOrConvertArray =\n    !readOnly && (convertMode ? canConvert(selection) && !Array.isArray(focusValue) : hasSelection)\n  const canInsertOrConvertValue =\n    !readOnly && (convertMode ? canConvert(selection) && isObjectOrArray(focusValue) : hasSelection)\n\n  const enforceString =\n    selection != null && focusValue\n      ? getEnforceString(\n          focusValue,\n          documentState.enforceStringMap,\n          compileJSONPointer(getFocusPath(selection)),\n          parser\n        )\n      : false\n\n  function handleInsertOrConvert(type: InsertType) {\n    if (hasSelectionContents) {\n      if (type !== 'structure') {\n        onConvert(type)\n      }\n    } else {\n      onInsert(type)\n    }\n  }\n\n  return [\n    {\n      type: 'row',\n      items: [\n        {\n          type: 'button',\n          onClick: () => onEditKey(),\n          icon: faPen,\n          text: 'Edit key',\n          title: 'Edit the key (Double-click on the key)',\n          disabled: !canEditKey\n        },\n        {\n          type: 'dropdown-button',\n          main: {\n            type: 'button',\n            onClick: () => onEditValue(),\n            icon: faPen,\n            text: editValueText,\n            title: 'Edit the value (Double-click on the value)',\n            disabled: !canEditValue\n          },\n          width: '11em',\n          items: [\n            {\n              type: 'button',\n              icon: faPen,\n              text: editValueText,\n              title: 'Edit the value (Double-click on the value)',\n              onClick: () => onEditValue(),\n              disabled: !canEditValue\n            },\n            {\n              type: 'button',\n              icon: enforceString ? faCheckSquare : faSquare,\n              text: 'Enforce string',\n              title: 'Enforce keeping the value as string when it contains a numeric value',\n              onClick: () => onToggleEnforceString(),\n              disabled: !canEnforceString\n            }\n          ]\n        }\n      ]\n    },\n    { type: 'separator' },\n    {\n      type: 'row',\n      items: [\n        {\n          type: 'dropdown-button',\n          main: {\n            type: 'button',\n            onClick: () => onCut(true),\n            icon: faCut,\n            text: 'Cut',\n            title: 'Cut selected contents, formatted with indentation (Ctrl+X)',\n            disabled: !canCut\n          },\n          width: '10em',\n          items: [\n            {\n              type: 'button',\n              icon: faCut,\n              text: 'Cut formatted',\n              title: 'Cut selected contents, formatted with indentation (Ctrl+X)',\n              onClick: () => onCut(true),\n              disabled: !canCut\n            },\n            {\n              type: 'button',\n              icon: faCut,\n              text: 'Cut compacted',\n              title: 'Cut selected contents, without indentation (Ctrl+Shift+X)',\n              onClick: () => onCut(false),\n              disabled: !canCut\n            }\n          ]\n        },\n        {\n          type: 'dropdown-button',\n          main: {\n            type: 'button',\n            onClick: () => onCopy(true),\n            icon: faCopy,\n            text: 'Copy',\n            title: 'Copy selected contents, formatted with indentation (Ctrl+C)',\n            disabled: !canCopy\n          },\n          width: '12em',\n          items: [\n            {\n              type: 'button',\n              icon: faCopy,\n              text: 'Copy formatted',\n              title: 'Copy selected contents, formatted with indentation (Ctrl+C)',\n              onClick: () => onCopy(true),\n              disabled: !canCopy\n            },\n            {\n              type: 'button',\n              icon: faCopy,\n              text: 'Copy compacted',\n              title: 'Copy selected contents, without indentation (Ctrl+Shift+C)',\n              onClick: () => onCopy(false),\n              disabled: !canCopy\n            }\n          ]\n        },\n        {\n          type: 'button',\n          onClick: () => onPaste(),\n          icon: faPaste,\n          text: 'Paste',\n          title: 'Paste clipboard contents (Ctrl+V)',\n          disabled: !canPaste\n        }\n      ]\n    },\n    { type: 'separator' },\n    {\n      type: 'row',\n      items: [\n        {\n          type: 'column',\n          items: [\n            {\n              type: 'button',\n              onClick: () => onDuplicate(),\n              icon: faClone,\n              text: 'Duplicate',\n              title: 'Duplicate selected contents (Ctrl+D)',\n              disabled: !canDuplicate\n            },\n            {\n              type: 'button',\n              onClick: () => onExtract(),\n              icon: faCropAlt,\n              text: 'Extract',\n              title: 'Extract selected contents',\n              disabled: !canExtract\n            },\n            {\n              type: 'button',\n              onClick: () => onSort(),\n              icon: faSortAmountDownAlt,\n              text: 'Sort',\n              title: 'Sort array or object contents',\n              disabled: readOnly || !hasSelectionContents\n            },\n            {\n              type: 'button',\n              onClick: () => onTransform(),\n              icon: faFilter,\n              text: 'Transform',\n              title: 'Transform array or object contents (filter, sort, project)',\n              disabled: readOnly || !hasSelectionContents\n            },\n            {\n              type: 'button',\n              onClick: () => onRemove(),\n              icon: faTrashCan,\n              text: 'Remove',\n              title: 'Remove selected contents (Delete)',\n              disabled: readOnly || !hasSelectionContents\n            }\n          ]\n        },\n        {\n          type: 'column',\n          items: [\n            { type: 'label', text: insertOrConvertText },\n            {\n              type: 'button',\n              onClick: () => handleInsertOrConvert('structure'),\n              icon: convertMode ? faArrowRightArrowLeft : faPlus,\n              text: 'Structure',\n              title: insertOrConvertText + ' structure',\n              disabled: !canInsertOrConvertStructure\n            },\n            {\n              type: 'button',\n              onClick: () => handleInsertOrConvert('object'),\n              icon: convertMode ? faArrowRightArrowLeft : faPlus,\n              text: 'Object',\n              title: insertOrConvertText + ' structure',\n              disabled: !canInsertOrConvertObject\n            },\n            {\n              type: 'button',\n              onClick: () => handleInsertOrConvert('array'),\n              icon: convertMode ? faArrowRightArrowLeft : faPlus,\n              text: 'Array',\n              title: insertOrConvertText + ' array',\n              disabled: !canInsertOrConvertArray\n            },\n            {\n              type: 'button',\n              onClick: () => handleInsertOrConvert('value'),\n              icon: convertMode ? faArrowRightArrowLeft : faPlus,\n              text: 'Value',\n              title: insertOrConvertText + ' value',\n              disabled: !canInsertOrConvertValue\n            }\n          ]\n        }\n      ]\n    },\n    {\n      type: 'separator'\n    },\n    {\n      type: 'row',\n      items: [\n        {\n          type: 'button',\n          onClick: () => onInsertBefore(),\n          icon: faCaretSquareUp,\n          text: 'Insert before',\n          title: 'Select area before current entry to insert or paste contents',\n          disabled: readOnly || !hasSelectionContents || rootSelected\n        },\n        {\n          type: 'button',\n          onClick: () => onInsertAfter(),\n          icon: faCaretSquareDown,\n          text: 'Insert after',\n          title: 'Select area after current entry to insert or paste contents',\n          disabled: readOnly || !hasSelectionContents || rootSelected\n        }\n      ]\n    }\n  ]\n}\n","/**\n * Create a readonly proxy around an object or array.\n *\n * Will throw an error when trying to mutate the object or array\n *\n * Inspired by: https://github.com/kourge/readonly-proxy/\n */\nexport function readonlyProxy(target: unknown): unknown {\n  if (!isObject(target)) {\n    return target\n  }\n\n  return new Proxy(target, {\n    get(target, property, receiver) {\n      const value = Reflect.get(target, property, receiver)\n\n      return readonlyProxy(value)\n    },\n\n    set() {\n      return false\n    },\n\n    deleteProperty() {\n      return false\n    }\n  })\n}\n\nfunction isObject(value: unknown): value is object {\n  return typeof value === 'object' && value !== null\n}\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { uniqueId } from '../../utils/uniqueId.js'\n  import { faCaretDown, faCaretRight } from '@fortawesome/free-solid-svg-icons'\n  import { debounce, isEmpty, noop } from 'lodash-es'\n  import { getContext } from 'svelte'\n  import Icon from 'svelte-awesome'\n  import { DEBOUNCE_DELAY } from '../../constants.js'\n  import type { JSONPath } from 'immutable-json-patch'\n  import { compileJSONPointer, getIn } from 'immutable-json-patch'\n  import { stringifyJSONPath } from '$lib/utils/pathUtils.js'\n  import { transformModalStates, transformModalStateShared } from './transformModalStates.js'\n  import TransformWizard from './TransformWizard.svelte'\n  import TransformModalHeader from './TransformModalHeader.svelte'\n  import AbsolutePopup from './popup/AbsolutePopup.svelte'\n  import { createDebug } from '$lib/utils/debug.js'\n  import TreeMode from '../modes/treemode/TreeMode.svelte'\n  import type {\n    Content,\n    JSONParser,\n    JSONPathParser,\n    OnChangeQueryLanguage,\n    OnClassName,\n    OnPatch,\n    OnRenderContextMenuInternal,\n    OnRenderMenuInternal,\n    OnRenderValue,\n    QueryLanguage,\n    QueryLanguageOptions\n  } from '$lib/types.js'\n  import { onEscape } from '$lib/actions/onEscape.js'\n  import type { Context } from 'svelte-simple-modal'\n  import { readonlyProxy } from '$lib/utils/readonlyProxy.js'\n\n  const debug = createDebug('jsoneditor:TransformModal')\n\n  export let id = 'transform-modal-' + uniqueId()\n  export let json: unknown\n  export let rootPath: JSONPath = []\n\n  export let indentation: number | string\n  export let escapeControlCharacters: boolean\n  export let escapeUnicodeCharacters: boolean\n  export let parser: JSONParser\n  export let parseMemoizeOne: JSONParser['parse']\n  export let validationParser: JSONParser\n  export let pathParser: JSONPathParser\n\n  export let queryLanguages: QueryLanguage[]\n  export let queryLanguageId: string\n  export let onChangeQueryLanguage: OnChangeQueryLanguage\n\n  export let onRenderValue: OnRenderValue\n  export let onRenderMenu: OnRenderMenuInternal\n  export let onRenderContextMenu: OnRenderContextMenuInternal\n  export let onClassName: OnClassName\n\n  export let onTransform: OnPatch\n\n  let selectedJson: unknown | undefined\n  $: selectedJson = readonlyProxy(getIn(json, rootPath))\n  let selectedContent: Content\n  $: selectedContent = selectedJson ? { json: selectedJson } : { text: '' }\n\n  const { close } = getContext<Context>('simple-modal')\n\n  let fullscreen = false\n\n  const stateId = `${id}:${compileJSONPointer(rootPath)}`\n  const state = transformModalStates[stateId] || {}\n\n  // showWizard is not stored inside a stateId\n  let showWizard = transformModalStateShared.showWizard !== false\n  let showOriginal = transformModalStateShared.showOriginal !== false\n\n  let queryOptions = state.queryOptions || {}\n  let query =\n    queryLanguageId === state.queryLanguageId && state.query\n      ? state.query\n      : getSelectedQueryLanguage(queryLanguageId).createQuery(\n          selectedJson,\n          state.queryOptions || {}\n        )\n  let isManual = state.isManual || false\n\n  let previewError: string | undefined = undefined\n  let previewContent: Content = { text: '' }\n\n  function getSelectedQueryLanguage(queryLanguageId: string): QueryLanguage {\n    return queryLanguages.find((item) => item.id === queryLanguageId) || queryLanguages[0]\n  }\n\n  function updateQueryByWizard(newQueryOptions: QueryLanguageOptions) {\n    queryOptions = newQueryOptions\n    query = getSelectedQueryLanguage(queryLanguageId).createQuery(selectedJson, newQueryOptions)\n    isManual = false\n\n    debug('updateQueryByWizard', { queryOptions, query, isManual })\n  }\n\n  function handleChangeQuery(event: Event) {\n    query = (event.target as HTMLTextAreaElement).value\n    isManual = true\n    debug('handleChangeQuery', { query, isManual })\n  }\n\n  function previewTransform(previewJson: unknown | undefined, query: string) {\n    if (previewJson === undefined) {\n      previewContent = { text: '' }\n      previewError = 'Error: No JSON'\n      return\n    }\n\n    try {\n      debug('previewTransform', {\n        query\n      })\n\n      const jsonTransformed = getSelectedQueryLanguage(queryLanguageId).executeQuery(\n        previewJson,\n        query,\n        parser\n      )\n\n      previewContent = { json: jsonTransformed }\n      previewError = undefined\n    } catch (err) {\n      previewContent = { text: '' }\n      previewError = String(err)\n    }\n  }\n\n  const previewTransformDebounced = debounce(previewTransform, DEBOUNCE_DELAY)\n\n  $: {\n    previewTransformDebounced(selectedJson, query)\n  }\n\n  $: {\n    // remember the selected values for the next time we open the SortModal\n    // just in memory, not persisted\n    transformModalStates[stateId] = {\n      queryOptions,\n      query,\n      queryLanguageId,\n      isManual\n    }\n\n    debug('store state in memory', stateId, transformModalStates[stateId])\n  }\n\n  function handleTransform() {\n    if (selectedJson === undefined) {\n      previewContent = { text: '' }\n      previewError = 'Error: No JSON'\n      return\n    }\n\n    try {\n      debug('handleTransform', { query })\n      const jsonTransformed = getSelectedQueryLanguage(queryLanguageId).executeQuery(\n        selectedJson,\n        query,\n        parser\n      )\n\n      onTransform([\n        {\n          op: 'replace',\n          path: compileJSONPointer(rootPath),\n          value: jsonTransformed\n        }\n      ])\n\n      close()\n    } catch (err) {\n      // this should never occur since we can only press the Transform\n      // button when creating a preview was successful\n      console.error(err)\n      previewContent = { text: '' }\n      previewError = String(err)\n    }\n  }\n\n  function toggleShowWizard() {\n    showWizard = !showWizard\n\n    // not stored inside a stateId\n    transformModalStateShared.showWizard = showWizard\n  }\n\n  function toggleShowOriginal() {\n    showOriginal = !showOriginal\n\n    // not stored inside a stateId\n    transformModalStateShared.showOriginal = showOriginal\n  }\n\n  function focus(element: HTMLElement) {\n    element.focus()\n  }\n\n  function handleChangeQueryLanguage(newQueryLanguageId: string) {\n    debug('handleChangeQueryLanguage', newQueryLanguageId)\n    queryLanguageId = newQueryLanguageId\n    onChangeQueryLanguage(newQueryLanguageId)\n\n    const newSelectedQueryLanguage = getSelectedQueryLanguage(queryLanguageId)\n    query = newSelectedQueryLanguage.createQuery(selectedJson, queryOptions)\n    isManual = false\n  }\n\n  function handleEscape() {\n    if (fullscreen) {\n      fullscreen = !fullscreen\n    } else {\n      close()\n    }\n  }\n</script>\n\n<div class=\"jse-modal jse-transform\" class:fullscreen use:onEscape={handleEscape}>\n  <AbsolutePopup>\n    <TransformModalHeader\n      {queryLanguages}\n      {queryLanguageId}\n      onChangeQueryLanguage={handleChangeQueryLanguage}\n      bind:fullscreen\n    />\n    <div class=\"jse-modal-contents\">\n      <div class=\"jse-main-contents\">\n        <div class=\"jse-query-contents\">\n          <div class=\"jse-label\">\n            <div class=\"jse-label-inner\">Language</div>\n          </div>\n          <div class=\"jse-description\">\n            <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n            {@html getSelectedQueryLanguage(queryLanguageId).description}\n          </div>\n\n          <div class=\"jse-label\">\n            <div class=\"jse-label-inner\">Path</div>\n          </div>\n          <input\n            class=\"jse-path\"\n            type=\"text\"\n            readonly\n            title=\"Selected path\"\n            value={!isEmpty(rootPath) ? stringifyJSONPath(rootPath) : '(document root)'}\n          />\n\n          <div class=\"jse-label\">\n            <div class=\"jse-label-inner\">\n              <button type=\"button\" on:click={toggleShowWizard}>\n                <Icon data={showWizard ? faCaretDown : faCaretRight} />\n                Wizard\n              </button>\n            </div>\n          </div>\n          {#if showWizard}\n            {#if Array.isArray(selectedJson)}\n              <TransformWizard {queryOptions} json={selectedJson} onChange={updateQueryByWizard} />\n            {:else}\n              (Only available for arrays, not for objects)\n            {/if}\n          {/if}\n\n          <div class=\"jse-label\">\n            <div class=\"jse-label-inner\">Query</div>\n          </div>\n          <textarea class=\"jse-query\" spellcheck=\"false\" on:input={handleChangeQuery}\n            >{query}</textarea\n          >\n        </div>\n        <div class=\"jse-data-contents\" class:jse-hide-original-data={!showOriginal}>\n          <div class=\"jse-original-data\" class:jse-hide={!showOriginal}>\n            <div class=\"jse-label\">\n              <div class=\"jse-label-inner\">\n                <button type=\"button\" on:click={toggleShowOriginal}>\n                  <Icon data={showOriginal ? faCaretDown : faCaretRight} />\n                  Original\n                </button>\n              </div>\n            </div>\n            {#if showOriginal}\n              <TreeMode\n                externalContent={selectedContent}\n                externalSelection={null}\n                readOnly={true}\n                mainMenuBar={false}\n                navigationBar={false}\n                {indentation}\n                {escapeControlCharacters}\n                {escapeUnicodeCharacters}\n                {parser}\n                {parseMemoizeOne}\n                {onRenderValue}\n                {onRenderMenu}\n                {onRenderContextMenu}\n                onError={console.error}\n                onChange={noop}\n                onChangeMode={noop}\n                onSelect={noop}\n                onFocus={noop}\n                onBlur={noop}\n                onSortModal={noop}\n                onTransformModal={noop}\n                onJSONEditorModal={noop}\n                {onClassName}\n                validator={null}\n                {validationParser}\n                {pathParser}\n              />\n            {/if}\n          </div>\n          <div class=\"jse-preview-data\">\n            <div class=\"jse-label\">\n              <div class=\"jse-label-inner\">Preview</div>\n            </div>\n            {#if !previewError}\n              <TreeMode\n                externalContent={previewContent}\n                externalSelection={null}\n                readOnly={true}\n                mainMenuBar={false}\n                navigationBar={false}\n                {indentation}\n                {escapeControlCharacters}\n                {escapeUnicodeCharacters}\n                {parser}\n                {parseMemoizeOne}\n                {onRenderValue}\n                {onRenderMenu}\n                {onRenderContextMenu}\n                onError={console.error}\n                onChange={noop}\n                onChangeMode={noop}\n                onSelect={noop}\n                onFocus={noop}\n                onBlur={noop}\n                onSortModal={noop}\n                onTransformModal={noop}\n                onJSONEditorModal={noop}\n                {onClassName}\n                validator={null}\n                {validationParser}\n                {pathParser}\n              />\n            {:else}\n              <div class=\"jse-preview jse-error\">\n                {previewError}\n              </div>\n            {/if}\n          </div>\n        </div>\n      </div>\n\n      <div class=\"jse-actions\">\n        <button\n          type=\"button\"\n          class=\"jse-primary\"\n          on:click={handleTransform}\n          use:focus\n          disabled={!!previewError}\n        >\n          Transform\n        </button>\n      </div>\n    </div>\n  </AbsolutePopup>\n</div>\n\n<style src=\"./TransformModal.scss\"></style>\n","import type { NumberOption, PathOption } from '$lib/types.js'\n\nexport interface SortModalState {\n  selectedProperty: PathOption\n  selectedDirection: NumberOption\n}\n\nexport const sortModalStates: Record<string, SortModalState> = {}\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { isEmpty } from 'lodash-es'\n  import { getContext } from 'svelte'\n  import Select from 'svelte-select'\n  import Header from './Header.svelte'\n  import { getNestedPaths } from '$lib/utils/arrayUtils.js'\n  import { pathToOption, stringifyJSONPath } from '../../utils/pathUtils.js'\n  import { sortJson } from '$lib/logic/sort.js'\n  import { sortModalStates } from './sortModalStates'\n  import type { JSONPath } from 'immutable-json-patch'\n  import { compileJSONPointer, getIn } from 'immutable-json-patch'\n  import { createDebug } from '$lib/utils/debug.js'\n  import type { OnSort } from '$lib/types.js'\n  import { onEscape } from '$lib/actions/onEscape.js'\n  import type { Context } from 'svelte-simple-modal'\n\n  const debug = createDebug('jsoneditor:SortModal')\n\n  export let id: string\n  export let json: unknown // the whole document\n  export let rootPath: JSONPath\n  export let onSort: OnSort\n\n  const { close } = getContext<Context>('simple-modal')\n\n  const stateId = `${id}:${compileJSONPointer(rootPath)}`\n  const selectedJson = getIn(json, rootPath)\n  $: jsonIsArray = Array.isArray(selectedJson)\n  $: paths = jsonIsArray && selectedJson !== undefined ? getNestedPaths(selectedJson) : undefined\n  $: properties = paths ? paths.map(pathToOption) : undefined\n\n  const asc = {\n    value: 1,\n    label: 'ascending'\n  }\n  const desc = {\n    value: -1,\n    label: 'descending'\n  }\n  const directions = [asc, desc]\n\n  let selectedProperty = sortModalStates[stateId]?.selectedProperty\n  let selectedDirection = sortModalStates[stateId]?.selectedDirection || asc\n  let sortError: string | undefined = undefined\n\n  $: {\n    // remember the selected values for the next time we open the SortModal\n    // just in memory, not persisted\n    sortModalStates[stateId] = {\n      selectedProperty,\n      selectedDirection\n    }\n\n    debug('store state in memory', stateId, sortModalStates[stateId])\n  }\n\n  function handleSort() {\n    try {\n      sortError = undefined\n\n      const itemPath: JSONPath = selectedProperty?.value || properties?.[0]?.value || []\n      const direction = selectedDirection?.value\n      const operations = sortJson(json, rootPath, itemPath, direction)\n      onSort({ operations, rootPath, itemPath, direction })\n\n      close()\n    } catch (err) {\n      sortError = String(err)\n    }\n  }\n\n  function focus(element: HTMLElement) {\n    element.focus()\n  }\n</script>\n\n<div class=\"jse-modal jse-sort\" use:onEscape={close}>\n  <Header title={jsonIsArray ? 'Sort array items' : 'Sort object keys'} />\n\n  <div class=\"jse-modal-contents\">\n    <table>\n      <colgroup>\n        <col width=\"25%\" />\n        <col width=\"75%\" />\n      </colgroup>\n      <tbody>\n        <tr>\n          <th>Path</th>\n          <td>\n            <input\n              class=\"jse-path\"\n              type=\"text\"\n              readonly\n              title=\"Selected path\"\n              value={!isEmpty(rootPath) ? stringifyJSONPath(rootPath) : '(document root)'}\n            />\n          </td>\n        </tr>\n        {#if jsonIsArray && ((properties && properties?.length > 1) || selectedProperty === undefined)}\n          <tr>\n            <th>Property</th>\n            <td>\n              <Select showChevron items={properties} bind:value={selectedProperty} />\n            </td>\n          </tr>\n        {/if}\n        <tr>\n          <th>Direction</th>\n          <td>\n            <Select\n              showChevron\n              clearable={false}\n              items={directions}\n              bind:value={selectedDirection}\n            />\n          </td>\n        </tr>\n      </tbody>\n    </table>\n\n    <div class=\"jse-space\">\n      {#if sortError}\n        <div class=\"jse-error\">\n          {sortError}\n        </div>\n      {/if}\n    </div>\n\n    <div class=\"jse-actions\">\n      <button\n        type=\"button\"\n        class=\"jse-primary\"\n        on:click={handleSort}\n        use:focus\n        disabled={jsonIsArray && properties && properties?.length > 1 ? !selectedProperty : false}\n      >\n        Sort\n      </button>\n    </div>\n  </div>\n</div>\n\n<style src=\"./SortModal.scss\"></style>\n","export function noop() {\n  return undefined\n}\n","/**\n * Return a human readable document size\n * For example formatSize(7570718) outputs '7.6 MB'\n * @param size\n * @param kilo Is 1000 by default, you can specify 1024 if you\n *                             want the output in KiB\n * @return Returns a human readable size\n */\nexport function formatSize(size: number, kilo = 1000): string {\n  if (size < 0.9 * kilo) {\n    return size.toFixed() + ' B'\n  }\n\n  const KB = size / kilo\n  if (KB < 0.9 * kilo) {\n    return KB.toFixed(1) + ' KB'\n  }\n\n  const MB = KB / kilo\n  if (MB < 0.9 * kilo) {\n    return MB.toFixed(1) + ' MB'\n  }\n\n  const GB = MB / kilo\n  if (GB < 0.9 * kilo) {\n    return GB.toFixed(1) + ' GB'\n  }\n\n  const TB = GB / kilo\n  return TB.toFixed(1) + ' TB'\n}\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import {\n    faFilter,\n    faRedo,\n    faSearch,\n    faSortAmountDownAlt,\n    faUndo\n  } from '@fortawesome/free-solid-svg-icons'\n  import { faJSONEditorCompact, faJSONEditorFormat } from '$lib/img/customFontawesomeIcons.js'\n  import Menu from '../../../controls/Menu.svelte'\n  import type { MenuItem, OnRenderMenuInternal } from '$lib/types'\n\n  export let readOnly = false\n  export let onFormat: () => boolean\n  export let onCompact: () => boolean\n  export let onSort: () => void\n  export let onTransform: () => void\n  export let onToggleSearch: () => void\n  export let onUndo: () => void\n  export let onRedo: () => void\n  export let canUndo: boolean\n  export let canRedo: boolean\n  export let canFormat: boolean\n  export let canCompact: boolean\n  export let canSort: boolean\n  export let canTransform: boolean\n  export let onRenderMenu: OnRenderMenuInternal\n\n  const searchItem: MenuItem = {\n    type: 'button',\n    icon: faSearch,\n    title: 'Search (Ctrl+F)',\n    className: 'jse-search',\n    onClick: onToggleSearch\n  }\n\n  let defaultItems: MenuItem[]\n  $: defaultItems = !readOnly\n    ? [\n        {\n          type: 'button',\n          icon: faJSONEditorFormat,\n          title: 'Format JSON: add proper indentation and new lines (Ctrl+I)',\n          className: 'jse-format',\n          onClick: onFormat,\n          disabled: readOnly || !canFormat\n        },\n        {\n          type: 'button',\n          icon: faJSONEditorCompact,\n          title: 'Compact JSON: remove all white spacing and new lines (Ctrl+Shift+I)',\n          className: 'jse-compact',\n          onClick: onCompact,\n          disabled: readOnly || !canCompact\n        },\n        {\n          type: 'separator'\n        },\n        {\n          type: 'button',\n          icon: faSortAmountDownAlt,\n          title: 'Sort',\n          className: 'jse-sort',\n          onClick: onSort,\n          disabled: readOnly || !canSort\n        },\n        {\n          type: 'button',\n          icon: faFilter,\n          title: 'Transform contents (filter, sort, project)',\n          className: 'jse-transform',\n          onClick: onTransform,\n          disabled: readOnly || !canTransform\n        },\n        searchItem,\n        {\n          type: 'separator'\n        },\n        {\n          type: 'button',\n          icon: faUndo,\n          title: 'Undo (Ctrl+Z)',\n          className: 'jse-undo',\n          onClick: onUndo,\n          disabled: !canUndo\n        },\n        {\n          type: 'button',\n          icon: faRedo,\n          title: 'Redo (Ctrl+Shift+Z)',\n          className: 'jse-redo',\n          onClick: onRedo,\n          disabled: !canRedo\n        },\n        {\n          type: 'space'\n        }\n      ]\n    : [\n        searchItem,\n        {\n          type: 'space'\n        }\n      ]\n\n  $: items = onRenderMenu(defaultItems) || defaultItems\n</script>\n\n<Menu {items} />\n","<script lang=\"ts\">\n  import type { EditorState, Line } from '@codemirror/state'\n\n  export let editorState: EditorState | undefined\n\n  let pos: number | undefined\n  $: pos = editorState?.selection?.main?.head\n\n  let line: Line | undefined\n  $: line = pos !== undefined ? editorState?.doc?.lineAt(pos) : undefined\n\n  let lineNumber: number | undefined\n  $: lineNumber = line !== undefined ? line.number : undefined\n\n  let columnNumber: number | undefined\n  $: columnNumber = line !== undefined && pos !== undefined ? pos - line.from + 1 : undefined\n\n  let charCount: number | undefined\n  $: charCount = editorState?.selection?.ranges?.reduce((count, range) => {\n    return count + range.to - range.from\n  }, 0)\n</script>\n\n<div class=\"jse-status-bar\">\n  {#if lineNumber !== undefined}\n    <div class=\"jse-status-bar-info\">Line: {lineNumber}</div>\n  {/if}\n\n  {#if columnNumber !== undefined}\n    <div class=\"jse-status-bar-info\">Column: {columnNumber}</div>\n  {/if}\n\n  {#if charCount !== undefined && charCount > 0}\n    <div class=\"jse-status-bar-info\">Selection: {charCount} characters</div>\n  {/if}\n</div>\n\n<style src=\"./StatusBar.scss\"></style>\n","import { HighlightStyle, syntaxHighlighting } from '@codemirror/language'\nimport { tags } from '@lezer/highlight'\n\nconst highlightStyle = HighlightStyle.define([\n  { tag: tags.propertyName, color: 'var(--internal-key-color)' }, // keys\n  { tag: tags.number, color: 'var(--internal-value-color-number)' },\n  { tag: tags.bool, color: 'var(--internal-value-color-boolean)' },\n  { tag: tags.string, color: 'var(--internal-value-color-string)' },\n  { tag: tags.keyword, color: 'var(--internal-value-color-null)' } // null\n])\n\nexport const highlighter = syntaxHighlighting(highlightStyle)\n\n// TODO: remove workaround when not needed anymore\n// Workaround for the error \"CodeMirror plugin crashed: TypeError: tags3 is undefined\"\n// thrown when using the json() language from '@codemirror/lang-json'\n//\n// Note that a plain CodeSandbox with parcel and code mirror v6.0.0,\n// so it is maybe related to Vite\n//\n// See https://discuss.codemirror.net/t/highlighting-that-seems-ignored-in-cm6/4320/15\nconst originalStyle = highlightStyle.style\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\n// noinspection JSConstantReassignment\nhighlightStyle.style = (tags) => originalStyle(tags || [])\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import {\n    faExclamationTriangle,\n    faEye,\n    faTimes,\n    faWrench\n  } from '@fortawesome/free-solid-svg-icons'\n  import { createDebug } from '$lib/utils/debug.js'\n  import type { JSONPatchDocument, JSONPath } from 'immutable-json-patch'\n  import { immutableJSONPatch, revertJSONPatch } from 'immutable-json-patch'\n  import { jsonrepair } from 'jsonrepair'\n  import { debounce, isEqual, uniqueId } from 'lodash-es'\n  import { onDestroy, onMount, tick } from 'svelte'\n  import {\n    JSON_STATUS_INVALID,\n    JSON_STATUS_REPAIRABLE,\n    JSON_STATUS_VALID,\n    MAX_CHARACTERS_TEXT_PREVIEW,\n    MAX_DOCUMENT_SIZE_TEXT_MODE,\n    TEXT_MODE_ONCHANGE_DELAY\n  } from '$lib/constants.js'\n  import {\n    activeElementIsChildOf,\n    createNormalizationFunctions,\n    getWindow\n  } from '$lib/utils/domUtils.js'\n  import { formatSize } from '$lib/utils/fileUtils.js'\n  import { findTextLocation, getText, needsFormatting } from '$lib/utils/jsonUtils.js'\n  import { createFocusTracker } from '../../controls/createFocusTracker.js'\n  import Message from '../../controls/Message.svelte'\n  import ValidationErrorsOverview from '../../controls/ValidationErrorsOverview.svelte'\n  import TextMenu from './menu/TextMenu.svelte'\n  import { Compartment, EditorSelection, EditorState, type Extension } from '@codemirror/state'\n  import {\n    crosshairCursor,\n    drawSelection,\n    dropCursor,\n    EditorView,\n    highlightActiveLine,\n    highlightActiveLineGutter,\n    highlightSpecialChars,\n    keymap,\n    lineNumbers,\n    rectangularSelection\n  } from '@codemirror/view'\n  import {\n    defaultKeymap,\n    history,\n    historyKeymap,\n    indentWithTab,\n    redo,\n    redoDepth,\n    undo,\n    undoDepth\n  } from '@codemirror/commands'\n  import type { Diagnostic } from '@codemirror/lint'\n  import { linter, lintGutter, lintKeymap } from '@codemirror/lint'\n  import { json as jsonLang } from '@codemirror/lang-json'\n  import {\n    bracketMatching,\n    defaultHighlightStyle,\n    foldGutter,\n    foldKeymap,\n    indentOnInput,\n    indentUnit,\n    syntaxHighlighting\n  } from '@codemirror/language'\n  import {\n    closeSearchPanel,\n    highlightSelectionMatches,\n    openSearchPanel,\n    search,\n    searchKeymap\n  } from '@codemirror/search'\n  import {\n    autocompletion,\n    closeBrackets,\n    closeBracketsKeymap,\n    completionKeymap\n  } from '@codemirror/autocomplete'\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore\n  import jsonSourceMap from 'json-source-map'\n  import StatusBar from './StatusBar.svelte'\n  import { highlighter } from './codemirror/codemirror-theme.js'\n  import type {\n    Content,\n    ContentErrors,\n    JSONEditorSelection,\n    JSONParser,\n    JSONPatchResult,\n    OnBlur,\n    OnChange,\n    OnChangeMode,\n    OnError,\n    OnFocus,\n    OnRenderMenuInternal,\n    OnSelect,\n    OnSortModal,\n    OnTransformModal,\n    ParseError,\n    RichValidationError,\n    TransformModalOptions,\n    ValidationError,\n    Validator\n  } from '$lib/types.js'\n  import { Mode, SelectionType, ValidationSeverity } from '$lib/types.js'\n  import { isContentParseError, isContentValidationErrors } from '$lib/typeguards.js'\n  import memoizeOne from 'memoize-one'\n  import { validateText } from '$lib/logic/validation.js'\n  import { truncate } from '$lib/utils/stringUtils.js'\n  import { faJSONEditorFormat } from '$lib/img/customFontawesomeIcons.js'\n  import { indentationMarkers } from '@replit/codemirror-indentation-markers'\n  import { isTextSelection } from '$lib/logic/selection.js'\n  import { wrappedLineIndent } from 'codemirror-wrapped-line-indent'\n\n  export let readOnly: boolean\n  export let mainMenuBar: boolean\n  export let statusBar: boolean\n  export let askToFormat: boolean\n  export let externalContent: Content\n  export let externalSelection: JSONEditorSelection | null\n  export let indentation: number | string\n  export let tabSize: number\n  export let escapeUnicodeCharacters: boolean\n  export let parser: JSONParser\n  export let validator: Validator | null\n  export let validationParser: JSONParser\n  export let onChange: OnChange\n  export let onChangeMode: OnChangeMode\n  export let onSelect: OnSelect\n  export let onError: OnError\n  export let onFocus: OnFocus\n  export let onBlur: OnBlur\n  export let onRenderMenu: OnRenderMenuInternal\n  export let onSortModal: OnSortModal\n  export let onTransformModal: OnTransformModal\n\n  const debug = createDebug('jsoneditor:TextMode')\n\n  const formatCompactKeyBinding = {\n    key: 'Mod-i',\n    run: handleFormat,\n    shift: handleCompact,\n    preventDefault: true\n  }\n\n  const isSSR = typeof window === 'undefined'\n  debug('isSSR:', isSSR)\n\n  let codeMirrorRef: HTMLDivElement\n  let domTextMode: HTMLDivElement\n  let codeMirrorView: EditorView\n  let editorState: EditorState\n\n  let onChangeDisabled = false\n  let acceptTooLarge = false\n\n  let validationErrors: ValidationError[] = []\n  const linterCompartment = new Compartment()\n  const readOnlyCompartment = new Compartment()\n  const indentCompartment = new Compartment()\n  const tabSizeCompartment = new Compartment()\n  const themeCompartment = new Compartment()\n\n  let content: Content = externalContent\n  let text = getText(content, indentation, parser) // text is just a cached version of content.text or parsed content.json\n\n  $: normalization = createNormalizationFunctions({\n    escapeControlCharacters: false,\n    escapeUnicodeCharacters\n  })\n\n  $: setCodeMirrorContent(externalContent, false, false)\n  $: applyExternalSelection(externalSelection)\n  $: updateLinter(validator)\n  $: updateIndentation(indentation)\n  $: updateTabSize(tabSize)\n  $: updateReadOnly(readOnly)\n\n  // force updating the text when escapeUnicodeCharacters changes\n  let previousEscapeUnicodeCharacters = escapeUnicodeCharacters\n  $: {\n    if (previousEscapeUnicodeCharacters !== escapeUnicodeCharacters) {\n      previousEscapeUnicodeCharacters = escapeUnicodeCharacters\n      forceUpdateText()\n    }\n  }\n\n  onMount(async () => {\n    if (isSSR) {\n      return\n    }\n\n    try {\n      codeMirrorView = createCodeMirrorView({\n        target: codeMirrorRef,\n        initialText: !disableTextEditor(text, acceptTooLarge)\n          ? normalization.escapeValue(text)\n          : '',\n        readOnly,\n        indentation\n      })\n    } catch (err) {\n      // TODO: report error to the user\n      console.error(err)\n    }\n  })\n\n  onDestroy(() => {\n    if (codeMirrorView) {\n      debug('Destroy CodeMirror editor')\n      codeMirrorView.destroy()\n    }\n  })\n\n  let canUndo = false\n  let canRedo = false\n\n  const sortModalId = uniqueId()\n  const transformModalId = uniqueId()\n\n  export function focus() {\n    if (codeMirrorView) {\n      debug('focus')\n      codeMirrorView.focus()\n    }\n  }\n\n  // modalOpen is true when one of the modals is open.\n  // This is used to track whether the editor still has focus\n  let modalOpen = false\n\n  onDestroy(() => {\n    flush()\n  })\n\n  createFocusTracker({\n    onMount,\n    onDestroy,\n    getWindow: () => getWindow(domTextMode),\n    hasFocus: () => (modalOpen && document.hasFocus()) || activeElementIsChildOf(domTextMode),\n    onFocus,\n    onBlur: () => {\n      flush()\n      onBlur()\n    }\n  })\n\n  export function patch(operations: JSONPatchDocument): JSONPatchResult {\n    return handlePatch(operations, false)\n  }\n\n  export function handlePatch(operations: JSONPatchDocument, emitChange: boolean): JSONPatchResult {\n    debug('handlePatch', operations, emitChange)\n\n    const previousJson = parser.parse(text)\n    const updatedJson = immutableJSONPatch(previousJson, operations)\n    const undo = revertJSONPatch(previousJson, operations)\n    const updatedContent = {\n      text: parser.stringify(updatedJson, null, indentation) as string\n    }\n\n    setCodeMirrorContent(updatedContent, emitChange, false)\n\n    return {\n      json: updatedJson,\n      previousJson,\n      undo,\n      redo: operations\n    }\n  }\n\n  function handleFormat(): boolean {\n    debug('format')\n\n    if (readOnly) {\n      return false\n    }\n\n    try {\n      const updatedJson = parser.parse(text)\n      const updatedContent = {\n        text: parser.stringify(updatedJson, null, indentation) as string\n      }\n\n      setCodeMirrorContent(updatedContent, true, false)\n\n      return true\n    } catch (err) {\n      onError(err as Error)\n    }\n\n    return false\n  }\n\n  function handleCompact(): boolean {\n    debug('compact')\n\n    if (readOnly) {\n      return false\n    }\n\n    try {\n      const updatedJson = parser.parse(text)\n      const updatedContent = {\n        text: parser.stringify(updatedJson) as string\n      }\n\n      setCodeMirrorContent(updatedContent, true, false)\n\n      return true\n    } catch (err) {\n      onError(err as Error)\n    }\n\n    return false\n  }\n\n  function handleRepair() {\n    debug('repair')\n\n    if (readOnly) {\n      return\n    }\n\n    try {\n      const updatedContent = {\n        text: jsonrepair(text)\n      }\n\n      setCodeMirrorContent(updatedContent, true, false)\n\n      jsonStatus = JSON_STATUS_VALID\n      jsonParseError = null\n    } catch (err) {\n      onError(err as Error)\n    }\n  }\n\n  function handleSort() {\n    if (readOnly) {\n      return\n    }\n\n    try {\n      const json = parser.parse(text)\n\n      modalOpen = true\n\n      onSortModal({\n        id: sortModalId,\n        json,\n        rootPath: [],\n        onSort: async ({ operations }) => {\n          debug('onSort', operations)\n          handlePatch(operations, true)\n        },\n        onClose: () => {\n          modalOpen = false\n          focus()\n        }\n      })\n    } catch (err) {\n      onError(err as Error)\n    }\n  }\n\n  /**\n   * This method is exposed via JSONEditor.transform\n   */\n  export function openTransformModal({\n    id,\n    rootPath,\n    onTransform,\n    onClose\n  }: TransformModalOptions) {\n    try {\n      const json = parser.parse(text)\n\n      modalOpen = true\n\n      onTransformModal({\n        id: id || transformModalId,\n        json,\n        rootPath: rootPath || [],\n        onTransform: (operations) => {\n          if (onTransform) {\n            onTransform({\n              operations,\n              json,\n              transformedJson: immutableJSONPatch(json, operations)\n            })\n          } else {\n            debug('onTransform', operations)\n            handlePatch(operations, true)\n          }\n        },\n        onClose: () => {\n          modalOpen = false\n          focus()\n          if (onClose) {\n            onClose()\n          }\n        }\n      })\n    } catch (err) {\n      onError(err as Error)\n    }\n  }\n\n  function handleTransform() {\n    if (readOnly) {\n      return\n    }\n\n    openTransformModal({\n      rootPath: []\n    })\n  }\n\n  function handleToggleSearch() {\n    if (codeMirrorView) {\n      // TODO: figure out the proper way to detect whether the search panel is open\n      if (codeMirrorRef && codeMirrorRef.querySelector('.cm-search')) {\n        closeSearchPanel(codeMirrorView)\n      } else {\n        openSearchPanel(codeMirrorView)\n      }\n    }\n  }\n\n  function handleUndo() {\n    if (readOnly) {\n      return\n    }\n\n    if (codeMirrorView) {\n      undo(codeMirrorView)\n      focus()\n    }\n  }\n\n  function handleRedo() {\n    if (readOnly) {\n      return\n    }\n\n    if (codeMirrorView) {\n      redo(codeMirrorView)\n      focus()\n    }\n  }\n\n  function handleAcceptTooLarge() {\n    acceptTooLarge = true\n    setCodeMirrorContent(externalContent, true, true)\n  }\n\n  function handleSwitchToTreeMode() {\n    onChangeMode(Mode.tree)\n  }\n\n  function cancelLoadTooLarge() {\n    // copy the latest contents of the text editor again into text\n    onChangeCodeMirrorValue()\n  }\n\n  function handleSelectValidationError(validationError: ValidationError) {\n    debug('select validation error', validationError)\n\n    const { from, to } = toRichValidationError(validationError)\n    if (from === null || to === null) {\n      return\n    }\n\n    // we take \"to\" as head, not as anchor, because the scrollIntoView will\n    // move to the head, and when a large whole object is selected as a whole,\n    // we want to scroll to the start of the object and not the end\n    setSelection(from, to)\n\n    focus()\n  }\n\n  function handleSelectParseError(parseError: ParseError) {\n    debug('select parse error', parseError)\n\n    const richParseError = toRichParseError(parseError, false)\n    const from = richParseError.from != null ? richParseError.from : 0\n    const to = richParseError.to != null ? richParseError.to : 0\n\n    // we take \"to\" as head, not as anchor, because the scrollIntoView will\n    // move to the head, and when a large whole object is selected as a whole,\n    // we want to scroll to the start of the object and not the end\n    setSelection(from, to)\n\n    focus()\n  }\n\n  function setSelection(anchor: number, head: number) {\n    debug('setSelection', { anchor, head })\n\n    if (codeMirrorView) {\n      codeMirrorView.dispatch(\n        codeMirrorView.state.update({\n          selection: { anchor, head },\n          scrollIntoView: true\n        })\n      )\n    }\n  }\n\n  function handleDoubleClick(event: MouseEvent, view: EditorView) {\n    // When the user double-clicked right from a bracket [ or {,\n    // select the contents of the array or object\n    if (view.state.selection.ranges.length === 1) {\n      const range = view.state.selection.ranges[0]\n      const selectedText = text.slice(range.from, range.to)\n      if (selectedText === '{' || selectedText === '[') {\n        const jsmap = jsonSourceMap.parse(text)\n        const path = Object.keys(jsmap.pointers).find((path) => {\n          const pointer = jsmap.pointers[path]\n          return pointer.value?.pos === range.from\n        })\n        const pointer = jsmap.pointers[path]\n\n        if (path && pointer && pointer.value && pointer.valueEnd) {\n          debug('pointer found, selecting inner contents of path:', path, pointer)\n          const anchor = pointer.value.pos + 1\n          const head = pointer.valueEnd.pos - 1\n          setSelection(anchor, head)\n        }\n      }\n    }\n  }\n\n  function createLinter() {\n    return linter(linterCallback, { delay: TEXT_MODE_ONCHANGE_DELAY })\n  }\n\n  function createCodeMirrorView({\n    target,\n    initialText,\n    readOnly,\n    indentation\n  }: {\n    target: HTMLDivElement\n    initialText: string\n    readOnly: boolean\n    indentation: number | string\n  }): EditorView {\n    debug('Create CodeMirror editor', { readOnly, indentation })\n\n    const state = EditorState.create({\n      doc: initialText,\n      selection: toCodeMirrorSelection(externalSelection),\n      extensions: [\n        keymap.of([indentWithTab, formatCompactKeyBinding]),\n        linterCompartment.of(createLinter()),\n        lintGutter(),\n        lineNumbers(),\n        highlightActiveLineGutter(),\n        highlightSpecialChars(),\n        history(),\n        foldGutter(),\n        drawSelection(),\n        dropCursor(),\n        EditorState.allowMultipleSelections.of(true),\n        indentOnInput(),\n        syntaxHighlighting(defaultHighlightStyle, { fallback: true }),\n        bracketMatching(),\n        closeBrackets(),\n        autocompletion(),\n        rectangularSelection(),\n        crosshairCursor(),\n        highlightActiveLine(),\n        highlightSelectionMatches(),\n        keymap.of([\n          ...closeBracketsKeymap,\n          ...defaultKeymap,\n          ...searchKeymap,\n          ...historyKeymap,\n          ...foldKeymap,\n          ...completionKeymap,\n          ...lintKeymap\n        ]),\n        highlighter,\n        indentationMarkers({ hideFirstIndent: true }),\n        EditorView.domEventHandlers({\n          dblclick: handleDoubleClick\n        }),\n        EditorView.updateListener.of((update) => {\n          editorState = update.state\n\n          if (update.docChanged) {\n            onChangeCodeMirrorValueDebounced()\n          } else if (update.selectionSet) {\n            // note that emitOnSelect is invoked in onChangeCodeMirrorValue too,\n            // right after firing onChange. Hence, the else if here, we do not want to fire it twice.\n            emitOnSelect()\n          }\n        }),\n        jsonLang(),\n        search({\n          top: true\n        }),\n        EditorView.lineWrapping,\n        readOnlyCompartment.of(EditorState.readOnly.of(readOnly)),\n        tabSizeCompartment.of(EditorState.tabSize.of(tabSize)),\n        indentCompartment.of(createIndent(indentation)),\n        themeCompartment.of(EditorView.theme({}, { dark: hasDarkTheme() }))\n      ]\n    })\n\n    codeMirrorView = new EditorView({\n      state,\n      parent: target\n    })\n\n    return codeMirrorView\n  }\n\n  function getCodeMirrorValue() {\n    return codeMirrorView ? normalization.unescapeValue(codeMirrorView.state.doc.toString()) : ''\n  }\n\n  function hasDarkTheme() {\n    return codeMirrorRef\n      ? getComputedStyle(codeMirrorRef).getPropertyValue('--jse-theme').includes('dark')\n      : false\n  }\n\n  function toRichValidationError(validationError: ValidationError): RichValidationError {\n    const { path, message, severity } = validationError\n    const { line, column, from, to } = findTextLocation(normalization.escapeValue(text), path)\n\n    return {\n      path,\n      line,\n      column,\n      from,\n      to,\n      message,\n      severity,\n      actions: []\n    }\n  }\n\n  function toRichParseError(parseError: ParseError, isRepairable: boolean): RichValidationError {\n    const { line, column, position, message } = parseError\n\n    return {\n      path: [] as JSONPath,\n      line,\n      column,\n      from: position,\n      to: position,\n      severity: ValidationSeverity.error,\n      message,\n      actions:\n        isRepairable && !readOnly\n          ? [\n              {\n                name: 'Auto repair',\n                apply: () => handleRepair()\n              }\n            ]\n          : null\n    }\n  }\n\n  function toDiagnostic(error: RichValidationError): Diagnostic {\n    return {\n      from: error.from || 0,\n      to: error.to || 0,\n      message: error.message || '',\n      actions: error.actions as Diagnostic['actions'],\n      severity: error.severity\n    }\n  }\n\n  function setCodeMirrorContent(newContent: Content, emitChange: boolean, forceUpdate: boolean) {\n    const newText = getText(newContent, indentation, parser)\n    const isChanged = !isEqual(newContent, content)\n    const previousContent = content\n\n    debug('setCodeMirrorContent', { isChanged, emitChange, forceUpdate })\n\n    if (!codeMirrorView || (!isChanged && !forceUpdate)) {\n      return\n    }\n\n    content = newContent\n    text = newText\n\n    if (!disableTextEditor(text, acceptTooLarge)) {\n      // keep state\n      // to reset state: codeMirrorView.setState(EditorState.create({doc: text, extensions: ...}))\n      codeMirrorView.dispatch({\n        changes: {\n          from: 0,\n          to: codeMirrorView.state.doc.length,\n          insert: normalization.escapeValue(text)\n        }\n      })\n    }\n\n    updateCanUndoRedo()\n\n    if (isChanged && emitChange) {\n      emitOnChange(content, previousContent)\n    }\n  }\n\n  function applyExternalSelection(externalSelection: JSONEditorSelection | null) {\n    if (!isTextSelection(externalSelection)) {\n      return\n    }\n\n    const selection = toCodeMirrorSelection(externalSelection)\n    if (codeMirrorView && selection && (!editorState || !editorState.selection.eq(selection))) {\n      debug('applyExternalSelection', selection)\n\n      // note that we cannot clear the selection (we could maybe set the cursor to 0 but that's not really what we want)\n      codeMirrorView.dispatch({ selection })\n    }\n  }\n\n  function toCodeMirrorSelection(\n    selection: JSONEditorSelection | null\n  ): EditorSelection | undefined {\n    return isTextSelection(selection) ? EditorSelection.fromJSON(selection) : undefined\n  }\n\n  /**\n   * Force refreshing the editor, for example after changing the font size\n   * to update the positioning of the line numbers in the gutter\n   */\n  export async function refresh(): Promise<void> {\n    debug('refresh')\n\n    // update the theme (light/dark), but also, as a side effect,\n    // refresh the font size of the line numbers in the gutter\n    await updateTheme()\n  }\n\n  function forceUpdateText() {\n    debug('forceUpdateText', { escapeUnicodeCharacters })\n\n    if (codeMirrorView) {\n      codeMirrorView.dispatch({\n        changes: {\n          from: 0,\n          to: codeMirrorView.state.doc.length,\n          insert: normalization.escapeValue(text)\n        }\n      })\n    }\n  }\n\n  function onChangeCodeMirrorValue() {\n    if (onChangeDisabled || !codeMirrorView) {\n      return\n    }\n\n    const codeMirrorText = getCodeMirrorValue()\n\n    const isChanged = codeMirrorText !== text\n    debug('onChangeCodeMirrorValue', { isChanged })\n    if (!isChanged) {\n      return\n    }\n\n    const previousContent = content\n    text = codeMirrorText\n    content = { text }\n\n    updateCanUndoRedo()\n    emitOnChange(content, previousContent)\n\n    // We emit OnSelect on the next tick to cater for the case where\n    // the user changes the content directly inside the OnChange callback.\n    // This change will be dispatched by Svelte on the next tick. Before\n    // that tick, emitOnSelect would be fired based on the \"old\" contents,\n    // which may be out of range when the replacement by the user is shorter.\n    tick().then(emitOnSelect)\n  }\n\n  function updateLinter(validator: Validator | null) {\n    debug('updateLinter', validator)\n\n    if (!codeMirrorView) {\n      return\n    }\n\n    codeMirrorView.dispatch({\n      effects: linterCompartment.reconfigure(createLinter())\n    })\n  }\n\n  function updateIndentation(indentation: number | string) {\n    if (codeMirrorView) {\n      debug('updateIndentation', indentation)\n\n      codeMirrorView.dispatch({\n        effects: indentCompartment.reconfigure(createIndent(indentation))\n      })\n    }\n  }\n\n  function updateTabSize(tabSize: number) {\n    if (codeMirrorView) {\n      debug('updateTabSize', tabSize)\n\n      codeMirrorView.dispatch({\n        effects: tabSizeCompartment.reconfigure(EditorState.tabSize.of(tabSize))\n      })\n    }\n  }\n\n  function updateReadOnly(readOnly: boolean) {\n    if (codeMirrorView) {\n      debug('updateReadOnly', readOnly)\n\n      codeMirrorView.dispatch({\n        effects: [readOnlyCompartment.reconfigure(EditorState.readOnly.of(readOnly))]\n      })\n    }\n  }\n\n  async function updateTheme(): Promise<void> {\n    // we check the theme on the next tick, to make sure the page\n    // is re-rendered with (possibly) changed CSS variables\n    await tick()\n\n    if (codeMirrorView) {\n      const dark = hasDarkTheme()\n      debug('updateTheme', { dark })\n\n      codeMirrorView.dispatch({\n        effects: [themeCompartment.reconfigure(EditorView.theme({}, { dark }))]\n      })\n    }\n  }\n\n  function createIndent(indentation: number | string): Extension[] {\n    const indent = indentUnit.of(\n      typeof indentation === 'number' ? ' '.repeat(indentation) : indentation\n    )\n\n    // We disable wrappedLineIndent in case of tabs to work around a bug:\n    // https://github.com/fauzi9331/codemirror-wrapped-line-indent/issues/2\n    return indentation === '\\t' ? [indent] : [indent, wrappedLineIndent]\n  }\n\n  function updateCanUndoRedo() {\n    canUndo = undoDepth(codeMirrorView.state) > 0\n    canRedo = redoDepth(codeMirrorView.state) > 0\n\n    debug({ canUndo, canRedo })\n  }\n\n  // debounce the input: when pressing Enter at the end of a line, two change\n  // events are fired: one with the new Return character, and a second with\n  // indentation added on the new line. This causes a race condition when used\n  // for example in React. Debouncing the onChange events also results in not\n  // firing a change event with every character that a user types, but only as\n  // soon as the user stops typing.\n  const onChangeCodeMirrorValueDebounced = debounce(\n    onChangeCodeMirrorValue,\n    TEXT_MODE_ONCHANGE_DELAY\n  )\n\n  function flush() {\n    onChangeCodeMirrorValueDebounced.flush()\n  }\n\n  function emitOnChange(content: Content, previousContent: Content) {\n    if (onChange) {\n      onChange(content, previousContent, {\n        contentErrors: validate(),\n        patchResult: null\n      })\n    }\n  }\n\n  function emitOnSelect() {\n    onSelect({\n      type: SelectionType.text,\n      ...editorState.selection.toJSON()\n    })\n  }\n\n  function disableTextEditor(text: string, acceptTooLarge: boolean): boolean {\n    const tooLarge = text ? text.length > MAX_DOCUMENT_SIZE_TEXT_MODE : false\n    return tooLarge && !acceptTooLarge\n  }\n\n  let jsonStatus = JSON_STATUS_VALID\n\n  let jsonParseError: ParseError | null = null\n\n  function linterCallback(): Diagnostic[] {\n    if (disableTextEditor(text, acceptTooLarge)) {\n      return []\n    }\n\n    const contentErrors = validate()\n\n    if (isContentParseError(contentErrors)) {\n      const { parseError, isRepairable } = contentErrors\n\n      return [toDiagnostic(toRichParseError(parseError, isRepairable))]\n    }\n\n    if (isContentValidationErrors(contentErrors)) {\n      return contentErrors.validationErrors.map(toRichValidationError).map(toDiagnostic)\n    }\n\n    return []\n  }\n\n  export function validate(): ContentErrors | null {\n    debug('validate:start')\n\n    flush()\n\n    const contentErrors = memoizedValidateText(\n      normalization.escapeValue(text),\n      validator,\n      parser,\n      validationParser\n    )\n\n    if (isContentParseError(contentErrors)) {\n      jsonStatus = contentErrors.isRepairable ? JSON_STATUS_REPAIRABLE : JSON_STATUS_INVALID\n      jsonParseError = contentErrors.parseError\n      validationErrors = []\n    } else {\n      jsonStatus = JSON_STATUS_VALID\n      jsonParseError = null\n      validationErrors = contentErrors?.validationErrors || []\n    }\n\n    debug('validate:end')\n\n    return contentErrors\n  }\n\n  // because onChange returns the validation errors and there is also a separate listener,\n  // we would execute validation twice. Memoizing the last result solves this.\n  const memoizedValidateText = memoizeOne(validateText)\n\n  function handleShowMe() {\n    if (jsonParseError) {\n      handleSelectParseError(jsonParseError)\n    }\n  }\n\n  const repairActionShowMe = {\n    icon: faEye,\n    text: 'Show me',\n    title: 'Move to the parse error location',\n    onClick: handleShowMe\n  }\n\n  $: repairActions =\n    jsonStatus === JSON_STATUS_REPAIRABLE && !readOnly\n      ? [\n          {\n            icon: faWrench,\n            text: 'Auto repair',\n            title: 'Automatically repair JSON',\n            onClick: handleRepair\n          },\n          repairActionShowMe\n        ]\n      : [repairActionShowMe]\n</script>\n\n<div class=\"jse-text-mode\" class:no-main-menu={!mainMenuBar} bind:this={domTextMode}>\n  {#if mainMenuBar}\n    {@const isNewDocument = text.length === 0}\n\n    <TextMenu\n      {readOnly}\n      onFormat={handleFormat}\n      onCompact={handleCompact}\n      onSort={handleSort}\n      onTransform={handleTransform}\n      onToggleSearch={handleToggleSearch}\n      onUndo={handleUndo}\n      onRedo={handleRedo}\n      canFormat={!isNewDocument}\n      canCompact={!isNewDocument}\n      canSort={!isNewDocument}\n      canTransform={!isNewDocument}\n      {canUndo}\n      {canRedo}\n      {onRenderMenu}\n    />\n  {/if}\n\n  {#if !isSSR}\n    {@const editorDisabled = disableTextEditor(text, acceptTooLarge)}\n\n    <div class=\"jse-contents\" class:jse-hidden={editorDisabled} bind:this={codeMirrorRef} />\n\n    {#if editorDisabled}\n      <Message\n        icon={faExclamationTriangle}\n        type=\"error\"\n        message={`The JSON document is larger than ${formatSize(\n          MAX_DOCUMENT_SIZE_TEXT_MODE,\n          1024\n        )}, ` +\n          `and may crash your browser when loading it in text mode. Actual size: ${formatSize(\n            text.length,\n            1024\n          )}.`}\n        actions={[\n          {\n            text: 'Open anyway',\n            title: 'Open the document in text mode. This may freeze or crash your browser.',\n            onClick: handleAcceptTooLarge\n          },\n          {\n            text: 'Open in tree mode',\n            title: 'Open the document in tree mode. Tree mode can handle large documents.',\n            onClick: handleSwitchToTreeMode\n          },\n          {\n            text: 'Cancel',\n            title: 'Cancel opening this large document.',\n            onClick: cancelLoadTooLarge\n          }\n        ]}\n        onClose={focus}\n      />\n\n      <div class=\"jse-contents jse-preview\">\n        {truncate(text || '', MAX_CHARACTERS_TEXT_PREVIEW)}\n      </div>\n    {/if}\n\n    {#if !editorDisabled}\n      {#if statusBar}\n        <StatusBar {editorState} />\n      {/if}\n\n      {#if jsonParseError}\n        <Message\n          type=\"error\"\n          icon={faExclamationTriangle}\n          message={jsonParseError.message}\n          actions={repairActions}\n          onClick={handleShowMe}\n          onClose={focus}\n        />\n      {/if}\n\n      {#if !jsonParseError && askToFormat && needsFormatting(text)}\n        <Message\n          type=\"success\"\n          message=\"Do you want to format the JSON?\"\n          actions={[\n            {\n              icon: faJSONEditorFormat,\n              text: 'Format',\n              title: 'Format JSON: add proper indentation and new lines (Ctrl+I)',\n              onClick: handleFormat\n            },\n            {\n              icon: faTimes,\n              text: 'No thanks',\n              title: 'Close this message',\n              onClick: () => (askToFormat = false)\n            }\n          ]}\n          onClose={focus}\n        />\n      {/if}\n\n      <ValidationErrorsOverview {validationErrors} selectError={handleSelectValidationError} />\n    {/if}\n  {:else}\n    <div class=\"jse-contents\">\n      <div class=\"jse-loading-space\" />\n      <div class=\"jse-loading\">loading...</div>\n    </div>\n  {/if}\n</div>\n\n<style src=\"./TextMode.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import type { MenuItem, OnRenderMenuInternal } from '$lib/types'\n  import Menu from '../../../controls/Menu.svelte'\n  import {\n    faEllipsisV,\n    faFilter,\n    faRedo,\n    faSearch,\n    faSortAmountDownAlt,\n    faUndo\n  } from '@fortawesome/free-solid-svg-icons'\n  import type { HistoryState } from '$lib/logic/history'\n  import { CONTEXT_MENU_EXPLANATION } from '$lib/constants.js'\n\n  export let containsValidArray: boolean\n  export let readOnly: boolean\n  export let showSearch = false\n  export let historyState: HistoryState\n  export let onSort: () => void\n  export let onTransform: () => void\n  export let onContextMenu: (event: MouseEvent) => void\n  export let onUndo: () => void\n  export let onRedo: () => void\n  export let onRenderMenu: OnRenderMenuInternal\n\n  function handleToggleSearch() {\n    showSearch = !showSearch\n  }\n\n  let defaultItems: MenuItem[]\n  $: defaultItems = !readOnly\n    ? [\n        {\n          type: 'button',\n          icon: faSortAmountDownAlt,\n          title: 'Sort',\n          className: 'jse-sort',\n          onClick: onSort,\n          disabled: readOnly || !containsValidArray\n        },\n        {\n          type: 'button',\n          icon: faFilter,\n          title: 'Transform contents (filter, sort, project)',\n          className: 'jse-transform',\n          onClick: onTransform,\n          disabled: readOnly || !containsValidArray\n        },\n        {\n          type: 'button',\n          icon: faSearch,\n          title: 'Search (Ctrl+F)',\n          className: 'jse-search',\n          onClick: handleToggleSearch,\n          disabled: !containsValidArray\n        },\n        {\n          type: 'button',\n          icon: faEllipsisV,\n          title: CONTEXT_MENU_EXPLANATION,\n          className: 'jse-contextmenu',\n          onClick: onContextMenu\n        },\n        {\n          type: 'separator'\n        },\n        {\n          type: 'button',\n          icon: faUndo,\n          title: 'Undo (Ctrl+Z)',\n          className: 'jse-undo',\n          onClick: onUndo,\n          disabled: !historyState.canUndo\n        },\n        {\n          type: 'button',\n          icon: faRedo,\n          title: 'Redo (Ctrl+Shift+Z)',\n          className: 'jse-redo',\n          onClick: onRedo,\n          disabled: !historyState.canRedo\n        },\n        {\n          type: 'space'\n        }\n      ]\n    : [\n        {\n          type: 'space'\n        }\n      ]\n\n  let items: MenuItem[]\n  $: items = onRenderMenu(defaultItems)\n</script>\n\n<Menu {items} />\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import type {\n    AfterPatchCallback,\n    JSONEditorContext,\n    JSONSelection,\n    SearchResultItem\n  } from '$lib/types'\n  import { isSvelteActionRenderer } from '$lib/typeguards.js'\n  import type { JSONPatchDocument, JSONPath } from 'immutable-json-patch'\n  import { isEditingSelection, isValueSelection } from '$lib/logic/selection.js'\n  import { createNestedValueOperations } from '$lib/logic/operations.js'\n\n  export let path: JSONPath\n  export let value: unknown\n  export let context: JSONEditorContext\n  export let enforceString: boolean\n  export let selection: JSONSelection | null\n  export let searchResultItems: SearchResultItem[] | undefined\n\n  function handlePatch(operations: JSONPatchDocument, afterPatch?: AfterPatchCallback) {\n    // When having flattened table columns, it is possible that we edit a nested value of which\n    // the parent object is not existing. Therefore, we call replaceNestedValue to create\n    // the parent object(s) first.\n    return context.onPatch(createNestedValueOperations(operations, context.getJson()), afterPatch)\n  }\n\n  $: isEditing = !context.readOnly && isValueSelection(selection) && isEditingSelection(selection)\n\n  $: renderers = context.onRenderValue({\n    path,\n    value,\n    readOnly: context.readOnly,\n    enforceString,\n    isEditing,\n    parser: context.parser,\n    normalization: context.normalization,\n    selection,\n    searchResultItems,\n    onPatch: handlePatch,\n    onPasteJson: context.onPasteJson,\n    onSelect: context.onSelect,\n    onFind: context.onFind,\n    findNextInside: context.findNextInside,\n    focus: context.focus\n  })\n</script>\n\n{#each renderers as renderer}\n  {#if isSvelteActionRenderer(renderer)}\n    {@const action = renderer.action}\n    {#key renderer.action}\n      <div\n        role=\"button\"\n        tabindex=\"-1\"\n        class=\"jse-value\"\n        data-type=\"selectable-value\"\n        use:action={renderer.props}\n      />\n    {/key}\n  {:else}\n    {#key renderer.component}\n      <svelte:component this={renderer.component} {...renderer.props} />\n    {/key}\n  {/if}\n{/each}\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import type { JSONPath } from 'immutable-json-patch'\n  import type { JSONParser } from '$lib/types'\n  import { truncate } from '$lib/utils/stringUtils.js'\n  import { MAX_INLINE_OBJECT_CHARS } from '$lib/constants.js'\n\n  export let path: JSONPath\n  export let value: unknown\n  export let parser: JSONParser\n  export let isSelected: boolean\n  export let containsSearchResult: boolean\n  export let containsActiveSearchResult: boolean\n  export let onEdit: (path: JSONPath) => void\n</script>\n\n<button\n  type=\"button\"\n  class=\"jse-inline-value\"\n  class:jse-selected={isSelected}\n  class:jse-highlight={containsSearchResult}\n  class:jse-active={containsActiveSearchResult}\n  on:dblclick={() => onEdit(path)}\n>\n  {truncate(parser.stringify(value) ?? '', MAX_INLINE_OBJECT_CHARS)}\n</button>\n\n<style src=\"./InlineValue.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import type { JSONPath } from 'immutable-json-patch'\n  import type { SortedColumn } from '$lib/types.js'\n  import { SortDirection } from '$lib/types.js'\n  import { stringifyJSONPath } from '$lib/utils/pathUtils.js'\n  import Icon from 'svelte-awesome'\n  import { faCaretDown, faCaretUp } from '@fortawesome/free-solid-svg-icons'\n  import { isEmpty, isEqual } from 'lodash-es'\n  import { MAX_HEADER_NAME_CHARACTERS, SORT_DIRECTION_NAMES } from '$lib/constants.js'\n  import { truncate } from '$lib/utils/stringUtils.js'\n\n  export let path: JSONPath\n  export let sortedColumn: SortedColumn | null\n  export let readOnly: boolean\n  export let onSort: (sortedColumn: SortedColumn) => void\n\n  // TODO: improve truncating of long column names when they are a deeply nested path: the last item from the path should be visible, and halfway the path is least interesting\n  $: columnName = !isEmpty(path) ? stringifyJSONPath(path) : 'values'\n\n  $: sortDirection =\n    sortedColumn && isEqual(path, sortedColumn?.path) ? sortedColumn.sortDirection : undefined\n  $: sortDirectionName = sortDirection ? SORT_DIRECTION_NAMES[sortDirection] : undefined\n\n  function handleSort() {\n    if (readOnly) {\n      return\n    }\n\n    onSort({\n      path,\n      sortDirection: sortDirection === SortDirection.asc ? SortDirection.desc : SortDirection.asc\n    })\n  }\n</script>\n\n<button\n  type=\"button\"\n  class=\"jse-column-header\"\n  class:jse-readonly={readOnly}\n  on:click={handleSort}\n  title={!readOnly ? columnName + ' (Click to sort the data by this column)' : columnName}\n>\n  <span class=\"jse-column-name\">\n    {truncate(columnName, MAX_HEADER_NAME_CHARACTERS)}\n  </span>\n  {#if sortDirection !== undefined}\n    <span class=\"jse-column-sort-icon\" title={`Currently sorted in ${sortDirectionName} order`}>\n      <Icon data={sortDirection === SortDirection.asc ? faCaretDown : faCaretUp} />\n    </span>\n  {/if}\n</button>\n\n<style src=\"./ColumnHeader.scss\"></style>\n","// source: https://github.com/sveltejs/svelte/issues/7583\n\nlet observer: ResizeObserver\nlet callbacks: WeakMap<Element, (element: Element) => void>\n\n/**\n * Example usage:\n *\n *   <script lang=\"ts\">\n *      let clientWidth = 0\n *   </script>\n *\n *   <div use:resizeObserver={element => clientWidth = element.clientWidth}>\n *      My width is: {clientWidth}\n *   </div>\n */\nexport function resizeObserver(element: Element, onResize: (element: Element) => void) {\n  if (!observer) {\n    callbacks = new WeakMap()\n    observer = new ResizeObserver((entries) => {\n      for (const entry of entries) {\n        const onResize = callbacks.get(entry.target)\n        if (onResize) {\n          onResize(entry.target)\n        }\n      }\n    })\n  }\n\n  callbacks.set(element, onResize)\n  observer.observe(element)\n\n  return {\n    destroy: () => {\n      callbacks.delete(element)\n      observer.unobserve(element)\n    }\n  }\n}\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import type { JSONPath } from 'immutable-json-patch'\n  import { getIn, isJSONArray, isJSONObject } from 'immutable-json-patch'\n  import type { JSONParser, OnChangeMode } from '$lib/types.js'\n  import { Mode } from '$lib/types.js'\n  import { valueType } from '$lib/utils/typeUtils.js'\n  import { findNestedArrays } from '$lib/logic/table.js'\n  import { isEmpty } from 'lodash-es'\n  import { stringifyJSONPath } from '$lib/utils/pathUtils.js'\n\n  export let text: string | undefined\n  export let json: unknown | undefined\n  export let readOnly: boolean\n  export let parser: JSONParser\n  export let openJSONEditorModal: (path: JSONPath) => void\n  export let onChangeMode: OnChangeMode\n  export let onClick: () => void\n\n  $: action = readOnly ? 'View' : 'Edit'\n\n  let nestedArrayPaths: JSONPath[]\n  $: nestedArrayPaths = json\n    ? findNestedArrays(json)\n        .slice(0, 99)\n        .filter((path) => path.length > 0)\n    : []\n  $: hasNestedArrays = !isEmpty(nestedArrayPaths)\n  $: isEmptyDocument = json === undefined && (text === '' || text === undefined)\n\n  $: documentType = hasNestedArrays\n    ? 'Object with nested arrays'\n    : isEmptyDocument\n      ? 'An empty document'\n      : isJSONObject(json)\n        ? 'An object'\n        : isJSONArray(json)\n          ? 'An empty array' // note: can also be an array with objects but without properties\n          : `A ${valueType(json, parser)}`\n\n  function countItems(nestedArrayPath: JSONPath): number {\n    return (getIn(json, nestedArrayPath) as JSONPath).length\n  }\n</script>\n\n<div class=\"jse-table-mode-welcome\" on:click={() => onClick()} role=\"none\">\n  <div class=\"jse-space jse-before\" />\n\n  <div class=\"jse-nested-arrays\">\n    <div class=\"jse-nested-arrays-title\">{documentType}</div>\n    <div class=\"jse-nested-arrays-info\">\n      {#if hasNestedArrays}\n        An object cannot be opened in table mode. You can open a nested array instead, or open the\n        document in tree mode.\n      {:else}\n        {documentType} cannot be opened in table mode.\n      {/if}\n      {#if isEmptyDocument && !readOnly}\n        You can open the document in tree mode instead, or paste a JSON Array using <b>Ctrl+V</b>.\n      {:else}\n        You can open the document in tree mode instead.\n      {/if}\n    </div>\n    {#each nestedArrayPaths as nestedArrayPath}\n      {@const count = countItems(nestedArrayPath)}\n\n      <button\n        type=\"button\"\n        class=\"jse-nested-array-action\"\n        on:click={() => openJSONEditorModal(nestedArrayPath)}\n      >\n        {action} \"{stringifyJSONPath(nestedArrayPath)}\"\n        <span class=\"jse-nested-array-count\">({count} {count !== 1 ? 'items' : 'item'})</span>\n      </button>\n    {/each}\n    <button type=\"button\" class=\"jse-nested-array-action\" on:click={() => onChangeMode(Mode.tree)}>\n      {action} in tree mode\n    </button>\n  </div>\n\n  <div class=\"jse-space jse-after\" />\n</div>\n\n<style src=\"./TableModeWelcome.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import Icon from 'svelte-awesome'\n  import { faRotate } from '@fortawesome/free-solid-svg-icons'\n\n  export let count: number\n  export let maxSampleCount: number\n  export let onRefresh: () => void\n</script>\n\n<button\n  type=\"button\"\n  class=\"jse-column-header\"\n  title={`The Columns are created by sampling ${maxSampleCount} items out of ${count}. ` +\n    \"If you're missing a column, click here to sample all of the items instead of a subset. \" +\n    'This is slower.'}\n  on:click={() => onRefresh()}\n>\n  <Icon data={faRotate} />\n</button>\n\n<style src=\"./RefreshColumnHeader.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import type {\n    AbsolutePopupContext,\n    AbsolutePopupOptions,\n    AfterPatchCallback,\n    Content,\n    ContentErrors,\n    ContextMenuItem,\n    DocumentState,\n    HistoryItem,\n    JSONEditorContext,\n    JSONEditorSelection,\n    JSONParser,\n    JSONPatchResult,\n    JSONSelection,\n    OnBlur,\n    OnChange,\n    OnChangeMode,\n    OnFocus,\n    OnJSONEditorModal,\n    OnRenderContextMenuInternal,\n    OnRenderMenuInternal,\n    OnRenderValue,\n    OnSelect,\n    OnSortModal,\n    OnTransformModal,\n    ParseError,\n    PastedJson,\n    SearchResult,\n    SortedColumn,\n    TransformModalOptions,\n    ValidationError,\n    Validator,\n    ValueNormalization\n  } from '$lib/types'\n  import { Mode, SortDirection, ValidationSeverity } from '$lib/types.js'\n  import TableMenu from './menu/TableMenu.svelte'\n  import {\n    compileJSONPointer,\n    compileJSONPointerProp,\n    existsIn,\n    getIn,\n    immutableJSONPatch,\n    isJSONArray,\n    type JSONPatchDocument,\n    type JSONPath\n  } from 'immutable-json-patch'\n  import {\n    isTextContent,\n    normalizeJsonParseError,\n    parseAndRepair,\n    parsePartialJson,\n    repairPartialJson\n  } from '../../../utils/jsonUtils.js'\n  import {\n    calculateAbsolutePosition,\n    calculateVisibleSection,\n    clearSortedColumnWhenAffectedByOperations,\n    getColumns,\n    groupValidationErrors,\n    maintainColumnOrder,\n    mergeValidationErrors,\n    selectNextColumn,\n    selectNextRow,\n    selectPreviousColumn,\n    selectPreviousRow,\n    toTableCellPosition\n  } from '$lib/logic/table.js'\n  import { isEmpty, isEqual, uniqueId } from 'lodash-es'\n  import JSONValueComponent from './JSONValue.svelte'\n  import {\n    activeElementIsChildOf,\n    createNormalizationFunctions,\n    encodeDataPath,\n    findParentWithNodeName,\n    getDataPathFromTarget,\n    getWindow,\n    isEditableDivRef\n  } from '$lib/utils/domUtils.js'\n  import { createDebug } from '$lib/utils/debug.js'\n  import {\n    createDocumentState,\n    documentStatePatch,\n    expandMinimal,\n    expandWithCallback,\n    getEnforceString,\n    setEnforceString\n  } from '$lib/logic/documentState.js'\n  import { isObjectOrArray, isUrl, stringConvert } from '$lib/utils/typeUtils.js'\n  import InlineValue from './tag/InlineValue.svelte'\n  import { revertJSONPatchWithMoveOperations } from '$lib/logic/operations.js'\n  import {\n    createValueSelection,\n    getAnchorPath,\n    getFocusPath,\n    isEditingSelection,\n    isJSONSelection,\n    isValueSelection,\n    pathInSelection,\n    pathStartsWith,\n    removeEditModeFromSelection\n  } from '$lib/logic/selection.js'\n  import { createHistory } from '$lib/logic/history.js'\n  import ColumnHeader from './ColumnHeader.svelte'\n  import { sortJson } from '$lib/logic/sort.js'\n  import { keyComboFromEvent } from '$lib/utils/keyBindings.js'\n  import { createFocusTracker } from '$lib/components/controls/createFocusTracker.js'\n  import { getContext, onDestroy, onMount, tick } from 'svelte'\n  import { jsonrepair } from 'jsonrepair'\n  import Message from '../../controls/Message.svelte'\n  import { faCheck, faCode, faWrench } from '@fortawesome/free-solid-svg-icons'\n  import { measure } from '$lib/utils/timeUtils.js'\n  import memoizeOne from 'memoize-one'\n  import { validateJSON } from '$lib/logic/validation.js'\n  import ValidationErrorsOverview from '../../controls/ValidationErrorsOverview.svelte'\n  import {\n    CONTEXT_MENU_HEIGHT,\n    CONTEXT_MENU_WIDTH,\n    SCROLL_DURATION,\n    SEARCH_BOX_HEIGHT,\n    SIMPLE_MODAL_OPTIONS\n  } from '$lib/constants.js'\n  import { noop } from '$lib/utils/noop.js'\n  import { createJump } from '$lib/assets/jump.js/src/jump.js'\n  import ValidationErrorIcon from '../treemode/ValidationErrorIcon.svelte'\n  import {\n    onCopy,\n    onCut,\n    onDuplicateRow,\n    onInsertAfterRow,\n    onInsertBeforeRow,\n    onInsertCharacter,\n    onPaste,\n    onRemove,\n    onRemoveRow\n  } from '$lib/logic/actions.js'\n  import JSONRepairModal from '../../modals/JSONRepairModal.svelte'\n  import { resizeObserver } from '$lib/actions/resizeObserver.js'\n  import CopyPasteModal from '../../../components/modals/CopyPasteModal.svelte'\n  import ContextMenuPointer from '../../../components/controls/contextmenu/ContextMenuPointer.svelte'\n  import SearchBox from '../../controls/SearchBox.svelte'\n  import TableModeWelcome from './TableModeWelcome.svelte'\n  import JSONPreview from '../../controls/JSONPreview.svelte'\n  import RefreshColumnHeader from './RefreshColumnHeader.svelte'\n  import type { Context } from 'svelte-simple-modal'\n  import createTableContextMenuItems from './contextmenu/createTableContextMenuItems'\n  import ContextMenu from '../../controls/contextmenu/ContextMenu.svelte'\n  import { filterValueSearchResults } from '$lib/logic/search.js'\n  import { filterPointerOrUndefined } from 'svelte-jsoneditor/utils/jsonPointer'\n\n  const debug = createDebug('jsoneditor:TableMode')\n  const { open } = getContext<Context>('simple-modal')\n  const { openAbsolutePopup, closeAbsolutePopup } =\n    getContext<AbsolutePopupContext>('absolute-popup')\n  const jump = createJump()\n  const sortModalId = uniqueId()\n  const transformModalId = uniqueId()\n\n  const isSSR = typeof window === 'undefined'\n  debug('isSSR:', isSSR)\n\n  export let readOnly: boolean\n  export let externalContent: Content\n  export let externalSelection: JSONEditorSelection | null\n  export let mainMenuBar: boolean\n  export let escapeControlCharacters: boolean\n  export let escapeUnicodeCharacters: boolean\n  export let flattenColumns: boolean\n  export let parser: JSONParser\n  export let parseMemoizeOne: JSONParser['parse']\n  export let validator: Validator | null\n  export let validationParser: JSONParser\n  export let indentation: number | string\n  export let onChange: OnChange\n  export let onChangeMode: OnChangeMode\n  export let onSelect: OnSelect\n  export let onRenderValue: OnRenderValue\n  export let onRenderMenu: OnRenderMenuInternal\n  export let onRenderContextMenu: OnRenderContextMenuInternal\n  export let onFocus: OnFocus\n  export let onBlur: OnBlur\n  export let onSortModal: OnSortModal\n  export let onTransformModal: OnTransformModal\n  export let onJSONEditorModal: OnJSONEditorModal\n\n  let normalization: ValueNormalization\n  $: normalization = createNormalizationFunctions({\n    escapeControlCharacters,\n    escapeUnicodeCharacters\n  })\n\n  let refJsonEditor: HTMLDivElement\n  let refContents: HTMLDivElement | undefined\n  let refHiddenInput: HTMLInputElement\n\n  createFocusTracker({\n    onMount,\n    onDestroy,\n    getWindow: () => getWindow(refJsonEditor),\n    hasFocus: () => (modalOpen && document.hasFocus()) || activeElementIsChildOf(refJsonEditor),\n    onFocus: () => {\n      hasFocus = true\n      if (onFocus) {\n        onFocus()\n      }\n    },\n    onBlur: () => {\n      hasFocus = false\n      if (onBlur) {\n        onBlur()\n      }\n    }\n  })\n\n  let json: unknown | undefined\n  let text: string | undefined\n  let parseError: ParseError | undefined = undefined\n\n  let pastedJson: PastedJson\n\n  let searchResult: SearchResult | undefined\n  let showSearch = false\n  let showReplace = false\n\n  $: applySearchBoxSpacing(showSearch)\n\n  function applySearchBoxSpacing(showSearch: boolean) {\n    if (!refContents) {\n      return\n    }\n\n    const offset = showSearch ? SEARCH_BOX_HEIGHT : -SEARCH_BOX_HEIGHT\n    refContents.scrollTo({\n      top: (refContents.scrollTop += offset),\n      left: refContents.scrollLeft\n    })\n  }\n\n  function handleSearch(result: SearchResult | undefined) {\n    searchResult = result\n  }\n\n  async function handleFocusSearch(path: JSONPath) {\n    documentState = {\n      ...documentState,\n      selection: null // navigation path of current selection would be confusing\n    }\n    await scrollTo(path)\n  }\n\n  function handleCloseSearch() {\n    showSearch = false\n    showReplace = false\n    focus()\n  }\n\n  $: applyExternalContent(externalContent)\n  $: applyExternalSelection(externalSelection)\n\n  let maxSampleCount = 10_000\n  let columns: JSONPath[] = []\n  $: columns = isJSONArray(json)\n    ? maintainColumnOrder(getColumns(json, flattenColumns, maxSampleCount), columns)\n    : []\n\n  let containsValidArray: boolean\n  $: containsValidArray = !!(json && !isEmpty(columns))\n  $: showRefreshButton = Array.isArray(json) && json.length > maxSampleCount\n\n  // modalOpen is true when one of the modals is open.\n  // This is used to track whether the editor still has focus\n  let modalOpen = false\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  let hasFocus = false\n\n  let itemHeightsCache: Record<number, number> = {}\n\n  let viewPortHeight = 600\n  let scrollTop = 0\n  let defaultItemHeight = 18 // px\n\n  $: visibleSection = calculateVisibleSection(\n    scrollTop,\n    viewPortHeight,\n    json,\n    itemHeightsCache, // warning: itemHeightsCache is mutated and is not responsive itself\n    defaultItemHeight,\n    showSearch ? SEARCH_BOX_HEIGHT : 0\n  )\n\n  $: refreshScrollTop(json)\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  function refreshScrollTop(_json: unknown | undefined) {\n    // When the contents go from lots of items and scrollable contents to only a few items and\n    // no vertical scroll, the actual scrollTop changes to 0 but there is no on:scroll event\n    // triggered, so the internal scrollTop variable is not up-to-date.\n    // This is a workaround to update the scrollTop by triggering an on:scroll event\n    if (refContents) {\n      refContents.scrollTo({\n        top: refContents.scrollTop,\n        left: refContents.scrollLeft\n      })\n    }\n  }\n\n  function clearSortedColumn() {\n    if (documentState.sortedColumn) {\n      documentState = {\n        ...documentState,\n        sortedColumn: null\n      }\n    }\n  }\n\n  function updateSelection(\n    selection:\n      | JSONSelection\n      | null\n      | ((selection: JSONSelection | null) => JSONSelection | null | void | undefined)\n  ) {\n    debug('updateSelection', selection)\n\n    const updatedSelection =\n      typeof selection === 'function' ? selection(documentState.selection) || null : selection\n\n    if (!isEqual(updatedSelection, documentState.selection)) {\n      documentState = {\n        ...documentState,\n        selection: updatedSelection\n      }\n\n      onSelect(updatedSelection)\n    }\n  }\n\n  function clearSelectionWhenNotExisting(json: unknown | undefined) {\n    if (!documentState.selection || json === undefined) {\n      return\n    }\n\n    if (\n      existsIn(json, getAnchorPath(documentState.selection)) &&\n      existsIn(json, getFocusPath(documentState.selection))\n    ) {\n      return\n    }\n\n    debug('clearing selection: path does not exist anymore', documentState.selection)\n    documentState = {\n      ...documentState,\n      selection: null // TODO: try find the closest cell that still exists (similar to getInitialSelection)\n    }\n  }\n\n  let documentState = createDocumentState()\n  let textIsRepaired = false\n\n  function onSortByHeader(newSortedColumn: SortedColumn) {\n    if (readOnly) {\n      return\n    }\n\n    debug('onSortByHeader', newSortedColumn)\n\n    const rootPath: JSONPath = []\n    const direction = newSortedColumn.sortDirection === SortDirection.desc ? -1 : 1\n    const operations = sortJson(json, rootPath, newSortedColumn.path, direction)\n    handlePatch(operations, (_, patchedState) => {\n      return {\n        state: {\n          ...patchedState,\n          sortedColumn: newSortedColumn\n        }\n      }\n    })\n  }\n\n  const history = createHistory<HistoryItem>({\n    onChange: (state) => {\n      historyState = state\n    }\n  })\n  let historyState = history.getState()\n\n  let context: JSONEditorContext\n  $: context = {\n    readOnly,\n    parser,\n    normalization,\n    getJson: () => json,\n    getDocumentState: () => documentState,\n    findElement,\n    findNextInside,\n    focus,\n    onPatch: handlePatch,\n    onSelect: updateSelection,\n    onFind: handleFind,\n    onPasteJson: handlePasteJson,\n    onRenderValue\n  }\n\n  function applyExternalContent(content: Content) {\n    const currentContent = { json }\n    const isChanged = isTextContent(content)\n      ? content.text !== text\n      : !isEqual(currentContent.json, content.json)\n\n    debug('update external content', { isChanged })\n\n    if (!isChanged) {\n      // no actual change, don't do anything\n      return\n    }\n\n    const previousJson = json\n    const previousState = documentState\n    const previousText = text\n    const previousTextIsRepaired = textIsRepaired\n\n    if (isTextContent(content)) {\n      try {\n        json = parseMemoizeOne(content.text)\n        text = content.text\n        textIsRepaired = false\n        parseError = undefined\n      } catch (err) {\n        try {\n          json = parseMemoizeOne(jsonrepair(content.text))\n          text = content.text\n          textIsRepaired = true\n          parseError = undefined\n        } catch (repairError) {\n          // no valid JSON, will show empty document or invalid json\n          json = undefined\n          text = content.text\n          textIsRepaired = false\n          parseError =\n            text !== ''\n              ? normalizeJsonParseError(text, (err as Error).message || String(err))\n              : undefined\n        }\n      }\n    } else {\n      json = content.json\n      text = undefined\n      textIsRepaired = false\n      parseError = undefined\n    }\n\n    // make sure the selection is valid\n    clearSelectionWhenNotExisting(json)\n\n    // reset the sorting order (we don't know...)\n    clearSortedColumn()\n\n    addHistoryItem({\n      previousJson,\n      previousState,\n      previousText,\n      previousTextIsRepaired\n    })\n  }\n\n  function applyExternalSelection(externalSelection: JSONEditorSelection | null) {\n    if (!isEqual(documentState.selection, externalSelection)) {\n      debug('applyExternalSelection', externalSelection)\n\n      if (isJSONSelection(externalSelection) || externalSelection === null) {\n        updateSelection(externalSelection)\n      }\n    }\n  }\n\n  // TODO: addHistoryItem is a duplicate of addHistoryItem in TreeMode.svelte. Can we extract and reuse this logic?\n  function addHistoryItem({\n    previousJson,\n    previousState,\n    previousText,\n    previousTextIsRepaired\n  }: {\n    previousJson: unknown | undefined\n    previousText: string | undefined\n    previousState: DocumentState\n    previousTextIsRepaired: boolean\n  }) {\n    if (previousJson === undefined && previousText === undefined) {\n      // initialization -> do not create a history item\n      return\n    }\n\n    if (json !== undefined) {\n      if (previousJson !== undefined) {\n        // regular undo/redo with JSON patch\n        history.add({\n          undo: {\n            patch: [{ op: 'replace', path: '', value: previousJson }],\n            state: removeEditModeFromSelection(previousState),\n            json: undefined,\n            text: previousText,\n            textIsRepaired: previousTextIsRepaired\n          },\n          redo: {\n            patch: [{ op: 'replace', path: '', value: json }],\n            state: removeEditModeFromSelection(documentState),\n            json: undefined,\n            text,\n            textIsRepaired\n          }\n        })\n      } else {\n        history.add({\n          undo: {\n            patch: undefined,\n            json: undefined,\n            text: previousText,\n            state: removeEditModeFromSelection(previousState),\n            textIsRepaired: previousTextIsRepaired\n          },\n          redo: {\n            patch: undefined,\n            json,\n            state: removeEditModeFromSelection(documentState),\n            text,\n            textIsRepaired\n          }\n        })\n      }\n    } else {\n      if (previousJson !== undefined) {\n        history.add({\n          undo: {\n            patch: undefined,\n            json: previousJson,\n            state: removeEditModeFromSelection(previousState),\n            text: previousText,\n            textIsRepaired: previousTextIsRepaired\n          },\n          redo: {\n            patch: undefined,\n            json: undefined,\n            text,\n            textIsRepaired,\n            state: removeEditModeFromSelection(documentState)\n          }\n        })\n      } else {\n        // this cannot happen. Nothing to do, no change\n      }\n    }\n  }\n\n  let validationErrors: ValidationError[] = []\n  $: updateValidationErrors(json, validator, parser, validationParser)\n  $: groupedValidationErrors = groupValidationErrors(validationErrors, columns)\n\n  // because onChange returns the validation errors and there is also a separate listener,\n  // we would execute validation twice. Memoizing the last result solves this.\n  const memoizedValidate = memoizeOne(validateJSON)\n\n  function updateValidationErrors(\n    json: unknown,\n    validator: Validator | null,\n    parser: JSONParser,\n    validationParser: JSONParser\n  ) {\n    measure(\n      () => {\n        let newValidationErrors: ValidationError[]\n        try {\n          newValidationErrors = memoizedValidate(json, validator, parser, validationParser)\n        } catch (err) {\n          newValidationErrors = [\n            {\n              path: [],\n              message: 'Failed to validate: ' + (err as Error).message,\n              severity: ValidationSeverity.warning\n            }\n          ]\n        }\n\n        if (!isEqual(newValidationErrors, validationErrors)) {\n          debug('validationErrors changed:', newValidationErrors)\n          validationErrors = newValidationErrors\n        }\n      },\n      (duration) => debug(`validationErrors updated in ${duration} ms`)\n    )\n  }\n\n  export function validate(): ContentErrors | null {\n    debug('validate')\n\n    if (parseError) {\n      return {\n        parseError,\n        isRepairable: false // not applicable, if repairable, we will not have a parseError\n      }\n    }\n\n    // make sure the validation results are up-to-date\n    // normally, they are only updated on the next tick after the json is changed\n    updateValidationErrors(json, validator, parser, validationParser)\n    return !isEmpty(validationErrors) ? { validationErrors } : null\n  }\n\n  export function patch(\n    operations: JSONPatchDocument,\n    afterPatch?: AfterPatchCallback\n  ): JSONPatchResult {\n    debug('patch', operations, afterPatch)\n\n    if (json === undefined) {\n      throw new Error('Cannot apply patch: no JSON')\n    }\n\n    const previousJson = json\n    const previousState = documentState\n    const previousTextIsRepaired = textIsRepaired\n\n    // execute the patch operations\n    const undo: JSONPatchDocument = revertJSONPatchWithMoveOperations(\n      json,\n      operations\n    ) as JSONPatchDocument\n    const patched = documentStatePatch(json, documentState, operations)\n\n    // Clear the sorted column when needed. We need to do this before `afterPatch`,\n    // else we clear any changed made in the callback. It is a bit odd that\n    // afterPatch does not receive the actual previousDocumentState. Better ideas?\n    const patchedJson = patched.json\n    const patchedDocumentState = clearSortedColumnWhenAffectedByOperations(\n      documentState,\n      operations,\n      columns\n    )\n\n    const callback =\n      typeof afterPatch === 'function' ? afterPatch(patchedJson, patchedDocumentState) : undefined\n\n    json = callback && callback.json !== undefined ? callback.json : patchedJson\n    const newState =\n      callback && callback.state !== undefined ? callback.state : patchedDocumentState\n    documentState = newState\n    text = undefined\n    textIsRepaired = false\n    pastedJson = undefined\n    parseError = undefined\n\n    history.add({\n      undo: {\n        patch: undo,\n        json: undefined,\n        text: undefined,\n        state: removeEditModeFromSelection(previousState),\n        textIsRepaired: previousTextIsRepaired\n      },\n      redo: {\n        patch: operations,\n        json: undefined,\n        state: removeEditModeFromSelection(newState),\n        text: undefined,\n        textIsRepaired\n      }\n    })\n\n    return {\n      json,\n      previousJson,\n      undo,\n      redo: operations\n    }\n  }\n\n  function handlePatch(\n    operations: JSONPatchDocument,\n    afterPatch?: AfterPatchCallback\n  ): JSONPatchResult {\n    debug('handlePatch', operations, afterPatch)\n\n    const previousContent = { json, text }\n    const patchResult = patch(operations, afterPatch)\n\n    emitOnChange(previousContent, patchResult)\n\n    return patchResult\n  }\n\n  function emitOnChange(previousContent: Content, patchResult: JSONPatchResult | null) {\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    if (previousContent.json === undefined && previousContent?.text === undefined) {\n      // initialization -> do not fire an onChange event\n      return\n    }\n\n    // make sure we cannot send an invalid contents like having both\n    // json and text defined, or having none defined\n    if (onChange) {\n      if (text !== undefined) {\n        const content = { text, json: undefined }\n        onChange(content, previousContent, {\n          contentErrors: validate(),\n          patchResult\n        })\n      } else if (json !== undefined) {\n        const content = { text: undefined, json }\n        onChange(content, previousContent, {\n          contentErrors: validate(),\n          patchResult\n        })\n      }\n    }\n  }\n\n  function handleFind(findAndReplace: boolean) {\n    debug('handleFind', findAndReplace)\n\n    // TODO: implement handleFind\n  }\n\n  function handlePasteJson(newPastedJson: PastedJson) {\n    debug('pasted json as text', newPastedJson)\n\n    pastedJson = newPastedJson\n  }\n\n  function findNextInside(path: JSONPath): JSONSelection {\n    const index = parseInt(path[0], 10)\n    const nextPath = [String(index + 1), ...path.slice(1)]\n\n    return existsIn(json, nextPath)\n      ? createValueSelection(nextPath, false)\n      : createValueSelection(path, false)\n  }\n\n  export function focus() {\n    debug('focus')\n    // with just .focus(), sometimes the input doesn't react on onpaste events\n    // in Chrome when having a large document open and then doing cut/paste.\n    // Calling both .focus() and .select() did solve this issue.\n    if (refHiddenInput) {\n      refHiddenInput.focus()\n      refHiddenInput.select()\n    }\n  }\n\n  function handleScroll(event: Event) {\n    scrollTop = (event.target as HTMLElement)['scrollTop']\n  }\n\n  function handleMouseDown(event: MouseEvent) {\n    const target = event.target as HTMLElement\n    const path = getDataPathFromTarget(target)\n    if (path) {\n      // when clicking inside the current selection, editing a value, do nothing\n      if (\n        isEditingSelection(documentState.selection) &&\n        pathInSelection(json, documentState.selection, path)\n      ) {\n        return\n      }\n\n      updateSelection(createValueSelection(path, false))\n\n      event.preventDefault()\n    }\n\n    // for example when clicking on the empty area in the main menu or on an InlineValue\n    if (!target.isContentEditable) {\n      focus()\n    }\n  }\n\n  function createDefaultSelection(): JSONSelection | null {\n    if (isJSONArray(json) && !isEmpty(json) && !isEmpty(columns)) {\n      // Select the first row, first column\n      const path = ['0', ...columns[0]]\n\n      return createValueSelection(path, false)\n    } else {\n      return null\n    }\n  }\n\n  function createDefaultSelectionWhenUndefined() {\n    if (!documentState.selection) {\n      updateSelection(createDefaultSelection())\n    }\n  }\n\n  export function acceptAutoRepair() {\n    if (textIsRepaired && json !== undefined) {\n      const previousState = documentState\n      const previousJson = json\n      const previousText = text\n      const previousContent = { json, text }\n      const previousTextIsRepaired = textIsRepaired\n\n      // json stays as is\n      text = undefined\n      textIsRepaired = false\n\n      clearSelectionWhenNotExisting(json)\n\n      addHistoryItem({\n        previousJson,\n        previousState,\n        previousText,\n        previousTextIsRepaired\n      })\n\n      // we could work out a patchResult, or use patch(), but only when the previous and new\n      // contents are both json and not text. We go for simplicity and consistency here and\n      // do _not_ return a patchResult ever.\n      const patchResult = null\n\n      emitOnChange(previousContent, patchResult)\n    }\n\n    return { json, text }\n  }\n\n  /**\n   * Scroll the window vertically to the node with given path.\n   * Expand the path when needed.\n   */\n  export function scrollTo(path: JSONPath, scrollToWhenVisible = true): Promise<void> {\n    const searchBoxHeight = showSearch ? SEARCH_BOX_HEIGHT : 0\n    const top = calculateAbsolutePosition(path, columns, itemHeightsCache, defaultItemHeight)\n    const roughDistance = top - scrollTop + searchBoxHeight + defaultItemHeight\n    const elem = findElement(path)\n\n    debug('scrollTo', { path, top, scrollTop, elem })\n\n    if (!refContents) {\n      return Promise.resolve()\n    }\n\n    const viewPortRect = refContents.getBoundingClientRect()\n    if (elem && !scrollToWhenVisible) {\n      const elemRect = elem.getBoundingClientRect()\n      if (elemRect.bottom > viewPortRect.top && elemRect.top < viewPortRect.bottom) {\n        // element is fully or partially visible, don't scroll to it\n        return Promise.resolve()\n      }\n    }\n\n    const offset = -Math.max(searchBoxHeight + 2 * defaultItemHeight, viewPortRect.height / 4)\n\n    if (elem) {\n      return new Promise((resolve) => {\n        jump(elem, {\n          container: refContents,\n          offset,\n          duration: SCROLL_DURATION,\n          callback: () => {\n            // TODO: improve horizontal scrolling: animate and integrate with the vertical scrolling (jump)\n            scrollToHorizontal(path)\n            resolve()\n          }\n        })\n      })\n    } else {\n      return new Promise((resolve) => {\n        jump(roughDistance, {\n          container: refContents,\n          offset,\n          duration: SCROLL_DURATION,\n          callback: async () => {\n            // ensure the element is rendered now that it is scrolled into view\n            await tick()\n\n            // TODO: improve horizontal scrolling: animate and integrate with the vertical scrolling (jump)\n            scrollToHorizontal(path)\n            resolve()\n          }\n        })\n      })\n    }\n  }\n\n  function scrollToVertical(path: JSONPath) {\n    if (!refContents) {\n      return\n    }\n\n    const { rowIndex } = toTableCellPosition(path, columns)\n    const top = calculateAbsolutePosition(path, columns, itemHeightsCache, defaultItemHeight)\n    const bottom = top + (itemHeightsCache[rowIndex] || defaultItemHeight)\n\n    const headerHeight = defaultItemHeight\n    const viewPortRect = refContents.getBoundingClientRect()\n    const viewPortTop = scrollTop\n    const viewPortBottom = scrollTop + viewPortRect.height - headerHeight\n\n    if (bottom > viewPortBottom) {\n      const diff = bottom - viewPortBottom\n      refContents.scrollTop += diff\n    }\n\n    if (top < viewPortTop) {\n      const diff = viewPortTop - top\n      refContents.scrollTop -= diff\n    }\n  }\n\n  function scrollToHorizontal(path: JSONPath) {\n    const elem = findElement(path)\n    if (!elem || !refContents) {\n      return\n    }\n\n    const viewPortRect = refContents.getBoundingClientRect()\n    const elemRect = elem.getBoundingClientRect() // TODO: scroll to column instead of item (is always rendered)\n\n    if (elemRect.right > viewPortRect.right) {\n      const diff = elemRect.right - viewPortRect.right\n      refContents.scrollLeft += diff\n    }\n\n    if (elemRect.left < viewPortRect.left) {\n      const diff = viewPortRect.left - elemRect.left\n      refContents.scrollLeft -= diff\n    }\n  }\n\n  function scrollIntoView(path: JSONPath) {\n    scrollToVertical(path)\n    scrollToHorizontal(path)\n  }\n\n  /**\n   * Find the DOM element of a given path.\n   * Note that the path can only be found when the node is expanded.\n   */\n  export function findElement(path: JSONPath): Element | null {\n    const column = columns.find((c) => pathStartsWith(path.slice(1), c))\n\n    const resolvedPath = column ? path.slice(0, 1).concat(column) : path\n\n    return refContents\n      ? refContents.querySelector(`td[data-path=\"${encodeDataPath(resolvedPath)}\"]`)\n      : null\n  }\n\n  function openContextMenu({\n    anchor,\n    left,\n    top,\n    width,\n    height,\n    offsetTop,\n    offsetLeft,\n    showTip\n  }: AbsolutePopupOptions) {\n    const defaultItems: ContextMenuItem[] = createTableContextMenuItems({\n      json,\n      documentState,\n      readOnly,\n      parser,\n\n      onEditValue: handleEditValue,\n      onEditRow: handleEditRow,\n      onToggleEnforceString: handleToggleEnforceString,\n\n      onCut: handleCut,\n      onCopy: handleCopy,\n      onPaste: handlePasteFromMenu,\n\n      onRemove: handleRemove,\n      onDuplicateRow: handleDuplicateRow,\n      onInsertBeforeRow: handleInsertBeforeRow,\n      onInsertAfterRow: handleInsertAfterRow,\n      onRemoveRow: handleRemoveRow\n    })\n\n    const items = onRenderContextMenu(defaultItems)\n\n    if (items === false) {\n      return\n    }\n\n    const props = {\n      tip: showTip\n        ? 'Tip: you can open this context menu via right-click or with Ctrl+Q'\n        : undefined,\n      items,\n      onRequestClose: function () {\n        closeAbsolutePopup(popupId)\n        focus()\n      }\n    }\n\n    const options = {\n      left,\n      top,\n      offsetTop,\n      offsetLeft,\n      width,\n      height,\n      anchor,\n      closeOnOuterClick: true,\n      onClose: () => {\n        modalOpen = false\n        focus()\n      }\n    }\n\n    modalOpen = true\n\n    const popupId = openAbsolutePopup(ContextMenu, props, options)\n  }\n\n  function handleContextMenu(event: Event) {\n    if (isEditingSelection(documentState.selection)) {\n      return\n    }\n\n    if (event) {\n      event.stopPropagation()\n      event.preventDefault()\n    }\n\n    if (event && event.type === 'contextmenu' && event.target !== refHiddenInput) {\n      // right mouse click to open context menu\n      openContextMenu({\n        left: (event as MouseEvent).clientX,\n        top: (event as MouseEvent).clientY,\n        width: CONTEXT_MENU_WIDTH,\n        height: CONTEXT_MENU_HEIGHT,\n        showTip: false\n      })\n    } else {\n      // type === 'keydown' (from the quick key Ctrl+Q)\n      // or target is hidden input -> context menu button on keyboard\n      const anchor = refContents?.querySelector('.jse-table-cell.jse-selected-value')\n      if (anchor) {\n        openContextMenu({\n          anchor,\n          offsetTop: 2,\n          width: CONTEXT_MENU_WIDTH,\n          height: CONTEXT_MENU_HEIGHT,\n          showTip: false\n        })\n      } else {\n        // fallback on just displaying the TreeContextMenu top left\n        const rect = refContents?.getBoundingClientRect()\n        if (rect) {\n          openContextMenu({\n            top: rect.top + 2,\n            left: rect.left + 2,\n            width: CONTEXT_MENU_WIDTH,\n            height: CONTEXT_MENU_HEIGHT,\n            showTip: false\n          })\n        }\n      }\n    }\n\n    return false\n  }\n\n  function handleContextMenuFromTableMenu(event: MouseEvent) {\n    openContextMenu({\n      anchor: findParentWithNodeName(event.target as HTMLElement, 'BUTTON'),\n      offsetTop: 0,\n      width: CONTEXT_MENU_WIDTH,\n      height: CONTEXT_MENU_HEIGHT,\n      showTip: true\n    })\n  }\n\n  function handleEditValue() {\n    if (readOnly || !documentState.selection) {\n      return\n    }\n\n    const path = getFocusPath(documentState.selection)\n    const value = getIn(json, path)\n    if (isObjectOrArray(value)) {\n      openJSONEditorModal(path)\n    } else {\n      updateSelection(createValueSelection(path, true))\n    }\n  }\n\n  function handleEditRow() {\n    if (readOnly || !documentState.selection) {\n      return\n    }\n\n    const path = getFocusPath(documentState.selection)\n    const pathRow = path.slice(0, 1)\n    openJSONEditorModal(pathRow)\n  }\n\n  function handleToggleEnforceString() {\n    if (readOnly || !isValueSelection(documentState.selection)) {\n      return\n    }\n\n    const path = documentState.selection.path\n    const pointer = compileJSONPointer(path)\n    const value = getIn(json, path)\n    const enforceString = !getEnforceString(value, documentState.enforceStringMap, pointer, parser)\n    const updatedValue = enforceString ? String(value) : stringConvert(String(value), parser)\n\n    debug('handleToggleEnforceString', { enforceString, value, updatedValue })\n\n    handlePatch(\n      [\n        {\n          op: 'replace',\n          path: pointer,\n          value: updatedValue\n        }\n      ],\n      (_, patchedState) => {\n        return {\n          state: setEnforceString(patchedState, pointer, enforceString)\n        }\n      }\n    )\n  }\n\n  async function handleParsePastedJson() {\n    debug('apply pasted json', pastedJson)\n    if (!pastedJson) {\n      return\n    }\n\n    const { path, contents } = pastedJson\n\n    // exit edit mode\n    const refEditableDiv = refContents?.querySelector('.jse-editable-div') || null\n    if (isEditableDivRef(refEditableDiv)) {\n      refEditableDiv.cancel()\n    }\n\n    // replace the value with the JSON object/array\n    const operations: JSONPatchDocument = [\n      {\n        op: 'replace',\n        path: compileJSONPointer(path),\n        value: contents\n      }\n    ]\n\n    handlePatch(operations)\n\n    // TODO: get rid of the setTimeout here\n    setTimeout(focus)\n  }\n\n  function handlePasteFromMenu() {\n    open(\n      CopyPasteModal,\n      {},\n      {\n        ...SIMPLE_MODAL_OPTIONS,\n        styleWindow: {\n          width: '450px'\n        }\n      },\n      {\n        onClose: () => focus()\n      }\n    )\n  }\n\n  function handleClearPastedJson() {\n    debug('clear pasted json')\n    pastedJson = undefined\n    focus()\n  }\n\n  function handleRequestRepair() {\n    onChangeMode(Mode.text)\n  }\n\n  async function handleCut(indent: boolean) {\n    await onCut({\n      json,\n      documentState,\n      indentation: indent ? indentation : undefined,\n      readOnly,\n      parser,\n      onPatch: handlePatch\n    })\n  }\n\n  async function handleCopy(indent = true) {\n    if (json === undefined) {\n      return\n    }\n\n    await onCopy({\n      json,\n      documentState,\n      indentation: indent ? indentation : undefined,\n      parser\n    })\n  }\n\n  function handleRemove() {\n    onRemove({\n      json,\n      text,\n      documentState,\n      keepSelection: true,\n      readOnly,\n      onChange,\n      onPatch: handlePatch\n    })\n  }\n\n  function handleDuplicateRow() {\n    onDuplicateRow({ json, documentState, columns, readOnly, onPatch: handlePatch })\n  }\n\n  function handleInsertBeforeRow() {\n    onInsertBeforeRow({ json, documentState, columns, readOnly, onPatch: handlePatch })\n  }\n\n  function handleInsertAfterRow() {\n    onInsertAfterRow({ json, documentState, columns, readOnly, onPatch: handlePatch })\n  }\n\n  function handleRemoveRow() {\n    onRemoveRow({ json, documentState, columns, readOnly, onPatch: handlePatch })\n  }\n\n  async function handleInsertCharacter(char: string) {\n    await onInsertCharacter({\n      char,\n      selectInside: false,\n      refJsonEditor,\n      json,\n      selection: documentState.selection,\n      readOnly,\n      parser,\n      onPatch: handlePatch,\n      onReplaceJson: handleReplaceJson,\n      onSelect: updateSelection\n    })\n  }\n\n  function handleKeyDown(event: KeyboardEvent) {\n    const combo = keyComboFromEvent(event)\n    debug('keydown', { combo, key: event.key })\n\n    if (combo === 'Ctrl+X') {\n      // cut formatted\n      event.preventDefault()\n      handleCut(true)\n    }\n    if (combo === 'Ctrl+Shift+X') {\n      // cut compact\n      event.preventDefault()\n      handleCut(false)\n    }\n    if (combo === 'Ctrl+C') {\n      // copy formatted\n      event.preventDefault()\n      handleCopy(true)\n    }\n    if (combo === 'Ctrl+Shift+C') {\n      // copy compact\n      event.preventDefault()\n      handleCopy(false)\n    }\n    // Note: Ctrl+V (paste) is handled by the on:paste event\n\n    if (combo === 'Ctrl+D') {\n      event.preventDefault()\n      // handleDuplicate()\n      // TODO: implement duplicate\n    }\n    if (combo === 'Delete' || combo === 'Backspace') {\n      event.preventDefault()\n      handleRemove()\n    }\n    if (combo === 'Insert') {\n      event.preventDefault()\n      // TODO: implement insert\n    }\n    if (combo === 'Ctrl+A') {\n      event.preventDefault()\n      // updateSelection(selectAll())\n      // TODO: implement select all\n    }\n\n    if (combo === 'Ctrl+Q') {\n      handleContextMenu(event)\n    }\n\n    if (combo === 'ArrowLeft') {\n      event.preventDefault()\n\n      createDefaultSelectionWhenUndefined()\n\n      if (documentState.selection) {\n        const newSelection = selectPreviousColumn(columns, documentState.selection)\n        updateSelection(newSelection)\n        scrollIntoView(getFocusPath(newSelection))\n      }\n    }\n\n    if (combo === 'ArrowRight') {\n      event.preventDefault()\n\n      createDefaultSelectionWhenUndefined()\n\n      if (documentState.selection) {\n        const newSelection = selectNextColumn(columns, documentState.selection)\n        updateSelection(newSelection)\n        scrollIntoView(getFocusPath(newSelection))\n      }\n    }\n\n    if (combo === 'ArrowUp') {\n      event.preventDefault()\n\n      createDefaultSelectionWhenUndefined()\n\n      if (documentState.selection) {\n        const newSelection = selectPreviousRow(columns, documentState.selection)\n        updateSelection(newSelection)\n        scrollIntoView(getFocusPath(newSelection))\n      }\n    }\n\n    if (combo === 'ArrowDown') {\n      event.preventDefault()\n\n      createDefaultSelectionWhenUndefined()\n\n      if (documentState.selection) {\n        const newSelection = selectNextRow(json, columns, documentState.selection)\n        updateSelection(newSelection)\n        scrollIntoView(getFocusPath(newSelection))\n      }\n    }\n\n    if (combo === 'Enter' && documentState.selection) {\n      if (isValueSelection(documentState.selection)) {\n        event.preventDefault()\n\n        const path = documentState.selection.path\n        const value = getIn(json, path)\n        if (isObjectOrArray(value)) {\n          // edit nested object/array\n          openJSONEditorModal(path)\n        } else {\n          if (!readOnly) {\n            // go to value edit mode\n            updateSelection({ ...documentState.selection, edit: true })\n          }\n        }\n      }\n    }\n\n    const normalizedCombo = combo.replace(/^Shift\\+/, '') // replace 'Shift+A' with 'A'\n    if (normalizedCombo.length === 1 && documentState.selection) {\n      // a regular key like a, A, _, etc is entered.\n      // Replace selected contents with a new value having this first character as text\n      event.preventDefault()\n      handleInsertCharacter(event.key)\n      return\n    }\n\n    if (combo === 'Ctrl+Enter' && isValueSelection(documentState.selection)) {\n      const value = getIn(json, documentState.selection.path)\n\n      if (isUrl(value)) {\n        // open url in new page\n        window.open(String(value), '_blank')\n      }\n    }\n\n    if (combo === 'Escape' && documentState.selection) {\n      event.preventDefault()\n      updateSelection(null)\n    }\n\n    if (combo === 'Ctrl+F') {\n      event.preventDefault()\n      openFind(false)\n    }\n\n    if (combo === 'Ctrl+H') {\n      event.preventDefault()\n      openFind(true)\n    }\n\n    if (combo === 'Ctrl+Z') {\n      event.preventDefault()\n\n      handleUndo()\n    }\n\n    if (combo === 'Ctrl+Shift+Z') {\n      event.preventDefault()\n\n      handleRedo()\n    }\n  }\n\n  function handlePaste(event: ClipboardEvent) {\n    event.preventDefault()\n\n    const clipboardText = event.clipboardData?.getData('text/plain') as string | undefined\n    if (clipboardText === undefined) {\n      return\n    }\n\n    onPaste({\n      clipboardText,\n      json,\n      selection: documentState.selection,\n      readOnly,\n      parser,\n      onPatch: handlePatch,\n      onChangeText: handleChangeText,\n      openRepairModal\n    })\n  }\n\n  // TODO: this function is duplicated from TreeMode. See if we can reuse the code instead\n  function handleReplaceJson(updatedJson: unknown, afterPatch?: AfterPatchCallback) {\n    const previousState = documentState\n    const previousJson = json\n    const previousText = text\n    const previousContent = { json, text }\n    const previousTextIsRepaired = textIsRepaired\n\n    const updatedState = expandWithCallback(json, documentState, [], expandMinimal)\n\n    const callback =\n      typeof afterPatch === 'function' ? afterPatch(updatedJson, updatedState) : undefined\n\n    json = callback && callback.json !== undefined ? callback.json : updatedJson\n    documentState = callback && callback.state !== undefined ? callback.state : updatedState\n    text = undefined\n    textIsRepaired = false\n    parseError = undefined\n\n    // make sure the selection is valid\n    clearSelectionWhenNotExisting(json)\n\n    addHistoryItem({\n      previousJson,\n      previousState,\n      previousText,\n      previousTextIsRepaired\n    })\n\n    // we could work out a patchResult, or use patch(), but only when the previous and new\n    // contents are both json and not text. We go for simplicity and consistency here and\n    // do _not_ return a patchResult ever.\n    const patchResult = null\n\n    emitOnChange(previousContent, patchResult)\n  }\n\n  // TODO: this function is duplicated from TreeMode. See if we can reuse the code instead\n  function handleChangeText(updatedText: string, afterPatch?: AfterPatchCallback) {\n    debug('handleChangeText')\n\n    const previousState = documentState\n    const previousJson = json\n    const previousText = text\n    const previousContent = { json, text }\n    const previousTextIsRepaired = textIsRepaired\n\n    try {\n      json = parseMemoizeOne(updatedText)\n      documentState = expandWithCallback(json, documentState, [], expandMinimal)\n      text = undefined\n      textIsRepaired = false\n      parseError = undefined\n    } catch (err) {\n      try {\n        json = parseMemoizeOne(jsonrepair(updatedText))\n        documentState = expandWithCallback(json, documentState, [], expandMinimal)\n        text = updatedText\n        textIsRepaired = true\n        parseError = undefined\n      } catch (repairError) {\n        // no valid JSON, will show empty document or invalid json\n        json = undefined\n        documentState = createDocumentState({ json, expand: expandMinimal })\n        text = updatedText\n        textIsRepaired = false\n        parseError =\n          text !== ''\n            ? normalizeJsonParseError(text, (err as Error).message || String(err))\n            : undefined\n      }\n    }\n\n    if (typeof afterPatch === 'function') {\n      const callback = afterPatch(json, documentState)\n\n      json = callback && callback.json ? callback.json : json\n      documentState = callback && callback.state ? callback.state : documentState\n    }\n\n    // ensure the selection is valid\n    clearSelectionWhenNotExisting(json)\n\n    addHistoryItem({\n      previousJson,\n      previousState,\n      previousText,\n      previousTextIsRepaired\n    })\n\n    // no JSON patch actions available in text mode\n    const patchResult = null\n\n    emitOnChange(previousContent, patchResult)\n  }\n\n  function handleSelectValidationError(error: ValidationError) {\n    debug('select validation error', error)\n\n    updateSelection(createValueSelection(error.path, false))\n\n    scrollTo(error.path)\n  }\n\n  function openSortModal(rootPath: JSONPath) {\n    if (readOnly || json === undefined) {\n      return\n    }\n\n    modalOpen = true\n\n    onSortModal({\n      id: sortModalId,\n      json,\n      rootPath,\n      onSort: ({ operations, itemPath, direction }) => {\n        debug('onSort', operations, rootPath, itemPath, direction)\n\n        handlePatch(operations, (_, patchedState) => {\n          return {\n            state: {\n              ...patchedState,\n              sortedColumn: {\n                path: itemPath,\n                sortDirection: direction === -1 ? SortDirection.desc : SortDirection.asc\n              }\n            }\n          }\n        })\n      },\n      onClose: () => {\n        modalOpen = false\n        focus()\n      }\n    })\n  }\n\n  /**\n   * This method is exposed via JSONEditor.transform\n   */\n  export function openTransformModal(options: TransformModalOptions) {\n    if (json === undefined) {\n      return\n    }\n\n    const { id, onTransform, onClose } = options\n    const rootPath = options.rootPath || []\n\n    modalOpen = true\n\n    onTransformModal({\n      id: id || transformModalId,\n      json,\n      rootPath: rootPath || [],\n      onTransform: (operations) => {\n        if (onTransform) {\n          onTransform({\n            operations,\n            json: json,\n            transformedJson: immutableJSONPatch(json, operations)\n          })\n        } else {\n          debug('onTransform', rootPath, operations)\n\n          handlePatch(operations)\n        }\n      },\n      onClose: () => {\n        modalOpen = false\n        focus()\n        if (onClose) {\n          onClose()\n        }\n      }\n    })\n  }\n\n  function openJSONEditorModal(path: JSONPath) {\n    debug('openJSONEditorModal', { path })\n\n    modalOpen = true\n\n    // open a popup where you can edit the nested object/array\n    onJSONEditorModal({\n      content: {\n        json: getIn(json, path)\n      },\n      path,\n      onPatch: context.onPatch,\n      onClose: () => {\n        modalOpen = false\n        focus()\n      }\n    })\n  }\n\n  function openRepairModal(text: string, onApply: (repairedText: string) => void) {\n    open(\n      JSONRepairModal,\n      {\n        text,\n        onParse: (text: string) => parsePartialJson(text, (t) => parseAndRepair(t, parser)),\n        onRepair: repairPartialJson,\n        onApply\n      },\n      {\n        ...SIMPLE_MODAL_OPTIONS,\n        styleWindow: {\n          width: '600px',\n          height: '500px'\n        },\n        styleContent: {\n          padding: 0,\n          height: '100%'\n        }\n      },\n      {\n        onClose: () => focus()\n      }\n    )\n  }\n\n  function handleSortAll() {\n    const rootPath: JSONPath = []\n    openSortModal(rootPath)\n  }\n\n  function handleTransformAll() {\n    openTransformModal({\n      rootPath: []\n    })\n  }\n\n  function openFind(findAndReplace: boolean): void {\n    debug('openFind', { findAndReplace })\n\n    showSearch = false\n    showReplace = false\n\n    tick().then(() => {\n      // trick to make sure the focus goes to the search box\n      showSearch = true\n      showReplace = findAndReplace\n    })\n  }\n\n  function handleUndo() {\n    if (readOnly) {\n      return\n    }\n\n    if (!history.getState().canUndo) {\n      return\n    }\n\n    const item = history.undo()\n    if (!item) {\n      return\n    }\n\n    const previousContent = { json, text }\n\n    json = item.undo.patch ? immutableJSONPatch(json, item.undo.patch) : item.undo.json\n    documentState = item.undo.state\n    text = item.undo.text\n    textIsRepaired = item.undo.textIsRepaired\n    parseError = undefined\n\n    debug('undo', { item, json })\n\n    const patchResult =\n      item.undo.patch && item.redo.patch\n        ? {\n            json,\n            previousJson: previousContent.json,\n            redo: item.undo.patch,\n            undo: item.redo.patch\n          }\n        : null\n\n    emitOnChange(previousContent, patchResult)\n\n    focus()\n    if (documentState.selection) {\n      scrollTo(getFocusPath(documentState.selection), false)\n    }\n  }\n\n  function handleRedo() {\n    if (readOnly) {\n      return\n    }\n\n    if (!history.getState().canRedo) {\n      return\n    }\n\n    const item = history.redo()\n    if (!item) {\n      return\n    }\n\n    const previousContent = { json, text }\n\n    json = item.redo.patch ? immutableJSONPatch(json, item.redo.patch) : item.redo.json\n    documentState = item.redo.state\n    text = item.redo.text\n    textIsRepaired = item.redo.textIsRepaired\n    parseError = undefined\n\n    debug('redo', { item, json })\n\n    const patchResult =\n      item.undo.patch && item.redo.patch\n        ? {\n            json,\n            previousJson: previousContent.json,\n            redo: item.redo.patch,\n            undo: item.undo.patch\n          }\n        : null\n\n    emitOnChange(previousContent, patchResult)\n\n    focus()\n    if (documentState.selection) {\n      scrollTo(getFocusPath(documentState.selection), false)\n    }\n  }\n\n  function handleResizeContents(element: Element) {\n    viewPortHeight = element.getBoundingClientRect().height\n  }\n\n  function handleResizeRow(element: Element, rowIndex: number) {\n    itemHeightsCache[rowIndex] = element.getBoundingClientRect().height\n  }\n</script>\n\n<!-- svelte-ignore a11y-no-noninteractive-element-interactions -->\n<div\n  role=\"table\"\n  class=\"jse-table-mode\"\n  class:no-main-menu={!mainMenuBar}\n  on:mousedown={handleMouseDown}\n  on:keydown={handleKeyDown}\n  on:contextmenu={handleContextMenu}\n  bind:this={refJsonEditor}\n>\n  {#if mainMenuBar}\n    <TableMenu\n      {containsValidArray}\n      {readOnly}\n      bind:showSearch\n      {historyState}\n      onSort={handleSortAll}\n      onTransform={handleTransformAll}\n      onUndo={handleUndo}\n      onRedo={handleRedo}\n      onContextMenu={handleContextMenuFromTableMenu}\n      {onRenderMenu}\n    />\n  {/if}\n\n  {#if !isSSR}\n    <label class=\"jse-hidden-input-label\">\n      <input\n        type=\"text\"\n        readonly={true}\n        tabindex=\"-1\"\n        class=\"jse-hidden-input\"\n        bind:this={refHiddenInput}\n        on:paste={handlePaste}\n      />\n    </label>\n    {#if containsValidArray}\n      <div class=\"jse-search-box-container\">\n        <SearchBox\n          {json}\n          {documentState}\n          {parser}\n          {showSearch}\n          {showReplace}\n          {readOnly}\n          {columns}\n          onSearch={handleSearch}\n          onFocus={handleFocusSearch}\n          onPatch={handlePatch}\n          onClose={handleCloseSearch}\n        />\n      </div>\n      <div\n        class=\"jse-contents\"\n        bind:this={refContents}\n        use:resizeObserver={handleResizeContents}\n        on:scroll={handleScroll}\n      >\n        <table class=\"jse-table-main\">\n          <tbody>\n            <tr class=\"jse-table-row jse-table-row-header\">\n              <th class=\"jse-table-cell jse-table-cell-header\">\n                {#if !isEmpty(groupedValidationErrors?.root)}\n                  {@const validationError = mergeValidationErrors(\n                    [],\n                    groupedValidationErrors?.root\n                  )}\n                  {#if validationError}\n                    <div class=\"jse-table-root-error\">\n                      <ValidationErrorIcon {validationError} onExpand={noop} />\n                    </div>\n                  {/if}\n                {/if}\n              </th>\n              {#each columns as column}\n                <th class=\"jse-table-cell jse-table-cell-header\">\n                  <ColumnHeader\n                    path={column}\n                    sortedColumn={documentState.sortedColumn}\n                    {readOnly}\n                    onSort={onSortByHeader}\n                  />\n                </th>\n              {/each}\n              {#if showRefreshButton}\n                <th class=\"jse-table-cell jse-table-cell-header\">\n                  <RefreshColumnHeader\n                    count={Array.isArray(json) ? json.length : 0}\n                    {maxSampleCount}\n                    onRefresh={() => (maxSampleCount = Infinity)}\n                  />\n                </th>\n              {/if}\n            </tr>\n            <tr class=\"jse-table-invisible-start-section\">\n              <td style:height={visibleSection.startHeight + 'px'} colspan={columns.length} />\n            </tr>\n            {#each visibleSection.visibleItems as item, visibleIndex}\n              {@const rowIndex = visibleSection.startIndex + visibleIndex}\n              {@const validationErrorsByRow = groupedValidationErrors.rows[rowIndex]}\n              {@const validationError = mergeValidationErrors(\n                [String(rowIndex)],\n                validationErrorsByRow?.row\n              )}\n              {@const searchResultItemsByRow = searchResult?.itemsMap\n                ? filterPointerOrUndefined(searchResult?.itemsMap, compileJSONPointerProp(rowIndex))\n                : undefined}\n              <tr class=\"jse-table-row\">\n                {#key rowIndex}\n                  <th\n                    class=\"jse-table-cell jse-table-cell-gutter\"\n                    use:resizeObserver={(element) => handleResizeRow(element, rowIndex)}\n                  >\n                    {rowIndex}\n                    {#if validationError}\n                      <ValidationErrorIcon {validationError} onExpand={noop} />\n                    {/if}\n                  </th>\n                {/key}\n                {#each columns as column, columnIndex}\n                  {@const path = [String(rowIndex)].concat(column)}\n                  {@const pointer = compileJSONPointer(path)}\n                  {@const value = getIn(item, column)}\n                  {@const isSelected =\n                    isValueSelection(documentState.selection) &&\n                    pathStartsWith(documentState.selection.path, path)}\n                  {@const validationErrorsByColumn = validationErrorsByRow?.columns[columnIndex]}\n                  {@const validationError = mergeValidationErrors(path, validationErrorsByColumn)}\n                  <td\n                    class=\"jse-table-cell\"\n                    data-path={encodeDataPath(path)}\n                    class:jse-selected-value={isSelected}\n                  >\n                    {#if isObjectOrArray(value)}\n                      {@const searchResultItemsByCell = searchResultItemsByRow\n                        ? filterPointerOrUndefined(searchResultItemsByRow, pointer)\n                        : undefined}\n                      {@const containsActiveSearchResult = searchResultItemsByCell\n                        ? Object.values(searchResultItemsByCell).some((items) =>\n                            items.some((item) => item.active)\n                          )\n                        : false}\n\n                      <InlineValue\n                        {path}\n                        {value}\n                        {parser}\n                        {isSelected}\n                        containsSearchResult={!isEmpty(searchResultItemsByCell)}\n                        {containsActiveSearchResult}\n                        onEdit={openJSONEditorModal}\n                      />{:else}\n                      {@const searchResultItemsByCell = searchResult?.itemsMap\n                        ? filterValueSearchResults(searchResult?.itemsMap, pointer)\n                        : undefined}\n\n                      <JSONValueComponent\n                        {path}\n                        value={value !== undefined ? value : ''}\n                        enforceString={getEnforceString(\n                          value,\n                          documentState.enforceStringMap,\n                          pointer,\n                          context.parser\n                        )}\n                        selection={isSelected ? documentState.selection : null}\n                        searchResultItems={searchResultItemsByCell}\n                        {context}\n                      />{/if}{#if !readOnly && isSelected && !isEditingSelection(documentState.selection)}\n                      <div class=\"jse-context-menu-anchor\">\n                        <ContextMenuPointer selected={true} onContextMenu={openContextMenu} />\n                      </div>\n                    {/if}{#if validationError}\n                      <ValidationErrorIcon {validationError} onExpand={noop} />\n                    {/if}\n                  </td>\n                {/each}\n                {#if showRefreshButton}\n                  <td class=\"jse-table-cell\" />\n                {/if}\n              </tr>\n            {/each}\n\n            <tr class=\"jse-table-invisible-end-section\">\n              <td style:height={visibleSection.endHeight + 'px'} colspan={columns.length} />\n            </tr>\n          </tbody>\n        </table>\n      </div>\n\n      {#if pastedJson}\n        <Message\n          type=\"info\"\n          message={`You pasted a JSON ${\n            Array.isArray(pastedJson.contents) ? 'array' : 'object'\n          } as text`}\n          actions={[\n            {\n              icon: faWrench,\n              text: 'Paste as JSON instead',\n              title: 'Paste the text as JSON instead of a single value',\n              // We use mousedown here instead of click: this message pops up\n              // whilst the user is editing a value. When clicking this button,\n              // the actual value is applied and the event is not propagated\n              // and an onClick on this button never happens.\n              onMouseDown: handleParsePastedJson\n            },\n            {\n              text: 'Leave as is',\n              title: 'Keep the pasted content as a single value',\n              onClick: handleClearPastedJson\n            }\n          ]}\n        />\n      {/if}\n\n      {#if textIsRepaired}\n        <Message\n          type=\"success\"\n          message=\"The loaded JSON document was invalid but is successfully repaired.\"\n          actions={!readOnly\n            ? [\n                {\n                  icon: faCheck,\n                  text: 'Ok',\n                  title: 'Accept the repaired document',\n                  onClick: acceptAutoRepair\n                },\n                {\n                  icon: faCode,\n                  text: 'Repair manually instead',\n                  title: 'Leave the document unchanged and repair it manually instead',\n                  onClick: handleRequestRepair\n                }\n              ]\n            : []}\n          onClose={focus}\n        />\n      {/if}\n\n      <ValidationErrorsOverview {validationErrors} selectError={handleSelectValidationError} />\n    {:else if parseError && text !== undefined && text !== ''}\n      <Message\n        type=\"error\"\n        message=\"The loaded JSON document is invalid and could not be repaired automatically.\"\n        actions={!readOnly\n          ? [\n              {\n                icon: faCode,\n                text: 'Repair manually',\n                title: 'Open the document in \"code\" mode and repair it manually',\n                onClick: handleRequestRepair\n              }\n            ]\n          : []}\n      />\n      <JSONPreview {text} {json} {indentation} {parser} />\n    {:else}\n      <TableModeWelcome\n        {text}\n        {json}\n        {readOnly}\n        {parser}\n        {openJSONEditorModal}\n        {onChangeMode}\n        onClick={() => {\n          // FIXME: this is a workaround for the editor not putting the focus on refHiddenInput\n          //  when clicking in the welcome screen so you cannot paste a document from clipboard.\n          focus()\n        }}\n      />\n    {/if}\n  {:else}\n    <div class=\"jse-contents jse-contents-loading\">\n      <div class=\"jse-loading-space\" />\n      <div class=\"jse-loading\">loading...</div>\n    </div>\n  {/if}\n</div>\n\n<style src=\"./TableMode.scss\"></style>\n","import type { ContextMenuItem, DocumentState, JSONParser } from 'svelte-jsoneditor'\nimport {\n  faCheckSquare,\n  faClone,\n  faCopy,\n  faCut,\n  faPaste,\n  faPen,\n  faPlus,\n  faSquare,\n  faTrashCan\n} from '@fortawesome/free-solid-svg-icons'\nimport { isKeySelection, isMultiSelection, isValueSelection } from '$lib/logic/selection'\nimport { compileJSONPointer, getIn } from 'immutable-json-patch'\nimport { getFocusPath, singleItemSelected } from '$lib/logic/selection'\nimport { isObjectOrArray } from '$lib/utils/typeUtils'\nimport { getEnforceString } from '$lib/logic/documentState'\n\nexport default function ({\n  json,\n  documentState,\n  readOnly,\n  parser,\n  onEditValue,\n  onEditRow,\n  onToggleEnforceString,\n  onCut,\n  onCopy,\n  onPaste,\n  onRemove,\n  onDuplicateRow,\n  onInsertBeforeRow,\n  onInsertAfterRow,\n  onRemoveRow\n}: {\n  json: unknown | undefined\n  documentState: DocumentState\n  readOnly: boolean\n  parser: JSONParser\n  onEditValue: () => void\n  onEditRow: () => void\n  onToggleEnforceString: () => void\n  onCut: (indent: boolean) => void\n  onCopy: (indent: boolean) => void\n  onPaste: () => void\n  onRemove: () => void\n  onDuplicateRow: () => void\n  onInsertBeforeRow: () => void\n  onInsertAfterRow: () => void\n  onRemoveRow: () => void\n}): ContextMenuItem[] {\n  const selection = documentState.selection\n\n  const hasJson = json !== undefined\n  const hasSelection = !!selection\n  const focusValue =\n    json !== undefined && selection ? getIn(json, getFocusPath(selection)) : undefined\n\n  const hasSelectionContents =\n    hasJson &&\n    (isMultiSelection(selection) || isKeySelection(selection) || isValueSelection(selection))\n\n  const canEditValue = !readOnly && hasJson && selection != null && singleItemSelected(selection)\n  const canEnforceString = canEditValue && !isObjectOrArray(focusValue)\n\n  const canCut = !readOnly && hasSelectionContents\n\n  const enforceString =\n    selection != null && focusValue !== undefined\n      ? getEnforceString(\n          focusValue,\n          documentState.enforceStringMap,\n          compileJSONPointer(getFocusPath(selection)),\n          parser\n        )\n      : false\n\n  return [\n    { type: 'separator' },\n    {\n      type: 'row',\n      items: [\n        {\n          type: 'column',\n          items: [\n            { type: 'label', text: 'Table cell:' },\n            {\n              type: 'dropdown-button',\n              main: {\n                type: 'button',\n                onClick: () => onEditValue(),\n                icon: faPen,\n                text: 'Edit',\n                title: 'Edit the value (Double-click on the value)',\n                disabled: !canEditValue\n              },\n              width: '11em',\n              items: [\n                {\n                  type: 'button',\n                  icon: faPen,\n                  text: 'Edit',\n                  title: 'Edit the value (Double-click on the value)',\n                  onClick: () => onEditValue(),\n                  disabled: !canEditValue\n                },\n                {\n                  type: 'button',\n                  icon: enforceString ? faCheckSquare : faSquare,\n                  text: 'Enforce string',\n                  title: 'Enforce keeping the value as string when it contains a numeric value',\n                  onClick: () => onToggleEnforceString(),\n                  disabled: !canEnforceString\n                }\n              ]\n            },\n            {\n              type: 'dropdown-button',\n              main: {\n                type: 'button',\n                onClick: () => onCut(true),\n                icon: faCut,\n                text: 'Cut',\n                title: 'Cut selected contents, formatted with indentation (Ctrl+X)',\n                disabled: !canCut\n              },\n              width: '10em',\n              items: [\n                {\n                  type: 'button',\n                  icon: faCut,\n                  text: 'Cut formatted',\n                  title: 'Cut selected contents, formatted with indentation (Ctrl+X)',\n                  onClick: () => onCut(true),\n                  disabled: readOnly || !hasSelectionContents\n                },\n                {\n                  type: 'button',\n                  icon: faCut,\n                  text: 'Cut compacted',\n                  title: 'Cut selected contents, without indentation (Ctrl+Shift+X)',\n                  onClick: () => onCut(false),\n                  disabled: readOnly || !hasSelectionContents\n                }\n              ]\n            },\n            {\n              type: 'dropdown-button',\n              main: {\n                type: 'button',\n                onClick: () => onCopy(true),\n                icon: faCopy,\n                text: 'Copy',\n                title: 'Copy selected contents, formatted with indentation (Ctrl+C)',\n                disabled: !hasSelectionContents\n              },\n              width: '12em',\n              items: [\n                {\n                  type: 'button',\n                  icon: faCopy,\n                  text: 'Copy formatted',\n                  title: 'Copy selected contents, formatted with indentation (Ctrl+C)',\n                  onClick: () => onCopy(false),\n                  disabled: !hasSelectionContents\n                },\n                {\n                  type: 'button',\n                  icon: faCopy,\n                  text: 'Copy compacted',\n                  title: 'Copy selected contents, without indentation (Ctrl+Shift+C)',\n                  onClick: () => onCopy(false),\n                  disabled: !hasSelectionContents\n                }\n              ]\n            },\n            {\n              type: 'button',\n              onClick: () => onPaste(),\n              icon: faPaste,\n              text: 'Paste',\n              title: 'Paste clipboard contents (Ctrl+V)',\n              disabled: readOnly || !hasSelection\n            },\n            {\n              type: 'button',\n              onClick: () => onRemove(),\n              icon: faTrashCan,\n              text: 'Remove',\n              title: 'Remove selected contents (Delete)',\n              disabled: readOnly || !hasSelectionContents\n            }\n          ]\n        },\n        {\n          type: 'column',\n          items: [\n            { type: 'label', text: 'Table row:' },\n            {\n              type: 'button',\n              onClick: () => onEditRow(),\n              icon: faPen,\n              text: 'Edit row',\n              title: 'Edit the current row',\n              disabled: readOnly || !hasSelection || !hasJson\n            },\n            {\n              type: 'button',\n              onClick: () => onDuplicateRow(),\n              icon: faClone,\n              text: 'Duplicate row',\n              title: 'Duplicate the current row',\n              disabled: readOnly || !hasSelection || !hasJson\n            },\n            {\n              type: 'button',\n              onClick: () => onInsertBeforeRow(),\n              icon: faPlus,\n              text: 'Insert before',\n              title: 'Insert a row before the current row',\n              disabled: readOnly || !hasSelection || !hasJson\n            },\n            {\n              type: 'button',\n              onClick: () => onInsertAfterRow(),\n              icon: faPlus,\n              text: 'Insert after',\n              title: 'Insert a row after the current row',\n              disabled: readOnly || !hasSelection || !hasJson\n            },\n            {\n              type: 'button',\n              onClick: () => onRemoveRow(),\n              icon: faTrashCan,\n              text: 'Remove row',\n              title: 'Remove current row',\n              disabled: readOnly || !hasSelection || !hasJson\n            }\n          ]\n        }\n      ]\n    }\n  ]\n}\n","<script lang=\"ts\">\n  import type {\n    Content,\n    ContentErrors,\n    ContextMenuItem,\n    JSONEditorSelection,\n    JSONParser,\n    JSONPatchResult,\n    JSONPathParser,\n    MenuItem,\n    MenuSeparator,\n    OnBlur,\n    OnChange,\n    OnChangeMode,\n    OnClassName,\n    OnError,\n    OnExpand,\n    OnFocus,\n    OnJSONEditorModal,\n    OnRenderContextMenu,\n    OnRenderContextMenuInternal,\n    OnRenderMenu,\n    OnRenderMenuInternal,\n    OnRenderValue,\n    OnSelect,\n    OnSortModal,\n    OnTransformModal,\n    TransformModalOptions,\n    Validator\n  } from '$lib/types'\n  import { Mode } from '$lib/types.js'\n  import TextMode from './textmode/TextMode.svelte'\n  import TableMode from './tablemode/TableMode.svelte'\n  import TreeMode from './treemode/TreeMode.svelte'\n  import type { JSONPatchDocument, JSONPath } from 'immutable-json-patch'\n  import { isMenuSpace } from '$lib/typeguards.js'\n  import { cloneDeep } from 'lodash-es'\n\n  export let content: Content\n  export let selection: JSONEditorSelection | null\n\n  export let readOnly: boolean\n  export let indentation: number | string\n  export let tabSize: number\n  export let mode: Mode\n  export let mainMenuBar: boolean\n  export let navigationBar: boolean\n  export let statusBar: boolean\n  export let askToFormat: boolean\n  export let escapeControlCharacters: boolean\n  export let escapeUnicodeCharacters: boolean\n  export let flattenColumns: boolean\n  export let parser: JSONParser\n  export let parseMemoizeOne: JSONParser['parse']\n  export let validator: Validator | null\n  export let validationParser: JSONParser\n  export let pathParser: JSONPathParser\n  export let insideModal: boolean\n\n  export let onChange: OnChange\n  export let onChangeMode: OnChangeMode\n  export let onSelect: OnSelect\n  export let onRenderValue: OnRenderValue\n  export let onClassName: OnClassName\n  export let onRenderMenu: OnRenderMenu\n  export let onRenderContextMenu: OnRenderContextMenu\n  export let onError: OnError\n  export let onFocus: OnFocus\n  export let onBlur: OnBlur\n  export let onSortModal: OnSortModal\n  export let onTransformModal: OnTransformModal\n  export let onJSONEditorModal: OnJSONEditorModal\n\n  let refTreeMode: TreeMode | undefined\n  let refTableMode: TableMode | undefined\n  let refTextMode: TextMode | undefined\n\n  let modeMenuItems: MenuItem[]\n  $: modeMenuItems = [\n    {\n      type: 'button',\n      text: 'text',\n      title: `Switch to text mode (current mode: ${mode})`,\n      // check for 'code' mode is here for backward compatibility (deprecated since v0.4.0)\n      className:\n        'jse-group-button jse-first' +\n        (mode === Mode.text || (mode as string) === 'code' ? ' jse-selected' : ''),\n      onClick: () => onChangeMode(Mode.text)\n    },\n    {\n      type: 'button',\n      text: 'tree',\n      title: `Switch to tree mode (current mode: ${mode})`,\n      className: 'jse-group-button ' + (mode === Mode.tree ? ' jse-selected' : ''),\n      onClick: () => onChangeMode(Mode.tree)\n    },\n    {\n      type: 'button',\n      text: 'table',\n      title: `Switch to table mode (current mode: ${mode})`,\n      className: 'jse-group-button jse-last' + (mode === Mode.table ? ' jse-selected' : ''),\n      onClick: () => onChangeMode(Mode.table)\n    }\n  ]\n\n  const separatorMenuItem: MenuSeparator = {\n    type: 'separator'\n  }\n\n  let handleRenderMenu: OnRenderMenuInternal\n  $: handleRenderMenu = (items: MenuItem[]) => {\n    const updatedItems = isMenuSpace(items[0])\n      ? modeMenuItems.concat(items) // menu is empty, readOnly mode\n      : modeMenuItems.concat(separatorMenuItem, items)\n\n    const updatedItemsOriginal = cloneDeep(updatedItems) // the user may change updatedItems in the callback\n\n    return (\n      onRenderMenu(updatedItems, { mode, modal: insideModal, readOnly }) || updatedItemsOriginal\n    )\n  }\n\n  let handleRenderContextMenu: OnRenderContextMenuInternal\n  $: handleRenderContextMenu = (items: ContextMenuItem[]) => {\n    const itemsOriginal = cloneDeep(items) // the user may change items in the callback\n\n    return (\n      onRenderContextMenu(items, { mode, modal: insideModal, readOnly, selection }) ??\n      (readOnly ? false : itemsOriginal)\n    )\n  }\n\n  export function patch(operations: JSONPatchDocument): JSONPatchResult {\n    if (refTreeMode) {\n      // Note that tree mode has an optional afterPatch callback.\n      // right now we don's support this in the public API.\n      return refTreeMode.patch(operations)\n    }\n\n    if (refTableMode) {\n      // Note that tree mode has an optional afterPatch callback.\n      // right now we don's support this in the public API.\n      return refTableMode.patch(operations)\n    }\n\n    if (refTextMode) {\n      return refTextMode.patch(operations)\n    }\n\n    throw new Error(`Method patch is not available in mode \"${mode}\"`)\n  }\n\n  export function expand(callback?: OnExpand): void {\n    if (refTreeMode) {\n      return refTreeMode.expand(callback)\n    } else {\n      throw new Error(`Method expand is not available in mode \"${mode}\"`)\n    }\n  }\n\n  /**\n   * Open the transform modal\n   */\n  export function transform(options: TransformModalOptions): void {\n    if (refTextMode) {\n      refTextMode.openTransformModal(options)\n    } else if (refTreeMode) {\n      refTreeMode.openTransformModal(options)\n    } else if (refTableMode) {\n      refTableMode.openTransformModal(options)\n    } else {\n      throw new Error(`Method transform is not available in mode \"${mode}\"`)\n    }\n  }\n\n  /**\n   * Validate the contents of the editor using the configured validator.\n   * Returns a parse error or a list with validation warnings\n   */\n  export function validate(): ContentErrors | null {\n    if (refTextMode) {\n      return refTextMode.validate()\n    } else if (refTreeMode) {\n      return refTreeMode.validate()\n    } else if (refTableMode) {\n      return refTableMode.validate()\n    } else {\n      throw new Error(`Method validate is not available in mode \"${mode}\"`)\n    }\n  }\n\n  /**\n   * In tree mode, invalid JSON is automatically repaired when loaded. When the\n   * repair was successful, the repaired contents are rendered but not yet\n   * applied to the document itself until the user clicks \"Ok\" or starts editing\n   * the data. Instead of accepting the repair, the user can also click\n   * \"Repair manually instead\". Invoking `.acceptAutoRepair()` will\n   * programmatically accept the repair. This will trigger an update,\n   * and the method itself also returns the updated contents. In case of text\n   * mode or when the editor is not in an \"accept auto repair\" status, nothing\n   * will happen, and the contents will be returned as is.\n   */\n  export function acceptAutoRepair(): Content {\n    if (refTreeMode) {\n      return refTreeMode.acceptAutoRepair()\n    } else {\n      return content\n    }\n  }\n\n  export function scrollTo(path: JSONPath): Promise<void> {\n    if (refTreeMode) {\n      return refTreeMode.scrollTo(path)\n    } else if (refTableMode) {\n      return refTableMode.scrollTo(path)\n    } else {\n      // TODO: implement scrollTo for text mode\n      throw new Error(`Method scrollTo is not available in mode \"${mode}\"`)\n    }\n  }\n\n  export function findElement(path: JSONPath): Element | null {\n    if (refTreeMode) {\n      return refTreeMode.findElement(path)\n    } else if (refTableMode) {\n      return refTableMode.findElement(path)\n    } else {\n      throw new Error(`Method findElement is not available in mode \"${mode}\"`)\n    }\n  }\n\n  export function focus() {\n    if (refTextMode) {\n      refTextMode.focus()\n    } else if (refTreeMode) {\n      refTreeMode.focus()\n    } else if (refTableMode) {\n      refTableMode.focus()\n    }\n  }\n\n  export async function refresh(): Promise<void> {\n    if (refTextMode) {\n      await refTextMode.refresh()\n    } else {\n      // nothing to do in tree or table mode (also: don't throw an exception or so,\n      // that annoying having to reckon with that when using .refresh()).\n    }\n  }\n</script>\n\n{#if mode === Mode.text || String(mode) === 'code'}\n  <TextMode\n    bind:this={refTextMode}\n    externalContent={content}\n    externalSelection={selection}\n    {readOnly}\n    {indentation}\n    {tabSize}\n    {mainMenuBar}\n    {statusBar}\n    {askToFormat}\n    {escapeUnicodeCharacters}\n    {parser}\n    {validator}\n    {validationParser}\n    {onChange}\n    {onSelect}\n    {onChangeMode}\n    {onError}\n    {onFocus}\n    {onBlur}\n    onRenderMenu={handleRenderMenu}\n    {onSortModal}\n    {onTransformModal}\n  />\n{:else if mode === Mode.table}\n  <TableMode\n    bind:this={refTableMode}\n    externalContent={content}\n    externalSelection={selection}\n    {readOnly}\n    {mainMenuBar}\n    {escapeControlCharacters}\n    {escapeUnicodeCharacters}\n    {flattenColumns}\n    {parser}\n    {parseMemoizeOne}\n    {validator}\n    {validationParser}\n    {indentation}\n    {onChange}\n    {onChangeMode}\n    {onSelect}\n    {onRenderValue}\n    {onFocus}\n    {onBlur}\n    onRenderMenu={handleRenderMenu}\n    onRenderContextMenu={handleRenderContextMenu}\n    {onSortModal}\n    {onTransformModal}\n    {onJSONEditorModal}\n  />\n{:else}\n  <!-- mode === Mode.tree -->\n  <TreeMode\n    bind:this={refTreeMode}\n    externalContent={content}\n    externalSelection={selection}\n    {readOnly}\n    {indentation}\n    {mainMenuBar}\n    {navigationBar}\n    {escapeControlCharacters}\n    {escapeUnicodeCharacters}\n    {parser}\n    {parseMemoizeOne}\n    {validator}\n    {validationParser}\n    {pathParser}\n    {onError}\n    {onChange}\n    {onChangeMode}\n    {onSelect}\n    {onRenderValue}\n    {onClassName}\n    {onFocus}\n    {onBlur}\n    onRenderMenu={handleRenderMenu}\n    onRenderContextMenu={handleRenderContextMenu}\n    {onSortModal}\n    {onTransformModal}\n    {onJSONEditorModal}\n  />\n{/if}\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { getContext, tick } from 'svelte'\n  import Header from './Header.svelte'\n  import type { JSONPatchDocument, JSONPath } from 'immutable-json-patch'\n  import { compileJSONPointer, immutableJSONPatch, isJSONArray } from 'immutable-json-patch'\n  import { createDebug } from '$lib/utils/debug.js'\n  import type {\n    Content,\n    JSONEditorModalCallback,\n    JSONEditorSelection,\n    JSONParser,\n    JSONPathParser,\n    OnClassName,\n    OnPatch,\n    OnRenderContextMenu,\n    OnRenderMenu,\n    OnRenderValue,\n    OnSortModal,\n    OnTransformModal,\n    Validator\n  } from '$lib/types'\n  import { Mode } from '$lib/types.js'\n  import JSONEditorRoot from '../modes/JSONEditorRoot.svelte'\n  import { noop } from '$lib/utils/noop.js'\n  import { stringifyJSONPath } from '$lib/utils/pathUtils.js'\n  import { initial, isEmpty, last } from 'lodash-es'\n  import { isJSONContent, toJSONContent } from '$lib/utils/jsonUtils.js'\n  import Icon from 'svelte-awesome'\n  import { faCaretLeft } from '@fortawesome/free-solid-svg-icons'\n  import memoizeOne from 'memoize-one'\n  import { onEscape } from '$lib/actions/onEscape.js'\n  import { getFocusPath, isJSONSelection } from '$lib/logic/selection.js'\n  import type { Context } from 'svelte-simple-modal'\n\n  const debug = createDebug('jsoneditor:JSONEditorModal')\n\n  export let content: Content // the nested document\n  export let path: JSONPath\n  export let onPatch: OnPatch\n\n  export let readOnly: boolean\n  export let indentation: number | string\n  export let tabSize: number\n  export let mainMenuBar: boolean\n  export let navigationBar: boolean\n  export let statusBar: boolean\n  export let askToFormat: boolean\n  export let escapeControlCharacters: boolean\n  export let escapeUnicodeCharacters: boolean\n  export let flattenColumns: boolean\n  export let parser: JSONParser\n  export let validator: Validator | null\n  export let validationParser: JSONParser\n  export let pathParser: JSONPathParser\n\n  export let onRenderValue: OnRenderValue\n  export let onClassName: OnClassName\n  export let onRenderMenu: OnRenderMenu\n  export let onRenderContextMenu: OnRenderContextMenu\n\n  export let onSortModal: OnSortModal\n  export let onTransformModal: OnTransformModal\n\n  const { close } = getContext<Context>('simple-modal')\n\n  interface ModalState {\n    mode: Mode\n    content: Content\n    selection: JSONEditorSelection | null\n    relativePath: JSONPath\n  }\n\n  let refEditor: JSONEditorRoot\n  let fullscreen: boolean\n\n  const rootState: ModalState = {\n    mode: determineMode(content),\n    content,\n    selection: null,\n    relativePath: path\n  }\n  let stack: ModalState[] = [rootState]\n\n  $: currentState = last(stack) || rootState\n  $: absolutePath = stack.flatMap((state) => state.relativePath)\n  $: pathDescription = !isEmpty(absolutePath) ? stringifyJSONPath(absolutePath) : '(document root)'\n\n  // not relevant in this Modal setting, but well\n  $: parseMemoizeOne = memoizeOne(parser.parse)\n\n  let error: string | undefined = undefined\n\n  function determineMode(content: Content): Mode {\n    return isJSONContent(content) && isJSONArray(content.json) ? Mode.table : Mode.tree\n  }\n\n  function scrollToSelection() {\n    const selection: JSONEditorSelection | null = last(stack)?.selection || null\n    if (isJSONSelection(selection)) {\n      refEditor.scrollTo(getFocusPath(selection))\n    }\n  }\n\n  function handleApply() {\n    debug('handleApply')\n\n    if (readOnly) {\n      return\n    }\n\n    try {\n      error = undefined\n\n      const path = currentState.relativePath\n      const content = currentState.content\n      const operations: JSONPatchDocument = [\n        {\n          op: 'replace',\n          path: compileJSONPointer(path),\n          value: toJSONContent(content, parser).json // this can throw an error\n        }\n      ]\n\n      if (stack.length > 1) {\n        const parentContent = stack[stack.length - 2].content\n        const parentJson = toJSONContent(parentContent, parser).json\n        const updatedParentContent = {\n          json: immutableJSONPatch(parentJson, operations)\n        }\n\n        // after successfully updated, remove from the stack and apply the change to the parent\n        const parentState = stack[stack.length - 2] || rootState\n        const updatedParentState: ModalState = { ...parentState, content: updatedParentContent }\n        stack = [...stack.slice(0, stack.length - 2), updatedParentState]\n        tick().then(scrollToSelection)\n      } else {\n        onPatch(operations)\n\n        close()\n      }\n    } catch (err) {\n      error = String(err)\n    }\n  }\n\n  function handleClose() {\n    debug('handleClose')\n\n    if (stack.length > 1) {\n      // remove the last item from the stack\n      stack = initial(stack)\n      tick().then(scrollToSelection)\n\n      // clear any error from the just closed state\n      error = undefined\n    } else {\n      // this is the first modal, the root state, close the modal\n      close()\n    }\n  }\n\n  function handleEscape() {\n    if (fullscreen) {\n      fullscreen = false\n    } else {\n      handleClose()\n    }\n  }\n\n  function handleChange(updatedContent: Content) {\n    debug('handleChange', updatedContent)\n\n    const updatedState = {\n      ...currentState,\n      content: updatedContent\n    }\n\n    stack = [...initial(stack), updatedState]\n  }\n\n  function handleChangeSelection(newSelection: JSONEditorSelection | null) {\n    debug('handleChangeSelection', newSelection)\n\n    const updatedState = {\n      ...currentState,\n      selection: newSelection\n    }\n\n    stack = [...initial(stack), updatedState]\n  }\n\n  function handleChangeMode(newMode: Mode) {\n    debug('handleChangeMode', newMode)\n\n    const updatedState = {\n      ...currentState,\n      mode: newMode\n    }\n\n    stack = [...initial(stack), updatedState]\n  }\n\n  function handleError(newError: Error) {\n    error = newError.toString()\n    console.error(newError)\n  }\n\n  function handleJSONEditorModal({ content, path }: JSONEditorModalCallback) {\n    debug('handleJSONEditorModal', { content, path })\n\n    const nestedModalState = {\n      mode: determineMode(content),\n      content,\n      selection: null,\n      relativePath: path\n    }\n    stack = [...stack, nestedModalState]\n  }\n\n  function focus(element: HTMLElement) {\n    element.focus()\n  }\n</script>\n\n<div class=\"jse-modal jse-jsoneditor-modal\" class:fullscreen use:onEscape={handleEscape}>\n  <Header\n    title=\"Edit nested content {stack.length > 1 ? ` (${stack.length})` : ''}\"\n    fullScreenButton={true}\n    bind:fullscreen\n    onClose={handleClose}\n  />\n\n  <div class=\"jse-modal-contents\">\n    <div class=\"jse-label\">\n      <div class=\"jse-label-inner\">Path</div>\n    </div>\n    <input class=\"jse-path\" type=\"text\" readonly title=\"Selected path\" value={pathDescription} />\n\n    <div class=\"jse-label\">\n      <div class=\"jse-label-inner\">Contents</div>\n    </div>\n\n    <div class=\"jse-modal-inline-editor\">\n      <JSONEditorRoot\n        bind:this={refEditor}\n        mode={currentState.mode}\n        content={currentState.content}\n        selection={currentState.selection}\n        {readOnly}\n        {indentation}\n        {tabSize}\n        {statusBar}\n        {askToFormat}\n        {mainMenuBar}\n        {navigationBar}\n        {escapeControlCharacters}\n        {escapeUnicodeCharacters}\n        {flattenColumns}\n        {parser}\n        {parseMemoizeOne}\n        {validator}\n        {validationParser}\n        {pathParser}\n        insideModal={true}\n        onError={handleError}\n        onChange={handleChange}\n        onChangeMode={handleChangeMode}\n        onSelect={handleChangeSelection}\n        {onRenderValue}\n        {onClassName}\n        onFocus={noop}\n        onBlur={noop}\n        {onRenderMenu}\n        {onRenderContextMenu}\n        {onSortModal}\n        {onTransformModal}\n        onJSONEditorModal={handleJSONEditorModal}\n      />\n    </div>\n\n    <div class=\"jse-actions\">\n      {#if error}\n        <div class=\"jse-error\">\n          {error}\n        </div>\n      {/if}\n\n      {#if stack.length > 1}\n        <button type=\"button\" class=\"jse-secondary\" on:click={handleClose}>\n          <Icon data={faCaretLeft} /> Back\n        </button>\n      {/if}\n      {#if !readOnly}\n        <button type=\"button\" class=\"jse-primary\" on:click={handleApply} use:focus> Apply </button>\n      {:else}\n        <button type=\"button\" class=\"jse-primary\" on:click={handleClose} use:focus> Close </button>\n      {/if}\n    </div>\n  </div>\n</div>\n\n<style src=\"./JSONEditorModal.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  // This component is to get a reference to the simple-modal context\n  // containing open and close. Usage:\n  //\n  // <script>\n  //   export let open\n  //   export let close\n  // < /script>\n  //\n  // <ModalRef bind:open bind:close />\n  //\n  import { getContext } from 'svelte'\n  import type { Context } from 'svelte-simple-modal'\n\n  const context = getContext<Context>('simple-modal')\n\n  export const open = context.open\n  export const close = context.close\n</script>\n","<svelte:options accessors={false} immutable={true} />\n\n<script lang=\"ts\">\n  import { createDebug } from '../utils/debug.js'\n  import Modal, { bind } from 'svelte-simple-modal'\n  import {\n    JSONEDITOR_MODAL_OPTIONS,\n    SORT_MODAL_OPTIONS,\n    TRANSFORM_MODAL_OPTIONS\n  } from '../constants.js'\n  import { uniqueId } from '../utils/uniqueId.js'\n  import {\n    isEqualParser,\n    isJSONContent,\n    isTextContent,\n    validateContentType\n  } from '../utils/jsonUtils.js'\n  import AbsolutePopup from './modals/popup/AbsolutePopup.svelte'\n  import { javascriptQueryLanguage } from '$lib/plugins/query/javascriptQueryLanguage.js'\n  import { renderValue } from '$lib/plugins/value/renderValue.js'\n  import { tick } from 'svelte'\n  import TransformModal from './modals/TransformModal.svelte'\n  import SortModal from './modals/SortModal.svelte'\n  import type {\n    Content,\n    ContentErrors,\n    JSONEditorModalCallback,\n    JSONEditorPropsOptional,\n    JSONEditorSelection,\n    JSONParser,\n    JSONPatchResult,\n    JSONPathParser,\n    OnBlur,\n    OnChange,\n    OnChangeMode,\n    OnChangeQueryLanguage,\n    OnChangeStatus,\n    OnClassName,\n    OnError,\n    OnExpand,\n    OnFocus,\n    OnRenderMenu,\n    OnRenderValue,\n    OnSelect,\n    QueryLanguage,\n    SortModalCallback,\n    TransformModalCallback,\n    TransformModalOptions,\n    Validator\n  } from '$lib/types'\n  import { Mode } from '$lib/types.js'\n  import type { JSONPatchDocument, JSONPath } from 'immutable-json-patch'\n  import { noop } from '../utils/noop.js'\n  import { parseJSONPath, stringifyJSONPath } from '$lib/utils/pathUtils.js'\n  import JSONEditorRoot from './modes/JSONEditorRoot.svelte'\n  import JSONEditorModal from './modals/JSONEditorModal.svelte'\n  import memoizeOne from 'memoize-one'\n  import ModalRef from '../components/modals/ModalRef.svelte'\n  import type { Open, Callbacks, Component } from 'svelte-simple-modal'\n  import type { OnRenderContextMenu } from '$lib/types.js'\n  import { cloneDeep } from 'lodash-es'\n\n  // TODO: document how to enable debugging in the readme: localStorage.debug=\"jsoneditor:*\", then reload\n  const debug = createDebug('jsoneditor:JSONEditor')\n\n  export let content: Content = { text: '' }\n  export let selection: JSONEditorSelection | null = null\n\n  export let readOnly = false\n  export let indentation: number | string = 2\n  export let tabSize = 4\n  export let mode: Mode = Mode.tree\n  export let mainMenuBar = true\n  export let navigationBar = true\n  export let statusBar = true\n  export let askToFormat = true\n  export let escapeControlCharacters = false\n  export let escapeUnicodeCharacters = false\n  export let flattenColumns = true\n  export let parser: JSONParser = JSON\n  export let validator: Validator | null = null\n  export let validationParser: JSONParser = JSON\n  export let pathParser: JSONPathParser = {\n    parse: parseJSONPath,\n    stringify: stringifyJSONPath\n  }\n\n  export let queryLanguages: QueryLanguage[] = [javascriptQueryLanguage]\n  export let queryLanguageId: string = queryLanguages[0].id\n\n  export let onChangeQueryLanguage: OnChangeQueryLanguage = noop\n  export let onChange: OnChange = null\n  export let onSelect: OnSelect | null = null\n  export let onRenderValue: OnRenderValue = renderValue\n  export let onClassName: OnClassName = () => undefined\n  export let onRenderMenu: OnRenderMenu = noop\n  export let onRenderContextMenu: OnRenderContextMenu = noop\n  export let onChangeMode: OnChangeMode = noop\n  export let onError: OnError = (err) => {\n    console.error(err)\n    alert(err.toString()) // TODO: create a nice alert modal\n  }\n  export let onFocus: OnFocus = noop\n  export let onBlur: OnBlur = noop\n\n  let instanceId = uniqueId()\n  let hasFocus = false\n  let refJSONEditorRoot: JSONEditorRoot\n  let open: Open // svelte-simple-modal context open(...)\n  let jsoneditorModalState: {\n    component: Component\n    callbacks: Partial<Callbacks>\n  } | null = null\n\n  $: {\n    const contentError = validateContentType(content)\n    if (contentError) {\n      console.error('Error: ' + contentError)\n    }\n  }\n\n  // We memoize the last parse result for the case when the content is text and very large.\n  // In that case parsing takes a few seconds. When the user switches between tree and table mode,\n  // without having made a change, we do not want to parse the text again.\n  $: parseMemoizeOne = memoizeOne(parser.parse)\n\n  // rerender the full editor when the parser changes. This is needed because\n  // numeric state is hold at many places in the editor.\n  let previousParser = parser\n  $: {\n    if (!isEqualParser(parser, previousParser)) {\n      debug('parser changed, recreate editor')\n\n      if (isJSONContent(content)) {\n        const text = previousParser.stringify(content.json)\n        content = {\n          json: text !== undefined ? parser.parse(text) : undefined\n        }\n      }\n\n      previousParser = parser\n\n      // new editor id -> will re-create the editor\n      instanceId = uniqueId()\n    }\n  }\n\n  export function get(): Content {\n    return content\n  }\n\n  export async function set(newContent: Content): Promise<void> {\n    debug('set')\n\n    const contentError = validateContentType(newContent)\n    if (contentError) {\n      throw new Error(contentError)\n    }\n\n    // new editor id -> will re-create the editor\n    instanceId = uniqueId()\n\n    // update content *after* re-render, so that the new editor will trigger an onChange event\n    content = newContent\n  }\n\n  export async function update(updatedContent: Content): Promise<void> {\n    debug('update')\n\n    const contentError = validateContentType(updatedContent)\n    if (contentError) {\n      throw new Error(contentError)\n    }\n\n    content = updatedContent\n\n    await tick() // await rerender\n  }\n\n  export async function patch(operations: JSONPatchDocument): Promise<JSONPatchResult> {\n    if (isTextContent(content)) {\n      try {\n        content = {\n          json: parser.parse(content.text),\n          text: undefined\n        }\n      } catch (err) {\n        throw new Error('Cannot apply patch: current document contains invalid JSON')\n      }\n    }\n\n    // Note that patch has an optional afterPatch callback.\n    // right now we don's support this in the public API.\n    const result = refJSONEditorRoot.patch(operations)\n\n    await tick() // await rerender\n\n    return result\n  }\n\n  export async function select(newSelection: JSONEditorSelection | null) {\n    selection = newSelection\n\n    await tick() // await rerender\n  }\n\n  export async function expand(callback?: OnExpand): Promise<void> {\n    refJSONEditorRoot.expand(callback)\n\n    await tick() // await rerender\n  }\n\n  /**\n   * Open the transform modal\n   */\n  export function transform(options: TransformModalOptions): void {\n    refJSONEditorRoot.transform(options)\n  }\n\n  /**\n   * Validate the contents of the editor using the configured validator.\n   * Returns a parse error or a list with validation warnings\n   */\n  export function validate(): ContentErrors | null {\n    return refJSONEditorRoot.validate()\n  }\n\n  /**\n   * In tree mode, invalid JSON is automatically repaired when loaded. When the\n   * repair was successful, the repaired contents are rendered but not yet\n   * applied to the document itself until the user clicks \"Ok\" or starts editing\n   * the data. Instead of accepting the repair, the user can also click\n   * \"Repair manually instead\". Invoking `.acceptAutoRepair()` will\n   * programmatically accept the repair. This will trigger an update,\n   * and the method itself also returns the updated contents. In case of text\n   * mode or when the editor is not in an \"accept auto repair\" status, nothing\n   * will happen, and the contents will be returned as is.\n   */\n  export async function acceptAutoRepair(): Promise<Content> {\n    const content = refJSONEditorRoot.acceptAutoRepair()\n\n    await tick() // await rerender\n\n    return content\n  }\n\n  export async function scrollTo(path: JSONPath): Promise<void> {\n    await refJSONEditorRoot.scrollTo(path)\n  }\n\n  export function findElement(path: JSONPath): Element | null {\n    return refJSONEditorRoot.findElement(path)\n  }\n\n  export async function focus(): Promise<void> {\n    refJSONEditorRoot.focus()\n\n    await tick() // await rerender\n  }\n\n  export async function refresh(): Promise<void> {\n    await refJSONEditorRoot.refresh()\n  }\n\n  export async function updateProps(props: JSONEditorPropsOptional): Promise<void> {\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    this.$set(props)\n\n    await tick() // await rerender\n  }\n\n  export async function destroy() {\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    this.$destroy()\n\n    await tick() // await destroying\n  }\n\n  function handleChange(updatedContent: Content, previousContent: Content, status: OnChangeStatus) {\n    content = updatedContent\n\n    if (onChange) {\n      onChange(updatedContent, previousContent, status)\n    }\n  }\n\n  function handleSelect(updatedSelection: JSONEditorSelection | null) {\n    selection = updatedSelection\n\n    if (onSelect) {\n      onSelect(cloneDeep(updatedSelection))\n    }\n  }\n\n  function handleFocus() {\n    hasFocus = true\n    if (onFocus) {\n      onFocus()\n    }\n  }\n\n  function handleBlur() {\n    hasFocus = false\n    if (onBlur) {\n      onBlur()\n    }\n  }\n\n  async function toggleMode(newMode: Mode) {\n    if (mode === newMode) {\n      return\n    }\n\n    mode = newMode\n\n    await tick()\n    await focus()\n\n    onChangeMode(newMode)\n  }\n\n  function handleChangeQueryLanguage(newQueryLanguageId: string) {\n    debug('handleChangeQueryLanguage', newQueryLanguageId)\n    queryLanguageId = newQueryLanguageId\n    onChangeQueryLanguage(newQueryLanguageId)\n  }\n\n  // The onTransformModal method is located in JSONEditor to prevent circular references:\n  //     TreeMode -> TransformModal -> TreeMode\n  function onTransformModal({ id, json, rootPath, onTransform, onClose }: TransformModalCallback) {\n    if (readOnly) {\n      return\n    }\n\n    open(\n      TransformModal,\n      {\n        id,\n        json,\n        rootPath,\n        indentation,\n        escapeControlCharacters,\n        escapeUnicodeCharacters,\n        parser,\n        parseMemoizeOne,\n        validationParser,\n        pathParser,\n        queryLanguages,\n        queryLanguageId,\n        onChangeQueryLanguage: handleChangeQueryLanguage,\n        onRenderValue,\n        onRenderMenu,\n        onRenderContextMenu,\n        onClassName,\n        onTransform\n      },\n      TRANSFORM_MODAL_OPTIONS,\n      {\n        onClose\n      }\n    )\n  }\n\n  // The onSortModal is positioned here for consistency with TransformModal\n  function onSortModal({ id, json, rootPath, onSort, onClose }: SortModalCallback) {\n    if (readOnly) {\n      return\n    }\n\n    open(\n      SortModal,\n      {\n        id,\n        json,\n        rootPath,\n        onSort\n      },\n      SORT_MODAL_OPTIONS,\n      {\n        onClose\n      }\n    )\n  }\n\n  // The onJSONEditorModal method is located in JSONEditor to prevent circular references:\n  //     JSONEditor -> TableMode -> JSONEditorModal -> JSONEditor\n  function onJSONEditorModal({ content, path, onPatch, onClose }: JSONEditorModalCallback) {\n    debug('onJSONEditorModal', { content, path })\n\n    jsoneditorModalState = {\n      component: bind(JSONEditorModal, {\n        content,\n        path,\n        onPatch,\n\n        readOnly,\n        indentation,\n        tabSize,\n        mainMenuBar,\n        navigationBar,\n        statusBar,\n        askToFormat,\n        escapeControlCharacters,\n        escapeUnicodeCharacters,\n        flattenColumns,\n        parser,\n        validator: undefined, // TODO: support partial JSON validation?\n        validationParser,\n        pathParser,\n        onRenderValue,\n        onClassName,\n        onRenderMenu,\n        onRenderContextMenu,\n        onSortModal,\n        onTransformModal\n      }),\n      callbacks: {\n        onClose\n      }\n    }\n  }\n\n  function closeJSONEditorModal() {\n    jsoneditorModalState?.callbacks?.onClose?.()\n    jsoneditorModalState = null\n  }\n\n  $: {\n    debug('mode changed to', mode)\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-expect-error\n    if (mode === 'code') {\n      // check for 'code' is here for backward compatibility (deprecated since v0.4.0)\n      console.warn(\n        'Deprecation warning: \"code\" mode is renamed to \"text\". Please use mode=\"text\" instead.'\n      )\n    }\n  }\n</script>\n\n<AbsolutePopup>\n  <Modal\n    show={jsoneditorModalState?.component}\n    {...JSONEDITOR_MODAL_OPTIONS}\n    closeOnEsc={false}\n    on:close={closeJSONEditorModal}\n  >\n    <Modal closeOnEsc={false}>\n      <ModalRef bind:open />\n      <div class=\"jse-main\" class:jse-focus={hasFocus}>\n        {#key instanceId}\n          <JSONEditorRoot\n            bind:this={refJSONEditorRoot}\n            {mode}\n            {content}\n            {selection}\n            {readOnly}\n            {indentation}\n            {tabSize}\n            {statusBar}\n            {askToFormat}\n            {mainMenuBar}\n            {navigationBar}\n            {escapeControlCharacters}\n            {escapeUnicodeCharacters}\n            {flattenColumns}\n            {parser}\n            {parseMemoizeOne}\n            {validator}\n            {validationParser}\n            {pathParser}\n            insideModal={false}\n            {onError}\n            onChange={handleChange}\n            onChangeMode={toggleMode}\n            onSelect={handleSelect}\n            {onRenderValue}\n            {onClassName}\n            onFocus={handleFocus}\n            onBlur={handleBlur}\n            {onRenderMenu}\n            {onRenderContextMenu}\n            {onSortModal}\n            {onTransformModal}\n            {onJSONEditorModal}\n          />\n        {/key}\n      </div>\n    </Modal>\n  </Modal>\n</AbsolutePopup>\n\n<style src=\"./JSONEditor.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import type { JSONPath } from 'immutable-json-patch'\n  import { compileJSONPointer } from 'immutable-json-patch'\n  import { getValueClass } from '$lib/plugins/value/components/utils/getValueClass.js'\n  import type { JSONParser, JSONSelection, OnPatch } from '$lib/types.js'\n  import { isValueSelection } from '$lib/logic/selection.js'\n\n  export let path: JSONPath\n  export let value: unknown\n  export let parser: JSONParser\n  export let readOnly: boolean\n  export let selection: JSONSelection | null\n  export let onPatch: OnPatch\n\n  export let options: Array<{ value: unknown; text: string }>\n\n  let refSelect: HTMLSelectElement | undefined\n\n  let bindValue: unknown = value\n  $: bindValue = value\n\n  function applyFocus(selection: JSONSelection | null) {\n    if (selection) {\n      if (refSelect) {\n        refSelect.focus()\n      }\n    }\n  }\n\n  $: applyFocus(selection)\n\n  function handleSelect(event: Event) {\n    event.stopPropagation()\n\n    if (readOnly) {\n      return\n    }\n\n    onPatch([\n      {\n        op: 'replace',\n        path: compileJSONPointer(path),\n        value: bindValue\n      }\n    ])\n  }\n\n  function handleMouseDown(event: MouseEvent) {\n    // stop propagation to prevent selecting the whole line\n    event.stopPropagation()\n  }\n</script>\n\n<select\n  class={`jse-enum-value ${getValueClass(bindValue, parser)}`}\n  class:jse-selected={isValueSelection(selection)}\n  bind:value={bindValue}\n  bind:this={refSelect}\n  on:change={handleSelect}\n  on:mousedown={handleMouseDown}\n>\n  {#each options as option}\n    <option value={option.value}>{option.text}</option>\n  {/each}\n</select>\n\n<style src=\"./EnumValue.scss\"></style>\n","import type { JSONPath } from 'immutable-json-patch'\nimport type { JSONSchema, JSONSchemaDefinitions, JSONSchemaEnum } from '$lib/types'\n\n/**\n * Find enum options for given path in a JSONSchema\n */\nexport function getJSONSchemaOptions(\n  schema: JSONSchema,\n  schemaDefinitions: JSONSchemaDefinitions | undefined,\n  path: JSONPath\n): JSONSchemaEnum | null {\n  const schemaForPath = findSchema(schema, schemaDefinitions || {}, path)\n\n  return schemaForPath ? findEnum(schemaForPath) : null\n}\n\n/**\n * find an enum definition in a JSON schema, as property `enum` or inside\n * one of the schemas composites (`oneOf`, `anyOf`, `allOf`)\n *\n * Source: https://github.com/josdejong/jsoneditor/blob/develop/src/js/Node.js\n */\nexport function findEnum(schema: JSONSchema): JSONSchemaEnum | null {\n  if (Array.isArray(schema['enum'])) {\n    return schema['enum']\n  }\n\n  const composite = schema['oneOf'] || schema['anyOf'] || schema['allOf']\n  if (Array.isArray(composite)) {\n    const match = composite.filter((entry) => entry.enum)\n    if (match.length > 0) {\n      return match[0].enum\n    }\n  }\n\n  return null\n}\n\n/**\n * Return the part of a JSON schema matching given path.\n *\n * Source: https://github.com/josdejong/jsoneditor/blob/develop/src/js/Node.js\n */\nexport function findSchema(\n  topLevelSchema: JSONSchema,\n  schemaDefinitions: JSONSchemaDefinitions,\n  path: JSONPath,\n  currentSchema = topLevelSchema\n): JSONSchema | null {\n  const nextPath = path.slice(1, path.length)\n  const nextKey = path[0]\n\n  let possibleSchemas = [currentSchema]\n  for (const subSchemas of [currentSchema.oneOf, currentSchema.anyOf, currentSchema.allOf]) {\n    if (Array.isArray(subSchemas)) {\n      possibleSchemas = possibleSchemas.concat(subSchemas)\n    }\n  }\n\n  for (const schema of possibleSchemas) {\n    currentSchema = schema\n\n    if ('$ref' in currentSchema && typeof currentSchema.$ref === 'string') {\n      const ref = currentSchema.$ref\n      if (ref in schemaDefinitions) {\n        currentSchema = schemaDefinitions[ref]\n      } else if (ref.startsWith('#/')) {\n        const refPath = ref.substring(2).split('/')\n        currentSchema = topLevelSchema\n        for (const segment of refPath) {\n          if (segment in currentSchema) {\n            currentSchema = currentSchema[segment] as JSONSchema\n          } else {\n            throw Error(`Unable to resolve reference ${ref}`)\n          }\n        }\n      } else if (ref.match(/#\\//g)?.length === 1) {\n        const [schemaUrl, relativePath] = ref.split('#/')\n        if (schemaUrl in schemaDefinitions) {\n          const referencedSchema = schemaDefinitions[schemaUrl]\n          const reference = { $ref: '#/'.concat(relativePath) }\n          const auxNextPath = []\n          auxNextPath.push(nextKey)\n          if (nextPath.length > 0) {\n            auxNextPath.push(...nextPath)\n          }\n          return findSchema(referencedSchema, schemaDefinitions, auxNextPath, reference)\n        } else {\n          throw Error(`Unable to resolve reference ${ref}`)\n        }\n      } else {\n        throw Error(`Unable to resolve reference ${ref}`)\n      }\n    }\n\n    // We have no more path segments to resolve, return the currently found schema\n    // We do this here, after resolving references, in case of the leaf schema beeing a reference\n    if (nextKey === undefined) {\n      return currentSchema\n    }\n\n    if (\n      typeof currentSchema.properties === 'object' &&\n      currentSchema.properties !== null &&\n      nextKey in currentSchema.properties\n    ) {\n      currentSchema = (currentSchema.properties as Record<string, JSONSchema>)[nextKey]\n      return findSchema(topLevelSchema, schemaDefinitions, nextPath, currentSchema)\n    }\n\n    if (\n      typeof currentSchema.patternProperties === 'object' &&\n      currentSchema.patternProperties !== null\n    ) {\n      for (const prop in currentSchema.patternProperties) {\n        if (nextKey.match(prop)) {\n          currentSchema = (currentSchema.patternProperties as Record<string, JSONSchema>)[prop]\n          return findSchema(topLevelSchema, schemaDefinitions, nextPath, currentSchema)\n        }\n      }\n    }\n\n    if (typeof currentSchema.additionalProperties === 'object') {\n      currentSchema = currentSchema.additionalProperties as JSONSchema\n      return findSchema(topLevelSchema, schemaDefinitions, nextPath, currentSchema)\n    }\n\n    if (typeof currentSchema.items === 'object' && currentSchema.items !== null) {\n      currentSchema = currentSchema.items as JSONSchema\n      return findSchema(topLevelSchema, schemaDefinitions, nextPath, currentSchema)\n    }\n  }\n\n  return null\n}\n","import EnumValue from './components/EnumValue.svelte'\nimport { getJSONSchemaOptions } from '$lib/utils/jsonSchemaUtils.js'\nimport type {\n  JSONSchema,\n  JSONSchemaDefinitions,\n  RenderValueComponentDescription,\n  RenderValueProps\n} from '$lib/types'\n\n/**\n * Search the JSON schema for enums defined at given props.path. If found,\n * return an EnumValue renderer. If not found, return null. In that case you\n * have to fallback on the default valueRender function\n */\nexport function renderJSONSchemaEnum(\n  props: RenderValueProps,\n  schema: JSONSchema,\n  schemaDefinitions?: JSONSchemaDefinitions\n): RenderValueComponentDescription[] | null {\n  const enumValues = getJSONSchemaOptions(schema, schemaDefinitions, props.path)\n\n  if (enumValues) {\n    const { value, path, selection, parser, readOnly, onPatch } = props\n\n    const options = enumValues.map((enumValue) => ({\n      value: enumValue,\n      text: enumValue\n    }))\n\n    // make sure the current value is also added as one of the options,\n    // else it would look as if the first option is the current value\n    const optionsWithValue = enumValues.includes(props.value)\n      ? options\n      : [{ value: value as unknown, text: value as unknown }].concat(options)\n\n    return [\n      {\n        component: EnumValue,\n        props: {\n          value,\n          path,\n          selection,\n          parser,\n          readOnly,\n          onPatch,\n          options: optionsWithValue\n        }\n      }\n    ]\n  }\n\n  return null\n}\n","import type Ajv from 'ajv'\nimport type { Options, Schema, ErrorObject } from 'ajv'\nimport AjvDist from 'ajv'\nimport { parsePath } from 'immutable-json-patch'\nimport type { JSONSchema, JSONSchemaDefinitions, ValidationError, Validator } from '$lib/types'\nimport { ValidationSeverity } from '$lib/types.js'\n\nexport interface AjvValidatorOptions {\n  schema: JSONSchema\n  schemaDefinitions?: JSONSchemaDefinitions\n  ajvOptions?: Options\n  onCreateAjv?: (ajv: Ajv) => Ajv | void\n}\n\n/**\n * Create a JSON Schema validator powered by Ajv.\n * @param options\n * @property schema\n *                    The JSON schema to validate (required).\n * @property [schemaDefinitions=undefined]\n *                    An object containing JSON Schema definitions\n *                    which can be referenced using $ref\n * @property [ajvOptions=undefined]\n *                    Optional extra options for Ajv\n * @property [onCreateAjv=undefined]\n *                    An optional callback function allowing to apply additional\n *                    configuration on the provided Ajv instance, or return\n *                    your own Ajv instance and ignore the provided one.\n * @return Returns a validation function\n */\nexport function createAjvValidator(options: AjvValidatorOptions): Validator {\n  // Deprecation error for the API of v0.9.2 and older\n  if (options.schema === undefined) {\n    throw new Error(\n      'Deprecation warning: ' +\n        'the signature of createAjvValidator is changed from ' +\n        'createAjvValidator(schema, schemaDefinitions, ajvOptions) ' +\n        'to ' +\n        'createAjvValidator({ schema, schemaDefinitions, ajvOptions }). ' +\n        'Please pass the arguments as an object instead of unnamed arguments.'\n    )\n  }\n\n  let ajv = createAjvInstance(options)\n  if (options.onCreateAjv !== undefined) {\n    ajv = options.onCreateAjv(ajv) || ajv\n\n    // validate whether ajv is configured correctly (this is needed to enhance error messages)\n    if (ajv.opts.verbose === false) {\n      throw new Error('Ajv must be configured with the option verbose=true')\n    }\n  }\n\n  const validateAjv = ajv.compile(options.schema as Schema)\n\n  if (validateAjv.errors) {\n    throw validateAjv.errors[0]\n  }\n\n  return function validate(json: unknown): ValidationError[] {\n    validateAjv(json)\n    const ajvErrors = validateAjv.errors || []\n\n    return ajvErrors.map(improveAjvError).map((error) => normalizeAjvError(json, error))\n  }\n}\n\nfunction createAjvInstance(options: AjvValidatorOptions): Ajv {\n  const { schemaDefinitions, ajvOptions } = options\n\n  const ajv = new AjvDist({\n    allErrors: true,\n    verbose: true,\n    $data: true,\n    ...ajvOptions\n  })\n\n  if (schemaDefinitions) {\n    Object.keys(schemaDefinitions).forEach((ref) => {\n      ajv.addSchema(schemaDefinitions[ref] as Schema, ref)\n    })\n  }\n\n  return ajv\n}\n\nfunction normalizeAjvError(json: unknown, ajvError: ErrorObject): ValidationError {\n  return {\n    path: parsePath(json, ajvError.instancePath),\n    message: ajvError.message || 'Unknown error',\n    severity: ValidationSeverity.warning\n  }\n}\n\n/**\n * Improve the error message of a JSON schema error,\n * for example list the available values of an enum.\n *\n * @param {Object} ajvError\n * @return {Object} Returns the error with improved message\n */\nfunction improveAjvError(ajvError: ErrorObject) {\n  if (ajvError.keyword === 'enum' && Array.isArray(ajvError.schema)) {\n    let enums = ajvError.schema\n    if (enums) {\n      enums = enums.map((value) => JSON.stringify(value))\n\n      if (enums.length > 5) {\n        const more = ['(' + (enums.length - 5) + ' more...)']\n        enums = enums.slice(0, 5)\n        enums.push(more)\n      }\n      ajvError.message = 'should be equal to one of: ' + enums.join(', ')\n    }\n  }\n\n  if (ajvError.keyword === 'additionalProperties') {\n    ajvError.message = 'should NOT have additional property: ' + ajvError.params.additionalProperty\n  }\n\n  return ajvError\n}\n","import * as _ from 'lodash-es'\nimport { last } from 'lodash-es'\nimport { createLodashPropertySelector, createPropertySelector } from '../../utils/pathUtils.js'\nimport { parseString } from '../../utils/stringUtils.js'\nimport type { QueryLanguage, QueryLanguageOptions } from '../../types.js'\nimport { isInteger } from '../../utils/typeUtils.js'\n\nconst description = `\n<p>\n  Enter a JavaScript function to filter, sort, or transform the data.\n  You can use <a href=\"https://lodash.com\" target=\"_blank\" rel=\"noopener noreferrer\">Lodash</a>\n  functions like <code>_.map</code>, <code>_.filter</code>,\n  <code>_.orderBy</code>, <code>_.sortBy</code>, <code>_.groupBy</code>,\n  <code>_.pick</code>, <code>_.uniq</code>, <code>_.get</code>, etcetera.\n</p>\n`\n\nexport const lodashQueryLanguage: QueryLanguage = {\n  id: 'lodash',\n  name: 'Lodash',\n  description,\n  createQuery,\n  executeQuery\n}\n\nfunction createQuery(json: unknown, queryOptions: QueryLanguageOptions): string {\n  const { filter, sort, projection } = queryOptions\n  const queryParts = ['  return _.chain(data)\\n']\n\n  if (filter && filter.path && filter.relation && filter.value) {\n    // Note that the comparisons embrace type coercion,\n    // so a filter value like '5' (text) will match numbers like 5 too.\n    const actualValueGetter = `item => item${createPropertySelector(filter.path)}`\n\n    const filterValue = parseString(filter.value)\n    const filterValueStr =\n      typeof filterValue === 'string'\n        ? `'${filter.value}'`\n        : isInteger(filter.value) && !Number.isSafeInteger(filterValue)\n          ? `${filter.value}n` // bigint\n          : filter.value\n\n    queryParts.push(`    .filter(${actualValueGetter} ${filter.relation} ${filterValueStr})\\n`)\n  }\n\n  if (sort && sort.path && sort.direction) {\n    queryParts.push(\n      `    .orderBy([${createLodashPropertySelector(sort.path)}], ['${sort.direction}'])\\n`\n    )\n  }\n\n  if (projection && projection.paths) {\n    // It is possible to make a util function \"pickFlat\"\n    // and use that when building the query to make it more readable.\n    if (projection.paths.length > 1) {\n      // Note that we do not use _.pick() here because this function doesn't flatten the results\n      const paths = projection.paths.map((path) => {\n        const name = last(path) || 'item' // 'item' in case of having selected the item root\n        return `      ${JSON.stringify(name)}: item${createPropertySelector(path)}`\n      })\n      queryParts.push(`    .map(item => ({\\n${paths.join(',\\n')}\\n    }))\\n`)\n    } else {\n      const path = projection.paths[0]\n      queryParts.push(`    .map(item => item${createPropertySelector(path)})\\n`)\n    }\n  }\n\n  queryParts.push('    .value()\\n')\n\n  return `function query (data) {\\n${queryParts.join('')}}`\n}\n\nfunction executeQuery(json: unknown, query: string): unknown {\n  validate(query)\n\n  // FIXME: replace unsafe new Function with a JS based query language\n  //  As long as we don't persist or fetch queries, there is no security risk.\n  // TODO: only import the most relevant subset of lodash instead of the full library?\n  // eslint-disable-next-line no-new-func\n  const queryFn = new Function(\n    '_',\n    '\"use strict\";\\n' +\n      '\\n' +\n      query +\n      '\\n' +\n      '\\n' +\n      'if (typeof query !== \"function\") {\\n' +\n      '  throw new Error(\"Cannot execute query: expecting a function named \\'query\\' but is undefined\")\\n' +\n      '}\\n' +\n      '\\n' +\n      'return query;\\n'\n  )(_)\n\n  const output = queryFn(json)\n  return output !== undefined ? output : null\n}\n\nfunction validate(query: string) {\n  // It is very common to forget to end a lodash chain with .value()\n  // This lets the JSON Editor crash though.\n  // Therefore, we do a simple validation (not a guarantee)\n  const chainCount = query.match(/_\\.chain\\(/g)?.length\n  const valueCount = query.match(/\\.value\\(\\)/g)?.length\n\n  if (chainCount !== valueCount) {\n    throw new Error('Cannot execute query: Lodash _.chain(...) must end with .value()')\n  }\n}\n","import jmespath from 'jmespath'\nimport type { JSONPath } from 'immutable-json-patch'\nimport { getIn } from 'immutable-json-patch'\nimport { parseString } from '$lib/utils/stringUtils.js'\nimport type { JSONParser, QueryLanguage, QueryLanguageOptions } from '$lib/types'\nimport { isEqualParser } from '$lib/utils/jsonUtils.js'\n\nconst description = `\n<p>\n  Enter a <a href=\"https://jmespath.org\" target=\"_blank\" rel=\"noopener noreferrer\">JMESPath</a> query \n  to filter, sort, or transform the JSON data.\n To learn JMESPath, go to <a href=\"https://jmespath.org/tutorial.html\" target=\"_blank\" rel=\"noopener noreferrer\">the interactive tutorial</a>.\n</p>\n`\n\nexport const jmespathQueryLanguage: QueryLanguage = {\n  id: 'jmespath',\n  name: 'JMESPath',\n  description: description,\n  createQuery,\n  executeQuery\n}\n\n/**\n * Build a JMESPath query based on query options coming from the wizard\n * @param json   The JSON document for which to build the query.\n *                      Used for context information like determining\n *                      the type of values (string or number)\n * @param queryOptions\n * @return Returns a query (as string)\n */\nfunction createQuery(json: unknown, queryOptions: QueryLanguageOptions): string {\n  const { sort, filter, projection } = queryOptions\n  let query = ''\n\n  if (filter && filter.path && filter.relation && filter.value) {\n    const examplePath = ['0'].concat(filter.path)\n    const exampleValue = getIn(json, examplePath)\n    const filterValue = parseString(filter.value)\n    const filterValueStr =\n      typeof exampleValue === 'string' && filterValue !== null && filterValue !== undefined\n        ? `\"${filter.value}\"`\n        : filterValue\n\n    query +=\n      '[? ' +\n      stringifyPathForJmespath(filter.path) +\n      ' ' +\n      filter.relation +\n      ' ' +\n      '`' +\n      filterValueStr +\n      '`' +\n      ']'\n  } else {\n    query += Array.isArray(json) ? '[*]' : '@'\n  }\n\n  if (sort && sort.path && sort.direction) {\n    if (sort.direction === 'desc') {\n      query += ' | reverse(sort_by(@, &' + stringifyPathForJmespath(sort.path) + '))'\n    } else {\n      query += ' | sort_by(@, &' + stringifyPathForJmespath(sort.path) + ')'\n    }\n  }\n\n  if (projection && projection.paths) {\n    if (query[query.length - 1] !== ']') {\n      query += ' | [*]'\n    }\n\n    if (projection.paths.length === 1) {\n      const path = projection.paths[0]\n\n      query +=\n        path.length === 0\n          ? '' // edge case, selecting projection of the item root\n          : '.' + stringifyPathForJmespath(path)\n    } else if (projection.paths.length > 1) {\n      query +=\n        '.{' +\n        projection.paths\n          .map((path) => {\n            const name = path[path.length - 1]\n            return stringifyProp(name) + ': ' + stringifyPathForJmespath(path)\n          })\n          .join(', ') +\n        '}'\n    } else {\n      // values.length === 0\n      // ignore\n    }\n  }\n\n  return query\n}\n\n/**\n * Execute a JMESPath query, returns the transformed JSON\n */\nfunction executeQuery(json: unknown, query: string, parser: JSONParser): unknown {\n  // JMESPath cannot handle non-native JSON data types like LosslessNumber\n\n  function stringifyAndParse(json: unknown) {\n    const text = parser.stringify(json)\n    return text !== undefined ? JSON.parse(text) : undefined\n  }\n\n  const preprocessedJson = isEqualParser(parser, JSON) ? json : stringifyAndParse(json)\n\n  return jmespath.search(preprocessedJson, query)\n}\n\n// TODO: unit test stringifyPathForJmespath\n// TODO: Isn't there a helper function exposed by the JMESPath library?\nexport function stringifyPathForJmespath(path: JSONPath): string {\n  if (path.length === 0) {\n    return '@'\n  }\n\n  const str = path\n    .map((prop) => {\n      if (typeof prop === 'number') {\n        return '[' + prop + ']'\n      } else {\n        return '.' + stringifyProp(String(prop))\n      }\n    })\n    .join('')\n\n  return str[0] === '.'\n    ? str.slice(1) // remove first dot\n    : str\n}\n\nfunction stringifyProp(prop: string): string {\n  return prop.match(/^[A-Za-z\\d_$]+$/) ? prop : JSON.stringify(prop)\n}\n"],"names":["noop","identity","x","assign","tar","src","k","run","fn","blank_object","Object","create","run_all","fns","forEach","is_function","thing","safe_not_equal","a","b","_typeof","not_equal","create_slot","definition","ctx","$$scope","slot_ctx","get_slot_context","slice","get_slot_changes","dirty","lets","undefined","merged","len","Math","max","length","i","update_slot_base","slot","slot_definition","slot_changes","get_slot_context_fn","slot_context","p","get_all_dirty_from_scope","exclude_internal_props","props","result","compute_rest_props","keys","rest","Set","has","null_to_empty","value","action_destroyer","action_result","destroy","is_client","window","now","performance","Date","raf","cb","requestAnimationFrame","tasks","run_tasks","task","c","f","size","globals","globalThis","global","append","target","node","appendChild","append_styles","style_sheet_id","styles","append_styles_to","get_root_for_style","getElementById","style","element","id","textContent","append_stylesheet","document","root","getRootNode","ownerDocument","host","append_empty_stylesheet","style_element","sheet","head","insert","anchor","insertBefore","detach","parentNode","removeChild","destroy_each","iterations","detaching","d","name","createElement","svg_element","createElementNS","text","data","createTextNode","space","empty","listen","event","handler","options","addEventListener","removeEventListener","prevent_default","preventDefault","call","this","stop_propagation","stopPropagation","attr","attribute","removeAttribute","getAttribute","setAttribute","always_set_through_set_attribute","set_attributes","attributes","descriptors","getOwnPropertyDescriptors","__proto__","key","cssText","set","indexOf","set_svg_attributes","set_data","set_input_value","input","set_style","important","removeProperty","setProperty","select_option","select","mounting","option","__value","selected","selectedIndex","toggle_class","toggle","classList","custom_event","type","detail","_ref2","arguments","_ref2$bubbles","bubbles","_ref2$cancelable","cancelable","CustomEvent","construct_svelte_component","component","current_component","managed_styles","Map","active","create_rule","duration","delay","ease","uid","step","keyframes","t","concat","rule","str","hash","charCodeAt","doc","_ref3","get","info","stylesheet","rules","create_style_information","insertRule","cssRules","animation","delete_rule","previous","split","next","filter","anim","deleted","join","ownerNode","clear","set_current_component","get_current_component","Error","onMount","$$","on_mount","push","onDestroy","on_destroy","createEventDispatcher","_ref4$cancelable","callbacks","defaultPrevented","setContext","context","getContext","bubble","_this","dirty_components","binding_callbacks","render_callbacks","flush_callbacks","resolved_promise","Promise","resolve","update_scheduled","schedule_update","then","flush","tick","add_render_callback","add_flush_callback","promise","seen_callbacks","flushidx","saved_component","update","e","pop","callback","add","fragment","before_update","after_update","dispatch","direction","kind","dispatchEvent","outros","outroing","group_outros","r","check_outros","transition_in","block","local","transition_out","o","null_transition","create_bidirectional_transition","params","intro","original_inert_value","config","running_program","pending_program","animation_name","clear_animation","init","program","abs","start","end","group","go","_ref5","_ref5$delay","_ref5$duration","_ref5$easing","easing","linear","_ref5$tick","css","inert","fulfill","ensure_array_like","array_like_or_iterator","Array","from","destroy_block","lookup","outro_and_destroy_block","update_keyed_each","old_blocks","get_key","dynamic","list","create_each_block","get_context","n","old_indexes","new_blocks","new_lookup","deltas","updates","_loop","child_ctx","will_move","did_move","m","first","new_block","old_block","new_key","old_key","get_spread_update","levels","to_null_out","accounted_for","get_spread_object","spread_props","bind","index","bound","create_component","mount_component","_component$$$","_component$$$$on_dest","new_on_destroy","map","apply","_toConsumableArray","destroy_component","filtered","targets","instance","create_fragment","parent_component","on_disconnect","skip_bound","ready","ret","fill","make_dirty","hydrate","nodes","childNodes","children","l","SvelteComponent","_createClass","_classCallCheck","_defineProperty","$destroy","splice","obj","$$set","createDebug","namespace","enabled","debug","localStorage","error","tryReadLocalStorage","endsWith","startsWith","enableDebug","color","colors","selectColor","_len","_console","args","_key4","console","log","__svelte","v","fade","_ref6","_ref6$delay","_ref6$duration","_ref6$easing","getComputedStyle","opacity","if_block","closeButton","create_if_block_1","div0","div0_class_value","classContent","div1","div1_class_value","classWindow","div1_aria_label_value","ariaLabelledBy","ariaLabel","div2","div2_class_value","classWindowWrap","div3","div3_id_value","div3_class_value","classBg","current","div1_transition","transitionWindowProps","div3_transition","transitionBgProps","button_class_value","classCloseButton","button","switch_value","create_if_block","Component","_objectSpread","background","wrap","modalWindow","scrollY","cssBg","cssWindowWrap","cssWindow","cssContent","cssCloseButton","currentTransitionBg","currentTransitionWindow","prevBodyPosition","prevBodyOverflow","prevBodyWidth","outerClickTarget","baseSetContext","svelte.setContext","_$$props$isTabbable","$$props","isTabbable","tabIndex","hidden","disabled","display","Boolean","offsetWidth","offsetHeight","getClientRects","_$$props$show","show","_$$props$id","_$$props$key","_$$props$ariaLabel","_$$props$ariaLabelled","_$$props$closeButton","_$$props$closeOnEsc","closeOnEsc","_$$props$closeOnOuter","closeOnOuterClick","styleBg","_$$props$styleBg","styleWindowWrap","_$$props$styleWindowW","styleWindow","_$$props$styleWindow","styleContent","_$$props$styleContent","styleCloseButton","_$$props$styleCloseBu","_$$props$classBg","_$$props$classWindowW","_$$props$classWindow","_$$props$classContent","_$$props$classCloseBu","_$$props$unstyled","unstyled","_$$props$setContext","_$$props$transitionBg","transitionBg","_$$props$transitionBg2","_$$props$transitionWi","transitionWindow","_$$props$transitionWi2","_$$props$disableFocus","disableFocusTrap","defaultState","state","toCssString","reduce","replace","toLowerCase","camelCaseToDash","isFunction","constructor","toVoid","onOpen","onClose","onOpened","onClosed","open","NewComponent","$$invalidate","width","innerWidth","height","innerHeight","disableScroll","close","enableScroll","body","position","overflow","top","scrollTo","left","behavior","isMounted","svelte.onDestroy","svelte.onMount","querySelectorAll","tabbable","sort","activeElement","shiftKey","focus","$$value","Mode","SelectionType","CaretType","ValidationSeverity","SearchField","SortDirection","UpdateSelectionAfterChange","AUTO_SCROLL_INTERVAL","AUTO_SCROLL_SPEED_SLOW","AUTO_SCROLL_SPEED_NORMAL","AUTO_SCROLL_SPEED_FAST","MAX_SEARCH_RESULTS","ARRAY_SECTION_SIZE","MAX_VALIDATION_ERRORS","MAX_CHARACTERS_TEXT_PREVIEW","DEFAULT_VISIBLE_SECTIONS","MAX_VALIDATABLE_SIZE","MAX_AUTO_REPAIRABLE_SIZE","MAX_DOCUMENT_SIZE_TEXT_MODE","MAX_DOCUMENT_SIZE_EXPAND_ALL","SIMPLE_MODAL_OPTIONS","SORT_MODAL_OPTIONS","TRANSFORM_MODAL_OPTIONS","JSONEDITOR_MODAL_OPTIONS","INSERT_EXPLANATION","CONTEXT_MENU_EXPLANATION","HOVER_INSERT_INSIDE","HOVER_INSERT_AFTER","HOVER_COLLECTION","JSON_STATUS_VALID","JSON_STATUS_REPAIRABLE","CONTEXT_MENU_HEIGHT","CONTEXT_MENU_WIDTH","SEARCH_BOX_HEIGHT","SORT_DIRECTION_NAMES","asc","desc","uniqueId","int","parseInt","isNumber","NUMBER_REGEX","test","isObject","isObjectOrArray","isTimestamp","isFinite","floor","isNaN","valueOf","Number","err","getColorCSS","colorTestDiv","applied","valueType","parser","isArray","valueStr","stringify","isUrlRegex","isUrl","stringConvert","strTrim","trim","parse","isInteger","INTEGER_REGEX","MAX_ITEM_PATHS_COLLECTION","ROOT_PATH","getNestedPaths","array","includeObjects","pointersMap","TypeError","recurseNestedPaths","path","compileJSONPointer","min","parseJSONPointer","forEachIndex","iteratee","limit","arrayToObject","objectToArray","object","values","moveItems","count","offset","copy","moving","parseAndRepair","jsonText","jsonrepair","parseAndRepairOrUndefined","partialJson","parsePartialJson","END_WITH_COMMA_AND_OPTIONAL_WHITESPACES_REGEX","repairPartialJson","repaired","substring","normalizeJsonParseError","parseErrorMessage","positionMatch","POSITION_REGEX","exec","line","character","charAt","countCharacterOccurrences","column","lastIndexOf","message","lineMatch","LINE_REGEX","lineOneBased","columnMatch","COLUMN_REGEX","columnOneBased","calculatePosition","validateContentType","content","json","isContent","isTextContent","isJSONContent","toTextContent","indentation","JSON","toJSONContent","getText","isLargeContent","maxSize","estimateSerializedSize","Infinity","estimatedSize","recurse","String","isEqualParser","needsFormatting","includes","DELIMITER_WITHOUT_SPACING_REGEX","createNormalizationFunctions","_ref7","escapeControlCharacters","escapeUnicodeCharacters","normalizeControlAndUnicode","normalizeControl","normalizeUnicode","normalizeNothing","escapeValue","jsonEscapeUnicode","jsonEscapeControl","unescapeValue","jsonUnescapeControl","jsonUnescapeUnicode","_x$codePointAt","codePointAt","toString","unescaped","controlCharacters","escapedControlCharacters","addNewLineSuffix","isChildOfNodeName","nodeName","isChildOf","toUpperCase","isChildOfAttribute","hasAttribute","predicate","findParent","setCursorToEnd","firstChild","range","createRange","selection","getSelection","setStart","collapse","removeAllRanges","addRange","insertActiveElementContents","container","replaceContents","onActiveElement","getWindow","isContentEditable","defaultView","activeElementIsChildOf","findParentWithNodeName","getSelectionTypeFromTarget","inside","after","multi","encodeDataPath","encodeURIComponent","getDataPathFromTarget","parent","dataPath","decodeURIComponent","findNearestElement","_ref8","allElements","currentElement","_ref8$hasPrio","hasPrio","_ref8$margin","margin","all","rect","getBoundingClientRect","calculateCenter","y","distance","weightY","diffX","diffY","sqrt","distanceToCurrent","candidate","candidatesLeft","right","candidatesLeftOnRow","nearest","minBy","candidates","prioCandidates","isEditableDivRef","refresh","cancel","keyComboFromEvent","separator","combi","ctrlKey","metaKey","altKey","keyName","metaKeys","Ctrl","Command","Control","Alt","Option","Shift","switch_instance_spread_levels","switch_instance_props","div","div_style_value","calculateStyle","handleMouseDownInside","refRootPopup","rootRect","_calculatePosition","_options$width","_options$height","_options$offsetTop","offsetTop","_options$offsetLeft","offsetLeft","_anchor$getBoundingCl","bottom","positionAbove","positionLeft","_options$width2","_options$height2","refHiddenInput","popup","closeAbsolutePopup","closeWhenOutside","each_blocks","popups","popupId","popupIndex","findIndex","openAbsolutePopup","stringifyJSONPath","integerNumberRegex","parseJSONPath","pathStr","parseProp","eatCharacter","isEnd","unescape","prop","char","SyntaxError","pathToOption","label","isEmpty","stringifyLodashProperty","javaScriptPropertyRegex","propStr","createPropertySelector","findUniqueName","keysSet","nameWithoutCopySuffix","validName","truncate","maxLength","maxTextLength","ellipsis","parseString","lower","num","numFloat","parseFloat","javascriptQueryLanguage","queryOptions","projection","queryParts","relation","actualValueGetter","filterValue","filterValueStr","isSafeInteger","paths","item","query","output","Function","queryFn","g","cursor","raw","getRaw","rawData","ids","match","rawId","_","pointerId","svg","class","svg_class_value","role","svg_role_value","_$$props2$class","className","_$$props5$box","box","_$$props6$spin","spin","_$$props7$inverse","inverse","_$$props8$pulse","pulse","_$$props9$flip","flip","_$$props10$style","_$$props11$label","path_1","polygon_1","each_value_1","_ctx$","each_value","_ctx$2","polygons","_ctx$3","_ctx$4","_ctx$5","_ctx$6","iconData","combinedStyle","_$$props13$class","_$$props15$scale","scale","_$$props16$spin","_$$props17$inverse","_$$props18$pulse","_$$props19$flip","_$$props20$label","_$$props21$style","normalisedScale","numScale","warn","calculateRatio","iconName","_data$icon","_slicedToArray","icon","normaliseData","combined","faCheckSquare","faSquare","div_aria_checked_value","icon_changes","readOnly","onPatch","op","ref","onChange","showOnTop","destroyColorPicker","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_yield$import","VanillaPicker","colorPicker","_callee$","_context","prev","import","t1","sent","t0","t2","onDone","hex","rgba","_getWindow$1$innerHei","_getWindow$","windowHeight","ColorPickerPopup","mergeSections","sections","sortedSections","sortBy","section","mergedSections","sortedIndex","mergedIndex","inVisibleSection","some","nextRoundNumber","currentRoundNumber","createDocumentState","documentState","expandedMap","enforceStringMap","visibleSectionsMap","sortedColumn","expand","expandWithCallback","getVisibleSections","pointer","forEachVisibleIndex","jsonArray","visibleSections","_ref24","expandPath","partialPath","partialPointer","getIn","newSection","expandedCallback","currentPath","pathIndex","_iterator","_step","_createForOfIteratorHelper","s","done","collapsePath","deletePath","setEnforceString","enforceString","updatedEnforceString","documentStatePatch","operations","updatedJson","immutableJSONPatch","updatedDocumentState","updatingState","operation","isJSONPatchAdd","documentStateAdd","isJSONPatchRemove","documentStateRemove","isJSONPatchReplace","cleanupNonExistingPaths","isJSONObject","isJSONArray","documentStateReplace","isJSONPatchCopy","isJSONPatchMove","renamePointer","expandedMapCopy","movePath","filterPath","enforceStringMapCopy","visibleSectionsMapCopy","updatedState","mergePaths","documentStateMoveOrCopy","parsePath","parentPath","initial","parentPointer","last","shiftPath","updateInPathsMap","shiftVisibleSections","updatedMap","itemPointer","startsWithJSONPointer","filteredMap","changePointer","movedMap","oldPointer","newPointer","indexPathPos","matches","_i13","_Object$keys","itemPath","existsIn","updatedValue","isEqual","mergeAdjacentSections","getEnforceString","isStringContainingPrimitiveValue","getNextKeys","includeKey","getVisiblePaths","_recurse","getVisibleCaretPositions","includeInside","propertyPath","getNextVisiblePath","visiblePaths","expandRecursive","expandContents","expandAll","expandMinimal","isAfterSelection","isInsideSelection","isKeySelection","isValueSelection","isMultiSelection","isMultiSelectionWithOneItem","focusPath","anchorPath","isJSONSelection","isTextSelection","getSelectionPaths","getAnchorPath","getFocusPath","sharedPath","findSharedPath","createMultiSelection","startPath","getStartPath","endPath","getEndPath","startIndex","getChildIndex","endIndex","iterateOverSelection","getParentPath","anchorIndex","getSelectionUp","keepAnchorPath","previousPath","visiblePathPointers","pathPointer","getPreviousVisiblePath","createValueSelection","createKeySelection","findCaretAndSiblings","caret","visibleCaretPositions","getInitialSelection","createSelectionFromOperations","every","firstOp","otherOps","path1","path2","singleItemSelected","findRootPath","pathStartsWith","removeEditModeFromSelection","edit","createInsideSelection","createAfterSelection","isParent","selectionToPartialJson","_parser$stringify","_parser$stringify2","_parser$stringify3","isEditingSelection","hasSelectionContents","canConvert","fromCaretPosition","caretPosition","fromSelectionType","selectionType","selectionIfOverlapping","pathInSelection","classnames","classes","_len2","_key5","_i15","_args2","arg","hasOwnProperty","getValueClass","div_class_value","domValue","valueClass","_$$props$shortText","shortText","onCancel","onFind","_$$props$onPaste","onPaste","_$$props$onValueClass","onValueClass","closed","getDomValue","removeNewLineSuffix","innerText","setDomValue","handleValueInput","newValue","handleCancel","no","combo","nextInside","clipboardData","clipboardText","getData","hasFocus","self","normalization","onPasteJson","onSelect","findNextInside","convert","updateSelection","patchedJson","patchedState","pastedText","pastedJson","contents","entry","afterKey","nextKeys","newProp","moveDown","rename","oldKey","newKey","newKeyUnique","duplicate","lastPath","beforeKey","clipboard","newValues","clipboardToValues","firstPath","removeAll","removeKeys","filteredKeys","nextKey","firstKey","reverse","textIsObject","textIsArray","clipboardOriginal","clipboardRepaired","createRemoveOperations","newSelection","previousKey","revertJSONPatchWithMoveOperations","revertJSONPatch","before","revertOperations","createRevertMoveOperations","updateSearchResult","newResultItems","previousResult","activePath","activeItem","getSearchResultPath","matchingActiveIndex","activeIndex","items","itemsMap","groupBy","searchNext","searchResult","nextActiveIndex","nextActiveItem","searchPrevious","previousActiveIndex","previousActiveItem","search","searchText","_options$maxResults","searchTextLowerCase","maxResults","columns","results","onMatch","searchRecursive","level","_i16","_keys4","findCaseInsensitiveMatches","field","textLower","fieldIndex","replaceText","replacementText","replaceAllText","occurrences","updatedText","forEachRight","occurrence","createSearchAndReplaceOperations","searchResultItem","currentValue","currentValueText","createSearchAndReplaceAllOperations","searchResultItems","deduplicatedMatches","previousItem","allOperations","lastNewSelection","filterKeySearchResults","_map$pointer","filterValueSearchResults","_map$pointer2","span","t_value","parts","_step2","previousEnd","_iterator2","precedingText","matchingText","lastMatch","splitValue","valueIsUrl","tooltip","_ref35","handleMouseEnter","Tooltip","handleMouseLeave","faClock","absolutePopupContext","renderValue","_ref38","isEditing","renderers","isBoolean","BooleanToggle","isColor","ColorPicker","EditableValue","ReadonlyValue","TimestampTag","transformModalStates","transformModalStateShared","showWizard","showOriginal","round","createCoords","oppositeSideMap","oppositeAlignmentMap","clamp","evaluate","param","getSide","placement","getAlignment","getOppositeAxis","axis","getAxisLength","getSideAxis","getAlignmentAxis","getAlignmentSides","rects","rtl","alignment","alignmentAxis","mainAlignmentSide","reference","floating","getOppositePlacement","getExpandedPlacements","oppositePlacement","getOppositeAlignmentPlacement","getOppositeAxisPlacements","flipAlignment","side","isStart","lr","rl","getSideList","getPaddingObject","padding","expandPaddingObject","rectToClientRect","computeCoordsFromPlacement","_ref","coords","sideAxis","alignLength","isVertical","commonX","commonY","commonAlign","computePosition","_ref39","_callee2","_config$placement","_config$strategy","strategy","_config$middleware","middleware","platform","validMiddleware","_computeCoordsFromPla","statefulPlacement","middlewareData","resetCount","_validMiddleware$i","_yield$fn","nextX","nextY","reset","_computeCoordsFromPla2","_context2","isRTL","getElementRects","initialPlacement","elements","abrupt","stop","_x","_x2","_x3","detectOverflow","_x4","_x5","_detectOverflow","_callee51","_await$platform$isEle","_evaluate3","_evaluate3$boundary","boundary","_evaluate3$rootBounda","rootBoundary","_evaluate3$elementCon","elementContext","_evaluate3$altBoundar","altBoundary","_evaluate3$padding","paddingObject","altContext","clippingClientRect","offsetParent","offsetScale","elementClientRect","_context51","isElement","t3","t4","t5","contextElement","getDocumentElement","t6","t7","t8","t9","t10","getClippingRect","t11","getOffsetParent","getScale","t13","t12","t14","convertOffsetParentRelativeRectToViewportRelativeRect","t15","t16","convertValueToCoords","_x6","_x7","_convertValueToCoords","_callee52","mainAxisMulti","crossAxisMulti","rawValue","_ref146","mainAxis","crossAxis","_callee52$","_context52","getNodeName","isNode","_node$ownerDocument","documentElement","Node","Element","isHTMLElement","HTMLElement","isShadowRoot","ShadowRoot","isOverflowElement","_getComputedStyle$","overflowX","overflowY","isTableElement","isContainingBlock","webkit","isWebKit","transform","perspective","containerType","backdropFilter","willChange","contain","CSS","supports","isLastTraversableNode","getNodeScroll","scrollLeft","scrollTop","pageXOffset","pageYOffset","getParentNode","assignedSlot","getNearestOverflowAncestor","getOverflowAncestors","traverseIframes","_node$ownerDocument2","scrollableAncestor","isBody","win","visualViewport","frameElement","getCssDimensions","hasOffset","shouldFallback","$","unwrapElement","domElement","_getCssDimensions","noOffsets","getVisualOffsets","includeScale","isFixedStrategy","clientRect","visualOffsets","isFixed","floatingOffsetParent","shouldAddVisualOffsets","offsetWin","currentIFrame","iframeScale","iframeRect","clientLeft","paddingLeft","clientTop","paddingTop","getWindowScrollBarX","getClientRectFromClippingAncestor","clippingAncestor","html","clientWidth","clientHeight","visualViewportBased","getViewportRect","scroll","scrollWidth","scrollHeight","getDocumentRect","getInnerBoundingClientRect","hasFixedPositionAncestor","stopNode","getRectRelativeToOffsetParent","isOffsetParentAnElement","offsets","offsetRect","getTrueOffsetParent","polyfill","currentNode","getContainingBlock","elementClippingAncestors","cache","cachedResult","el","currentContainingBlockComputedStyle","elementIsFixed","computedStyle","currentNodeIsContaining","ancestor","getClippingElementAncestors","_c","clippingAncestors","firstClippingAncestor","clippingRect","accRect","_ref40","_callee6","getOffsetParentFn","getDimensionsFn","_context6","getDimensions","_x8","_getCssDimensions2","autoUpdate","_options","_options$ancestorScro","ancestorScroll","_options$ancestorResi","ancestorResize","_options$elementResiz","elementResize","ResizeObserver","_options$layoutShift","layoutShift","IntersectionObserver","_options$animationFra","animationFrame","referenceEl","ancestors","passive","frameId","cleanupIo","onMove","timeoutId","io","cleanup","clearTimeout","disconnect","skip","threshold","_element$getBoundingC","rootMargin","isFirstUpdate","handleObserve","observe","entries","ratio","intersectionRatio","setTimeout","observeMove","reobserveFrame","resizeObserver","firstEntry","unobserve","cancelAnimationFrame","prevRefRect","frameLoop","nextRefRect","shift","_callee5","_evaluate2","_evaluate2$mainAxis","checkMainAxis","_evaluate2$crossAxis","checkCrossAxis","_evaluate2$limiter","limiter","detectOverflowOptions","mainAxisCoord","crossAxisCoord","maxSide","_min","_max","_maxSide","_min2","_max2","limitedCoords","_callee5$","_context5","_objectWithoutProperties","_excluded2","_callee3","_middlewareData$arrow","_middlewareData$flip","_evaluate","_evaluate$mainAxis","_evaluate$crossAxis","specifiedFallbackPlacements","_evaluate$fallbackStr","fallbackStrategy","_evaluate$fallbackAxi","fallbackAxisSideDirection","_evaluate$flipAlignme","isBasePlacement","fallbackPlacements","placements","overflows","overflowsData","sides","_middlewareData$flip2","_overflowsData$filter","nextIndex","nextPlacement","resetPlacement","_overflowsData$map$so","_placement","_callee3$","_context3","_excluded","arrow","alignmentOffset","acc","mergedOptions","platformWithCache","computePosition$1","_ref43","loadOptions","filterText","multiple","itemId","filterSelectedItems","itemFilter","convertStringItemsToObjects","filterGroupedItems","filterResults","matchesFilter","getItems","_x9","_getItems","_callee53","_ref44","res","_callee53$","_context53","details","cancelled","filteredItems","loading","focused","listOpen","circle","if_block0","create_if_block_13","if_block2","create_if_block_9","_ctx$7","_ctx$8","groupHeader","groupItem","_ctx$9","selectable","listDom","_ctx$10","span0","span1","ClearIcon","create_if_block_6","create_if_block_8","create_if_block_7","create_if_block_4","create_if_block_3","create_if_block_2","input_1","if_block6","input_1_readonly_value","_items","timeout","activeValue","prev_value","prev_filterText","prev_multiple","_inputAttributes","slots","_$$props$justValue","justValue","_$$props$filter","_filter","_$$props$getItems","_$$props$id2","_$$props$name","_$$props$container","_$$props$input","_$$props$multiple","_$$props$multiFullIte","multiFullItemClearable","_$$props$disabled","_$$props$focused","_$$props$value","_$$props$filterText","_$$props$placeholder","placeholder","_$$props$placeholderA","placeholderAlwaysShow","_$$props$items","_$$props$label","_$$props$itemFilter","_$$props$groupBy","groupFilter","_$$props$groupFilter","groups","_$$props$groupHeaderS","groupHeaderSelectable","_$$props$itemId","_$$props$loadOptions","_$$props$containerSty","containerStyles","_$$props$hasError","hasError","_$$props$filterSelect","_$$props$required","required","_$$props$closeListOnC","closeListOnChange","_$$props$clearFilterT","clearFilterTextOnBlur","createGroupHeaderItem","_$$props$createGroupH","groupValue","_$$props$searchable","searchable","_$$props$inputStyles","inputStyles","_$$props$clearable","clearable","_$$props$loading","_$$props$listOpen","_$$props$debounce","debounce","wait","_$$props$debounceWait","debounceWait","_$$props$hideEmptySta","hideEmptyState","inputAttributes","_$$props$inputAttribu","_$$props$listAutoWidt","listAutoWidth","_$$props$showChevron","showChevron","_$$props$listOffset","listOffset","_$$props$hoverItemInd","hoverItemIndex","floatingConfig","_$$props$floatingConf","_$$props$class","containerClasses","groupValues","sortedGroupedItems","checkHoverSelectable","startingIndex","ignoreGroup","setHoverIndex","checkValueForDuplicates","noDuplicates","uniqueValues","val","findItem","matchTo","find","handleMultiItemClear","_x10","_handleMultiItemClear","_callee9","itemToRemove","_callee9$","_context9","handleFocus","_document","_input","handleBlur","_x11","_handleBlur","_callee10","_input2","_context10","isScrolling","closeList","blur","_callee8","_context8","_$$props$ariaValues","ariaValues","ariaListOpen","_$$props$ariaListOpen","ariaFocused","_$$props$ariaFocused","isScrollingTimer","handleListScroll","_list2","remove","handleSelect","itemSelected","handleHover","handleItemClick","isItemSelectable","increment","hasOwn","hover","activeScroll","scrollAction","hoverScroll","scrollIntoView","_floatingConfig","_callee4","_middlewareData$offse","diffCoords","_context4","_createFloatingAction","initOptions","referenceElement","floatingElement","defaultOptions","getOptions","mixin","updatePosition","updateOptions","_options2","onComputed","setupVirtualElementObserver","subscribe","$node","contentOptions","autoUpdateDestroy","destroyAutoUpdate","initAutoUpdate","_ref42","_autoUpdate","createFloatingActions","_createFloatingAction2","floatingRef","floatingContent","floatingUpdate","prefloat","setValue","autocapitalize","autocomplete","autocorrect","spellcheck","tabindex","_context7","hasValue","hideSelectedItem","showClear","placeholderText","_value4","ariaSelection","ariaContext","_item","handleAriaContent","updateValueDisplay","handleFilterEvent","_floatingConfig2","listMounted","scrollToHoverItem","hoverItem","_list","contains","table","tr0","th0","td0","tr1","th1","td1","tr2","th2","td2","_$$props$queryOptions","filterRelationOptions","sortDirectionOptions","_queryOptions","filterRelation","_queryOptions2","_queryOptions$filter","_queryOptions3","sortPath","_queryOptions4","sortDirection","_queryOptions5","_queryOptions$sort","_queryOptions6","_queryOptions7","_queryOptions8","_queryOptions10","jsonIsArray","pathsIncludingObjects","fieldOptions","projectionOptions","projectionPaths","_queryOptions12","_filterPath","setIn","_filterRelation","_queryOptions9","changeSortPath","_sortPath","_sortDirection","_queryOptions11","changeProjectionPaths","t1_value","button_title_value","queryLanguages","queryLanguageId","onChangeQueryLanguage","handleChangeQueryLanguage","newQueryLanguageId","queryLanguage","faDownLeftAndUpRightToCenter","faUpRightAndDownLeftFromCenter","faTimes","_$$props$title","title","_$$props$fullScreenBu","fullScreenButton","_$$props$fullscreen","fullscreen","_$$props$onClose","faCog","refConfigButton","_getContext4","SelectQueryLanguage","easeInOutQuad","createJump","a11y","timeStart","timeElapsed","scrolling","loop","timeCurrent","querySelector","MAX_HISTORY_ITEMS","createHistory","maxItems","canUndo","canRedo","getState","handleChange","undo","redo","measure","onDuration","validateJSON","validator","validationParser","validateText","validationErrors","severity","convertedJSON","isRepairable","canAutoRepair","parseError","createFocusTracker","_ref57","blurTimeoutHandle","onFocus","onBlur","handleFocusIn","newFocus","handleFocusOut","icon_1","Icon","icon_1_changes","button_disabled_value","_$$props$type","_$$props$icon","_$$props$message","actions","_$$props$actions","_$$props$onClick","onClick","_$$props$onClose2","action","onMouseDown","faExclamationTriangle","faAngleRight","tr","tr_class_value","tbody","faAngleDown","t3_value","td3","show_if","selectError","expanded","errors","warning","validationError","IS_MAC","navigator","handleKeyDown","onEscape","div10","div9","div7","div4","div6","div5","div8","isMenuSpace","isMenuSeparator","isMenuLabel","isMenuButton","isMenuDropDownButton","isContextMenuRow","isContextMenuColumn","isContentParseError","contentErrors","isContentValidationErrors","isValidationError","isNestedValidationError","isChildError","isSvelteComponentRenderer","isSvelteActionRenderer","unknownMenuItem","if_block1","show_if_1","show_if_2","_$$props$items2","message_changes","textarea","domTextArea","_$$props$text","_$$props$readOnly","onParse","onRepair","_$$props$onChange","onApply","handleApply","getErrorMessage","repairable","errorActions","gotoAction","repairAction","successActions","faCheck","faArrowDown","setSelectionRange","faWrench","repairedText","handleMouseMove","sectionIndex","total","onExpandSection","visibleSection","getJson","expandItemsSections","section1","start2","section2","currentIndex","previousIndex","section3","showSection2","getExpandItemsSections","expandItemsSection","faCaretDown","onContextMenu","buttonElem","showTip","editablediv_changes","searchresulthighlighter_changes","contextmenupointer_changes","onUpdateKey","isKeySelected","isEditingKey","updatedKey","updatedPath","previous_key","dispose","action_action","constants_0","onRenderValue","singleton","selecting","selectionAnchor","selectionAnchorType","selectionFocus","dragging","onMoveSelection","_ref76","deltaY","updatedSelection","dragInsideAction","_ref77","initialPath","initialIndex","prevHeight","_items2","cumulativeHeight","beforePath","findSwapPathUp","_ref78","_items$beforeIndex","nextHeight","_items3","findSwapPathDown","startKey","endKey","toKey","toIndex","times","moveInsideParent","_ref79","_items4","_items5","createUpdatedArraySelection","filterPointerOrUndefined","_i58","_Object$keys2","filterMapOrUndefined","onExpand","create_if_block_26","create_if_block_24","create_if_block_23","jsonvalue_changes","create_if_block_21","create_if_block_20","if_block4","create_if_block_18","create_if_block_16","create_if_block_17","create_if_block_10","faCaretRight","t2_value","t4_value","each_value_2","create_if_block_14","keySearchResultItemsMap","jsonkey_changes","validationErrorsMap","searchResultItemsMap","valueSearchResultItemsMap","jsonnode_changes","collapseditems_changes","onClassName","div_data_path_value","isNodeSelected","onDragSelectionStart","hoverTimer","memoizePath","memoize","handleMouseMoveGlobal","onDrag","handleMouseUpGlobal","onDragEnd","findContentTop","_context$findElement","findElement","calculateDeltaY","contentOffset","initialContentTop","clientY","initialClientY","handleDragSelection","getDocumentState","didMoveItems","handleDragSelectionEnd","_onMoveSelection3","initialTarget","keyPath","keyPointer","appendToJSONPointer","selectionStartIndex","selectionItemsCount","originalIndexes","recursive","contentEditable","isContentEditableDiv","which","anchorType","fullSelection","lastCaretPosition","selectionParentPath","addHeight","currentSection","getVisibleItemsWithHeights","contextMenuProps","faJSONEditorExpand","prefix","faJSONEditorCollapse","faJSONEditorFormat","faJSONEditorCompact","expandMenuItem","collapseMenuItem","searchMenuItem","defaultItems","_$$props$showSearch","showSearch","historyState","onExpandAll","onCollapseAll","onUndo","onRedo","onSort","onTransform","onCopy","onRenderMenu","handleToggleSearch","hasJson","faSearch","faCopy","faSortAmountDownAlt","faFilter","faEllipsisV","faUndo","faRedo","button0","button1","onCreateArray","onCreateObject","caseInsensitiveNaturalCompare","aLower","bLower","naturalCompare","sortJson","rootPath","comparator","valueA","valueB","createObjectComparator","sortArray","sortedKeys","keyA","keyB","sortObjectKeys","MAX_ITEM_CHARACTERS","MAX_ITEMS","selectedItem","refNavigationBarItem","_getContext7","handleSelectItem","NavigationBarDropdown","copyToClipBoard","_document$queryComman","_document2","writeText","queryCommandSupported","execCommand","inputRef","inputPath","pathParser","onError","pathExists","validationActive","copiedTimer","copied","parseAndValidate","validatePathExists","inputValidationError","currentTarget","navigationbaritem_changes","faClose","faEdit","refNavigationBar","editing","handleCloseEditor","hasNextItem","faChevronDown","faChevronUp","form","button2","faCircleNotch","initSearchInput","showReplace","onSearch","previousText","searching","applyChangedSearchTextDebounced","_x13","_applyChangedSearchText","applyChangedJsonDebounced","_x14","_applyChangedJson","toggleShowReplace","_handlePaste","_context11","_callee11","handleReplace","_handleReplace","_context12","_searchResult3","_createSearchAndRepla","_callee12","_handleReplaceAll","_context13","_createSearchAndRepla2","_callee13","handleNext","_handleNext","_context14","_callee14","handlePrevious","_handlePrevious","_context15","_callee15","_handleFocus","_searchResult4","_context16","_callee16","_applyChangedShowSearch","_callee17","_context17","applySearch","_callee18","_context18","_callee19","_context19","_x15","_x16","_x17","_applySearch","_callee20","_context20","handleClose","resultCount","_searchResult","_searchResult2","formattedResultCount","_x12","applyChangedShowSearch","endOfPath","Symbol","getColumns","flatten","maxSampleCount","forEachSample","_recurseObject","_collectPaths","valueMerged","calculateVisibleSection","viewPortHeight","itemHeights","defaultItemHeight","searchBoxOffset","itemCount","averageItemHeight","calculateAverageItemHeight","viewPortTop","viewPortBottom","getItemHeight","startHeight","visibleHeight","endHeight","visibleItems","calculateAbsolutePosition","rowIndex","toTableCellPosition","_path5","columnIndex","fromTableCellPosition","groupValidationErrors","_partition2","partition","arrayErrors","rootErrors","errorsByRow","findRowIndex","groupedErrorsByRow","mapValues","groupByRow","row","findColumnIndex","rows","mergeValidationErrors","clearSortedColumnWhenAffectedByOperations","columms","_toTableCellPosition6","selectedColumnIndex","operationAffectsSortedColumn","onCut","_x18","_onCut","_callee54","_ref94","_createRemoveOperatio2","_callee54$","_context54","copyToClipboard","_x19","_onCopy","_callee55","_ref95","_context55","_ref96","onChangeText","openRepairModal","doPaste","selectionNonNull","onRemove","_ref97","keepSelection","removeSelection","patchResult","_createRemoveOperatio","onDuplicateRow","_ref98","_toTableCellPosition7","rowPath","onInsertBeforeRow","_ref99","onInsertAfterRow","_ref100","_toTableCellPosition9","nextRowIndex","nextRowPath","onRemoveRow","_ref101","_toTableCellPosition10","newRowIndex","onInsert","_ref102","insertType","selectInside","refJsonEditor","onReplaceJson","jsonExample","cloneDeepWith","createNewValue","tick2","refreshEditableDiv","onInsertCharacter","_x20","_onInsertCharacter","_callee56","_ref103","_char4","_replaceContents","_callee56$","_context56","onInsertValueWithCharacter","_x21","_onInsertValueWithCharacter","_callee57","_ref104","_char5","_context57","truncated","_$$props$className","onRequestClose","li","ul","_$$props$items3","_$$props$title2","_$$props$width","visible","handleClick","allItemsDisabled","wasVisible","main","dropdownbutton_changes","_$$props$className2","show_if_3","faLightbulb","refContextMenu","tip","firstEnabledButton","directionByCombo","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","treemenu_changes","navigationbar_changes","_ctx$11","_ctx$12","faCode","create_if_block_5","isSSR","refContents","sortModalId","transformModalId","_getContext9","jump","externalContent","externalSelection","mainMenuBar","navigationBar","parseMemoizeOne","onChangeMode","onRenderContextMenu","onSortModal","onTransformModal","onJSONEditorModal","modalOpen","documentStateInitialized","_handleFocusSearch","_callee22","_callee22$","_context22","history","textIsRepaired","memoizedValidate","memoizeOne","updateValidationErrors","newValidationErrors","validate","applyExternalContent","updatedContent","isChanged","currentlyText","previousState","previousJson","previousTextIsRepaired","expandWhenNotInitialized","clearSelectionWhenNotExisting","addHistoryItem","applyExternalJson","repairError","applyExternalText","getDefaultExpand","_ref21","patch","afterPatch","patched","patchedDocumentState","updateSelectionInDocumentState","newState","handleEditKey","handleEditValue","openJSONEditorModal","handleToggleEnforceString","handlePatch","handleCut","_handleCut","indent","_args4","_context23","handleCopy","_handleCopy","_args5","_context24","handlePasteFromMenu","CopyPasteModal","JSONRepairModal","handleRemove","handleDuplicate","handleExtract","extract","handleInsert","handleReplaceJson","handleInsertFromContextMenu","handleConvert","convertedValue","parsedValue","convertValue","handleInsertBefore","selectionBefore","handleContextMenu","handleInsertAfter","handleInsertCharacter","_x23","_handleInsertCharacter","_callee25","_context25","handleUndo","previousContent","emitOnChange","handleRedo","openSortModal","_onSort","_ref45","handleSortSelection","openTransformModal","transformedJson","handleTransformSelection","_x25","_scrollTo","_callee26","scrollToWhenVisible","elem","viewPortRect","elemRect","_args7","_context26","elemHeight","_onChange","_onChange2","handleChangeText","handleExpand","expandSingleItem","isSelectionInsidePath","openFind","findAndReplace","handleExpandSection","expandSection","handlePasteJson","newPastedJson","openContextMenu","_ref46","_ref115","onEditKey","onEditValue","onToggleEnforceString","onDuplicate","onExtract","onInsertBefore","onConvert","onInsertAfter","hasSelection","rootSelected","focusValue","editValueText","canEditKey","canEditValue","canEnforceString","canCut","canCopy","canPaste","canDuplicate","canExtract","convertMode","insertOrConvertText","canInsertOrConvertStructure","canInsertOrConvertObject","canInsertOrConvertArray","canInsertOrConvertValue","handleInsertOrConvert","faPen","faCut","faPaste","faClone","faCropAlt","faTrashCan","faArrowRightArrowLeft","faPlus","faCaretSquareUp","faCaretSquareDown","createTreeContextMenuItems","ContextMenu","clientX","_refContents","_refContents2","_handleParsePastedJson","_context27","_pastedJson","refEditableDiv","_refContents3","_callee27","childPath","nextPathInside","getSelectionNextInside","handleDrag","autoScrollHandler","handleDragEnd","_parseInt","overflowAnchor","applySearchBoxSpacing","applyExternalSelection","mapValidationErrors","scrollableElement","autoScrollSpeed","autoScrollTimer","calculateSpeed","diff","autoScrollCallback","startAutoScroll","speed","stopAutoScroll","setInterval","clearInterval","_scrollableElement$ge","createAutoScrollHandler","_x22","_event$clipboardData","collapsedState","nextPath","nextPathAfter","getSelectionDown","_findCaretAndSiblings","getSelectionLeft","_findCaretAndSiblings2","getSelectionRight","outsideEditor","cleanDocumentState","readonlyProxy","Proxy","property","receiver","Reflect","deleteProperty","description","input_value_value","div19","div17","div16","div12","div11","div15","div14","div18","innerHTML","raw_value","selectedJson","selectedContent","_$$props$id3","_$$props$rootPath","stateId","getSelectedQueryLanguage","createQuery","isManual","previewError","previewContent","previewTransformDebounced","previewJson","jsonTransformed","executeQuery","newQueryOptions","newSelectedQueryLanguage","sortModalStates","th","td","_ctx$13","_ctx$14","colgroup","_ctx$15","_ctx$16","directions","selectedProperty","_sortModalStates$stat","selectedDirection","_sortModalStates$stat2","sortError","properties","_selectedProperty","_properties","_selectedDirection","formatSize","kilo","toFixed","KB","MB","GB","_$$props$readOnly2","onFormat","onCompact","onToggleSearch","canFormat","canCompact","canSort","canTransform","searchItem","pos","lineNumber","columnNumber","charCount","editorState","_editorState","_editorState2","lineAt","number","_editorState3","ranges","to","highlightStyle","HighlightStyle","define","tag","tags","propertyName","bool","string","keyword","highlighter","syntaxHighlighting","originalStyle","get_if_ctx_1","toDiagnostic","codeMirrorRef","domTextMode","codeMirrorView","statusBar","askToFormat","tabSize","formatCompactKeyBinding","handleFormat","handleCompact","acceptTooLarge","linterCompartment","Compartment","readOnlyCompartment","indentCompartment","tabSizeCompartment","themeCompartment","previousEscapeUnicodeCharacters","_callee28","_context28","createCodeMirrorView","initialText","disableTextEditor","emitChange","setCodeMirrorContent","handleRepair","jsonStatus","jsonParseError","_ref122","setSelection","handleDoubleClick","view","selectedText","jsmap","jsonSourceMap","pointers","_pointer$value","valueEnd","createLinter","linter","linterCallback","_ref123","EditorState","toCodeMirrorSelection","extensions","keymap","of","indentWithTab","lintGutter","lineNumbers","highlightActiveLineGutter","highlightSpecialChars","foldGutter","drawSelection","dropCursor","allowMultipleSelections","indentOnInput","defaultHighlightStyle","fallback","bracketMatching","closeBrackets","autocompletion","rectangularSelection","crosshairCursor","highlightActiveLine","highlightSelectionMatches","closeBracketsKeymap","defaultKeymap","searchKeymap","historyKeymap","foldKeymap","completionKeymap","lintKeymap","indentationMarkers","hideFirstIndent","EditorView","domEventHandlers","dblclick","updateListener","docChanged","onChangeCodeMirrorValueDebounced","selectionSet","emitOnSelect","jsonLang","lineWrapping","createIndent","theme","dark","hasDarkTheme","getPropertyValue","toRichValidationError","_findTextLocation","pointerName","keyEnd","findTextLocation","toRichParseError","newContent","forceUpdate","newText","changes","updateCanUndoRedo","EditorSelection","fromJSON","_refresh","updateTheme","_context30","_callee30","onChangeCodeMirrorValue","codeMirrorText","_updateTheme","effects","reconfigure","indentUnit","repeat","wrappedLineIndent","undoDepth","redoDepth","toJSON","memoizedValidateText","handleShowMe","richParseError","handleSelectParseError","repairActionShowMe","faEye","eq","updateLinter","updateIndentation","updateTabSize","updateReadOnly","repairActions","_onSort2","_ref121","_context29","_callee29","closeSearchPanel","openSearchPanel","tree","_toRichValidationErro","containsValidArray","_$$props$showSearch2","flatMap","extendedOperations","unshift","createNestedValueOperations","_ctx$2$stringify","_ctx$2$stringify2","isSelected","containsSearchResult","containsActiveSearchResult","onEdit","faCaretUp","t0_value","columnName","_sortedColumn","sortDirectionName","observer","onResize","WeakMap","_iterator5","_step5","t7_value","t5_value","nestedArrayPaths","maxLevel","findNestedArrays","hasNestedArrays","isEmptyDocument","documentType","nestedArrayPath","faRotate","onRefresh","constants_2","_child_ctx$","constants_3","_child_ctx$2","_child_ctx$3","compileJSONPointerProp","constants_1","_child_ctx$4","_child_ctx$7","_ctx$17","td0_colspan_value","td1_colspan_value","_ctx$18","each_blocks_1","create_if_block_11","columnheader_changes","jsonvaluecomponent_changes","inlinevalue_changes","_child_ctx$5","_child_ctx$6","td_data_path_value","_getContext13","flattenColumns","_handleFocusSearch2","_callee33","_context33","itemHeightsCache","currentContent","_ref137","handleFind","createDefaultSelectionWhenUndefined","searchBoxHeight","roughDistance","scrollToHorizontal","_callback","_callee32","_context32","scrollToVertical","resolvedPath","_ref138","_ref136","onEditRow","createTableContextMenuItems","handleEditRow","handleDuplicateRow","handleInsertBeforeRow","handleInsertAfterRow","handleRemoveRow","_refContents4","_refContents5","_handleParsePastedJson2","_context34","_pastedJson2","_refContents6","_callee34","_x28","_handleCut2","_callee35","_context35","_handleCopy2","_args17","_context36","_handleInsertCharacter2","_callee37","_context37","handleResizeRow","newColumns","previousColumns","_step3","orderedColumns","newColumnsSet","_iterator3","_step4","_iterator4","maintainColumnOrder","showRefreshButton","groupedValidationErrors","_x27","newSortedColumn","_toTableCellPosition4","selectPreviousColumn","_toTableCellPosition5","selectNextColumn","_toTableCellPosition2","selectPreviousRow","_toTableCellPosition3","selectNextRow","_x29","_event$clipboardData2","_ref139","refTreeMode","refTableMode","refTextMode","modeMenuItems","handleRenderMenu","handleRenderContextMenu","mode","insideModal","separatorMenuItem","_refresh2","_context38","_callee38","updatedItems","updatedItemsOriginal","cloneDeep","modal","_onRenderContextMenu","itemsOriginal","acceptAutoRepair","faCaretLeft","jsoneditorroot_changes","refEditor","rootState","determineMode","relativePath","stack","scrollToSelection","_last","currentState","absolutePath","pathDescription","parentJson","updatedParentContent","updatedParentState","parentState","newMode","newError","_ref140","nestedModalState","_ctx$19","_ctx$20","refJSONEditorRoot","_$$props$content","_$$props$selection","_$$props$readOnly3","_$$props$indentation","_$$props$tabSize","_$$props$mode","_$$props$mainMenuBar","_$$props$navigationBa","_$$props$statusBar","_$$props$askToFormat","_$$props$escapeContro","_$$props$escapeUnicod","_$$props$flattenColum","_$$props$parser","_$$props$validator","_$$props$validationPa","_$$props$pathParser","_$$props$queryLanguag","_$$props$queryLanguag2","_$$props$onChangeQuer","_$$props$onChange2","_$$props$onSelect","_$$props$onRenderValu","_$$props$onClassName","_$$props$onRenderMenu","_$$props$onRenderCont","_$$props$onChangeMode","_$$props$onError","alert","_$$props$onFocus","_$$props$onBlur","instanceId","jsoneditorModalState","previousParser","_set","_callee39","contentError","_callee39$","_context39","_update","_callee40","_context40","_patch","_callee41","_context41","_select","_callee42","_context42","_expand","_callee43","_context43","_acceptAutoRepair","_context44","_callee44","_scrollTo2","_callee45","_callee45$","_context45","_focus","_context46","_callee46","_refresh3","_context47","_callee47","_updateProps","_callee48","_callee48$","_context48","$set","_destroy","_context49","_callee49","_toggleMode","_callee50","_context50","_ref141","TransformModal","_ref142","SortModal","status","_x37","_ref143","JSONEditorModal","_jsoneditorModalState","_jsoneditorModalState2","_x30","_x31","_x32","_x33","_x34","_x35","_x36","option_1","option_1_value_value","handleMouseDown","refSelect","bindValue","applyFocus","selected_option","getJSONSchemaOptions","schema","schemaDefinitions","schemaForPath","findSchema","composite","findEnum","topLevelSchema","currentSchema","possibleSchemas","_i129","_arr","oneOf","anyOf","allOf","subSchemas","_step6","_iterator6","$ref","_ref$match","_ref$split2","schemaUrl","referencedSchema","auxNextPath","refPath","_step7","_iterator7","segment","patternProperties","additionalProperties","renderJSONSchemaEnum","enumValues","enumValue","optionsWithValue","EnumValue","createAjvValidator","ajv","ajvOptions","AjvDist","allErrors","verbose","$data","addSchema","createAjvInstance","onCreateAjv","opts","validateAjv","compile","improveAjvError","ajvError","instancePath","normalizeAjvError","enums","more","additionalProperty","lodashQueryLanguage","createLodashPropertySelector","_query$match","_query$match2","chainCount","valueCount","jmespathQueryLanguage","examplePath","exampleValue","stringifyPathForJmespath","stringifyProp","preprocessedJson","stringifyAndParse","jmespath"],"mappings":"s8dACO,SAASA,KAAS,CAElB,IAAMC,GAAW,SAACC,GAAC,OAAKA,CAE/B,EAOO,SAASC,GAAOC,EAAKC,GAE3B,IAAK,IAAMC,KAAKD,EAAKD,EAAIE,GAAKD,EAAIC,GAClC,OAA6BF,CAC9B,CAuBO,SAASG,GAAIC,GACnB,OAAOA,GACR,CAEO,SAASC,KACf,OAAOC,OAAOC,OAAO,KACtB,CAMO,SAASC,GAAQC,GACvBA,EAAIC,QAAQP,GACb,CAMO,SAASQ,GAAYC,GAC3B,MAAwB,mBAAVA,CACf,CAGO,SAASC,GAAeC,EAAGC,GACjC,OAAOD,GAAKA,EAAIC,GAAKA,EAAID,IAAMC,GAAMD,GAAkB,WAAbE,EAAOF,IAAgC,mBAANA,CAC5E,CAiDO,SAASG,GAAUH,EAAGC,GAC5B,OAAOD,GAAKA,EAAIC,GAAKA,EAAID,IAAMC,CAChC,CA4CO,SAASG,GAAYC,EAAYC,EAAKC,EAASjB,GACrD,GAAIe,EAAY,CACf,IAAMG,EAAWC,GAAiBJ,EAAYC,EAAKC,EAASjB,GAC5D,OAAOe,EAAW,GAAGG,EACrB,CACF,CAEA,SAASC,GAAiBJ,EAAYC,EAAKC,EAASjB,GACnD,OAAOe,EAAW,IAAMf,EAAKL,GAAOsB,EAAQD,IAAII,QAASL,EAAW,GAAGf,EAAGgB,KAASC,EAAQD,GAC5F,CAEO,SAASK,GAAiBN,EAAYE,EAASK,EAAOtB,GAC5D,GAAIe,EAAW,IAAMf,EAAI,CACxB,IAAMuB,EAAOR,EAAW,GAAGf,EAAGsB,IAC9B,QAAsBE,IAAlBP,EAAQK,MACX,OAAOC,EAER,GAAoB,WAAhBX,EAAOW,GAAmB,CAG7B,IAFA,IAAME,EAAS,GACTC,EAAMC,KAAKC,IAAIX,EAAQK,MAAMO,OAAQN,EAAKM,QACvCC,EAAI,EAAGA,EAAIJ,EAAKI,GAAK,EAC7BL,EAAOK,GAAKb,EAAQK,MAAMQ,GAAKP,EAAKO,GAErC,OAAOL,CACP,CACD,OAAOR,EAAQK,MAAQC,CACvB,CACD,OAAON,EAAQK,KAChB,CAGO,SAASS,GACfC,EACAC,EACAjB,EACAC,EACAiB,EACAC,GAEA,GAAID,EAAc,CACjB,IAAME,EAAejB,GAAiBc,EAAiBjB,EAAKC,EAASkB,GACrEH,EAAKK,EAAED,EAAcF,EACrB,CACF,CAiBO,SAASI,GAAyBrB,GACxC,GAAIA,EAAQD,IAAIa,OAAS,GAAI,CAG5B,IAFA,IAAMP,EAAQ,GACRO,EAASZ,EAAQD,IAAIa,OAAS,GAC3BC,EAAI,EAAGA,EAAID,EAAQC,IAC3BR,EAAMQ,IAAM,EAEb,OAAOR,CACP,CACD,OAAQ,CACT,CAGO,SAASiB,GAAuBC,GACtC,IAAMC,EAAS,CAAA,EACf,IAAK,IAAM3C,KAAK0C,EAAoB,MAAT1C,EAAE,KAAY2C,EAAO3C,GAAK0C,EAAM1C,IAC3D,OAAO2C,CACR,CAGO,SAASC,GAAmBF,EAAOG,GACzC,IAAMC,EAAO,CAAA,EAEb,IAAK,IAAM9C,KADX6C,EAAO,IAAIE,IAAIF,GACCH,EAAYG,EAAKG,IAAIhD,IAAe,MAATA,EAAE,KAAY8C,EAAK9C,GAAK0C,EAAM1C,IACzE,OAAO8C,CACR,CAqBO,SAASG,GAAcC,GAC7B,OAAgB,MAATA,EAAgB,GAAKA,CAC7B,CASO,SAASC,GAAiBC,GAChC,OAAOA,GAAiB3C,GAAY2C,EAAcC,SAAWD,EAAcC,QAAU3D,EACtF,CCtRO,IAAM4D,GAA8B,oBAAXC,OAGrBC,GAAMF,GAAY,WAAA,OAAMC,OAAOE,YAAYD,OAAQ,WAAM,OAAAE,KAAKF,OAE9DG,GAAML,GAAY,SAACM,GAAO,OAAAC,sBAAsBD,EAAMlE,EAAAA,GCL3DoE,GAAQ,IAAIf,IAMlB,SAASgB,GAAUP,GAClBM,GAAMtD,SAAQ,SAACwD,GACTA,EAAKC,EAAET,KACXM,UAAaE,GACbA,EAAKE,IAER,IACoB,IAAfJ,GAAMK,MAAYR,GAAII,GAC3B,CCfO,IAAMK,GACM,oBAAXb,OACJA,OACsB,oBAAfc,WACPA,WAEAC,OCuIG,SAASC,GAAOC,EAAQC,GAC9BD,EAAOE,YAAYD,EACpB,CAQO,SAASE,GAAcH,EAAQI,EAAgBC,GACrD,IAAMC,EAAmBC,GAAmBP,GAC5C,IAAKM,EAAiBE,eAAeJ,GAAiB,CACrD,IAAMK,EAAQC,GAAQ,SACtBD,EAAME,GAAKP,EACXK,EAAMG,YAAcP,EACpBQ,GAAkBP,EAAkBG,EACpC,CACF,CAMO,SAASF,GAAmBN,GAClC,IAAKA,EAAM,OAAOa,SAClB,IAAMC,EAAOd,EAAKe,YAAcf,EAAKe,cAAgBf,EAAKgB,cAC1D,OAAIF,GAAmCA,EAAMG,KACVH,EAE5Bd,EAAKgB,aACb,CAMO,SAASE,GAAwBlB,GACvC,IAAMmB,EAAgBV,GAAQ,SAQ9B,OAFAU,EAAcR,YAAc,cAC5BC,GAAkBN,GAAmBN,GAAOmB,GACrCA,EAAcC,KACtB,CAOA,SAASR,GAAkBZ,EAAMQ,GAEhC,OADAV,GAAgCE,EAAMqB,MAAQrB,EAAMQ,GAC7CA,EAAMY,KACd,CAuCO,SAASE,GAAOvB,EAAQC,EAAMuB,GACpCxB,EAAOyB,aAAaxB,EAAMuB,GAAU,KACrC,CAoBO,SAASE,GAAOzB,GAClBA,EAAK0B,YACR1B,EAAK0B,WAAWC,YAAY3B,EAE9B,CAIO,SAAS4B,GAAaC,EAAYC,GACxC,IAAK,IAAIvE,EAAI,EAAGA,EAAIsE,EAAWvE,OAAQC,GAAK,EACvCsE,EAAWtE,IAAIsE,EAAWtE,GAAGwE,EAAED,EAErC,CAOO,SAASrB,GAAQuB,GACvB,OAAOnB,SAASoB,cAAcD,EAC/B,CAuCO,SAASE,GAAYF,GAC3B,OAAOnB,SAASsB,gBAAgB,6BAA8BH,EAC/D,CAMO,SAASI,GAAKC,GACpB,OAAOxB,SAASyB,eAAeD,EAChC,CAIO,SAASE,KACf,OAAOH,GAAK,IACb,CAIO,SAASI,KACf,OAAOJ,GAAK,GACb,CAiBO,SAASK,GAAOzC,EAAM0C,EAAOC,EAASC,GAE5C,OADA5C,EAAK6C,iBAAiBH,EAAOC,EAASC,GAC/B,WAAA,OAAM5C,EAAK8C,oBAAoBJ,EAAOC,EAASC,GACvD,CAIO,SAASG,GAAgBtH,GAC/B,OAAiBiH,SAAAA,GAGhB,OAFAA,EAAMM,iBAECvH,EAAGwH,KAAKC,KAAMR,EACvB,CACA,CAIO,SAASS,GAAiB1H,GAChC,OAAiBiH,SAAAA,GAGhB,OAFAA,EAAMU,kBAEC3H,EAAGwH,KAAKC,KAAMR,EACvB,CACA,CAoCO,SAASW,GAAKrD,EAAMsD,EAAW7E,GACxB,MAATA,EAAeuB,EAAKuD,gBAAgBD,GAC/BtD,EAAKwD,aAAaF,KAAe7E,GAAOuB,EAAKyD,aAAaH,EAAW7E,EAC/E,CAQA,IAAMiF,GAAmC,CAAC,QAAS,UAO5C,SAASC,GAAe3D,EAAM4D,GAEpC,IAAMC,EAAclI,OAAOmI,0BAA0B9D,EAAK+D,WAC1D,IAAK,IAAMC,KAAOJ,EACM,MAAnBA,EAAWI,GACdhE,EAAKuD,gBAAgBS,GACH,UAARA,EACVhE,EAAKQ,MAAMyD,QAAUL,EAAWI,GACd,YAARA,EACUhE,EAAMvB,MAAQuB,EAAKgE,GAAOJ,EAAWI,GAEzDH,EAAYG,IACZH,EAAYG,GAAKE,MACkC,IAAnDR,GAAiCS,QAAQH,GAEzChE,EAAKgE,GAAOJ,EAAWI,GAEvBX,GAAKrD,EAAMgE,EAAKJ,EAAWI,GAG9B,CAOO,SAASI,GAAmBpE,EAAM4D,GACxC,IAAK,IAAMI,KAAOJ,EACjBP,GAAKrD,EAAMgE,EAAKJ,EAAWI,GAE7B,CAqWO,SAASK,GAASjC,EAAMC,GAC9BA,EAAO,GAAKA,EACRD,EAAKC,OAASA,IAClBD,EAAKC,KAA8BA,EACpC,CA6BO,SAASiC,GAAgBC,EAAO9F,GACtC8F,EAAM9F,MAAiB,MAATA,EAAgB,GAAKA,CACpC,CAcO,SAAS+F,GAAUxE,EAAMgE,EAAKvF,EAAOgG,GAC9B,MAAThG,EACHuB,EAAKQ,MAAMkE,eAAeV,GAE1BhE,EAAKQ,MAAMmE,YAAYX,EAAKvF,EAAOgG,EAAY,YAAc,GAE/D,CAIO,SAASG,GAAcC,EAAQpG,EAAOqG,GAC5C,IAAK,IAAIvH,EAAI,EAAGA,EAAIsH,EAAOjC,QAAQtF,OAAQC,GAAK,EAAG,CAClD,IAAMwH,EAASF,EAAOjC,QAAQrF,GAC9B,GAAIwH,EAAOC,UAAYvG,EAEtB,YADAsG,EAAOE,UAAW,EAGnB,CACIH,QAAsB7H,IAAVwB,IAChBoG,EAAOK,eAAiB,EAE1B,CA2GO,SAASC,GAAa1E,EAASuB,EAAMoD,GAE3C3E,EAAQ4E,UAAUD,OAAOpD,IAAQoD,EAClC,CASO,SAASE,GAAaC,EAAMC,GAAsDC,IAAAA,EAAAC,UAAApI,OAAAoI,QAAAzI,IAAAyI,aAAAA,UAAJ,GAAA,GAAEC,EAAAF,EAA1CG,QAAAA,OAAO,IAAAD,GAAQA,EAAAE,EAAAJ,EAAEK,WAC7D,OAAW,IAAAC,YAAYR,EAAM,CAAEC,OAAAA,EAAQI,QAAAA,EAASE,gBAD0B,IAAHD,GAAQA,GAEhF,CAmNO,SAASG,GAA2BC,EAAWhI,GACrD,WAAWgI,EAAUhI,EACtB,CCtsCA,ICJWiI,GDILC,GAAiB,IAAIC,IAEvBC,GAAS,EAoCN,SAASC,GAAYtG,EAAM7D,EAAGC,EAAGmK,EAAUC,EAAOC,EAAMhL,GAG9D,IAHkE,IAAAiL,EAAGhB,UAAApI,OAAA,QAAAL,IAAAyI,UAAA,GAAAA,UAAA,GAAG,EAClEiB,EAAO,OAASJ,EAClBK,EAAY,MACP9I,EAAI,EAAGA,GAAK,EAAGA,GAAK6I,EAAM,CAClC,IAAME,EAAI1K,GAAKC,EAAID,GAAKsK,EAAK3I,GAC7B8I,GAAiB,IAAJ9I,EAAO,KAAAgJ,OAAQrL,EAAGoL,EAAG,EAAIA,GAAO,MAC7C,CACD,IAAME,EAAOH,EAASE,SAAAA,OAAYrL,EAAGW,EAAG,EAAIA,GAAE,QACxC4F,EAAI8E,YAAAA,OArCX,SAAcE,GAGb,IAFA,IAAIC,EAAO,KACP1J,EAAIyJ,EAAI1J,OACLC,KAAK0J,GAASA,GAAQ,GAAKA,EAAQD,EAAIE,WAAW3J,GACzD,OAAO0J,IAAS,CACjB,CAgC0BA,CAAKF,GAAKD,KAAAA,OAAIJ,GACjCS,EAAM7G,GAAmBN,GAC/BoH,EAA8BjB,GAAekB,IAAIF,IA3BlD,SAAkCA,EAAKnH,GACtC,IAAMsH,EAAO,CAAEC,WAAYrG,GAAwBlB,GAAOwH,MAAO,CAAA,GAEjE,OADArB,GAAejC,IAAIiD,EAAKG,GACjBA,CACR,CAuB0DG,CAAyBN,EAAKnH,GAA/EuH,EAAUH,EAAVG,WAAYC,EAAKJ,EAALI,MACfA,EAAMxF,KACVwF,EAAMxF,IAAQ,EACduF,EAAWG,yBAAUZ,OAAe9E,EAAI,KAAA8E,OAAIC,GAAQQ,EAAWI,SAASrK,SAEzE,IAAMsK,EAAY5H,EAAKQ,MAAMoH,WAAa,GAK1C,OAJA5H,EAAKQ,MAAMoH,UAAS,GAAAd,OACnBc,EAAS,GAAAd,OAAMc,EAAS,MAAO,IAAEd,OAC/B9E,EAAI,KAAA8E,OAAIP,EAAQ,cAAAO,OAAaN,EAAK,aACrCH,IAAU,EACHrE,CACR,CAOO,SAAS6F,GAAY7H,EAAMgC,GACjC,IAAM8F,GAAY9H,EAAKQ,MAAMoH,WAAa,IAAIG,MAAM,MAC9CC,EAAOF,EAASG,OACrBjG,EACG,SAACkG,GAAI,OAAKA,EAAK/D,QAAQnC,GAAQ,CAAC,EAChC,SAACkG,GAAS,OAA8B,IAA9BA,EAAK/D,QAAQ,WAAkB,GAEvCgE,EAAUL,EAASxK,OAAS0K,EAAK1K,OACnC6K,IACHnI,EAAKQ,MAAMoH,UAAYI,EAAKI,KAAK,OACjC/B,IAAU8B,IAOXjJ,IAAI,WACCmH,KACJF,GAAepK,SAAQ,SAACuL,GACvB,IAAQe,EAAcf,EAAKC,WAAnBc,UAEJA,GAAW5G,GAAO4G,EACzB,IACElC,GAAemC,QACjB,IAZA,CChFO,SAASC,GAAsBtC,GACrCC,GAAoBD,CACrB,CAEO,SAASuC,KACf,IAAKtC,GAAmB,MAAM,IAAIuC,MAAM,oDACxC,OAAOvC,EACR,CA6BO,SAASwC,GAAQjN,GACvB+M,KAAwBG,GAAGC,SAASC,KAAKpN,EAC1C,CAyBO,SAASqN,GAAUrN,GACzB+M,KAAwBG,GAAGI,WAAWF,KAAKpN,EAC5C,CAyBO,SAASuN,KACf,IAAM/C,EAAYuC,KAClB,OAAQjD,SAAAA,EAAMC,GAAwC,IAALyD,GAAKvD,UAAApI,OAAAoI,QAAAzI,IAAAyI,UAAAzI,GAAAyI,UAAA,GAAP,IAAvBI,WAAAA,OAAa,IAAHmD,GAAQA,EACnCC,EAAYjD,EAAU0C,GAAGO,UAAU3D,GACzC,GAAI2D,EAAW,CAGd,IAAMxG,EAAQ4C,GAAoCC,EAAOC,EAAQ,CAAEM,WAAAA,IAInE,OAHAoD,EAAUrM,QAAQd,SAAQ,SAACN,GAC1BA,EAAGwH,KAAKgD,EAAWvD,EACvB,KACWA,EAAMyG,gBACd,CACD,OAAW,CACb,CACA,CAeO,SAASC,GAAWpF,EAAKqF,GAE/B,OADAb,KAAwBG,GAAGU,QAAQnF,IAAIF,EAAKqF,GACrCA,CACR,CAWO,SAASC,GAAWtF,GAC1B,OAAOwE,KAAwBG,GAAGU,QAAQhC,IAAIrD,EAC/C,CAmCO,SAASuF,GAAOtD,EAAWvD,GAAO8G,IAAAA,EACxCtG,KAAMgG,EAAYjD,EAAU0C,GAAGO,UAAUxG,EAAM6C,MAC3C2D,GAEHA,EAAUrM,QAAQd,SAAQ,SAACN,GAAE,OAAKA,EAAGwH,KAAKuG,EAAM9G,EAAO,GAEzD,CCnLO,IAAM+G,GAAmB,GAEnBC,GAAoB,GAE7BC,GAAmB,GAEjBC,GAAkB,GAElBC,GAAmCC,QAAQC,UAE7CC,IAAmB,EAGhB,SAASC,KACVD,KACJA,IAAmB,EACnBH,GAAiBK,KAAKC,IAExB,CAGO,SAASC,KAEf,OADAH,KACOJ,EACR,CAGO,SAASQ,GAAoB5O,GACnCkO,GAAiBd,KAAKpN,EACvB,CAGO,SAAS6O,GAAmB7O,GAClCmO,GAAgBf,KAAKpN,EACtB,CAoBA,IC/CI8O,GD+CEC,GAAiB,IAAIlM,IAEvBmM,GAAW,EAGR,SAASN,KAIf,GAAiB,IAAbM,GAAJ,CAGA,IAAMC,EAAkBxE,GACxB,EAAG,CAGF,IACC,KAAOuE,GAAWhB,GAAiBnM,QAAQ,CAC1C,IAAM2I,EAAYwD,GAAiBgB,IACnCA,KACAlC,GAAsBtC,GACtB0E,GAAO1E,EAAU0C,GACjB,CACD,CAAC,MAAOiC,GAIR,MAFAnB,GAAiBnM,OAAS,EAC1BmN,GAAW,EACLG,CACN,CAID,IAHArC,GAAsB,MACtBkB,GAAiBnM,OAAS,EAC1BmN,GAAW,EACJf,GAAkBpM,QAAQoM,GAAkBmB,KAAlBnB,GAIjC,IAAK,IAAInM,EAAI,EAAGA,EAAIoM,GAAiBrM,OAAQC,GAAK,EAAG,CACpD,IAAMuN,EAAWnB,GAAiBpM,GAC7BiN,GAAejM,IAAIuM,KAEvBN,GAAeO,IAAID,GACnBA,IAED,CACDnB,GAAiBrM,OAAS,CAC5B,OAAUmM,GAAiBnM,QAC1B,KAAOsM,GAAgBtM,QACtBsM,GAAgBiB,KAAhBjB,GAEDI,IAAmB,EACnBQ,GAAelC,QACfC,GAAsBmC,EAxCrB,CAyCF,CAGA,SAASC,GAAOhC,GACf,GAAoB,OAAhBA,EAAGqC,SAAmB,CACzBrC,EAAGgC,SACH9O,GAAQ8M,EAAGsC,eACX,IAAMlO,EAAQ4L,EAAG5L,MACjB4L,EAAG5L,MAAQ,EAAE,GACb4L,EAAGqC,UAAYrC,EAAGqC,SAASlN,EAAE6K,EAAGlM,IAAKM,GACrC4L,EAAGuC,aAAanP,QAAQsO,GACxB,CACF,CC1FA,SAASc,GAASnL,EAAMoL,EAAWC,GAClCrL,EAAKsL,cAAchG,GAAYwB,GAAAA,OAAIsE,EAAY,QAAU,SAAOtE,OAAGuE,IACpE,CAEA,IAKIE,GALEC,GAAW,IAAIlN,IASd,SAASmN,KACfF,GAAS,CACRG,EAAG,EACHlM,EAAG,GACH1B,EAAGyN,GAEL,CAIO,SAASI,KACVJ,GAAOG,GACX7P,GAAQ0P,GAAO/L,GAEhB+L,GAASA,GAAOzN,CACjB,CAOO,SAAS8N,GAAcC,EAAOC,GAChCD,GAASA,EAAMtO,IAClBiO,GAAQ,OAAQK,GAChBA,EAAMtO,EAAEuO,GAEV,CASO,SAASC,GAAeF,EAAOC,EAAOrK,EAAQqJ,GACpD,GAAIe,GAASA,EAAMG,EAAG,CACrB,GAAIR,GAASjN,IAAIsN,GAAQ,OACzBL,GAAST,IAAIc,GACbN,GAAO/L,EAAEqJ,MAAK,WACb2C,GAAe,OAACK,GACZf,IACCrJ,GAAQoK,EAAM9J,EAAE,GACpB+I,IAEJ,IACEe,EAAMG,EAAEF,EACR,MAAUhB,GACVA,GAEF,CAKA,IAAMmB,GAAkB,CAAE1F,SAAU,GA+K7B,SAAS2F,GAAgClM,EAAMvE,EAAI0Q,EAAQC,GAGjE,IAcIC,EAbAC,EAAS7Q,EAAGuE,EAAMmM,EADN,CAAEf,UAAW,SAEzBvE,EAAIuF,EAAQ,EAAI,EAIhBG,EAAkB,KAIlBC,EAAkB,KAClBC,EAAiB,KAOrB,SAASC,IACJD,GAAgB5E,GAAY7H,EAAMyM,EACtC,CAOD,SAASE,EAAKC,EAASrG,GACtB,IAAMxE,EAAiC6K,EAAQxQ,EAAIyK,EAEnD,OADAN,GAAYnJ,KAAKyP,IAAI9K,GACd,CACN5F,EAAG0K,EACHzK,EAAGwQ,EAAQxQ,EACX2F,EAAAA,EACAwE,SAAAA,EACAuG,MAAOF,EAAQE,MACfC,IAAKH,EAAQE,MAAQvG,EACrByG,MAAOJ,EAAQI,MAEhB,CAMD,SAASC,EAAG7Q,GACX,INpSmB0O,EMoSnBoC,EAMIZ,GAAUL,GAAekB,EAAAD,EAL5B1G,MAAAA,OAAK,IAAA2G,EAAG,EAACA,EAAAC,EAAAF,EACT3G,SAAAA,OAAW,IAAH6G,EAAG,IAAGA,EAAAC,EAAAH,EACdI,OAAAA,OAAM,IAAAD,EAAGE,GAAMF,EAAAG,EAAAN,EACf9C,KAAAA,OAAOnP,IAAHuS,EAAGvS,GAAIuS,EACXC,EAAGP,EAAHO,IAKKb,EAAU,CACfE,MAAO/N,KAAQyH,EACfpK,EAAAA,GAGIA,IAEJwQ,EAAQI,MAAQzB,GAChBA,GAAOG,GAAK,GAGT,UAAW1L,IACV5D,OAC0Ba,IAAzBoP,IAEHrM,EAAK0N,MAAQrB,IAGdA,EAAmDrM,EAAM0N,MACzD1N,EAAK0N,OAAQ,IAIXnB,GAAmBC,EACtBA,EAAkBI,GAIda,IACHf,IACAD,EAAiBnG,GAAYtG,EAAM6G,EAAGzK,EAAGmK,EAAUC,EAAO8G,EAAQG,IAE/DrR,GAAGgO,EAAK,EAAG,GACfmC,EAAkBI,EAAKC,EAASrG,GAChC8D,IAAoB,WAAM,OAAAc,GAASnL,EAAM5D,EAAG,YNhV1B0O,EMiVb,SAAC/L,GAkBL,GAjBIyN,GAAmBzN,EAAMyN,EAAgBM,QAC5CP,EAAkBI,EAAKH,EAAiBjG,GACxCiG,EAAkB,KAClBrB,GAASnL,EAAMuM,EAAgBnQ,EAAG,SAC9BqR,IACHf,IACAD,EAAiBnG,GAChBtG,EACA6G,EACA0F,EAAgBnQ,EAChBmQ,EAAgBhG,SAChB,EACA+G,EACAhB,EAAOmB,OAINlB,EACH,GAAIxN,GAAOwN,EAAgBQ,IAC1B3C,EAAMvD,EAAI0F,EAAgBnQ,EAAI,EAAIyK,GAClCsE,GAASnL,EAAMuM,EAAgBnQ,EAAG,OAC7BoQ,IAEAD,EAAgBnQ,EAEnBsQ,MAGOH,EAAgBS,MAAMtB,GAAG7P,GAAQ0Q,EAAgBS,MAAMxN,IAGhE+M,EAAkB,UACRxN,GAAAA,GAAOwN,EAAgBO,MAAO,CACxC,IAAMhP,EAAIiB,EAAMwN,EAAgBO,MAChCjG,EAAI0F,EAAgBpQ,EAAIoQ,EAAgBxK,EAAIuL,EAAOxP,EAAIyO,EAAgBhG,UACvE6D,EAAKvD,EAAG,EAAIA,EACZ,CAEF,SAAU0F,IAAmBC,EACjC,ENtXoB,IAAfnN,GAAMK,MAAYR,GAAII,IAEhB,IAAIwK,SAAQ,SAAC6D,GACrBtO,GAAM0L,IAAY,CAAEvL,EAAGsL,EAAUrL,EAAGkO,GACvC,IMoXE,CACD,MAAO,CACNnS,IAAG,SAACY,GACCJ,GAAYsQ,IA9Yb/B,KACJA,GAAUT,QAAQC,WACVG,MAAK,WACZK,GAAU,IACb,IAEQA,IAyYGL,MAAK,WAGXoC,EAASA,EAFI,CAAElB,UAAWhP,EAAI,KAAO,QAGrC6Q,EAAG7Q,EACR,IAEI6Q,EAAG7Q,EAEJ,EACD2Q,eACCL,IACAH,EAAkBC,EAAkB,IACpC,EAEH,CCzaO,SAASoB,GAAkBC,GACjC,YAA0C5Q,KAAnC4Q,aAAAA,EAAAA,EAAwBvQ,QAC5BuQ,EACAC,MAAMC,KAAKF,EACf,CAKO,SAASG,GAAcnC,EAAOoC,GACpCpC,EAAM9J,EAAE,GACRkM,EAAa,OAACpC,EAAM7H,IACrB,CAGO,SAASkK,GAAwBrC,EAAOoC,GAC9ClC,GAAeF,EAAO,EAAG,GAAG,WAC3BoC,EAAM,OAAQpC,EAAM7H,IACtB,GACA,CAeO,SAASmK,GACfC,EACArR,EACAsR,EACAC,EACA7R,EACA8R,EACAN,EACAjO,EACApB,EACA4P,EACAxG,EACAyG,GAMA,IAJA,IAAIzC,EAAIoC,EAAW9Q,OACfoR,EAAIH,EAAKjR,OACTC,EAAIyO,EACF2C,EAAc,CAAA,EACbpR,KAAKoR,EAAYP,EAAW7Q,GAAGyG,KAAOzG,EAC7C,IAAMqR,EAAa,GACbC,EAAa,IAAIzI,IACjB0I,EAAS,IAAI1I,IACb2I,EAAU,GAChBxR,EAAImR,EACJ,IADM,IAAAM,EAAA,WAEL,IAAMC,EAAYR,EAAYhS,EAAK8R,EAAMhR,GACnCyG,EAAMqK,EAAQY,GAChBpD,EAAQoC,EAAO5G,IAAIrD,GAClB6H,EAGMyC,GAEVS,EAAQlG,MAAK,kBAAMgD,EAAM/N,EAAEmR,EAAWlS,EAAM,KAJ5C8O,EAAQ2C,EAAkBxK,EAAKiL,IACzBzP,IAKPqP,EAAW3K,IAAIF,EAAM4K,EAAWrR,GAAKsO,GACjC7H,KAAO2K,GAAaG,EAAO5K,IAAIF,EAAK5G,KAAKyP,IAAItP,EAAIoR,EAAY3K,IACjE,EAbMzG,KAAGyR,IAcV,IAAME,EAAY,IAAI5Q,IAChB6Q,EAAW,IAAI7Q,IAErB,SAASgD,EAAOuK,GACfD,GAAcC,EAAO,GACrBA,EAAMuD,EAAEpP,EAAMgI,GACdiG,EAAO/J,IAAI2H,EAAM7H,IAAK6H,GACtB7D,EAAO6D,EAAMwD,MACbX,GACA,CACD,KAAO1C,GAAK0C,GAAG,CACd,IAAMY,EAAYV,EAAWF,EAAI,GAC3Ba,EAAYnB,EAAWpC,EAAI,GAC3BwD,EAAUF,EAAUtL,IACpByL,EAAUF,EAAUvL,IACtBsL,IAAcC,GAEjBvH,EAAOsH,EAAUD,MACjBrD,IACA0C,KACWG,EAAWtQ,IAAIkR,IAIfxB,EAAO1P,IAAIiR,IAAYN,EAAU3Q,IAAIiR,GAChDlO,EAAOgO,GACGH,EAAS5Q,IAAIkR,GACvBzD,IACU8C,EAAOzH,IAAImI,GAAWV,EAAOzH,IAAIoI,IAC3CN,EAASpE,IAAIyE,GACblO,EAAOgO,KAEPJ,EAAUnE,IAAI0E,GACdzD,MAXApN,EAAQ2Q,EAAWtB,GACnBjC,IAYD,CACD,KAAOA,KAAK,CACX,IAAMuD,EAAYnB,EAAWpC,GACxB6C,EAAWtQ,IAAIgR,EAAUvL,MAAMpF,EAAQ2Q,EAAWtB,EACvD,CACD,KAAOS,GAAGpN,EAAOsN,EAAWF,EAAI,IAEhC,OADA7S,GAAQkT,GACDH,CACR,CCvHO,SAASc,GAAkBC,EAAQZ,GAKzC,IAJA,IAAMpE,EAAS,CAAA,EACTiF,EAAc,CAAA,EACdC,EAAgB,CAAEnT,QAAS,GAC7Ba,EAAIoS,EAAOrS,OACRC,KAAK,CACX,IAAMyO,EAAI2D,EAAOpS,GACXmR,EAAIK,EAAQxR,GAClB,GAAImR,EAAG,CACN,IAAK,IAAM1K,KAAOgI,EACXhI,KAAO0K,IAAIkB,EAAY5L,GAAO,GAErC,IAAK,IAAMA,KAAO0K,EACZmB,EAAc7L,KAClB2G,EAAO3G,GAAO0K,EAAE1K,GAChB6L,EAAc7L,GAAO,GAGvB2L,EAAOpS,GAAKmR,CACf,MACG,IAAK,IAAM1K,KAAOgI,EACjB6D,EAAc7L,GAAO,CAGvB,CACD,IAAK,IAAMA,KAAO4L,EACX5L,KAAO2G,IAASA,EAAO3G,QAAO/G,GAErC,OAAO0N,CACR,CAEO,SAASmF,GAAkBC,GACjC,MAA+B,WAAxB1T,EAAO0T,IAA8C,OAAjBA,EAAwBA,EAAe,EACnF,CCZO,SAASC,GAAK/J,EAAWjE,EAAM8I,GACrC,IAAMmF,EAAQhK,EAAU0C,GAAG1K,MAAM+D,QACnB/E,IAAVgT,IACHhK,EAAU0C,GAAGuH,MAAMD,GAASnF,EAC5BA,EAAS7E,EAAU0C,GAAGlM,IAAIwT,IAE5B,CAGO,SAASE,GAAiBtE,GAChCA,GAASA,EAAMrM,GAChB,CAQO,SAAS4Q,GAAgBnK,EAAWlG,EAAQwB,GAClD,IAAA8O,EAAmCpK,EAAU0C,GAArCqC,EAAQqF,EAARrF,SAAUE,EAAYmF,EAAZnF,aAClBF,GAAYA,EAASoE,EAAErP,EAAQwB,GAE/B8I,IAAoB,WACnB,IAI6BiG,EAJvBC,EAAiBtK,EAAU0C,GAAGC,SAAS4H,IAAIhV,IAAKyM,OAAOjM,IAIzDiK,EAAU0C,GAAGI,YAChBuH,EAAArK,EAAU0C,GAAGI,YAAWF,KAAI4H,MAAAH,EAAAI,EAAIH,IAIhC1U,GAAQ0U,GAETtK,EAAU0C,GAAGC,SAAW,EAC1B,IACCsC,EAAanP,QAAQsO,GACtB,CAGO,SAASsG,GAAkB1K,EAAWnE,GAC5C,IJgEsChG,EAChC8U,EACAC,EIlEAlI,EAAK1C,EAAU0C,GACD,OAAhBA,EAAGqC,WJ+D+BlP,EI9Dd6M,EAAGuC,aJ+DrB0F,EAAW,GACXC,EAAU,GAChBlH,GAAiB5N,SAAQ,SAACyD,GAAO,OAAoB,IAApB1D,EAAIqI,QAAQ3E,GAAYoR,EAAS/H,KAAKrJ,GAAKqR,EAAQhI,KAAKrJ,MACzFqR,EAAQ9U,SAAQ,SAACyD,UAAMA,OACvBmK,GAAmBiH,EIlElB/U,GAAQ8M,EAAGI,YACXJ,EAAGqC,UAAYrC,EAAGqC,SAASjJ,EAAED,GAG7B6G,EAAGI,WAAaJ,EAAGqC,SAAW,KAC9BrC,EAAGlM,IAAM,GAEX,CAuBO,SAASkQ,GACf1G,EACArD,EACAkO,EACAC,EACAzU,EACA2B,GACA,IAAAiC,EAAawF,UAAApI,OAAAoI,QAAAzI,IAAAyI,aAAAA,UAAA,GAAG,KAChB3I,EAAK2I,UAAApI,OAAA,QAAAL,IAAAyI,UAAA,GAAAA,UAAG,GAAA,EAAE,GAEJsL,EAAmB9K,GACzBqC,GAAsBtC,GAEtB,IAAM0C,EAAM1C,EAAU0C,GAAK,CAC1BqC,SAAU,KACVvO,IAAK,GAELwB,MAAAA,EACA0M,OAAQ1P,GACRqB,UAAAA,EACA4T,MAAOxU,KAEPkN,SAAU,GACVG,WAAY,GACZkI,cAAe,GACfhG,cAAe,GACfC,aAAc,GACd7B,QAAS,IAAIjD,IAAIxD,EAAQyG,UAAY2H,EAAmBA,EAAiBrI,GAAGU,QAAU,KAEtFH,UAAWxN,KACXqB,MAAAA,EACAmU,YAAY,EACZpQ,KAAM8B,EAAQ7C,QAAUiR,EAAiBrI,GAAG7H,MAE7CZ,GAAiBA,EAAcyI,EAAG7H,MAClC,IAAIqQ,GAAQ,EAgBZ,GAfAxI,EAAGlM,IAAMqU,EACNA,EAAS7K,EAAWrD,EAAQ3E,OAAS,CAAE,GAAE,SAACV,EAAG6T,GAC7C,IAAM3S,IAAQiH,UAAApI,QAAAoI,IAAAA,UAAApI,SAAAoI,UAAApI,QAAAL,OAAAA,EAAAyI,UAAA,GAAwB0L,EAKtC,OAJIzI,EAAGlM,KAAOH,EAAUqM,EAAGlM,IAAIc,GAAKoL,EAAGlM,IAAIc,GAAKkB,MAC1CkK,EAAGuI,YAAcvI,EAAGuH,MAAM3S,IAAIoL,EAAGuH,MAAM3S,GAAGkB,GAC3C0S,GA7DT,SAAoBlL,EAAW1I,IACC,IAA3B0I,EAAU0C,GAAG5L,MAAM,KACtB0M,GAAiBZ,KAAK5C,GACtBgE,KACAhE,EAAU0C,GAAG5L,MAAMsU,KAAK,IAEzBpL,EAAU0C,GAAG5L,MAAOQ,EAAI,GAAM,IAAM,GAAKA,EAAI,EAC9C,CAsDgB+T,CAAWrL,EAAW1I,IAE3B6T,CACX,IACI,GACHzI,EAAGgC,SACHwG,GAAQ,EACRtV,GAAQ8M,EAAGsC,eAEXtC,EAAGqC,WAAW+F,GAAkBA,EAAgBpI,EAAGlM,KAC/CmG,EAAQ7C,OAAQ,CACnB,GAAI6C,EAAQ2O,QAAS,CAIpB,IAAMC,EP4cF,SAAkB/Q,GACxB,OAAOqN,MAAMC,KAAKtN,EAAQgR,WAC3B,CO9ciBC,CAAS9O,EAAQ7C,QAC/B4I,EAAGqC,UAAYrC,EAAGqC,SAAS2G,EAAEH,GAC7BA,EAAMzV,QAAQ0F,GACjB,MAEGkH,EAAGqC,UAAYrC,EAAGqC,SAASxL,IAExBoD,EAAQwJ,OAAOR,GAAc3F,EAAU0C,GAAGqC,UAC9CoF,GAAgBnK,EAAWrD,EAAQ7C,OAAQ6C,EAAQrB,QAEnD4I,IACA,CACD5B,GAAsByI,EACvB,CA6RA,IAMaY,GAAe,WAgBV,OAAAC,GAhBU,SAAAD,IAAAE,EAAAF,KAAAA,GAC5BG,EAOM9U,KAAAA,UAAAA,GACN8U,EAAA7O,KAAA,aAOSjG,EAAS,GAAA,CAAA,CAAA+G,IAAA,WAAAvF,MAGjB,WACCkS,GAAkBzN,KAAM,GACxBA,KAAK8O,SAAW/W,EAChB,IAEF+I,IAAA,MAAAvF,MAMC,SAAI8G,EAAMuF,GACT,IAAK9O,GAAY8O,GAChB,OAAO7P,GAER,IAAMiO,EAAYhG,KAAKyF,GAAGO,UAAU3D,KAAUrC,KAAKyF,GAAGO,UAAU3D,GAAQ,IAExE,OADA2D,EAAUL,KAAKiC,cAEd,IAAMmF,EAAQ/G,EAAU/E,QAAQ2G,IACjB,IAAXmF,GAAc/G,EAAU+I,OAAOhC,EAAO,EAC7C,CACE,GAEF,CAAAjM,IAAAvF,OAAAA,MAIC,SAAKR,GX/XC,IAAkBiU,EWgYnBhP,KAAKiP,QXhYcD,EWgYKjU,EX/XM,IAA5BtC,OAAOyC,KAAK8T,GAAK5U,UWgYtB4F,KAAKyF,GAAGuI,YAAa,EACrBhO,KAAKiP,MAAMlU,GACXiF,KAAKyF,GAAGuI,YAAa,EAEtB,IAGF,CAvD4B,GC9atB,SAAUkB,GACdC,GACA,IAAAC,EAAO5M,UAAApI,OAAAoI,QAAAzI,IAAAyI,aAAAA,UAAA,GAaT,SAAqB2M,GACnB,IAAME,EAYR,SAA6BvO,GAC3B,IACE,GAAsB,oBAAXlF,aAAyD,IAAxBA,OAAO0T,aAEjD,OAAO1T,OAAO0T,aAAaxO,EAE9B,CAAC,MAAOyO,IAGX,CArBgBC,CAAoB,SAElC,OAAOH,SAAAA,EAAOI,SAAS,KAAON,EAAUO,WAAWL,EAAM1V,MAAM,GAAI,IAAMwV,IAAcE,CACzF,CAjBYM,CAAYR,GAEtB,IAAKC,EACH,OAAOrX,GAGT,IAAM6X,EAuCR,SAAqBT,GAGnB,IAFA,IAAIpL,EAAO,EAEF1J,EAAI,EAAGA,EAAI8U,EAAU/U,OAAQC,IACpC0J,GAAQA,GAAQ,GAAKA,EAAOoL,EAAUnL,WAAW3J,GACjD0J,GAAQ,EAGV,OAAO8L,GAAO3V,KAAKyP,IAAI5F,GAAQ8L,GAAOzV,OACxC,CAhDgB0V,CAAYX,GAE1B,OAAO,WAAsBY,IAAA,IAAAC,EAAAD,EAAAvN,UAAApI,OAAJ6V,EAAIrF,IAAAA,MAAAmF,GAAAG,EAAA,EAAAA,EAAAH,EAAAG,IAAJD,EAAIC,GAAA1N,UAAA0N,IAC3BF,EAAAG,SAAQC,IAAG7C,MAAAyC,EAAApM,CAAAA,KAAAA,OAAMuL,GAAS,SAAAvL,OAAagM,IAAKhM,OAAOqM,GACrD,CACF,CAQA,SAASlY,MC9Ca,oBAAX6D,SAETA,OAAOyU,WAAazU,OAAOyU,SAAW,CAAEC,EAAG,IAAIlV,OAAUkV,EAAEzI,ICK/B,KF4E9B,IAAMgI,GAAS,CACb,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WG7DK,SAASU,GAAKzT,GAA2D0T,IAAAA,EAAAhO,UAAApI,OAAAoI,QAAAzI,IAAAyI,UAAAzI,GAAAyI,UAAJ,GAAA,GAAEiO,EAAAD,EAAjDlN,MAAAA,OAAQ,IAAHmN,EAAG,EAACA,EAAAC,EAAAF,EAAEnN,SAAAA,WAAQqN,EAAG,IAAGA,EAAAC,EAAAH,EAAEpG,OAAAA,OAAM,IAAAuG,EAAGtG,GAAMsG,EAChE7H,GAAK8H,iBAAiB9T,GAAM+T,QAClC,MAAO,CACNvN,MAAAA,EACAD,SAAAA,EACA+G,OAAAA,EACAG,IAAK,SAAC5G,qBAACC,OAAiBD,EAAImF,EAAC,EAE/B,0iECycagI,EAAAvX,KAAMwX,aAAWC,GAAAzX,KAmBIA,EAAS,6HAJ1B4G,GAAA8Q,EAAA,QAAAC,EAAA5V,GAAA/B,KAAM4X,cAAY,+BAElB5X,EAAU,oBADDA,EAAQ,IA9BnB4G,GAAAiR,EAAA,QAAAC,EAAA/V,GAAA/B,KAAM+X,aAAW,kEAIZnR,GAAAiR,EAAA,aAAAG,EAAAhY,KAAMiY,eAAiB,KAAOjY,EAAK,GAACkY,WAAa,+BAC5ClY,EAAK,GAACiY,gBAAkB,mBAOlCjY,EAAS,mBAXDA,EAAQ,IAPlB4G,GAAAuR,EAAA,QAAAC,EAAArW,GAAA/B,KAAMqY,iBAAe,+BAGrBrY,EAAa,iBAFPA,EAAQ,+BAXnB4G,GAAA0R,EAAA,KAAAC,EAAAvY,KAAMiE,IACH2C,GAAA0R,EAAA,QAAAE,EAAAzW,GAAA/B,KAAMyY,SAAO,+BAMbzY,EAAK,eALDA,EAAQ,qBAJrB6E,GAuDKvB,EAAAgV,EAAAxT,GA5CHzB,GA2CKiV,EAAAH,GArCH9U,GAoCK8U,EAAAN,0BAPHxU,GAMKwU,EAAAH,wFA1BUnY,GAAAS,QAAAA,EAAM,IAAAgU,MAAAvN,KAAAwC,4CACN1J,GAAAS,QAAAA,EAAO,IAAAgU,MAAAvN,KAAAwC,0CACT1J,GAAAS,QAAAA,EAAQ,IAAAgU,MAAAvN,KAAAwC,0CACR1J,GAAAS,QAAAA,EAAQ,IAAAgU,MAAAvN,KAAAwC,+BAxBXjJ,EAAoB,oBACtBA,EAAkB,yCA0BfwX,uIAmBexX,EAAS,IAAA,gJAJ1B0Y,GAAA,EAAApY,EAAA,IAAAqX,KAAAA,EAAA5V,GAAA/B,KAAM4X,cAAY,iEAElB5X,EAAU,kCADDA,EAAQ,MA9BnB0Y,GAAA,EAAApY,EAAA,IAAAwX,KAAAA,EAAA/V,GAAA/B,KAAM+X,aAAW,sCAIZW,GAAA,EAAApY,EAAA,IAAA0X,KAAAA,EAAAhY,KAAMiY,eAAiB,KAAOjY,EAAK,GAACkY,WAAa,iDAC5ClY,EAAK,GAACiY,gBAAkB,+DAOlCjY,EAAS,iCAXDA,EAAQ,MAPlB0Y,GAAA,EAAApY,EAAA,IAAA8X,KAAAA,EAAArW,GAAA/B,KAAMqY,iBAAe,iEAGrBrY,EAAa,+BAFPA,EAAQ,MAXnB0Y,GAAA,EAAApY,EAAA,IAAAiY,KAAAA,EAAAvY,KAAMiE,qBACHyU,GAAA,EAAApY,EAAA,IAAAkY,KAAAA,EAAAzW,GAAA/B,KAAMyY,SAAO,gEAMbzY,EAAK,6BALDA,EAAQ,0EAqBqB2Y,IAAAA,EAAAlJ,GAAAoI,EAAA7X,EAAA,IAAAA,KAAM4Y,uBAAqB,uCAjBnCC,IAAAA,EAAApJ,GAAA6I,EAAAtY,EAAA,IAAAA,KAAM8Y,mBAAiB,uEAiBfH,IAAAA,EAAAlJ,GAAAoI,EAAA7X,EAAA,IAAAA,KAAM4Y,uBAAqB,kBAjBnCC,IAAAA,EAAApJ,GAAA6I,EAAAtY,EAAA,IAAAA,KAAM8Y,mBAAiB,4OAyB5C9Y,EAAU,IAACA,EAAK,GAACwX,ubAIX5Q,kBAAA,QAAAmS,EAAAhX,GAAA/B,KAAMgZ,kBAAgB,gEAItBhZ,EAAc,yCAHPA,EAAQ,qBAFxB6E,GAOCvB,EAAA2V,EAAAnU,sBAHW9E,EAAK,4BAHR,EAAAM,EAAA,IAAAyY,KAAAA,EAAAhX,GAAA/B,KAAMgZ,kBAAgB,2DAItBhZ,EAAc,2BAHPA,EAAQ,0EAJAkZ,EAAAlZ,KAAMwX,kDAAsBxX,EAAK,uIAAjC,GAAA,EAAAM,EAAA,IAAA4Y,KAAAA,EAAAlZ,KAAMwX,aAAW,sTAnChDxX,EAAS,IAAAmZ,GAAAnZ,mKAFaA,EAAa,4BAEnCA,EAAS,kVA9bIuT,GAAK6F,OAAW5X,EAAKyH,UAAApI,OAAAoI,QAAAzI,IAAAyI,UAAAzI,GAAAyI,UAAA,GAAA,GACnB,OAAA,SAAe9C,cAClBiT,EAASC,EAAAA,EAAA,CAAA,EACflT,GAAO,CAAA,EAAA,CACV3E,MAAK6X,EAAAA,EAAA,CAAA,EACA7X,GACA2E,EAAQ3E,kCA8Nf8X,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,4CAhOE1L,EAAWnC,KAEX8N,EAAiBC,GAmBZC,EAA2BC,EAA3BC,WAAAA,OAAU,IAAAF,EAdG,SAAAhX,GAAI,OAC1BA,EAAKmX,UAAY,IAChBnX,EAAKoX,SACLpX,EAAKqX,UACiB,SAAvBrX,EAAKQ,MAAM8W,SACG,WAAdtX,EAAKuF,MACLgS,QACEvX,EAAKwX,aAAexX,EAAKyX,cAAgBzX,EAAK0X,iBAAiBpa,OAOxD,EAA2B0Z,EAM3BW,EAAWV,EAAXW,KAAAA,OAAO,IAAHD,EAAG,KAAIA,EAMXE,EAASZ,EAATvW,GAAAA,OAAE,IAAAmX,EAAG,KAAIA,EAMTC,EAAoBb,EAApBjT,IAAAA,OAAM,IAAH8T,EAAG,eAAcA,EAOpBC,EAAgBd,EAAhBtC,UAAAA,OAAS,IAAAoD,EAAG,KAAIA,EAOhBC,EAAqBf,EAArBvC,eAAAA,WAAcsD,EAAG,KAAIA,EAMrBC,EAAkBhB,EAAlBhD,YAAAA,OAAc,IAAHgE,GAAOA,EAMlBC,EAAiBjB,EAAjBkB,WAAAA,OAAU,IAAAD,GAAOA,EAMjBE,EAAwBnB,EAAxBoB,kBAAAA,OAAoB,IAAHD,GAAOA,IAMjBnB,EAAPqB,QAAAA,OAAO,IAAAC,EAAA,GAAAA,IAMQtB,EAAfuB,gBAAAA,OAAe,IAAAC,EAAA,GAAAA,IAMJxB,EAAXyB,YAAAA,OAAW,IAAAC,EAAA,GAAAA,IAMC1B,EAAZ2B,aAAAA,OAAY,IAAAC,EAAA,GAAAA,IAMI5B,EAAhB6B,iBAAAA,OAAgB,IAAAC,EAAA,GAAAA,EAMhBC,EAAc/B,EAAd/B,QAAAA,WAAO8D,EAAG,KAAIA,EAMdC,GAAsBhC,EAAtBnC,gBAAAA,QAAkB,IAAHmE,GAAG,KAAIA,GAMtBC,GAAkBjC,EAAlBzC,YAAAA,QAAW,IAAA0E,GAAG,KAAIA,GAMlBC,GAAmBlC,EAAnB5C,aAAAA,QAAe,IAAH8E,GAAG,KAAIA,GAMnBC,GAAuBnC,EAAvBxB,iBAAAA,QAAgB,IAAA2D,GAAG,KAAIA,GAMvBC,GAAgBpC,EAAhBqC,SAAAA,QAAW,IAAHD,IAAQA,GAUhBE,GAA2BtC,aAA3B7N,QAAU,IAAAmQ,GAAGzC,EAAcyC,GAO3BC,GAAmBvC,EAAnBwC,aAAAA,YAAYD,GAAG/F,GAAI+F,MAMgBvC,EAAnC1B,kBAAAA,QAAiB,IAAAmE,GAAA,CAAKnT,SAAU,KAAGmT,GAOnCC,GAA+B1C,EAA/B2C,iBAAAA,QAAgB,IAAAD,GAAGF,GAAYE,GAM/BE,GAAyC5C,EAAzC5B,sBAAAA,QAAwBE,IAAHsE,GAAGtE,GAAiBsE,GAMzCC,GAAwB7C,EAAxB8C,iBAAAA,YAAgBD,IAAQA,GAE7BE,GAAY,CAChBtZ,GAAAA,EACAiU,UAAAA,EACAD,eAAAA,EACAT,YAAAA,EACAkE,WAAAA,EACAE,kBAAAA,EACAC,QAAAA,EACAE,gBAAAA,EACAE,YAAAA,EACAE,aAAAA,EACAE,iBAAAA,EACA5D,QAAAA,EACAJ,gBAAAA,GACAN,YAAAA,GACAH,aAAAA,GACAoB,iBAAAA,GACAgE,aAAAA,GACAlE,kBAAAA,GACAqE,iBAAAA,GACAvE,sBAAAA,GACA0E,iBAAAA,GACA7C,WAAAA,EACAoC,SAAAA,IAEEW,GAAKnE,EAAQkE,CAAAA,EAAAA,IAEbnE,GAAY,KAqBVqE,GAAe,SAAAjc,GAAK,OACxBA,EACItC,OAAOyC,KAAKH,GAAOkc,QAAM,SACtBnT,EAAKhD,GAAG8C,MAAAA,GAAAA,OAAQE,QAAGF,OANH,SAAAE,GACvB,OAAAA,EAAIoT,QAAQ,uBAAwB,OAAOC,cAKZC,CAAgBtW,gBAAS/F,EAAM+F,MACxD,IAEF,EAAE,EAEFuW,GAAc,SAAA9a,GAAC,SAAQA,GAAKA,EAAE+a,aAAe/a,EAAEwD,MAAQxD,EAAEgR,QAqBzDgK,GAAM,aACRC,GAASD,GACTE,GAAUF,GACVG,GAAWH,GACXI,GAAWJ,GAQTK,YAAQC,GAAoD,IAAvBnY,EAAO8C,UAAApI,OAAAoI,QAAAzI,IAAAyI,UAAAzI,GAAAyI,gBAAOwD,EAASxD,UAAApI,OAAAoI,QAAAzI,IAAAyI,UAAAzI,GAAAyI,UAAA,GAAA,GAChEsV,EAAA,EAAAnF,GAAY7F,GAAK+K,EADiBrV,UAAApI,OAAA,QAAAL,IAAAyI,UAAA,GAAAA,UAAA,GAAO,CAAA,QAEzCuU,GAAKnE,EAAAA,EAAQkE,CAAAA,EAAAA,IAAiBpX,IAhC9BoY,EAAA,EAAA7E,EAAQ+D,GACNve,OAAOP,WAGH6f,MAAOnc,OAAOoc,WACdC,OAAQrc,OAAOsc,aAEjBnB,GAAM3B,WAGV0C,EAAA,EAAA5E,EAAgB8D,GAAYD,GAAMzB,kBAClCwC,EAAA,EAAA3E,EAAY6D,GAAYD,GAAMvB,cAC9BsC,EAAA,EAAA1E,EAAa4D,GAAYD,GAAMrB,eAC/BoC,EAAA,GAAAzE,EAAiB2D,GAAYD,GAAMnB,wBACnCtC,EAAsByD,GAAMR,mBAC5BhD,EAA0BwD,GAAML,kBAmBhCyB,KACAL,EAAA,GAAAN,GAAU,SAAAhY,GACJwG,EAAUwR,QAAQxR,EAAUwR,OAAOhY,GAKvCyI,EAAS,QAMTA,EAAS,aAEX6P,EAAA,GAAAL,GAAW,SAAAjY,GACLwG,EAAUyR,SAASzR,EAAUyR,QAAQjY,GAKzCyI,EAAS,SAMTA,EAAS,aAEX6P,EAAA,GAAAJ,GAAY,SAAAlY,GACNwG,EAAU0R,UAAU1R,EAAU0R,SAASlY,GAK3CyI,EAAS,YAEX6P,EAAA,GAAAH,GAAY,SAAAnY,GACNwG,EAAU2R,UAAU3R,EAAU2R,SAASnY,GAK3CyI,EAAS,aAUPmQ,cAAS,IAAApS,EAASxD,UAAApI,OAAA,QAAAL,IAAAyI,UAAA,GAAAA,UAAA,GAAA,GACjBmQ,KACLmF,EAAA,GAAAL,GAAUzR,EAAUyR,SAAWA,IAC/BK,EAAA,GAAAH,GAAW3R,EAAU2R,UAAYA,IACjCG,EAAA,EAAAnF,GAAY,MACZ0F,OA0CIF,GAAa,WACjBnF,EAAUpX,OAAOoX,QACjBQ,EAAmB7V,SAAS2a,KAAKhb,MAAMib,SACvC9E,EAAmB9V,SAAS2a,KAAKhb,MAAMkb,SACvC9E,EAAgB/V,SAAS2a,KAAKhb,MAAMya,MACpCpa,SAAS2a,KAAKhb,MAAMib,SAAW,QAC/B5a,SAAS2a,KAAKhb,MAAMmb,IAAG7U,IAAAA,OAAOoP,EAAO,MACrCrV,SAAS2a,KAAKhb,MAAMkb,SAAW,SAC/B7a,SAAS2a,KAAKhb,MAAMya,MAAQ,QAGxBM,GAAY,WAChB1a,SAAS2a,KAAKhb,MAAMib,SAAW/E,GAAoB,GACnD7V,SAAS2a,KAAKhb,MAAMmb,IAAM,GAC1B9a,SAAS2a,KAAKhb,MAAMkb,SAAW/E,GAAoB,GACnD9V,SAAS2a,KAAKhb,MAAMya,MAAQrE,GAAiB,GAC7C9X,OAAO8c,SAAQ,CACbD,IAAKzF,EACL2F,KAAM,EACNC,SAAU,aAUd1S,GAAWpF,EAFE,CAAK8W,KAAAA,GAAMQ,MAAAA,KAIpB,IAAAS,IAAY,SAYhBC,IAAgB,WACVD,IAAWT,QAGjBW,IAAc,WACZjB,EAAA,GAAAe,IAAY,ktCAdRA,KACExB,GAAW3C,GACbkD,GAAKlD,GAEL0D,uDA7EiB,SAAA5Y,MACjBuX,GAAM9B,YAActC,IAA2B,WAAdnT,EAAMsB,MACzCtB,EAAMM,iBACNsY,MAGEzF,IAA2B,QAAdnT,EAAMsB,MAAkBiW,GAAMF,iBAAgB,CAEvD,IAAAvI,EAAQyE,EAAYiG,iBAAiB,KACrCC,EAAWrO,MAAMC,KAAKyD,GACzBvJ,OAAOgS,GAAM/C,YACbkF,MAAI,SAAEjgB,EAAGC,GAAM,OAAAD,EAAEgb,SAAW/a,EAAE+a,QAAQ,IAErClH,EAAQkM,EAAShY,QAAQtD,SAASwb,gBACvB,IAAXpM,GAAgBvN,EAAM4Z,WAAUrM,EAAQ,GAE5CA,GAASkM,EAAS7e,QAAUoF,EAAM4Z,UAAY,EAAI,GAGlDH,EAFAlM,GAASkM,EAAS7e,QAEFif,QAChB7Z,EAAMM,mBAIoB,SAAAN,IAE1BuX,GAAM5B,mBACL3V,EAAM3C,SAAWgW,GAAcrT,EAAM3C,SAAWiW,IAEjDa,EAAmBnU,EAAM3C,SAGD,SAAA2C,GACtBuX,GAAM5B,mBAAqB3V,EAAM3C,SAAW8W,IAC9CnU,EAAMM,iBACNsY,6HAmFarF,EAAWuG,0DAVbxG,EAAIwG,0DAPNzG,EAAUyG,YCpbbC,GAMAC,GASAC,GA8IAC,GAyIAC,GAwQAC,GAKAC,ihBAnjBZ,SAAYN,GACVA,EAAA,KAAA,OACAA,EAAA,KAAA,OACAA,EAAA,MAAA,OACD,CAJD,CAAYA,KAAAA,GAIX,CAAA,IAED,SAAYC,GACVA,EAAA,MAAA,QACAA,EAAA,OAAA,SACAA,EAAA,IAAA,MACAA,EAAA,MAAA,QACAA,EAAA,MAAA,QACAA,EAAa,KAAA,MACd,CAPD,CAAYA,KAAAA,GAOX,CAAA,IAED,SAAYC,GACVA,EAAA,MAAA,QACAA,EAAA,IAAA,MACAA,EAAA,MAAA,QACAA,EAAA,OAAA,QACD,CALD,CAAYA,KAAAA,GAKX,CAAA,IAyID,SAAYC,GACVA,EAAA,KAAA,OACAA,EAAA,QAAA,UACAA,EAAA,MAAA,OACD,CAJD,CAAYA,KAAAA,GAIX,CAAA,IAqID,SAAYC,GACVA,EAAA,IAAA,MACAA,EAAA,MAAA,OACD,CAHD,CAAYA,KAAAA,GAGX,CAAA,IAqQD,SAAYC,GACVA,EAAA,IAAA,MACAA,EAAA,KAAA,MACD,CAHD,CAAYA,KAAAA,GAGX,CAAA,IAED,SAAYC,GACVA,EAAA,GAAA,KACAA,EAAA,KAAA,OACAA,EAAA,WAAA,YACD,CAJD,CAAYA,KAAAA,GAIX,CAAA,IC5lBM,IAGMC,GAAuB,GACvBC,GAAyB,IACzBC,GAA2B,IAC3BC,GAAyB,KACzBC,GAAqB,IACrBC,GAAqB,IACrBC,GAAwB,IACxBC,GAA8B,IAG9BC,GAAsC,CAAC,CAAE1Q,MAAO,EAAGC,IAAKsQ,KACxDI,GAAuB,UACvBC,GAA2B,QAC3BC,GAA8B,SAC9BC,GAA+B,MAE/BC,GAAuB,CAClC5J,aAAa,EACbiB,QAAS,eACTV,YAAa,mBACbM,gBAAiB,wBACjBT,aAAc,uBAGHyJ,GAAkBhI,EAAAA,EAAA,CAAA,EAC1B+H,IAAoB,CAAA,EAAA,CACvBrJ,YAAa,2CAGFuJ,GAAuBjI,EAAAA,EAC/B+H,CAAAA,EAAAA,IACHrJ,CAAAA,EAAAA,CAAAA,YAAa,gDAGFwJ,GAAwBlI,EAAAA,EAChC+H,CAAAA,EAAAA,IACHrJ,CAAAA,EAAAA,CAAAA,YAAa,iDAGFyJ,GACX,8HAKWC,GACX,yGAKWC,GAAsB,sBACtBC,GAAqB,qBACrBC,GAAmB,mBAEnBC,GAAoB,QACpBC,GAAyB,aAIzBC,GAAsB,IACtBC,GAAqB,IACrBC,GAAoB,IAEpBC,GAAoB5M,EAAAA,EAAA,CAAA,EAC9B+K,GAAc8B,IAAM,aACpB9B,GAAc+B,KAAO,cCxEpBne,GAAK,WAEOoe,KAEd,QADApe,EAEF,CCLM,SAAUqe,GAAItgB,GAClB,OAAOugB,SAASvgB,EAAO,GACzB,CASM,SAAUwgB,GAASxgB,GACvB,OAAOygB,GAAaC,KAAK1gB,EAC3B,CAEA,IAAMygB,GAAe,gDCPf,SAAUE,GAAS3gB,GAGvB,MACmB,WAAjBpC,EAAOoC,IACG,OAAVA,SACuBxB,IAAtBwB,EAAM+b,aAAwD,WAA3B/b,EAAM+b,YAAYxY,KAE1D,CAMM,SAAUqd,GAAgB5gB,GAG9B,MACmB,WAAjBpC,EAAOoC,IACG,OAAVA,SACuBxB,IAAtBwB,EAAM+b,aACsB,WAA3B/b,EAAM+b,YAAYxY,MACS,UAA3BvD,EAAM+b,YAAYxY,KAExB,CAeM,SAAUsd,GAAY7gB,GAG1B,GAAqB,iBAAVA,EACT,OACEA,EAJc,WAKd8gB,SAAS9gB,IACTrB,KAAKoiB,MAAM/gB,KAAWA,IACrBghB,MAAM,IAAIxgB,KAAKR,GAAOihB,WAI3B,GAAqB,iBAAVjhB,EACT,OAAO6gB,GAAYK,OAAOlhB,IAI5B,IACE,IAAMihB,EAAUjhB,EAAQA,EAAMihB,UAAYjhB,EAC1C,GAAIihB,IAAYjhB,EACd,OAAO6gB,GAAYI,EAEtB,CAAC,MAAOE,GACP,OAAY,CACb,CAED,OAAO,CACT,CAYM,SAAUC,GAAY/M,IAC1BgN,GAAeA,IAAgBhhB,OAAO+B,SAASoB,cAAc,QAEhDzB,MAAMsS,MAAQ,GAC3BgN,GAAatf,MAAMsS,MAAQA,EAE3B,IAAMiN,EAAUD,GAAatf,MAAMsS,MACnC,MAAmB,KAAZiN,EAAiBA,EAAQ3F,QAAQ,OAAQ,IAAIC,cAAgB,IACtE,CACA,IAAIyF,GAAsC,KAc1B,SAAAE,GAAUvhB,EAAgBwhB,GAExC,GACmB,iBAAVxhB,GACU,iBAAVA,GACU,kBAAVA,QACU,IAAVA,EAEP,OAAApC,EAAcoC,GAEhB,GAAqB,iBAAVA,EACT,MAAO,SAET,GAAc,OAAVA,EACF,MAAO,OAGT,GAAIqP,MAAMoS,QAAQzhB,GAChB,MAAO,QAET,GAAI2gB,GAAS3gB,GAEX,MAAO,SAIT,IAAM0hB,EAAWF,EAAOG,UAAU3hB,GAClC,OAAI0hB,GAAYlB,GAASkB,GAChB,SAEQ,SAAbA,GAAoC,UAAbA,EAClB,UAEQ,SAAbA,EACK,OAGF,SACT,CAMA,IAAME,GAAa,mBACb,SAAUC,GAAMle,GACpB,MAAuB,iBAATA,GAAqBie,GAAWlB,KAAK/c,EACrD,CAMgB,SAAAme,GAAcvZ,EAAaiZ,GACzC,GAAY,KAARjZ,EACF,MAAO,GAGT,IAAMwZ,EAAUxZ,EAAIyZ,OAEpB,MAAgB,SAAZD,EACK,KAGO,SAAZA,GAIY,UAAZA,IAIAvB,GAASuB,GACJP,EAAOS,MAAMF,GAGfxZ,EACT,CAaM,SAAU2Z,GAAUliB,GACxB,OAAOmiB,GAAczB,KAAK1gB,EAC5B,CAEA,IAAMmiB,GAAgB,aCtMhBC,GAA4B,IAC5BC,GAAsB,YA4DZC,GAAeC,GAAsC,IAAtBC,EAAcvb,UAAApI,OAAA,QAAAL,IAAAyI,UAAAzI,IAAAyI,UAAA,GACrDwb,EAAuC,CAAA,EAE7C,IAAKpT,MAAMoS,QAAQc,GACjB,MAAU,IAAAG,UAAU,kBAGtB,SAASC,EAAmBlP,EAAcmP,KACvBvT,MAAMoS,QAAQhO,KAASkN,GAASlN,IAEjC+O,GAAkBI,EAAK/jB,OAAS,KAC9C4jB,EAAYI,EAAmBD,KAAS,GAGtCjC,GAASlN,IACXvW,OAAOyC,KAAK8T,GAAKnW,SAAQ,SAACiI,GACxBod,EAAmBlP,EAAIlO,GAAMqd,EAAKva,OAAO9C,GAC3C,GAEH,CAGD,IADA,IAAM3G,EAAMD,KAAKmkB,IAAIP,EAAM1jB,OAAQujB,IAC1BtjB,EAAI,EAAGA,EAAIF,EAAKE,IAAK,CAE5B6jB,EADaJ,EAAMzjB,GACMujB,GAC1B,CAID,OAFmBnlB,OAAOyC,KAAK8iB,GAAa9E,OAE1B5L,IAAIgR,EACxB,UASgBC,GAAa3U,EAAeC,EAAa2U,GACvD,KAAI3U,GAAOD,GAIX,IAAK,IAAImD,EAAQnD,EAAOmD,EAAQlD,EAAKkD,IACnCyR,EAASzR,EAEb,CAMgB,SAAA0R,GAASX,EAAiB3jB,GACxC,OAAO2jB,EAAM1jB,OAASD,EAAM2jB,EAAMnkB,MAAM,EAAGQ,GAAO2jB,CACpD,CAKM,SAAUY,GAAiBZ,GAC/B,OAAAlL,EAAA,CAAA,EACKkL,EAEP,CAKM,SAAUa,GAAiBC,GAC/B,OAAOnmB,OAAOomB,OAAOD,EACvB,CAsBM,SAAUE,GAAahB,EAAY/Q,EAAegS,EAAeC,GAErE,IAAMC,EAAOnB,EAAMnkB,MAAM,GACnBulB,EAAcD,EAAKlQ,OAAOhC,EAAOgS,GAIvC,OADAE,EAAKlQ,OAAOxB,MAAM0R,EAAOlS,CAAAA,EAAQiS,EAAQ,GAACpb,OAAA4J,EAAK0R,KACxCD,CACT,CCjJgB,SAAAE,GAAeC,EAAkBrC,GAC/C,IACE,OAAOA,EAAOS,MAAM4B,EACrB,CAAC,MAAO1C,GAEP,OAAOK,EAAOS,MAAM6B,EAAWD,GAChC,CACH,CAMgB,SAAAE,GACdC,EACAxC,GAEA,IACE,OAAOoC,GAAeI,EAAaxC,EACpC,CAAC,MAAOL,GACP,MACD,CACH,CAGgB,SAAA8C,GAAiBD,EAAqB/B,GAIpD+B,EAAcA,EAAYrI,QAAQuI,GAA+C,IAEjF,IACE,OAAOjC,EAAM+B,EACd,CAAC,MAAO7C,IAIT,IACE,OAAOc,EAAM,IAAM+B,EAAc,IAClC,CAAC,MAAO7C,IAIT,IACE,OAAOc,EAAM,IAAM+B,EAAc,IAClC,CAAC,MAAO7C,IAIT,UAAUnX,MAAM,+BAClB,CAKM,SAAUma,GAAkBH,GAIhCA,EAAcA,EAAYrI,QAAQuI,GAA+C,IAEjF,IACE,OAAOJ,EAAWE,EACnB,CAAC,MAAO7C,IAIT,IACE,IAAMiD,EAAWN,EAAW,IAAME,EAAc,KAChD,OAAOI,EAASC,UAAU,EAAGD,EAASvlB,OAAS,EAChD,CAAC,MAAOsiB,IAIT,IACE,IAAMiD,EAAWN,EAAW,IAAME,EAAc,KAChD,OAAOI,EAASC,UAAU,EAAGD,EAASvlB,OAAS,EAChD,CAAC,MAAOsiB,IAIT,UAAUnX,MAAM,gCAClB,CAGA,IAAMka,GAAgD,QAYtC,SAAAI,GAAwBT,EAAkBU,GACxD,IAAMC,EAAgBC,GAAeC,KAAKH,GAE1C,GAAIC,EAAe,CAEjB,IAAMxH,EAAWsD,GAAIkE,EAAc,IAE7BG,EAuDM,SACdhhB,EACAihB,GAMA,QALAvW,EAAKpH,UAAApI,OAAAoI,QAAAzI,IAAAyI,UAAAzI,GAAAyI,UAAA,GAAG,EACRqH,EAAGrH,UAAApI,eAAAL,IAAAyI,UAAA,GAAAA,aAAGtD,EAAK9E,OAEP2kB,EAAQ,EAEH1kB,EAAIuP,EAAOvP,EAAIwP,EAAKxP,IACvB6E,EAAKkhB,OAAO/lB,KAAO8lB,GACrBpB,IAIJ,OAAOA,CACT,CAtEiBsB,CAA0BjB,EAAU,KAAM,EAAG7G,GAEpD+H,EAAS/H,EADG6G,EAASmB,YAAY,KAAMhI,GACP,EAEtC,MAAO,CACLA,SAAAA,EACA2H,KAAAA,EACAI,OAAAA,EACAE,QAASV,EAAkB5I,QAAQ8I,IAAgB,WACjD,cAAApc,OAAesc,EAAO,cAACtc,OAAW0c,EAAS,EAC7C,IAEH,CAEC,IAAMG,EAAYC,GAAWT,KAAKH,GAC5Ba,EAAeF,EAAY5E,GAAI4E,EAAU,IAAM,KAC/CP,EAAwB,OAAjBS,EAAwBA,EAAe,EAAI,KAElDC,EAAcC,GAAaZ,KAAKH,GAChCgB,EAAiBF,EAAc/E,GAAI+E,EAAY,IAAM,KACrDN,EAA4B,OAAnBQ,EAA0BA,EAAiB,EAAI,KAExDvI,EACK,OAAT2H,GAA4B,OAAXI,WAkBWphB,EAAcghB,EAAcI,GAC5D,IAAIvT,EAAQ7N,EAAK+B,QAAQ,MACrB5G,EAAI,EAER,KAAOA,EAAI6lB,IAAmB,IAAXnT,GACjBA,EAAQ7N,EAAK+B,QAAQ,KAAM8L,EAAQ,GACnC1S,IAGF,OAAkB,IAAX0S,EACHA,EAAQuT,EAAS,EACjB,IACN,CA9ByCS,CAAkB3B,EAAUc,EAAMI,GAAU,KAGjF,MAAO,CACL/H,SAAAA,EACA2H,KAAAA,EACAI,OAAAA,EACAE,QAASV,EAAkB5I,QAAQ,gBAAiB,IAAIA,QAAQ,qBAAsB,IAG5F,CAkKM,SAAU8J,GAAoBC,GAClC,OAAK/E,GAAS+E,QAIOlnB,IAAjBknB,EAAQC,UACWnnB,IAAjBknB,EAAQ/hB,KACH,kFAEI,UAGQnF,IAAjBknB,EAAQ/hB,KACH,qEAC0B,iBAAjB+hB,EAAQ/hB,KAEtB,6HAdG,2BAqBX,CAKM,SAAUiiB,GAAUF,GACxB,OACE/E,GAAS+E,UAAqC,IAAjBA,EAAQC,MAAgD,iBAAjBD,EAAQ/hB,KAEhF,CAKM,SAAUkiB,GAAcH,GAC5B,OAAO/E,GAAS+E,IAAoC,iBAAjBA,EAAQ/hB,IAC7C,CAKM,SAAUmiB,GAAcJ,GAC5B,OAAO/E,GAAS+E,SAAoC,IAAjBA,EAAQC,IAC7C,CAKM,SAAUI,GACdL,GACA,IAAAM,EAA2C/e,UAAApI,OAAA,QAAAL,IAAAyI,UAAA,GAAAA,UAAA,QAAAzI,EAC3CgjB,EAAAva,UAAApI,eAAAL,IAAAyI,UAAA,GAAAA,UAAA,GAAqBgf,KAErB,OAAOJ,GAAcH,GACjBA,EACA,CAAE/hB,KAAM6d,EAAOG,UAAU+D,EAAQC,KAAM,KAAMK,GACnD,UAMgBE,GAAcR,GAA2C,IAAzBlE,yDAAqByE,KACnE,OAAOH,GAAcJ,GAAWA,EAAU,CAAEC,KAAMnE,EAAOS,MAAMyD,EAAQ/hB,MACzE,UAKgBwiB,GAAQT,EAAkBM,EAA8BxE,GACtE,OAAOuE,GAAcL,EAASM,EAAaxE,GAAQ7d,IACrD,CAQgB,SAAAyiB,GAAeV,EAAkBW,GAC/C,OAAOC,GAAuBZ,EAASW,GAAWA,CACpD,UAUgBC,GAAuBZ,GAAkB,IAAAW,EAAOpf,UAAApI,OAAAoI,QAAAzI,IAAAyI,UAAAzI,GAAAyI,UAAGsf,GAAAA,IACjE,GAAIV,GAAcH,GAChB,OAAOA,EAAQ/hB,KAAK9E,OAGtB,IAAM8mB,EAAOD,EAAQC,KAEjBa,EAAgB,EA6CpB,OA3CA,SAASC,EAAQd,GACf,GAAItW,MAAMoS,QAAQkE,GAAO,CAIvB,IAFAa,GAAsBb,EAAK9mB,OAAS,EAAnB,GAEGwnB,EAClB,OAAOG,EAGT,IAAK,IAAI1nB,EAAI,EAAGA,EAAI6mB,EAAK9mB,OAAQC,IAAK,CAKpC,GAFA2nB,EAFad,EAAK7mB,IAId0nB,EAAgBH,EAClB,OAAOG,CAEV,CACF,MAAU7F,GAAAA,GAASgF,GAAO,CACzB,IAAMhmB,EAAOzC,OAAOyC,KAAKgmB,GAGzBa,GAAiB,EAAI7mB,EAAKd,QAAUc,EAAKd,OAAS,GAElD,IAAK,IAAI/B,EAAI,EAAGA,EAAI6C,EAAKd,OAAQ/B,IAAK,CACpC,IAAMyI,EAAM5F,EAAK7C,GACXkD,EAAQ2lB,EAAKpgB,GAGnBihB,GAAiBjhB,EAAI1G,OAAS,EAE9B4nB,EAAQzmB,EACT,CACF,MACCwmB,GADyB,iBAATb,EACCA,EAAK9mB,OAAS,EAGd6nB,OAAOf,GAAM9mB,MAEjC,CAED4nB,CAAQd,GAEDa,CACT,CAEA,IAAM/B,GAAiB,wBACjBU,GAAa,aACbG,GAAe,eAML,SAAAqB,GAAcjpB,EAAeC,GAC3C,OAAOD,EAAEukB,QAAUtkB,EAAEskB,OAASvkB,EAAEikB,YAAchkB,EAAEgkB,SAClD,CAKM,SAAUiF,GAAgB/C,GAC9B,IACMjhB,EAAOihB,EAASQ,UAAU,EADd,KAC4BrC,OAC9C,OAAQpf,EAAKikB,SAAS,OAASC,GAAgCpG,KAAK9d,EACtE,CAGA,IAAMkkB,GAAkC,kBClexBC,GAA4BC,GAM3C,IALCC,EAAuBD,EAAvBC,wBACAC,EAAuBF,EAAvBE,wBAKA,OAAID,EACEC,EACKC,GAEAC,GAGLF,EACKG,GAEAC,EAGb,CAEA,IAAMH,GAA6B,CACjCI,YAAa,SAACvnB,GAAmB,OAAAwnB,GAAkBC,GAAkBf,OAAO1mB,IAC5E0nB,EAAAA,cAAe,SAAC1nB,GAAkB,OAAA2nB,GAAoBC,GAAoB5nB,MAGtEonB,GAAmB,CACvBG,YAAa,SAACvnB,GAAmB,OAAAynB,GAAkBf,OAAO1mB,GAAO,EACjE0nB,cAAe,SAAC1nB,UAAkB2nB,GAAoB3nB,KAGlDqnB,GAAmB,CACvBE,YAAa,SAACvnB,GAAc,OAAKwnB,GAAkBd,OAAO1mB,KAC1D0nB,cAAe,SAAC1nB,UAAkB4nB,GAAoB5nB,KAGlDsnB,GAAmB,CACvBC,YAAa,SAACvnB,UAAmB0mB,OAAO1mB,IACxC0nB,cAAe,SAAC1nB,UAAkBA,IAM9B,SAAUwnB,GAAkBxnB,GAChC,OAAOA,EAAM2b,QAAQ,iBAAiB,SAACjf,GAAKmrB,IAAAA,EAC1C,MAAU,OAANnrB,GAAoB,OAANA,GAAoB,OAANA,GAAoB,OAANA,GAAoB,OAANA,EACnDA,EAGF,OAAS,OAAwB,QAAnBmrB,EAAGnrB,EAAEorB,YAAY,UAAE,IAAAD,OAAA,EAAhBA,EAAkBE,SAAS,MAAK3pB,OAAO,EACjE,GACF,CAEM,SAAUwpB,GAAoB5nB,GAClC,OAAOA,EAAM2b,QAAQ,sBAAsB,SAACjf,GAC1C,IACE,IAAMsrB,EAAoB/B,KAAKhE,MAAM,IAAMvlB,EAAI,KAK/C,OAAOurB,GAAkBD,IAAcA,CACxC,CAAC,MAAO7G,GACP,OAAOzkB,CACR,CACH,GACF,CAEA,IAAMurB,GAAoB,CACxB,IAAK,MACL,KAAM,OAEN,KAAM,MACN,KAAM,MACN,KAAM,MACN,KAAM,MACN,KAAM,OAIFC,GAA2B,CAC/B,MAAO,IACP,OAAQ,KAER,MAAO,IACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,MAIH,SAAUT,GAAkBznB,GAChC,OAAOA,EAAM2b,QAAQ,oBAAoB,SAACjf,GAGxC,OAAOurB,GAAkBvrB,IAAMA,CACjC,GACF,CAEM,SAAUirB,GAAoB3nB,GAClC,OAAOA,EAAM2b,QAAQ,iBAAiB,SAACjf,GAGrC,OAAOwrB,GAAyBxrB,IAAMA,CACxC,GACF,CAEM,SAAUyrB,GAAiBnoB,GAC/B,MAAqB,iBAAVA,EACF0mB,OAAO1mB,GAGZA,EAAMkU,SAAS,MAEVlU,EAAQ,KAGVA,CACT,CAkBgB,SAAAooB,GAAkBpmB,EAAkBqmB,GAClD,OAAOC,GAAUtmB,GAAS,SAACmK,UAAMA,EAAEkc,SAASE,gBAAkBF,EAASE,aAAc,GACvF,UAEgBC,GAAmBxmB,EAAkBuB,EAAcvD,GACjE,OAAOsoB,GAAUtmB,GAAS,SAACmK,GAAM,OAiBnC,SAAsBnK,EAAkBuB,EAAcvD,GACpD,MAAuC,mBAAzBgC,EAAQ+C,cAA+B/C,EAAQ+C,aAAaxB,KAAUvD,CACtF,CAnBmCyoB,CAAatc,EAAG5I,EAAMvD,EAAM,GAC/D,CAyBgB,SAAAsoB,GAAUtmB,EAAkB0mB,GAC1C,QAASC,GAAW3mB,EAAS0mB,EAC/B,CAUgB,SAAAC,GACd3mB,EACA0mB,GAIA,IAFA,IAAIvc,EAAoBnK,EAEjBmK,IAAMuc,EAAUvc,IACrBA,EAAIA,EAAElJ,WAGR,OAAOkJ,QAAK3N,CACd,CAOM,SAAUoqB,GAAe5mB,GAC7B,GAA0B,MAAtBA,EAAQ6mB,WAAZ,CAKA,IAAMC,EAAQ1mB,SAAS2mB,cACjBC,EAAY3oB,OAAO4oB,eACzBH,EAAMI,SAASlnB,EAAS,GACxB8mB,EAAMK,UAAS,GACfH,SAAAA,EAAWI,kBACXJ,SAAAA,EAAWK,SAASP,EAPnB,MAFC9mB,EAAQ8b,OAUZ,CAKM,SAAUwL,GACdC,EACA5lB,EACA6lB,EACAC,GAEA,IAAMppB,EAASqpB,GAAUH,GACzB,GAAKlpB,EAAL,CAIA,IAAMud,EAAoCvd,EAAO+B,SAASwb,cACrDvd,EAAO+B,SAASwb,cACjB,KAEAA,GAAiBA,EAAc+L,oBACjC/L,EAAc1b,YAAcsnB,EAAkB7lB,EAAOia,EAAc1b,YAAcyB,EACjFilB,GAAehL,GACX6L,GACFA,EAAgB7L,GAVnB,CAaH,CAMM,SAAU8L,GAAU1nB,GACxB,OAAOA,GAAWA,EAAQO,cAAgBP,EAAQO,cAAcqnB,YAAc,IAChF,CAEM,SAAUC,GAAuB7nB,GACrC,IAAM3B,EAASqpB,GAAU1nB,GACnB4b,EAAgBvd,eAAAA,EAAQ+B,SAASwb,cACvC,QAAOA,GAAgB0K,GAAU1K,GAAe,SAACzR,GAAC,OAAKA,IAAMnK,CAAO,GACtE,CAOgB,SAAA8nB,GAAuB9nB,EAAkBqmB,GACvD,OAAOM,GAAW3mB,GAAS,SAACmK,GAAM,OAAAA,EAAEkc,WAAaA,CAAQ,GAC3D,CAEM,SAAU0B,GAA2BzoB,GACzC,OAAIknB,GAAmBlnB,EAAQ,YAAa,kBACnC2c,GAAc1Y,IAGnBijB,GAAmBlnB,EAAQ,YAAa,oBACnC2c,GAAcje,MAGnBwoB,GAAmBlnB,EAAQ,YAAa,gCACnC2c,GAAc+L,OAGnBxB,GAAmBlnB,EAAQ,YAAa,+BACnC2c,GAAcgM,MAGhBhM,GAAciM,KACvB,CAKM,SAAUC,GAAevH,GAC7B,OAAOwH,mBAAmBvH,EAAmBD,GAC/C,CAYM,SAAUyH,GAAsB/oB,GACpC,IAAMgpB,EAAS3B,GAAWrnB,GAAQ,SAACU,GACjC,QAAOA,UAAAA,EAASymB,eAAezmB,EAAQymB,aAAa,YACtD,IAEM8B,EAAWD,eAAAA,EAAQvlB,aAAa,aACtC,OAAOwlB,EAZAxH,EAAiByH,mBAYSD,IAAY,IAC/C,CAMM,SAAUE,GAAkBC,GAChC,IAAAC,EAAWD,EAAXC,YACAC,EAAcF,EAAdE,eACAje,EAAS+d,EAAT/d,UAASke,EAAAH,EACTI,QAAAA,OAAU,IAAHD,EAAG,WAAA,QAAUA,EAAAA,EAAAE,EAAAL,EACpBM,OAAAA,WAAMD,EAAG,GAAEA,EAQLE,EAAMlZ,EAAI4Y,EAAYnhB,QAU5B,SAAmBxH,GACjB,IAAMkpB,EAAOlpB,EAAQmpB,wBACrB,OAAOD,EAAK1O,MAAQ,GAAK0O,EAAKxO,OAAS,CACxC,IAb8C0O,GACzC1U,EAAU0U,EAAgBR,GAchC,SAASQ,EAAgBppB,GACvB,IAAMkpB,EAAOlpB,EAAQmpB,wBACrB,MAAO,CACLzuB,EAAGwuB,EAAK9N,KAAO8N,EAAK1O,MAAQ,EAC5B6O,EAAGH,EAAKhO,IAAMgO,EAAKxO,OAAS,EAC5BwO,KAAAA,EACAlpB,QAAAA,EAEH,CAQD,SAASspB,EAAS5tB,EAAmBC,GAA8B,IAAX4tB,EAAOtkB,UAAApI,OAAA,QAAAL,IAAAyI,UAAAzI,GAAAyI,UAAA,GAAG,EAC1DukB,EAAQ9tB,EAAEhB,EAAIiB,EAAEjB,EAChB+uB,GAAS/tB,EAAE2tB,EAAI1tB,EAAE0tB,GAAKE,EAC5B,OAAO5sB,KAAK+sB,KAAKF,EAAQA,EAAQC,EAAQA,EAC1C,CACD,IAAME,EAAoB,SAACC,GAAyB,OAAKN,EAASM,EAAWlV,EAC7E,EAEA,GAAkB,SAAd/J,GAAsC,UAAdA,EAAuB,CAGjD,IAAMkf,EACU,SAAdlf,EACIse,EAAIzhB,QAAO,SAACyN,UAlBetZ,EAkBW+Y,EAARO,EAlBqBiU,KAAK9N,KAAO4N,EAASrtB,EAAEutB,KAAK9N,KAAxE,IAAoBzf,CAkBoB,IAC/CstB,EAAIzhB,QAAO,SAACyN,UAlBgBtZ,EAkBW+Y,EAARO,EAlBqBiU,KAAKY,MAAQnuB,EAAEutB,KAAKY,MAAQd,EAAxE,IAAoBrtB,CAkBmB,IAC/CouB,EAAsBF,EAAeriB,QAAO,SAACyN,GAAW,OArB3CvZ,EAqBuDuZ,EArBpCtZ,EAqB4C+Y,EArBtB/X,KAAKyP,IAAI1Q,EAAE2tB,EAAI1tB,EAAE0tB,GAAKL,EAAhE,IAACttB,EAAmBC,KAsBhCquB,EACJC,EAAMF,EAAqBJ,IAC3BM,EAAMJ,GAZwB,SAACD,GAA8B,OAAAN,EAASM,EAAWlV,EAAS,GAE9F,IAYE,OAAOsV,aAAAA,EAAAA,EAAShqB,OACjB,CAED,GAAkB,OAAd2K,GAAoC,SAAdA,EAAsB,CAG9C,IAAMuf,EACU,OAAdvf,EACIse,EAAIzhB,QAAO,SAACyN,GAAM,OA/BUtZ,EA+BW+Y,EAARO,EA/BqBoU,EAAIL,EAASrtB,EAAE0tB,EAA3D,IAAoB1tB,CA+BmB,IAC/CstB,EAAIzhB,QAAO,SAACyN,GAAM,OA/BUtZ,EA+BW+Y,EAARO,EA/BqBoU,EAAI1tB,EAAE0tB,EAAIL,EAAtD,IAAoBrtB,CA+BmB,IAC/CwuB,EAAiBD,EAAW1iB,QAAO,SAACyN,GAAM,OAAK6T,EAAQ7T,EAAOjV,QAAQ,IACtEgqB,EAAUC,EAAME,EAAgBR,IAAsBM,EAAMC,EAAYP,GAE9E,OAAOK,aAAO,EAAPA,EAAShqB,OACjB,CAGH,CAOM,SAAUoqB,GAAiBpqB,GAC/B,QACIA,GACmB,QAArBA,EAAQqmB,UAC2D,mBAA3DrmB,EAA+CqqB,SACW,mBAA1DrqB,EAA+CsqB,MAE3D,UCjZgBC,GAAkBtoB,GAAqC,IAAfuoB,EAASvlB,UAAApI,eAAAL,IAAAyI,UAAA,GAAAA,UAAA,GAAG,IAC5DwlB,EAAQ,GAEVxoB,EAAMyoB,SAERD,EAAMriB,KAAK,QAETnG,EAAM0oB,SAERF,EAAMriB,KAAK,QAETnG,EAAM2oB,QAERH,EAAMriB,KAAK,OAETnG,EAAM4Z,UACR4O,EAAMriB,KAAK,SAGb,IAAMyiB,EAA+B,IAArB5oB,EAAMsB,IAAI1G,OAAeoF,EAAMsB,IAAIgjB,cAAgBtkB,EAAMsB,IAMzE,OALMsnB,KAAWC,IAEfL,EAAMriB,KAAKyiB,GAGNJ,EAAM9iB,KAAK6iB,EACpB,CAEA,IAAMM,GAAW,CACfC,MAAM,EACNC,SAAS,EACTC,SAAS,EACTC,KAAK,EACLC,QAAQ,EACRC,OAAO,odCmE0CC,EAAA,CAAArvB,KAAMwB,OAA3B0X,EAAAlZ,KAAMwJ,iGAAe8lB,EAAA3wB,GAAA2wB,EAAArc,GAAAoc,EAAA,CAAAhc,GAAArT,KAAMwB,oRARNoF,GAAA2oB,EAAA,QAAAC,EAAAC,GAAezvB,EAAc,GAAAA,KAAMmG,2BAAlFtB,GASKvB,EAAAisB,EAAAzqB,GARHzB,GAMCksB,EAAAznB,yDACuB,GAAA,EAAAxH,GAAA4Y,KAAAA,EAAAlZ,KAAMwJ,WAAS,uKAAMyJ,GAAAoc,EAAA,CAAAhc,GAAArT,KAAMwB,wBARNkX,GAAA,EAAApY,GAAAkvB,KAAAA,EAAAC,GAAezvB,EAAc,GAAAA,KAAMmG,kMAD/EnG,EAAY,IAAAmZ,GAAAnZ,mIAPnB6E,GAmBKvB,EAAAisB,EAAAzqB,wDAxBmB9E,EAAqB,IAAA,mBACvBA,EAAa,IAAA,iBACfA,EAAiB,IAAA,oBAOrB0vB,mBACF1vB,EAAa,4CAEpBA,EAAY,iOAnFR,SAAA0vB,GAAsBzpB,GAC7BA,EAAMU,2BAcC8oB,GAAeE,EAA8BxpB,OAkC9CypB,EAAWD,EAAaxC,wBACtB0C,aAjCF,GAAA1pB,EAAQrB,OAAM,CACR,IAAAA,EAA2EqB,EAA3ErB,OAAMgrB,EAAqE3pB,EAAnEqY,MAAAA,OAAK,IAAAsR,EAAG,EAACA,EAAAC,EAA0D5pB,EAAxDuY,OAAAA,OAAS,IAAHqR,EAAG,EAACA,EAAAC,EAA8C7pB,EAA5C8pB,UAAAA,OAAY,IAAHD,EAAG,EAACA,EAAAE,EAA+B/pB,EAA7BgqB,WAAAA,WAAUD,EAAG,EAACA,EAAElR,EAAa7Y,EAAb6Y,WACjCla,EAAOqoB,wBAApC/N,EAAIgR,EAAJhR,KAAMF,EAAGkR,EAAHlR,IAAKmR,EAAMD,EAANC,OAAQvC,EAAKsC,EAALtC,MAErBwC,EACS,QAAbtR,GAAuBE,EAAMR,EAASrc,OAAOsc,aAAeO,EAAMR,EAC9D6R,EACS,SAAbvR,GAAwBI,EAAOZ,EAAQnc,OAAOoc,YAAcW,EAAOZ,SAGnEY,KAAMmR,EAAezC,EAAQqC,EAAa/Q,EAAO+Q,EACjDjR,IAAKoR,EAAgBpR,EAAM+Q,EAAYI,EAASJ,EAChDK,cAAAA,EACAC,aAAAA,MAE+B,iBAAjBpqB,EAAQiZ,MAA4C,iBAAhBjZ,EAAQ+Y,IAAgB,KACpEE,EAAqCjZ,EAArCiZ,KAAMF,EAA+B/Y,EAA/B+Y,IAAGsR,EAA4BrqB,EAA1BqY,MAAAA,WAAKgS,EAAG,EAACA,EAAAC,EAAiBtqB,EAAfuY,OAAAA,OAAM,IAAA+R,EAAG,EAACA,EAMtC,MAAA,CAAArR,KAAAA,EACAF,IAAAA,EACAoR,cANoBpR,EAAMR,EAASrc,OAAOsc,aAAeO,EAAMR,EAO/D6R,aANmBnR,EAAOZ,EAAQnc,OAAOoc,YAAcW,EAAOZ,GAStD,UAAAxS,MAAM,kEAK+Bwb,GAA3CpI,EAAIyQ,EAAJzQ,KAAMF,EAAG2Q,EAAH3Q,IAAKoR,EAAaT,EAAbS,cAAeC,EAAYV,EAAZU,aAU3B,OARiBD,EAAAjmB,WAAAA,OACTulB,EAAS1Q,IAAMA,EAAG,OAAA,QAAA7U,OACrB6U,EAAM0Q,EAAS1Q,IAAG,SAEJqR,EAAA,UAAAlmB,OACZulB,EAASxQ,KAAOA,EAAI,OAAA,SAAA/U,OACrB+U,EAAOwQ,EAASxQ,KAAI,+BA7E/BuQ,EACAe,EAJOC,EAAiBnW,EAAjBmW,MACAC,EAA6CpW,EAA7CoW,mBAOF,SAAAC,EAAiB5qB,GAEtB0qB,EAAMxqB,SACNwqB,EAAMxqB,QAAQyV,oBACb0O,GAAUrkB,EAAM3C,QAAwB,SAAA6K,GAAC,OAAKA,IAAMwhB,CAAY,KAEjEiB,EAAmBD,EAAM1sB,WAR7BgI,eAgFMykB,GACFA,EAAe5Q,yHArEV,SAAsB7Z,GAC7B4qB,EAAiB5qB,IAOV,SAAcA,GAEP,WADAsoB,GAAkBtoB,IAE9B2qB,EAAmBD,EAAM1sB,KAIpB,SAAkBgC,GACzB4qB,EAAiB5qB,yDA8EFyqB,EAAc3Q,0DAZpB4P,EAAY5P,uiBCxDlB/f,EAAM,iBAAXa,OAAIC,GAAA,kVAACd,EAAM,YAAXa,OAAIC,GAAA,EAAA,oHAAJD,OAAIC,EAAAgwB,EAAAjwB,OAAAC,GAAA,sHAAJD,OAAIC,GAAA,2NAzCEgV,EAAQH,GAAY,4BAEtBob,EAAM,GAqBD,SAAAH,EAAmBI,OACpBC,EAAaF,EAAOG,WAAW,SAAAP,GAAU,OAAAA,EAAM1sB,KAAO+sB,CAAO,IAE/D,IAAgB,IAAhBC,EAAiB,KACbN,EAAQI,EAAOE,GACjBN,EAAMxqB,QAAQ+X,SAChByS,EAAMxqB,QAAQ+X,cAGhB6S,EAASA,EAAOvlB,QAAQ,SAAAmlB,GAAU,OAAAA,EAAM1sB,KAAO+sB,CAAO,aAM1DrkB,GAAiC,iBAAoB,CAAAwkB,kBAlC5C,SACP3nB,EACAhI,EACA2E,GAEA2P,EAAM,UAAWtU,EAAO2E,OAElBwqB,EAAK,CACT1sB,GAAIoe,KACO7Y,UAAAA,EACXhI,MAAOA,GAAK,CAAA,EACZ2E,QAASA,GAAO,CAAA,GAKX,WAFP4qB,EAAM1mB,GAAAA,OAAA4J,EAAO8c,GAAM,CAAEJ,KAEdA,EAAM1sB,IAkByD2sB,mBAAAA,8FAFrE9a,EAAM,SAAUib,6HCnCf,SAAUK,GAAkBxM,GAChC,OAAOA,EACJ7Q,KAAI,SAAC1S,EAAGmS,GACP,OAAO6d,GAAmB3O,KAAKrhB,GAC3B,IAAMA,EAAI,IACV,SAASqhB,KAAKrhB,IAAY,KAANA,EAClB,MAAoBA,EAOlBsc,QAAQ,KAAM,OAPS,OACxBnK,EAAQ,EAAI,IAAM,IAAMnS,CACjC,IACCsK,KAAK,GACV,CASM,SAAU2lB,GAAcC,GAI5B,IAHA,IAAM3M,EAAiB,GACnB9jB,EAAI,EAEDA,EAAIywB,EAAQ1wB,QACE,MAAf0wB,EAAQzwB,IACVA,IAGiB,MAAfywB,EAAQzwB,IACVA,IAEmB,MAAfywB,EAAQzwB,IACVA,IACA8jB,EAAKxY,KAAKolB,GAAU,SAACzuB,GAAM,MAAM,MAANA,KAAW,IACtC0uB,EAAa,MAEb7M,EAAKxY,KAAKolB,GAAU,SAACzuB,GAAM,MAAM,MAANA,MAG7B0uB,EAAa,MAEb7M,EAAKxY,KAAKolB,GAAU,SAACzuB,GAAM,MAAM,MAANA,GAAmB,MAANA,CAAU,KAItD,SAASyuB,EAAUE,GAGjB,IAHmE,IAAhBC,EAAQ1oB,UAAApI,OAAA,QAAAL,IAAAyI,UAAAzI,IAAAyI,UAAA,GACvD2oB,EAAO,GAEJ9wB,EAAIywB,EAAQ1wB,SAAW6wB,EAAMH,EAAQzwB,KACtC6wB,GAA2B,OAAfJ,EAAQzwB,IAAkC,MAAnBywB,EAAQzwB,EAAI,IAEjD8wB,GAAQ,IACR9wB,GAAK,IAEL8wB,GAAQL,EAAQzwB,GAChBA,KAIJ,OAAO8wB,CACR,CAED,SAASH,EAAaI,GACpB,GAAIN,EAAQzwB,KAAO+wB,EACjB,MAAU,IAAAC,YAAW,sBAAAznB,OAAuBwnB,EAAIxnB,0BAAAA,OAAyBvJ,IAE3EA,GACD,CAED,OAAO8jB,CACT,CAKM,SAAUmN,GAAanN,GAC3B,MAAO,CACL5iB,MAAO4iB,EACPoN,MAAOC,EAAQrN,GAAQ,cAAgBwM,GAAkBxM,GAE7D,CAuBA,SAASsN,GAAwBN,GAC/B,GAAIP,GAAmB3O,KAAKkP,GAC1B,MAAO,IAAMA,EAAO,IACf,GAAIO,GAAwBzP,KAAKkP,GACtC,MAAO,IAAMA,EAEb,IAAMQ,EAAUnK,KAAKtE,UAAUiO,GAG/B,MAAO,KADaQ,EAAQ/L,UAAU,EAAG+L,EAAQvxB,OAAS,GAAG8c,QAAQ,OAAQ,KACjD,IAEhC,CAeM,SAAU0U,GAAuBzN,GACrC,OAAOA,EACJ7Q,KAAI,SAAC6d,GACJ,OAAIP,GAAmB3O,KAAKkP,GAE1B,MAAAvnB,OAAaunB,EAAI,KACRO,GAAwBzP,KAAKkP,GAEtC,KAAAvnB,OAAYunB,GAGZ,MAAAvnB,OAAa4d,KAAKtE,UAAUiO,GAAK,IAErC,IACCjmB,KAAK,GACV,CAKA,IAAMwmB,GAA0B,4BAC1Bd,GAAqB,QC1JX,SAAAiB,GAAe/sB,EAAc5D,GAS3C,IARA,IAAM4wB,EAAU,IAAI1wB,IAAIF,GAGlB6wB,EAAwBjtB,EAAKoY,QAAQ,oBAAqB,IAE5D8U,EAAYltB,EACZzE,EAAI,EAEDyxB,EAAQzwB,IAAI2wB,IAAY,CAC7B,IAAM/M,EAAO,QAAU5kB,EAAI,EAAI,IAAMA,EAAI,IACzC2xB,EAAS,GAAApoB,OAAMmoB,EAAqB,MAAAnoB,OAAKqb,EAAO,KAChD5kB,GACD,CAED,OAAO2xB,CACT,CAiCgB,SAAAC,GAAS/sB,EAAcgtB,GACrC,IACMC,EAAgBD,EAAYE,EAElC,OAAOltB,EAAK9E,OAAS8xB,EAAYhtB,EAAK0gB,UAAU,EAAGuM,GAHlC,MAG8DjtB,CACjF,CAQM,SAAUmtB,GAAYvoB,GAC1B,GAAY,KAARA,EACF,MAAO,GAGT,IAAMwoB,EAAQxoB,EAAIqT,cAClB,GAAc,SAAVmV,EACF,OAAO,KAET,GAAc,SAAVA,EACF,OAAO,EAET,GAAc,UAAVA,EACF,OAAO,EAET,GAAc,cAAVA,EAAJ,CAIA,IAAMC,EAAM9P,OAAO3Y,GACb0oB,EAAWC,WAAW3oB,GAC5B,OAAKyY,MAAMgQ,IAAShQ,MAAMiQ,GAInB1oB,EAHEyoB,CALR,CASH,CCzFA,IAMaG,GAAyC,CACpDlvB,GAAI,aACJsB,KAAM,yBAJP,mGAUD,SAAqBoiB,EAAeyL,GAClC,IAAQ5nB,EAA6B4nB,EAA7B5nB,OAAQmU,EAAqByT,EAArBzT,KAAM0T,EAAeD,EAAfC,WAChBC,EAAa,CAAC,mBAEpB,GAAI9nB,GAAUA,EAAOoZ,MAAQpZ,EAAO+nB,UAAY/nB,EAAOxJ,MAAO,CAG5D,IAAMwxB,EAAiBnpB,eAAAA,OAAkBgoB,GAAuB7mB,EAAOoZ,OAEjE6O,EAAcX,GAAYtnB,EAAOxJ,OACjC0xB,EACmB,iBAAhBD,EAAwB,IAAAppB,OACvBmB,EAAOxJ,MAAK,KAChBkiB,GAAU1Y,EAAOxJ,SAAWkhB,OAAOyQ,cAAcF,GAAYppB,GAAAA,OACxDmB,EAAOxJ,MAAQ,KAClBwJ,EAAOxJ,MAEfsxB,EAAWlnB,KAAI,eAAA/B,OAAgBmpB,EAAiBnpB,KAAAA,OAAImB,EAAO+nB,SAAQ,KAAAlpB,OAAIqpB,EAAmB,OAC3F,CAEG/T,GAAQA,EAAKiF,MAAQjF,EAAKhR,YACL,SAAnBgR,EAAKhR,UACP2kB,EAAWlnB,KACT,kEAE8B/B,yBAAAA,OACHgoB,GAAuB1S,EAAKiF,YAASva,yBAAAA,OACrCgoB,GAAuB1S,EAAKiF,YAJvD,yEAUF0O,EAAWlnB,KACT,0FAE6B/B,OACFgoB,GAAuB1S,EAAKiF,MAAS,MAAA,yBAAAva,OACrCgoB,GAAuB1S,EAAKiF,MAAS,MAJhE,0EAWN,GAAIyO,GAAcA,EAAWO,MAG3B,GAAIP,EAAWO,MAAM/yB,OAAS,EAAG,CAC/B,IAAM+yB,EAAQP,EAAWO,MAAM7f,KAAI,SAAC6Q,GAClC,IAAMrf,EAAOqf,EAAKA,EAAK/jB,OAAS,IAAM,OAChCgzB,EAAIxpB,OAAAA,OAAUgoB,GAAuBzN,IAC3C,MAAAva,SAAAA,OAAgB4d,KAAKtE,UAAUpe,GAAK8E,MAAAA,OAAKwpB,EAC3C,IAEAP,EAAWlnB,6BAAI/B,OAAyBupB,EAAMjoB,KAAK,sBACpD,KAAM,CACL,IAAMkoB,EAAI,OAAAxpB,OAAUgoB,GAAuBgB,EAAWO,MAAM,KAE5DN,EAAWlnB,KAAI/B,oBAAAA,OAAqBwpB,EAAI,OACzC,CAGH,MAAAxpB,4BAAAA,OAAmCipB,EAAW3nB,KAAK,IACrD,IAAA,eAEA,SAAsBgc,EAAemM,GAKnC,IAaMC,EAbU,IAAIC,SAClB,oBAEEF,EAFF,iKADc,EAaDG,CAAQtM,GACvB,YAAkBnnB,IAAXuzB,EAAuBA,EAAS,IACzC,uECzGAlvB,GAEGvB,EAAA4wB,EAAApvB,eADM9E,EAAG,8CAAHA,EAAG,2DAGA,IAAAm0B,EAAS,OAKjB,IAAAC,EAAM,GACCxuB,EAAI4U,EAAJ5U,KACF,SAAAyuB,EAAOzuB,OACPA,IAASA,EAAKwuB,UACR,OAEPE,EAAU1uB,EAAKwuB,IACbG,EAAG,CAAA,SACTD,EAAUA,EAAQ3W,QAAQ,mCAAiC,SAAG6W,EAAOvwB,GAC3D,IAAAoe,gBAZV8R,GAAU,GACUpK,SAAS,YAYzBwK,EAAItwB,GAAMoe,iBACKA,UAEnBiS,EAAUA,EAAQ3W,QAAQ,yDAA0D,SAAA6W,EAAOC,EAAOC,EAAGC,OAC3F1wB,EAAKwwB,GAASE,SACf1wB,GAAOswB,EAAItwB,GAGL,IAAAoG,OAAAkqB,EAAItwB,IAFJuwB,KAIRF,6FAER/V,EAAA,EAAA6V,EAAMC,EAAOzuB,ouBC7BE5F,EAAS,6CAQbA,EAAK,YACXA,EAAK,GAAG,MAAQ,yBACbA,EAAG,iBAERA,EAAW,2GAXAA,EAAI,oBACHA,EAAK,sBACHA,EAAO,IACC0I,GAAAksB,EAAA,qBAAS,eAAT50B,MACF0I,GAAAksB,EAAA,mBAAS,aAAT50B,iDAP1B6E,GAiBKvB,EAAAsxB,EAAA9vB,2LAfa9E,EAAS,MAAA,CAAA60B,MAAAC,+EAQb90B,EAAK,uBACXA,EAAK,GAAG,MAAQ,kBAAc,CAAA+0B,KAAAC,uBAC3Bh1B,EAAG,sCAERA,EAAW,sBAXAA,EAAI,oBACHA,EAAK,sBACHA,EAAO,IACC0I,GAAAksB,EAAA,qBAAS,eAAT50B,MACF0I,GAAAksB,EAAA,mBAAS,aAAT50B,mSA0CAi1B,EAAAza,EAAA,MAAd0a,OAAY,IAAHD,EAAG,GAAEA,EAEfzW,EAAKhE,EAALgE,MACAE,EAAMlE,EAANkE,OACeyW,EAAA3a,EAAf4a,IAAAA,OAAG,IAAAD,EAAG,UAASA,EACHE,EAAA7a,EAAZ8a,KAAAA,OAAO,IAAHD,GAAQA,EACGE,EAAA/a,EAAfgb,QAAAA,OAAU,IAAHD,GAAQA,EACFE,EAAAjb,EAAbkb,MAAAA,OAAK,IAAAD,GAAQA,EACAE,EAAAnb,EAAbob,KAAAA,OAAI,IAAAD,EAAG,OAAMA,EAEHE,EAAArb,EAAVzW,MAAAA,OAAQ,IAAH8xB,EAAG,GAAEA,EACAC,EAAAtb,EAAVwX,MAAAA,OAAQ,IAAH8D,EAAG,GAAEA,guBC7CL91B,EAAI,mGAAd6E,GAAiBvB,EAAAyyB,EAAAjxB,uCAAP9E,EAAI,6DAGDA,EAAO,sGAApB6E,GAAuBvB,EAAA0yB,EAAAlxB,uCAAV9E,EAAO,sGAGI,IAARA,EAAQ,YAARA,EAAQ,sLAARA,EAAQ,2PAPnBi2B,EAAA9kB,YAAA+kB,EAAAl2B,YAAAk2B,WAAAA,EAAAA,EAAUtC,QAAK,iBAApB/yB,OAAIC,GAAA,yBAGC,IAAAq1B,EAAAhlB,YAAAilB,EAAAp2B,YAAAo2B,WAAAA,EAAAA,EAAUC,WAAQ,iBAAvBx1B,OAAIC,GAAA,qBAGD,IAAAyW,WAAA+e,EAAAt2B,yBAAAs2B,EAAUlC,MAAGjb,GAAAnZ,uUANXi2B,EAAA9kB,YAAAolB,EAAAv2B,YAAAu2B,WAAAA,EAAAA,EAAU3C,QAAK,YAApB/yB,OAAIC,GAAA,EAAA,yHAAJD,4BAGKs1B,EAAAhlB,YAAAqlB,EAAAx2B,yBAAAw2B,EAAUH,WAAQ,YAAvBx1B,OAAIC,GAAA,EAAA,yHAAJD,iBAGGb,YAAAy2B,OAAAA,EAAUrC,smBAfVp0B,EAAa,+DAKbA,EAAS,IACZA,EAAW,0TANRA,EAAa,yFAKbA,EAAS,eACZA,EAAW,+LAqBb02B,EAeAC,EACAvB,qIAlBcwB,EAAApc,EAAA,MAAd0a,OAAS,IAAA0B,EAAG,GAAEA,EACPhxB,EAAI4U,EAAJ5U,KAESixB,EAAArc,EAATsc,MAAAA,OAAQ,IAAHD,EAAG,EAACA,EACGE,EAAAvc,EAAZ8a,KAAAA,OAAO,IAAHyB,GAAQA,EACGC,EAAAxc,EAAfgb,QAAAA,OAAO,IAAAwB,GAAQA,EACFC,EAAAzc,EAAbkb,MAAAA,OAAK,IAAAuB,GAAQA,EACGC,EAAA1c,EAAhBob,KAAAA,OAAOp1B,IAAH02B,OAAG12B,EAAS02B,EACNC,EAAA3c,EAAVwX,MAAAA,OAAQ,IAAHmF,EAAG,GAAEA,EACAC,EAAA5c,EAAVzW,MAAAA,OAAQ,IAAHqzB,EAAG,GAAEA,EAMjB5Y,EAAQ,GACRE,EAAS,YAmCJ2Y,IACD,IAAAC,EAAW,EAIX,YAHiB,IAAVR,IACPQ,EAAWpU,OAAO4T,IAElB9T,MAAMsU,IAAaA,GAAY,GAC/B1gB,QAAQ2gB,KAAK,yDA3CJ,KA8CND,WAQFE,WACAd,EAGE/1B,KAAKC,IAAI81B,EAASlY,MAAOkY,EAAShY,QAAU,GAFvC,+YAwCZgY,EA3FK,SAAc9wB,OAEf8wB,KACC9wB,GAGI,KAAA,eAAgBA,GAAhB,CAIA,GAAA,aAAcA,GAAQ,SAAUA,EAAI,CAClCA,EAAK6xB,SAIL,IAAAC,EAAAC,EAA2B/xB,EAAKgyB,KAAhCpZ,GAAAA,EAAKkZ,EAAEhZ,GAAAA,EAAMgZ,EAAA,GAAM9S,EAAI8S,EAAA,GAE9BhB,EAAQ,CACJlY,MAAAA,EACAE,OAAAA,EACAkV,OAJUviB,MAAMoS,QAAQmB,GAAQA,EAAI,CAAIA,IAI3B7Q,KAAK,SAAA6Q,GACL,MAAA,CAAAtf,EAAGsf,YAOpB8R,EAAW9wB,EADJ1G,OAAOyC,KAAKiE,GAAM,WAGtB8wB,EAvBH9f,QAAQZ,MAAM,0KAoFP6hB,CAAcjyB,IAGzB2Y,EAAA,EAAAC,EAnCIkY,EACQA,EAASlY,MAAQgZ,IAAoBH,IAE1C,GAiCP9Y,EAAA,EAAAG,EA3BIgY,EACQA,EAAShY,OAAS8Y,IAAoBH,IAE3C,GAyBP9Y,EAAA,EAAAoY,aAtBI,IAAAmB,EAAW,GACD,OAAV/zB,IACA+zB,GAAY/zB,GAEZ,IAAAd,EAAOo0B,IACP,OAAS,IAATp0B,EACwB,IAApB60B,EAASj3B,OACF,GAEJi3B,GAEM,KAAbA,GAAoBA,EAAS5hB,SAAS,OACtC4hB,GAAY,MAENztB,GAAAA,OAAAytB,EAAQztB,eAAAA,OAAcpH,SAQhBwsB,IAChBlR,EAAA,GAAA6W,EArDIsB,EACcrsB,OAAAA,OAAAqsB,EAASlY,MAAKnU,KAAAA,OAAIqsB,EAAShY,QAE/B,OAAArU,OAAAmU,EAAK,KAAAnU,OAAIqU,uDA3ELgY,EAAQ10B,4gBCsBhB4D,MAAU,IAAV5F,EAAU,GAAO+3B,GAAgBC,gGAN/BpxB,GAAA2oB,EAAA,eAAA0I,GAAU,IAAVj4B,sEAINA,EAAQ,GAAuC,iBAAAqK,OAAoBrK,EAAK,IAA7D,0DAFCA,EAAQ,qBAL9B6E,GAUKvB,EAAAisB,EAAAzqB,4CAJW9E,EAAkB,gDAGpB,EAAAM,IAAA43B,EAAAtyB,MAAU,IAAV5F,EAAU,GAAO+3B,GAAgBC,gBAN/Btf,GAAA,EAAApY,GAAA23B,KAAAA,GAAU,IAAVj4B,gDAINA,EAAQ,GAAuC,iBAAAqK,OAAoBrK,EAAK,IAA7D,uFAFCA,EAAQ,yJA9BjB4kB,EAAcpK,EAAdoK,KACA5iB,EAAcwY,EAAdxY,MACAm2B,EAAiB3d,EAAjB2d,SACAC,EAAgB5d,EAAhB4d,QACAtY,EAAiBtF,EAAjBsF,2LAEF,SAAmB7Z,GAC1BA,EAAMU,kBAEFwxB,IAIJC,EAAO,EAEHC,GAAI,UACJzT,KAAMC,EAAmBD,GACzB5iB,OAAQA,KAIZ8d,u6CCWJjb,GAAqDvB,EAAAisB,EAAAzqB,sFAlC/CwzB,EAJOjiB,EAAamE,EAAbnE,MACAkiB,EAAoC/d,EAApC+d,SACAC,EAAkBhe,EAAlBge,UAGPC,EAAkB,oBAEtBxsB,GAAOysB,EAAAC,IAAAC,MAAA,SAAAC,IAAA,IAAAC,EAAAC,EAAAC,EAAAL,OAAAA,IAAApf,MAAA0f,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAA3tB,MAAA2tB,KAAAA,EAGc,OAHdA,EAAA3tB,KAGc,EAAA6tB,OAAiB,kBAAgB,KAAA,EAAA,GAAAF,EAAAG,GAAAP,EAAAI,EAAAI,KAAAJ,EAAAK,GAAA,OAAAL,EAAAG,GAAAH,EAAAK,GAAA,CAAAL,EAAA3tB,KAAA2tB,EAAAA,KAAAA,CAAAA,EAAAK,QAAAL,IAAAJ,EAAAI,KAAAA,EAAAA,IAAAA,EAAAK,GAAAL,CAAAA,EAAA3tB,KAAA2tB,GAAAA,KAAAA,CAAAA,EAAAM,QAAAN,EAAAA,EAAA3tB,KAAA2tB,GAAAA,MAAAA,KAAAA,GAAAA,EAAAM,GAAjCV,EAA4C,QAAA,KAAA,GAAzDC,EAAaG,EAAAM,GAEbR,MAAkBD,EAAa,CACnCzM,OAAQgM,EACRjiB,MAAAA,EACAsa,MAAO6H,EAAY,MAAQ,SAC3BiB,OAAM,SAAYpjB,GACV,IACAqjB,EACM,IAFErjB,EAAMsjB,KAAK,GAGnBtjB,EAAMqjB,IAAIrT,UAAU,EAAG,GACvBhQ,EAAMqjB,IACZnB,EAASmB,MAIbV,EAAY7d,OAEZsd,EAAkB,WAChBO,EAAY72B,wDAIhBkK,IAAS,WACPosB,0LAI2CH,EAAGvY,2wBCgC5B/f,EAAK,mBACjBA,EAAQ,YAAiCqK,OAAYrK,EAAK,IAA/C,oDAFCA,EAAQ,qBAH9B6E,GAOCvB,EAAA2V,EAAAnU,sBADW9E,EAAe,kEAFLA,EAAK,gBACjBA,EAAQ,GAAiCqK,SAAAA,OAAYrK,EAAK,IAA/C,0EAFCA,EAAQ,0EA7DpBmxB,EAAsBtkB,GAAiC,kBAAvDskB,kBAEGvM,EAAcpK,EAAdoK,KACA5iB,EAAawY,EAAbxY,MACAm2B,EAAiB3d,EAAjB2d,SACAC,EAAgB5d,EAAhB4d,QACAtY,EAAiBtF,EAAjBsF,MAIF,SAAAyY,EAASliB,GAChB+hB,EAAO,EAEHC,GAAI,UACJzT,KAAMC,EAAmBD,GACzB5iB,MAAOqU,KAIX6H,aAGOA,IACP4B,yNAfCvB,EAAA,EAAAlI,EAAQ+M,GAAYphB,YAkBd,SAAgBiE,GAAiB,IAAA2zB,EAAAC,MACpC1B,GAOE,IAEA70B,EAAS2C,EAAM3C,OACf4b,EAAM5b,EAAO6pB,wBAAwBjO,IACrC4a,UAAYF,EAAsB,QAAtBC,EAAGnO,GAAUpoB,UAAVooB,IAAmBmO,OAAnBnO,EAAAA,EAAmB/M,mBAAW,IAAAib,EAAAA,EAAI,EASvDzI,EAAkB4I,IALhB1jB,MAAOrU,EACPu2B,SAAAA,EACAC,UALgBsB,EAAe5a,EALlB,KAKkCA,EALlC,KAa0B,CACvCpa,OAAQxB,EACRsY,mBAAmB,EACnBsC,QAAAA,EACA+R,UAAW,GACXE,YAAa,EACbzR,OAnBa,4KCGb,SAAUsb,GAAcC,GAK5B,IAJA,IAAMC,EAAiBC,EAAOF,GAAU,SAACG,GAAO,OAAKA,EAAQ/pB,KAAK,IAE5DgqB,EAAiB,CAACH,EAAe,IAE9BI,EAAc,EAAGA,EAAcJ,EAAer5B,OAAQy5B,IAAe,CAC5E,IAAMC,EAAcF,EAAex5B,OAAS,EACtCwK,EAAWgvB,EAAeE,GAC1B7hB,EAAUwhB,EAAeI,GAE3B5hB,EAAQrI,OAAShF,EAASiF,IAE5B+pB,EAAeE,GAAe,CAC5BlqB,MAAO1P,KAAKmkB,IAAIzZ,EAASgF,MAAOqI,EAAQrI,OACxCC,IAAK3P,KAAKC,IAAIyK,EAASiF,IAAKoI,EAAQpI,MAItC+pB,EAAejuB,KAAKsM,EAEvB,CAED,OAAO2hB,CACT,CAGgB,SAAAG,GAAiBP,EAAqBzmB,GACpD,OAAOymB,EAASQ,MAAK,SAACL,GACpB,OAAO5mB,GAAS4mB,EAAQ/pB,OAASmD,EAAQ4mB,EAAQ9pB,GACnD,GACF,CAEM,SAAUoqB,GAAgBlnB,GAC9B,OAAOmnB,GAAmBnnB,GAASoN,EACrC,CAEM,SAAU+Z,GAAmBnnB,GACjC,OAAO7S,KAAKoiB,MAAMvP,EAAQoN,IAAsBA,EAClD,CC9BM,SAAUga,GAAoBp5B,GAClC,IAAIq5B,EAA+B,CACjCC,YAAa,CAAE,EACfC,iBAAkB,CAAE,EACpBC,mBAAoB,CAAE,EACtBhQ,UAAW,KACXiQ,aAAc,MAchB,OAXIz5B,SAAAA,EAAO4G,aAAyB5H,IAAfgB,EAAMmmB,OACzBkT,EAAaxhB,EAAAA,EAAA,CAAA,EACRwhB,GACH7P,CAAAA,EAAAA,CAAAA,UAAWxpB,EAAM4G,OAAO5G,EAAMmmB,KAAMkT,MAIpCr5B,SAAAA,EAAO05B,SACTL,EAAgBM,GAAmB35B,EAAMmmB,KAAMkT,EAAe,GAAIr5B,EAAM05B,SAGnEL,CACT,CAEgB,SAAAO,GACdP,EACAQ,GAEA,OAAOR,EAAcG,mBAAmBK,IAAYta,EACtD,UAKgBua,GACdC,EACAC,EACAntB,GAEAmtB,EAAgBl8B,SAAQ,SAAAm8B,GAAmB,IAAhBprB,EAAKorB,EAALprB,MAAOC,EAAGmrB,EAAHnrB,IAChC0U,GAAa3U,EAAO1P,KAAKmkB,IAAIyW,EAAU16B,OAAQyP,GAAMjC,EACvD,GACF,UAMgBqtB,GACd/T,EACAkT,EACAjW,GAKA,IAHA,IAAMkW,EAAWzhB,KAAiCwhB,EAAcC,aAC1DE,EAAkB3hB,EAAQwhB,CAAAA,EAAAA,EAAcG,oBAErCl6B,EAAI,EAAGA,EAAI8jB,EAAK/jB,OAAQC,IAAK,CACpC,IAAM66B,EAAc/W,EAAKxkB,MAAM,EAAGU,GAC5B86B,EAAiB/W,EAAmB8W,GAEpC35B,EAAQ65B,EAAMlU,EAAMgU,GAO1B,GALI/Y,GAAgB5gB,KAClB84B,EAAYc,IAAkB,GAI5BvqB,MAAMoS,QAAQzhB,IAAUlB,EAAI8jB,EAAK/jB,OAAQ,CAC3C,IAAMo5B,EAAWe,EAAmBY,IAAmB7a,GACjDvN,EAAQ8O,GAAIsC,EAAK9jB,IAEvB,IAAK05B,GAAiBP,EAAUzmB,GAAQ,CACtC,IAAMnD,EAAQsqB,GAAmBnnB,GAE3BsoB,EAAa,CAAEzrB,MAAAA,EAAOC,IADhBoqB,GAAgBrqB,IAE5B2qB,EAAmBY,GAAkB5B,GAAcC,EAAS5vB,OAAOyxB,GACpE,CACF,CACF,CAED,OAAAziB,EAAAA,EAAA,CAAA,EACKwhB,GAAa,CAAA,EAAA,CAChBC,YAAAA,EACAE,mBAAAA,GAEJ,CAMM,SAAUG,GACdxT,EACAkT,EACAjW,EACAmX,GAEA,IAAMjB,EAAWzhB,EAAQwhB,CAAAA,EAAAA,EAAcC,aAsCvC,IAAMkB,EAAcpX,EAAKxkB,QACnB4B,OAAiBxB,IAATmnB,EAAqBkU,EAAMlU,EAAM/C,GAAQ+C,EAKvD,YAJcnnB,IAAVwB,GAtCJ,SAASymB,EAAQzmB,GACf,IAAMi6B,EAAYD,EAAYn7B,OAE9B,GAAIwQ,MAAMoS,QAAQzhB,IAChB,GAAI+5B,EAAiBC,GAAc,CACjC,IAAMX,EAAUxW,EAAmBmX,GAGnC,GAFAlB,EAAYO,IAAW,EAEnBr5B,EAAMnB,OAAS,EAAG,CACpB,IAAM26B,EAAkBJ,GAAmBP,EAAeQ,GAE1DC,GAAoBt5B,EAAOw5B,GAAiB,SAAChoB,GAC3CwoB,EAAYC,GAAavT,OAAOlV,GAChCiV,EAAQzmB,EAAMwR,GAChB,IAEAwoB,EAAY5tB,KACb,CACF,OACQuU,GAAAA,GAAS3gB,IACd+5B,EAAiBC,GAAc,CACjClB,EAAYjW,EAAmBmX,KAAgB,EAE/C,IAAMr6B,EAAOzC,OAAOyC,KAAKK,GACzB,GAAIL,EAAKd,OAAS,EAAG,CAAAq7B,IACGC,EADHD,EAAAE,EACDz6B,GAAlB,IAAA,IAAAu6B,EAAAG,MAAAF,EAAAD,EAAAjqB,KAAAqqB,MAAwB,CAAA,IAAb/0B,EAAG40B,EAAAn6B,MACZg6B,EAAYC,GAAa10B,EACzBkhB,EAAQzmB,EAAMuF,GACf,CAAA,CAAA,MAAA4b,GAAA+Y,EAAA/tB,EAAAgV,EAAA+Y,CAAAA,QAAAA,EAAAl5B,GAEDg5B,CAAAA,EAAY5tB,KACb,CACF,CAEJ,CAKCqa,CAAQzmB,GAGVqX,EAAAA,EAAA,CAAA,EACKwhB,GACHC,CAAAA,EAAAA,CAAAA,YAAAA,GAEJ,CAcgB,SAAAyB,GAAa1B,EAA8BjW,GAEzD,IAAMkW,EAAc0B,GAAW3B,EAAcC,YAAalW,GACpDmW,EAAmByB,GAAW3B,EAAcE,iBAAkBnW,GAC9DoW,EAAqBwB,GAAW3B,EAAcG,mBAAoBpW,GAExE,OAAAvL,EAAAA,EAAA,CAAA,EACKwhB,GAAa,CAAA,EAAA,CAChBC,YAAAA,EACAC,iBAAAA,EACAC,mBAAAA,GAEJ,UAGgByB,GACd5B,EACAQ,EACAqB,GAEA,GAAIA,EAAe,CACjB,IAAMC,EAAoBtjB,KAAQwhB,EAAcE,kBAGhD,OAFA4B,EAAqBtB,GAAWqB,EAEhCrjB,EAAAA,EAAA,CAAA,EACKwhB,GACHE,CAAAA,EAAAA,CAAAA,iBAAkB4B,GAErB,CAEC,GAAuD,kBAA5C9B,EAAcE,iBAAiBM,GAAwB,CAChE,IAAMsB,EAAoBtjB,EAAA,CAAA,EAAQwhB,EAAcE,kBAEhD,cADO4B,EAAqBtB,GAC5BhiB,EAAAA,EACKwhB,CAAAA,EAAAA,GACHE,CAAAA,EAAAA,CAAAA,iBAAkB4B,GAErB,CACC,OAAO9B,CAGb,UAuCgB+B,GACdjV,EACAkT,EACAgC,GAEA,IAAMC,EAAuBC,EAAmBpV,EAAMkV,GAEhDG,EAAuBH,EAAWnf,QAAO,SAACuf,EAAeC,GAC7D,OAAIC,EAAeD,GACVE,GAAiBN,EAAaG,EAAeC,GAGlDG,EAAkBH,GACbI,GAAoBR,EAAaG,EAAeC,GAGrDK,EAAmBL,YA4FzBJ,EACAjC,EACAqC,GAEA,IAAM7B,EAAU6B,EAAUtY,KAGpBkW,EAAc0C,GAAwBV,EAAajC,EAAcC,aACjEC,EAAmByC,GAAwBV,EAAajC,EAAcE,kBACtEC,EAAqBwC,GAAwBV,EAAajC,EAAcG,oBAGzEyC,EAAaP,EAAUl7B,QAAW07B,EAAYR,EAAUl7B,eACpD84B,EAAYO,GAEhBqC,EAAYR,EAAUl7B,eAClBg5B,EAAmBK,IAExBoC,EAAaP,EAAUl7B,QAAU07B,EAAYR,EAAUl7B,gBAClD+4B,EAAiBM,GAG1B,OAAAhiB,EAAAA,EACKwhB,CAAAA,EAAAA,GACHC,CAAAA,EAAAA,CAAAA,YAAAA,EACAC,iBAAAA,EACAC,mBAAAA,GAEJ,CAvHa2C,CAAqBb,EAAaG,EAAeC,GAGtDU,EAAgBV,IAAcW,EAAgBX,YAuHpDJ,EACAjC,EACAqC,GAEA,GAAIW,EAAgBX,IAAcA,EAAU5rB,OAAS4rB,EAAUtY,KAE7D,OAAOiW,EAIT,IAAMiD,EAAgB,SAACzC,GAAoB,OACzC6B,EAAUtY,KAAOyW,EAAQhV,UAAU6W,EAAU5rB,KAAKzQ,OAAO,EACrDk9B,EAAkBC,GACtBC,GAAWpD,EAAcC,YAAaoC,EAAU5rB,MAChDwsB,GAEII,EAAuBF,GAC3BC,GAAWpD,EAAcE,iBAAkBmC,EAAU5rB,MACrDwsB,GAEIK,EAAyBH,GAC7BC,GAAWpD,EAAcG,mBAAoBkC,EAAU5rB,MACvDwsB,GAKEM,EAAevD,EACfgD,EAAgBX,KAClBkB,EAAed,GAAoBR,EAAasB,EAAc,CAC5D/F,GAAI,SACJzT,KAAMsY,EAAU5rB,QAGpB8sB,EAAehB,GAAiBN,EAAasB,EAAc,CACzD/F,GAAI,MACJzT,KAAMsY,EAAUtY,KAChB5iB,MAAO,OAIT,IAAM84B,EAAcuD,GAAWD,EAAatD,YAAaiD,GACnDhD,EAAmBsD,GAAWD,EAAarD,iBAAkBmD,GAC7DlD,EAAqBqD,GAAWD,EAAapD,mBAAoBmD,GAEvE,OAAA9kB,EAAAA,EAAA,CAAA,EACKwhB,GAAa,CAAA,EAAA,CAChBC,YAAAA,EACAC,iBAAAA,EACAC,mBAAAA,GAEJ,CAzKasD,CAAwBxB,EAAaG,EAAeC,GAGtDD,CACR,GAAEpC,GAEH,MAAO,CACLlT,KAAMmV,EACNjC,cAAemC,EAEnB,UAEgBI,GACdzV,EACAkT,EACAqC,GAEA,IAAMtY,EAAO2Z,EAAU5W,EAAMuV,EAAUtY,MACjC4Z,EAAaC,EAAQ7Z,GACrB8Z,EAAgB7Z,EAAmB2Z,GACnClS,EAASuP,EAAMlU,EAAM6W,GAE3B,GAAId,EAAYpR,GAAS,CACvB,IAAM9Y,EAAQ8O,GAAIqc,GAAK/Z,IAGjBkW,EAAc8D,GAAU/D,EAAcC,YAAa0D,EAAYhrB,EAAO,GACtEunB,EAAmB6D,GAAU/D,EAAcE,iBAAkByD,EAAYhrB,EAAO,GAClFwnB,EAAqB4D,GAAU/D,EAAcG,mBAAoBwD,EAAYhrB,EAAO,GAOxF,OAJAwnB,EAAqB6D,GAAiB7D,EAAoB0D,GAAe,SAACzE,GACxE,OAAA6E,GAAqB7E,EAAUzmB,EAAO,EAAE,IAG1C6F,EAAAA,KACKwhB,GAAa,CAAA,EAAA,CAChBC,YAAAA,EACAC,iBAAAA,EACAC,mBAAAA,GAEH,CAGD,OAAOH,CACT,UAEgByC,GACdR,EACAjC,EACAqC,GAEA,IAAMtY,EAAO2Z,EAAUzB,EAAaI,EAAUtY,MACxC4Z,EAAaC,EAAQ7Z,GACrB8Z,EAAgB7Z,EAAmB2Z,GACnClS,EAASuP,EAAMiB,EAAa0B,GAE5B1D,EAAsDD,EAAtDC,YAAaC,EAAyCF,EAAzCE,iBAAkBC,EAAuBH,EAAvBG,mBAOrC,GAJAF,EAAc0B,GAAW1B,EAAalW,GACtCmW,EAAmByB,GAAWzB,EAAkBnW,GAChDoW,EAAqBwB,GAAWxB,EAAoBpW,GAEhD8Y,EAAYpR,GAAS,CACvB,IAAM9Y,EAAQ8O,GAAIqc,GAAK/Z,IAGvBkW,EAAc8D,GAAU9D,EAAa0D,EAAYhrB,GAAQ,GACzDunB,EAAmB6D,GAAU7D,EAAkByD,EAAYhrB,GAAQ,GAInEwnB,EAAqB6D,GAHrB7D,EAAqB4D,GAAU5D,EAAoBwD,EAAYhrB,GAAQ,GAGbkrB,GAAe,SAACzE,GAAQ,OAChF6E,GAAqB7E,EAAUzmB,GAAQ,EACxC,GACF,CAED,OAAA6F,EAAAA,EAAA,CAAA,EACKwhB,GAAa,CAAA,EAAA,CAChBC,YAAAA,EACAC,iBAAAA,EACAC,mBAAAA,GAEJ,CA2FgB,SAAAwB,GAAczoB,EAAwB6Q,GACpD,IAAMma,EAAgC,CAAA,EAChC1D,EAAUxW,EAAmBD,GASnC,OANA1lB,OAAOyC,KAAKoS,GAAKzU,SAAQ,SAAC0/B,GACnBC,EAAsBD,EAAa3D,KACtC0D,EAAWC,GAAejrB,EAAIirB,GAElC,IAEOD,CACT,CAGgB,SAAAd,GAAclqB,EAAwBsnB,GACpD,IAAM6D,EAAiC,CAAA,EAQvC,OANAhgC,OAAOyC,KAAKoS,GAAKzU,SAAQ,SAAC0/B,GACpBC,EAAsBD,EAAa3D,KACrC6D,EAAYF,GAAejrB,EAAIirB,GAEnC,IAEOE,CACT,CAGgB,SAAAb,GAAc3+B,EAAsBC,GAClD,OAAA0Z,EAAAA,EAAA,CAAA,EAAY3Z,GAAMC,EACpB,CAGgB,SAAAq+B,GACdjqB,EACAorB,GAEA,IAAMC,EAA8B,CAAA,EAOpC,OALAlgC,OAAOyC,KAAKoS,GAAKzU,SAAQ,SAAC+/B,GACxB,IAAMC,EAAaH,EAAcE,GACjCD,EAASE,GAAcvrB,EAAIsrB,EAC7B,IAEOD,CACT,CAEM,SAAUR,GACd7qB,EACA6Q,EACApR,EACAiS,GAOA,IALA,IAAM8Z,EAAe3a,EAAK/jB,OACpBw6B,EAAUxW,EAAmBD,GAG7B4a,EAA4E,GAClFC,EAAA,EAAAC,EAA0BxgC,OAAOyC,KAAKoS,GAAI0rB,EAAAC,EAAA7+B,OAAA4+B,IAAE,CAAvC,IAAMT,EAAWU,EAAAD,GACpB,GAAIR,EAAsBD,EAAa3D,GAAU,CAC/C,IAAMsE,EAAqB5a,EAAiBia,GACtC/C,EAAY3Z,GAAIqd,EAASJ,IAE3BtD,GAAazoB,IACfmsB,EAASJ,GAAgB7W,OAAOuT,EAAYxW,GAE5C+Z,EAAQpzB,KAAK,CACXizB,WAAYL,EACZM,WAAYza,EAAmB8a,GAC/B39B,MAAO+R,EAAIirB,KAGhB,CACF,CAGD,GAAuB,IAAnBQ,EAAQ3+B,OACV,OAAOkT,EAGT,IAAMgrB,EAAU1lB,EAAQtF,CAAAA,EAAAA,GAaxB,OATAyrB,EAAQlgC,SAAQ,SAACk1B,UACRuK,EAAWvK,EAAM6K,WAC1B,IAGAG,EAAQlgC,SAAQ,SAACk1B,GACfuK,EAAWvK,EAAM8K,YAAc9K,EAAMxyB,KACvC,IAEO+8B,CACT,CAGgB,SAAAvB,GACd7V,EACA5T,GAEA,IAAMgrB,EAAgC,CAAA,EAWtC,OANA7/B,OAAOyC,KAAKoS,GACTvI,QAAO,SAAC6vB,GAAO,OAAKuE,EAASjY,EAAM4W,EAAU5W,EAAM0T,GAAS,IAC5D/7B,SAAQ,SAAC+7B,GACR0D,EAAW1D,GAAWtnB,EAAIsnB,EAC5B,IAEK0D,CACT,UAOgBF,GACd9qB,EACAsnB,EACAhtB,GAEA,IAAMrM,EAAQ+R,EAAIsnB,GAElB,GAAIA,KAAWtnB,EAAK,CAClB,IAAM8rB,EAAexxB,EAASrM,GAC9B,IAAK89B,GAAQ99B,EAAO69B,GAAe,CACjC,IAAMd,EAAU1lB,EAAA,CAAA,EAAQtF,GAQxB,YANqBvT,IAAjBq/B,SACKd,EAAW1D,GAElB0D,EAAW1D,GAAWwE,EAGjBd,CACR,CACF,CAED,OAAOhrB,CACT,UAKgB+qB,GACdtD,EACAhoB,EACAiS,GASA,OAIF,SAA+B+V,GAC7B,IAAM/6B,EAAS+6B,EAAgBp7B,MAAM,GAEjCU,EAAI,EACR,KAAOA,EAAIL,EAAOI,QACZJ,EAAOK,EAAI,GAAGwP,MAAQ7P,EAAOK,GAAGuP,QAClC5P,EAAOK,EAAI,GAAK,CACduP,MAAO5P,EAAOK,EAAI,GAAGuP,MACrBC,IAAK7P,EAAOK,GAAGwP,KAEjB7P,EAAO+U,OAAO1U,IAEhBA,IAGF,OAAOL,CACT,CApBSs/B,CAPiBvE,EAAgBznB,KAAI,SAACqmB,GAC3C,MAAO,CACL/pB,MAAO+pB,EAAQ/pB,MAAQmD,EAAQ4mB,EAAQ/pB,MAAQoV,EAAS2U,EAAQ/pB,MAChEC,IAAK8pB,EAAQ9pB,IAAMkD,EAAQ4mB,EAAQ9pB,IAAMmV,EAAS2U,EAAQ9pB,IAE9D,IAGF,CAqBM,SAAU0vB,GACdh+B,EACA+4B,EACAM,EACA7X,GAEA,IAAMkZ,EAAgB3B,EAAmBA,EAAiBM,QAAW76B,EAErE,MAA6B,kBAAlBk8B,EACFA,EjBzeK,SAAiCnyB,EAAciZ,GAC7D,MAAsB,iBAARjZ,GAA0D,iBAA/BuZ,GAAcvZ,EAAKiZ,EAC9D,CiB0eSyc,CAAiCj+B,EAAOwhB,EACjD,CAEM,SAAU0c,GAAYv+B,EAAgB4F,GAA+B,IAAlB44B,EAAUl3B,UAAApI,OAAA,QAAAL,IAAAyI,UAAAzI,IAAAyI,UAAA,GAC3DuK,EAAQ7R,EAAK+F,QAAQH,GAC3B,OAAe,IAAXiM,EACK2sB,EAAax+B,EAAKvB,MAAMoT,GAAS7R,EAAKvB,MAAMoT,EAAQ,GAGpD,EAEX,CAMgB,SAAA4sB,GAAgBzY,EAAekT,GAC7C,IAAMjH,EAAoB,GAwB1B,OAtBA,SAASyM,EAASr+B,EAAgB4iB,GAChCgP,EAAMxnB,KAAKwY,GACX,IAAMyW,EAAUxW,EAAmBD,GAEnC,GAAI5iB,IAAgD,IAAvC64B,EAAcC,YAAYO,GAAmB,CACxD,GAAIqC,EAAY17B,GAAQ,CACtB,IAAMw5B,EAAkBJ,GAAmBP,EAAeQ,GAC1DC,GAAoBt5B,EAAOw5B,GAAiB,SAAChoB,GAC3C6sB,EAASr+B,EAAMwR,GAAQoR,EAAKva,OAAOqe,OAAOlV,IAC5C,GACD,CAEGiqB,EAAaz7B,IACf9C,OAAOyC,KAAKK,GAAO1C,SAAQ,SAACiI,GAC1B84B,EAASr+B,EAAMuF,GAAMqd,EAAKva,OAAO9C,GACnC,GAEH,CACF,CAED84B,CAAS1Y,EAAM,IAERiM,CACT,CAOM,SAAU0M,GACd3Y,EACAkT,GACoB,IAApB0F,IAAat3B,UAAApI,OAAA,QAAAL,IAAAyI,UAAA,KAAAA,UAAA,GAEP2qB,EAAyB,GA2C/B,OAzCA,SAASyM,EAASr+B,EAAgB4iB,GAChCgP,EAAMxnB,KAAK,CAAEwY,KAAAA,EAAM9b,KAAMoX,GAAUle,QAEnC,IAAMq5B,EAAUxW,EAAmBD,GACnC,GAAI5iB,IAAgD,IAAvC64B,EAAcC,YAAYO,GAAmB,CAKxD,GAJIkF,GACF3M,EAAMxnB,KAAK,CAAEwY,KAAAA,EAAM9b,KAAMoX,GAAU8L,SAGjC0R,EAAY17B,GAAQ,CACtB,IAAMw5B,EAAkBJ,GAAmBP,EAAeQ,GAC1DC,GAAoBt5B,EAAOw5B,GAAiB,SAAChoB,GAC3C,IAAMmsB,EAAW/a,EAAKva,OAAOqe,OAAOlV,IAEpC6sB,EAASr+B,EAAMwR,GAAQmsB,GAEnBY,GACF3M,EAAMxnB,KAAK,CAAEwY,KAAM+a,EAAU72B,KAAMoX,GAAU+L,OAEjD,GACD,CAED,GAAIwR,EAAaz7B,GACF9C,OAAOyC,KAAKK,GACpB1C,SAAQ,SAACiI,GACZ,IAAMi5B,EAAe5b,EAAKva,OAAO9C,GAEjCqsB,EAAMxnB,KAAK,CAAEwY,KAAM4b,EAAc13B,KAAMoX,GAAU3Y,MAEjD84B,EAASr+B,EAAMuF,GAAMi5B,GAEjBD,GACF3M,EAAMxnB,KAAK,CAAEwY,KAAM4b,EAAc13B,KAAMoX,GAAU+L,OAErD,GAEH,CACF,CAEDoU,CAAS1Y,EAAM,IAERiM,CACT,UA6BgB6M,GACd9Y,EACAkT,EACAjW,GAEA,IAAM8b,EAAeN,GAAgBzY,EAAMkT,GAErCrnB,EADsBktB,EAAa3sB,IAAI8Q,GACXnd,QAAQmd,EAAmBD,IAE7D,OAAe,IAAXpR,GAAgBA,EAAQktB,EAAa7/B,OAAS,EACzC6/B,EAAaltB,EAAQ,GAGvB,IACT,UAOgBmtB,GACdhZ,EACAkT,EACAjW,GAEA,IAAMgc,EAAsC/E,EAAMlU,EAAM/C,GACxD,YAAuBpkB,IAAnBogC,EACK/F,EAMFM,GAAmBxT,EAAMkT,EAAejW,GAHnBwD,GAAe,CAAET,KAAMiZ,GAAkBzf,IACzB0f,GAAYC,GAG1D,CAGM,SAAUA,GAAclc,GAC5B,OAAuB,IAAhBA,EAAK/jB,QAAsC,IAAhB+jB,EAAK/jB,QAA4B,MAAZ+jB,EAAK,EAC9D,UAGgBic,KACd,OAAO,CACT,CCrzBM,SAAUE,GACd/V,GAEA,OAAQA,GAAaA,EAAUliB,OAASmX,GAAcgM,QAAU,CAClE,CAEM,SAAU+U,GACdhW,GAEA,OAAQA,GAAaA,EAAUliB,OAASmX,GAAc+L,SAAW,CACnE,CAEM,SAAUiV,GAAejW,GAC7B,OAAQA,GAAaA,EAAUliB,OAASmX,GAAc1Y,MAAQ,CAChE,CAEM,SAAU25B,GACdlW,GAEA,OAAQA,GAAaA,EAAUliB,OAASmX,GAAcje,QAAU,CAClE,CAEM,SAAUm/B,GACdnW,GAEA,OAAQA,GAAaA,EAAUliB,OAASmX,GAAciM,QAAU,CAClE,CAEM,SAAUkV,GACdpW,GAEA,OAAOmW,GAAiBnW,IAAc8U,GAAQ9U,EAAUqW,UAAWrW,EAAUsW,WAC/E,CAEM,SAAUC,GAAgBvW,GAC9B,OACEmW,GAAiBnW,IACjB+V,GAAiB/V,IACjBgW,GAAkBhW,IAClBiW,GAAejW,IACfkW,GAAiBlW,EAErB,CAEM,SAAUwW,GAAgBxW,GAC9B,OAAQA,GAAaA,EAAUliB,OAASmX,GAActa,OAAS,CACjE,CAMgB,SAAA87B,GAAkB9Z,EAAeqD,GAC/C,IAAM4I,EAAoB,GAM1B,gBAcAjM,EACAqD,EACA3c,GAEA,IAAK2c,EACH,OAGF,IAAMsW,EAAaI,GAAc1W,GAC3BqW,EAAYM,GAAa3W,GAE/B,GAAI8U,GAAQwB,EAAYD,GAEtB,OAAOhzB,EAASizB,GAGhB,QAAa9gC,IAATmnB,EACF,OAGF,IAAMia,EAAaC,GAAeP,EAAYD,GAE9C,GAAIC,EAAWzgC,SAAW+gC,EAAW/gC,QAAUwgC,EAAUxgC,SAAW+gC,EAAW/gC,OAE7E,OAAOwN,EAASuzB,GAGlB,IAAM5W,EAAY8W,GAAqBR,EAAYD,GAC7CU,EAAYC,GAAara,EAAMqD,GAC/BiX,EAAUC,GAAWva,EAAMqD,GAE3BmX,EAAaC,GAAcza,EAAMqD,EAAW+W,GAC5CM,EAAWD,GAAcza,EAAMqD,EAAWiX,GAEhD,IAAoB,IAAhBE,IAAmC,IAAdE,EACvB,OAGF,IAAMrgC,EAAQ65B,EAAMlU,EAAMia,GAE1B,GAAInE,EAAaz7B,GAAQ,CAGvB,IAFA,IAAML,EAAOzC,OAAOyC,KAAKK,GAEhBlB,EAAIqhC,EAAYrhC,GAAKuhC,EAAUvhC,IAAK,CAC3C,IAAMkB,EAAQqM,EAASuzB,EAAWv3B,OAAO1I,EAAKb,KAC9C,QAAcN,IAAVwB,EACF,OAAOA,CAEV,CAED,MACD,CAED,GAAI07B,EAAY17B,GAAQ,CACtB,IAAK,IAAIlB,EAAIqhC,EAAYrhC,GAAKuhC,EAAUvhC,IAAK,CAC3C,IAAMkB,EAAQqM,EAASuzB,EAAWv3B,OAAOqe,OAAO5nB,KAChD,QAAcN,IAAVwB,EACF,OAAOA,CAEV,CAED,MACD,CAGH,MAAM,IAAIgK,MAAM,6BAClB,CApFEs2B,CAAqB3a,EAAMqD,GAAW,SAACpG,GACrCgP,EAAMxnB,KAAKwY,EACb,IAEOgP,CACT,CAiFM,SAAU2O,GAAcvX,GAC5B,OAAIgW,GAAkBhW,GACbA,EAAUpG,KAEV6Z,EAAQkD,GAAa3W,GAEhC,CAEgB,SAAAgX,GAAara,EAAeqD,GAC1C,IAAKmW,GAAiBnW,GACpB,OAAOA,EAAUpG,KAGnB,IAAM4d,EAAcJ,GAAcza,EAAMqD,EAAWA,EAAUsW,YAG7D,OAFmBc,GAAcza,EAAMqD,EAAWA,EAAUqW,WAExCmB,EAAcxX,EAAUqW,UAAYrW,EAAUsW,UACpE,CAEgB,SAAAY,GAAWva,EAAeqD,GACxC,IAAKmW,GAAiBnW,GACpB,OAAOA,EAAUpG,KAGnB,IAAM4d,EAAcJ,GAAcza,EAAMqD,EAAWA,EAAUsW,YAG7D,OAFmBc,GAAcza,EAAMqD,EAAWA,EAAUqW,WAExCmB,EAAcxX,EAAUqW,UAAYrW,EAAUsW,UACpE,CAUM,SAAUmB,GACd9a,EACAkT,GACA,IAAA6H,EAAcz5B,UAAApI,OAAA,QAAAL,IAAAyI,UAAA,IAAAA,UAAG,GAEX+hB,EAAY6P,EAAc7P,UAChC,IAAKA,EACH,OAAO,KAGT,IAAMqW,EAAYqB,EAAiBf,GAAa3W,GAAagX,GAAara,EAAMqD,GAC1E2X,WDqjBNhb,EACAkT,EACAjW,GAEA,IAAM8b,EAAeN,GAAgBzY,EAAMkT,GACrC+H,EAAsBlC,EAAa3sB,IAAI8Q,GACvCge,EAAche,EAAmBD,GACjCpR,EAAQovB,EAAoBl7B,QAAQm7B,GAE1C,OAAe,IAAXrvB,GAAgBA,EAAQ,EACnBktB,EAAaltB,EAAQ,GAGvB,IACT,CCnkBuBsvB,CAAuBnb,EAAMkT,EAAewG,GAEjE,GAAIqB,EAEF,OAAI1B,GAAkBhW,IAAc+V,GAAiB/V,GAC3B,OAAjB2X,EAAwBb,GAAqBT,EAAWA,GAAa,KAGtD,OAAjBsB,EACHb,GAAqBJ,GAAc1W,GAAY2X,GAC/C,KAGN,GAAI5B,GAAiB/V,GAGnB,OAAO+X,GAAqB1B,GAAW,GAGzC,GAAIL,GAAkBhW,GAEpB,OAAO+X,GAAqB1B,GAAW,GAGzC,GAAIJ,GAAejW,GAAY,CAC7B,GAAoB,MAAhB2X,GAAgD,IAAxBA,EAAa9hC,OACvC,YAGF,IAAM29B,EAAaC,EAAQkE,GACrBrW,EAASuP,EAAMlU,EAAM6W,GAC3B,OAAIntB,MAAMoS,QAAQ6I,IAAW2F,EAAQ0Q,GAE5BI,GAAqBJ,GAAc,GAEnCK,GAAmBL,GAAc,EAE3C,CAED,OAAIzB,GAAiBlW,GACK,OAAjB2X,EAAwBI,GAAqBJ,GAAc,GAAS,IAQ/E,UAuGgBM,GACdtb,EACAkT,EACA0F,GAEA,IAAMvV,EAAY6P,EAAc7P,UAChC,IAAKA,EACH,MAAO,CAAEkY,MAAO,KAAM73B,SAAU,KAAME,KAAM,MAE9C,IAAM43B,EAAwB7C,GAAyB3Y,EAAMkT,EAAe0F,GAEtE/sB,EAAQ2vB,EAAsBjS,WAAU,SAACgS,GAC7C,OACEpD,GAAQoD,EAAMte,KAAM+c,GAAa3W,KAAetC,OAAOwa,EAAMp6B,QAAU4f,OAAOsC,EAAUliB,KAE5F,IAEA,MAAO,CACLo6B,OAAkB,IAAX1vB,EAAe2vB,EAAsB3vB,GAAS,KAErDnI,UAAqB,IAAXmI,GAAgBA,EAAQ,EAAI2vB,EAAsB3vB,EAAQ,GAAK,KAEzEjI,MACa,IAAXiI,GAAgBA,EAAQ2vB,EAAsBtiC,OAAS,EACnDsiC,EAAsB3vB,EAAQ,GAC9B,KAEV,CA4EgB,SAAA4vB,GAAoBzb,EAAekT,GAKjD,IAJA,IAAM6F,EAAeN,GAAgBzY,EAAMkT,GAGvCrnB,EAAQ,EAEVA,EAAQktB,EAAa7/B,OAAS,GAC9B6/B,EAAaltB,EAAQ,GAAG3S,OAAS6/B,EAAaltB,GAAO3S,QAErD2S,IAGF,IAAMoR,EAAO8b,EAAaltB,GAC1B,YAAgBhT,IAATokB,GAAsC,IAAhBA,EAAK/jB,QAAgBwQ,MAAMoS,QAAQoY,EAAMlU,EAAM8W,EAAQ7Z,KAChFme,GAAqBne,GAAM,GAC3Boe,GAAmBpe,GAAM,EAC/B,CAEgB,SAAAye,GACd1b,EACAkV,GAEA,GAA0B,IAAtBA,EAAWh8B,OAAc,CAC3B,IAAMq8B,EAAYtqB,GAAMiqB,GACxB,GAAqB,YAAjBK,EAAU7E,GAIZ,OAAO0K,GAFMxE,EAAU5W,EAAMuV,EAAUtY,OAEL,EAErC,CAED,IAAKqN,EAAQ4K,IAAeA,EAAWyG,OAAM,SAACpG,GAAS,MAAsB,SAAjBA,EAAU7E,EAAa,IAAG,CACpF,IAAMkL,EAAU3wB,GAAMiqB,GAChB2G,EAAW3G,EAAWz8B,MAAM,GAElC,IACGw9B,EAAgB2F,IAAY1F,EAAgB0F,KAC7CA,EAAQjyB,OAASiyB,EAAQ3e,MACzB4e,EAASF,OAAM,SAACjL,GAAO,OAACuF,EAAgBvF,IAAOwF,EAAgBxF,KAAQA,EAAG/mB,OAAS+mB,EAAGzT,IAAK,IAK3F,OAAOoe,GAFMzE,EAAU5W,EAAM4b,EAAQ3e,OAEL,EAEnC,CAED,IAAMgP,EAAQiJ,EACXrxB,QAAO,SAAC0xB,GACP,MACmB,SAAjBA,EAAU7E,IACO,WAAjB6E,EAAU7E,KACQ,SAAjB6E,EAAU7E,IAAiB6E,EAAU5rB,OAAS4rB,EAAUtY,OAC/B,iBAAnBsY,EAAUtY,IAErB,IACC7Q,KAAI,SAACmpB,UAAcqB,EAAU5W,EAAMuV,EAAUtY,SAEhD,OAAIqN,EAAQ2B,GACC,KAKN,CACL9qB,KAAMmX,GAAciM,MACpBoV,WAAY1uB,GAAMghB,GAClByN,UAAW1C,GAAK/K,GAEpB,CAOgB,SAAAiO,GAAe4B,EAAiBC,GAE9C,IADA,IAAI5iC,EAAI,EACDA,EAAI2iC,EAAM5iC,QAAUC,EAAI4iC,EAAM7iC,QAAU4iC,EAAM3iC,KAAO4iC,EAAM5iC,IAChEA,IAGF,OAAO2iC,EAAMrjC,MAAM,EAAGU,EACxB,CAEM,SAAU6iC,GAAmB3Y,GACjC,OACEiW,GAAejW,IACfkW,GAAiBlW,IACjBoW,GAA4BpW,EAEhC,CAEgB,SAAA4Y,GAAajc,EAAeqD,GAC1C,OAAO2Y,GAAmB3Y,IAAcpI,GAAgBiZ,EAAMlU,EAAMga,GAAa3W,KAC7E2W,GAAa3W,GACbyT,EAAQkD,GAAa3W,GAC3B,CAGgB,SAAA6Y,GAAejf,EAAgB4Z,GAC7C,GAAI5Z,EAAK/jB,OAAS29B,EAAW39B,OAC3B,OAAY,EAGd,IAAK,IAAIC,EAAI,EAAGA,EAAI09B,EAAW39B,OAAQC,IACrC,GAAI8jB,EAAK9jB,KAAO09B,EAAW19B,GACzB,OAAO,EAIX,OAAW,CACb,CAGM,SAAUgjC,GAA4BjJ,GAC1C,IAAM7P,EAAY6P,EAAc7P,UAEhC,OAAKiW,GAAejW,IAAckW,GAAiBlW,KAAeA,EAAU+Y,KAC1E1qB,EAAAA,EAAA,CAAA,EACKwhB,GACH7P,CAAAA,EAAAA,CAAAA,UAAS3R,EAAAA,EAAA,CAAA,EACJ2R,GAAS,CAAA,EAAA,CACZ+Y,MAAM,MAKLlJ,CACT,CAEgB,SAAAmI,GAAmBpe,EAAgBmf,GACjD,MAAO,CACLj7B,KAAMmX,GAAc1Y,IACpBqd,KAAAA,EACAmf,KAAAA,EAEJ,CAEgB,SAAAhB,GAAqBne,EAAgBmf,GACnD,MAAO,CACLj7B,KAAMmX,GAAcje,MACpB4iB,KAAAA,EACAmf,KAAAA,EAEJ,CAEM,SAAUC,GAAsBpf,GACpC,MAAO,CACL9b,KAAMmX,GAAc+L,OACpBpH,KAAAA,EAEJ,CAEM,SAAUqf,GAAqBrf,GACnC,MAAO,CACL9b,KAAMmX,GAAcgM,MACpBrH,KAAAA,EAEJ,CAEgB,SAAAkd,GAAqBR,EAAsBD,GAEzD,IAAMO,EAAaC,GAAeP,EAAYD,GACxC6C,EAAW5C,EAAWzgC,OAAS+gC,EAAW/gC,QAAUwgC,EAAUxgC,OAAS+gC,EAAW/gC,OAExF,MAAO,CACLiI,KAAMmX,GAAciM,MACpBoV,WAAY4C,EAAWtC,EAAWv3B,OAAOi3B,EAAWM,EAAW/gC,SAAW+gC,EAC1EP,UAAW6C,EAAWtC,EAAWv3B,OAAOg3B,EAAUO,EAAW/gC,SAAW+gC,EAE5E,CAMM,SAAUuC,GACdxc,EACAqD,EACAhD,EACAxE,GAEA,GAAIyd,GAAejW,GACjB,OAAOtC,OAAOiW,GAAK3T,EAAUpG,OAG/B,GAAIsc,GAAiBlW,GAAY,CAAAoZ,IAAAA,EACzBpiC,EAAQ65B,EAAMlU,EAAMqD,EAAUpG,MACpC,MAAwB,iBAAV5iB,EAAqBA,EAAkDoiC,QAA7CA,EAAG5gB,EAAOG,UAAU3hB,EAAO,KAAMgmB,cAAYoc,EAAAA,EAAI,IAC1F,CAED,GAAIjD,GAAiBnW,GAAY,CACG,IAAAqZ,EAAlC,GAAIpS,EAAQjH,EAAUqW,WAEpB,OAAgD,QAAhDgD,EAAO7gB,EAAOG,UAAUgE,EAAM,KAAMK,UAAYqc,IAAAA,EAAAA,EAAI,KAGtD,IAAM7F,EAAa+D,GAAcvX,GAC3BsB,EAASuP,EAAMlU,EAAM6W,GAC3B,GAAIntB,MAAMoS,QAAQ6I,GAAS,CACzB,GAAI8U,GAA4BpW,GAAY,CAAAsZ,IAAAA,EAEpCzQ,EAAOgI,EAAMlU,EAAMqD,EAAUqW,WACnC,eAAAiD,EAAO9gB,EAAOG,UAAUkQ,EAAM,KAAM7L,UAAY,IAAAsc,EAAAA,EAAI,IACrD,CACC,OAAO7C,GAAkB9Z,EAAMqD,GAC5BjX,KAAI,SAAC6Q,GACJ,IAAMiP,EAAOgI,EAAMlU,EAAM/C,GACzB,MAAA,GAAAva,OAAUmZ,EAAOG,UAAUkQ,EAAM,KAAM7L,GACzC,IAAA,IACCrc,KAAK,KAEX,CAEC,OAAO81B,GAAkB9Z,EAAMqD,GAC5BjX,KAAI,SAAC6Q,GACJ,IAAMrd,EAAMo3B,GAAK/Z,GACX5iB,EAAQ65B,EAAMlU,EAAM/C,GAC1B,MAAA,GAAAva,OAAUmZ,EAAOG,UAAUpc,GAAI,MAAA8C,OAAKmZ,EAAOG,UAAU3hB,EAAO,KAAMgmB,GAAY,IAChF,IACCrc,KAAK,KAEX,CAED,OAAO,IACT,CAEM,SAAU44B,GAAmBvZ,GACjC,OAAQiW,GAAejW,IAAckW,GAAiBlW,MAAkC,IAAnBA,EAAU+Y,IACjF,CA0BM,SAAUS,GAAqBxZ,GACnC,OAAOiW,GAAejW,IAAckW,GAAiBlW,IAAcmW,GAAiBnW,EACtF,CAMM,SAAUyZ,GAAWzZ,GACzB,OACEiW,GAAejW,IACfkW,GAAiBlW,IACjBoW,GAA4BpW,EAEhC,CAGM,SAAU0Z,GAAkBC,GAChC,OAAQA,EAAc77B,MACpB,KAAKoX,GAAU3Y,IACb,OAAOy7B,GAAmB2B,EAAc/f,MAAM,GAChD,KAAK1E,GAAUle,MACb,OAAO+gC,GAAqB4B,EAAc/f,MAAM,GAClD,KAAK1E,GAAU+L,MACb,OAAOgY,GAAqBU,EAAc/f,MAC5C,KAAK1E,GAAU8L,OACb,OAAOgY,GAAsBW,EAAc/f,MAEjD,UAGgBggB,GACdjd,EACAkd,EACAjgB,GAEA,OAAQigB,GACN,KAAK5kB,GAAc1Y,IACjB,OAAOy7B,GAAmBpe,GAAM,GAClC,KAAK3E,GAAcje,MACjB,OAAO+gC,GAAqBne,GAAM,GACpC,KAAK3E,GAAcgM,MACjB,OAAOgY,GAAqBrf,GAC9B,KAAK3E,GAAc+L,OACjB,OAAOgY,GAAsBpf,GAC/B,KAAK3E,GAAciM,MACnB,KAAKjM,GAActa,KACjB,OAAOm8B,GAAqBld,EAAMA,GAExC,UAEgBkgB,GACdnd,EACAqD,EACApG,GAEA,OAAKoG,IAID+Z,GAAgBpd,EAAMqD,EAAWpG,IAKjCif,GADe1C,GAAiBnW,GAAayT,EAAQzT,EAAUqW,WAAarW,EAAUpG,KAC3DA,IAJtBoG,EAJI,IAaf,UAEgB+Z,GACdpd,EACAqD,EACApG,GAEA,QAAapkB,IAATmnB,IAAuBqD,EACzB,OAAO,EAGT,GAAIiW,GAAejW,IAAcgW,GAAkBhW,IAAc+V,GAAiB/V,GAChF,OAAO8U,GAAQ9U,EAAUpG,KAAMA,GAGjC,GAAIsc,GAAiBlW,GACnB,OAAO6Y,GAAejf,EAAMoG,EAAUpG,MAGxC,GAAIuc,GAAiBnW,GAAY,CAC/B,IAAM+W,EAAYC,GAAara,EAAMqD,GAC/BiX,EAAUC,GAAWva,EAAMqD,GAC3BwT,EAAaC,EAAQzT,EAAUqW,WAErC,IAAKwC,GAAejf,EAAM4Z,IAAe5Z,EAAK/jB,QAAU29B,EAAW39B,OACjE,SAGF,IAAMshC,EAAaC,GAAcza,EAAMqD,EAAW+W,GAC5CM,EAAWD,GAAcza,EAAMqD,EAAWiX,GAC1ChG,EAAYmG,GAAcza,EAAMqD,EAAWpG,GACjD,OAAsB,IAAfqX,GAAoBA,GAAakG,GAAclG,GAAaoG,CACpE,CAED,OAAO,CACT,CAEA,SAASD,GAAcza,EAAeqD,EAA2BpG,GAC/D,IAAM4Z,EAAaC,EAAQzT,EAAUqW,WACrC,IAAKwC,GAAejf,EAAM4Z,IAAe5Z,EAAK/jB,QAAU29B,EAAW39B,OACjE,OAAQ,EAGV,IAAM0G,EAAMqd,EAAK4Z,EAAW39B,QACtByrB,EAASuP,EAAMlU,EAAM6W,GAE3B,GAAIf,EAAanR,GAEf,OADaptB,OAAOyC,KAAK2qB,GACb5kB,QAAQH,GAGtB,GAAIm2B,EAAYpR,GAAS,CACvB,IAAM9Y,EAAQ8O,GAAI/a,GAClB,GAAIiM,EAAQ8Y,EAAOzrB,OACjB,OAAO2S,CAEV,CAED,OAAQ,CACV,CAGM,SAAUmuB,GAAa3W,GAC3B,OAAOmW,GAAiBnW,GAAaA,EAAUqW,UAAYrW,EAAUpG,IACvE,CAGM,SAAU8c,GAAc1W,GAC5B,OAAOmW,GAAiBnW,GAAaA,EAAUsW,WAAatW,EAAUpG,IACxE,CCp2BgB,SAAAogB,KACI,IAAlB,IAAMC,EAAU,GAAEC,EAAAj8B,UAAApI,OADU6V,MAAyDrF,MAAA6zB,GAAAC,EAAAA,EAAAA,EAAAD,EAAAC,IAAzDzuB,EAAyDyuB,GAAAl8B,UAAAk8B,GAGrF,QAAAC,EAAA,EAAAC,EAAkB3uB,EAAI0uB,EAAAC,EAAAxkC,OAAAukC,IAAE,CAAnB,IAAME,EAAGD,EAAAD,GAKZ,GAJmB,iBAARE,GACTL,EAAQ74B,KAAKk5B,GAGXA,GAAsB,WAAf1lC,EAAO0lC,GAChB,IAAK,IAAM/9B,KAAO+9B,EACZpmC,OAAOqmC,eAAe/+B,KAAK8+B,EAAK/9B,IAAQ+9B,EAAI/9B,IAC9C09B,EAAQ74B,KAAK7E,EAIpB,CAED,OAAO09B,EAAQt5B,KAAK,IACtB,CCtBgB,SAAA65B,GAAcxjC,EAAgBwhB,GAG5C,OAAOwhB,GAAW,YAAa,OAFlBzhB,GAAUvhB,EAAOwhB,GAEgB,CAC5C,UAAWK,GAAM7hB,GACjB,YAA8B,iBAAVA,GAAuC,IAAjBA,EAAMnB,QAEpD,k/CCmJS+F,GAAA2oB,EAAA,QAAAkW,EAAA1jC,GAAAijC,GAAW,mBAAoBhlC,EAAc,GAAA,CAAA,iBAAkBA,EAAS,MAAA,6FAHjF6E,GAWCvB,EAAAisB,EAAAzqB,gCALW9E,EAAgB,mBACdA,EAAkB,iBACpBA,EAAgB,gBACjBA,EAAU,4BANZ,SAAA,IAAAylC,KAAAA,EAAA1jC,GAAAijC,GAAW,mBAAoBhlC,EAAc,GAAA,CAAA,iBAAkBA,EAAS,MAAA,qHAxI3E0lC,EACAC,EAXE7vB,EAAQH,GAAY,0BAEf3T,EAAawY,EAAbxY,MACA4jC,EAAiBprB,EAAjBqrB,UAAAA,OAAY,IAAHD,GAAQA,EACjBrN,EAAiF/d,EAAjF+d,SACAuN,EAAoBtrB,EAApBsrB,SACAC,EAAcvrB,EAAdurB,OACAC,EAAuBxrB,EAAvByrB,QAAAA,WAAOD,EAAYxnC,GAAIwnC,EACvBE,EAAkD1rB,EAAlD2rB,aAAAA,OAAY,IAAAD,mBAAoC,EAAE,EAAAA,EAKzDE,GAAS,WAiCJC,WACFX,ElB+EH,SAA8B//B,GAClC,OAAOA,EAAKgY,QAAQ,MAAO,GAC7B,CkB9EW2oB,CAAoBZ,EAASa,WAF3B,GAKF,SAAAC,EAAY3G,GACd6F,GAGLnnB,EAAA,EAAAmnB,EAASa,UAAYpc,GAAiB0V,GAAY6F,YAG3Ce,IACD,IAAAC,EAAWL,IAEA,KAAbK,GAEFF,EAAY,QAIdb,EAAaQ,EAAaO,aAGnBC,IAEPP,GAAS,EAETN,WA7DF75B,IAAO,WACL6J,EAAM,UAAS,CAAI9T,MAAAA,IACnBwkC,EAAYxkC,GAGR0jC,IACF9a,GAAe8a,OAKfA,EAASrX,QAAUoY,EAAgBf,OAMnCA,EAASpX,OAASqY,EAAYjB,OAIlCr5B,IAAS,WACD,IAAAq6B,EAAWL,IAEjBvwB,EAAM,YAAW,CAAIswB,OAAAA,EAAQpkC,MAAAA,EAAO0kC,SAAAA,IAE/BN,GAAUM,IAAa1kC,GAC1Bu2B,EAASmO,EAAUpmB,GAA2BsmB,mTA9B/CroB,EAAA,EAAAonB,EAAaQ,EAAankC,cAmEpB,SAAmBiE,GAC1BA,EAAMU,sBAEAkgC,EAAQtY,GAAkBtoB,GAM5B,GAJU,WAAV4gC,GACFF,IAGY,UAAVE,GAA+B,QAAVA,EAAe,CAEtCT,GAAS,EAEH,IAAAM,EAAWL,IACjB9N,EAASmO,EAAUpmB,GAA2BwmB,YAGlC,WAAVD,IACF5gC,EAAMM,iBACNw/B,GAAO,IAGK,WAAVc,IACF5gC,EAAMM,iBACNw/B,GAAO,KAIF,SAAiB9/B,MACxBA,EAAMU,kBAEDs/B,GAAYhgC,EAAM8gC,eAIjB,IAAAC,EAAgB/gC,EAAM8gC,cAAcE,QAAQ,cAClDhB,EAAQe,oBAIFE,EAAW9iC,SAAS8iC,WACpBR,EAAWL,IAEjBvwB,EAAM,aAAgB,CAAAoxB,SAAAA,EAAUd,OAAAA,EAAQpkC,MAAAA,EAAO0kC,SAAAA,IAM3CtiC,SAAS8iC,aAAed,IAC1BA,GAAS,EACLM,IAAa1kC,GACfu2B,EAASmO,EAAUpmB,GAA2B6mB,uEAsBzCzB,EAAQ3lB,6PCpEZ/f,EAAa,GAACupB,YAAYvpB,EAAK,aAC5BA,EAAiB,YACjBA,EAAkB,WACnBA,EAAW,4BAENA,EAAkB,0HALzBA,EAAa,GAACupB,YAAYvpB,EAAK,yKA5E3B4kB,EAAcpK,EAAdoK,KACA5iB,EAAcwY,EAAdxY,MACAwhB,EAAkBhJ,EAAlBgJ,OACA4jB,EAAiC5sB,EAAjC4sB,cACA1K,EAAsBliB,EAAtBkiB,cACAtE,EAAgB5d,EAAhB4d,QACAiP,EAAwB7sB,EAAxB6sB,YACAC,EAAsB9sB,EAAtB8sB,SACAvB,EAAcvrB,EAAdurB,OACAjmB,EAAiBtF,EAAjBsF,MACAynB,EAA8B/sB,EAA9B+sB,eAEF,SAAAC,EAAQxlC,GACR,OAAA06B,EAAgB16B,EAAQ8hB,GAAc9hB,EAAOwhB,kbAG3BkjB,EAAkBe,GAC3CrP,IAGMC,GAAI,UACJzT,KAAMC,EAAmBD,GACzB5iB,MAAOwlC,EAAQJ,EAAc1d,cAAcgd,OAG9C,SAAAgB,EAAaC,OAIRA,EAAa3c,WAAc8U,GAAQlb,EAAM+c,GAAagG,EAAa3c,aAIjE,IAAAA,EACJyc,IAAoBnnB,GAA2BwmB,WAC3CS,EAAe3iB,GACfme,GAAqBne,GAAM,UAG/BpH,MAAKnE,EAAAA,EACAsuB,CAAAA,EAAAA,GACH3c,CAAAA,EAAAA,CAAAA,UAAAA,SAMRlL,gBAIAwnB,EAASvE,GAAqBne,GAAM,IACpC9E,KAGO,SAAY8nB,OAEX,IAAAC,EAAarkB,EAAOS,MAAM2jB,GAC5BhlB,GAAgBilB,IAClBR,EACE,CAAAziB,KAAAA,EACAkjB,SAAUD,UAGP1kB,MAMF,SAAmBnhB,UACnBwjC,GAAcgC,EAAQJ,EAAc1d,cAAc1nB,IAASwhB,8QC1CtDze,GACd4iB,EACA/C,EACAU,GAEA,IAAMkZ,EAAaC,EAAQ7Z,GACrB0H,EAASuP,EAAMlU,EAAM6W,GAE3B,GAAId,EAAYpR,GAAS,CAGvB,IAAM7G,EAASnD,GAAIqc,GAAK/Z,IACxB,OAAOU,EAAOvR,KAAI,SAACg0B,EAAOv0B,GAAK,MAAM,CACnC6kB,GAAI,MACJzT,KAAMC,EAAmB2Z,EAAWn0B,OAAOqe,OAAOjD,EAASjS,KAC3DxR,MAAO+lC,EAAM/lC,MACb,GACH,CAAM,GAAIy7B,EAAanR,GAAS,CAE/B,IAAM0b,EAAWrJ,GAAK/Z,GAChBjjB,EAAOzC,OAAOyC,KAAK2qB,GACnB2b,OAAwBznC,IAAbwnC,EAAyB9H,GAAYv+B,EAAMqmC,GAAU,GAAQ,GAE9E,MAAA,GAAA39B,OAAA4J,EAEKqR,EAAOvR,KAAI,SAACg0B,GACb,IAAMG,EAAU5V,GAAeyV,EAAMxgC,IAAK5F,GAC1C,MAAO,CACL02B,GAAI,MACJzT,KAAMC,EAAmB2Z,EAAWn0B,OAAO69B,IAC3ClmC,MAAO+lC,EAAM/lC,MAEjB,KAAEiS,EAGCg0B,EAASl0B,KAAI,SAACxM,GAAQ,OAAA4gC,GAAS3J,EAAYj3B,EAAK,KAEtD,CACC,MAAU,IAAAyE,MAAM,qEAEpB,UAUgB3I,GAAOskB,EAAe/C,EAAgBU,GACpD,IAAMgH,EAASuP,EAAMlU,EAAM/C,GAE3B,GAAIvT,MAAMoS,QAAQ6I,GAAS,CACzB,IAAM7G,EAAS6G,EAAOzrB,OACtB,OAAOykB,EAAOvR,KAAI,SAACg0B,EAAOv0B,SAAW,CACnC6kB,GAAI,MACJzT,KAAMC,EAAmBD,EAAKva,OAAOqe,OAAOjD,EAASjS,KACrDxR,MAAO+lC,EAAM/lC,MACd,GACF,CAEC,OAAOsjB,EAAOvR,KAAI,SAACg0B,GACjB,IAAMG,EAAU5V,GAAeyV,EAAMxgC,IAAKrI,OAAOyC,KAAK2qB,IACtD,MAAO,CACL+L,GAAI,MACJzT,KAAMC,EAAmBD,EAAKva,OAAO69B,IACrClmC,MAAO+lC,EAAM/lC,MAEjB,GAEJ,CAMM,SAAUomC,GACd5J,EACA78B,EACA0mC,EACAC,GAEA,IACMC,EAAejW,GAAegW,EADf3mC,EAAK6J,QAAO,SAACjE,GAAQ,OAAAA,IAAQ8gC,CAAO,KAEnDJ,EAAW/H,GAAYv+B,EAAM0mC,GAAQ,GAE3C,OAEE,CACEhQ,GAAI,OACJ/mB,KAAMuT,EAAmB2Z,EAAWn0B,OAAOg+B,IAC3CzjB,KAAMC,EAAmB2Z,EAAWn0B,OAAOk+B,MAC5Cl+B,OAAA4J,EAGEg0B,EAASl0B,KAAI,SAACxM,GAAG,OAAK4gC,GAAS3J,EAAYj3B,EAAK,KAEvD,CA+EgB,SAAAihC,GAAU7gB,EAAeiM,GAEvC,IAAM6U,EAAW9J,GAAK/K,GAEtB,GAAI3B,EAAQwW,GACV,MAAM,IAAIz8B,MAAM,gCAGlB,IAAMwyB,EAAaC,EAAQgK,GACrBC,EAAY/J,GAAK8J,GACjBnc,EAASuP,EAAMlU,EAAM6W,GAE3B,GAAId,EAAYpR,GAAS,CACvB,IAAMmc,EAAW9J,GAAK/K,GAChBnO,EAASgjB,EAAWnmB,GAAIqc,GAAK8J,IAAuB,EAAI,EAE9D,OAAAx0B,EAEK2f,EAAM7f,KAAI,SAAC6Q,EAAMpR,GAOlB,MANsC,CACpC6kB,GAAI,OACJ/mB,KAAMuT,EAAmBD,GACzBA,KAAMC,EAAmB2Z,EAAWn0B,OAAOqe,OAAOlV,EAAQiS,KAI9D,IAEH,IAAUgY,EAAanR,GAAS,CAE/B,IAAM3qB,EAAOzC,OAAOyC,KAAK2qB,GACnB2b,OAAyBznC,IAAdkoC,EAA0BxI,GAAYv+B,EAAM+mC,GAAW,GAAS,GAEjF,SAAAr+B,OAAA4J,EAEK2f,EAAM7f,KAAI,SAAC6Q,GACZ,IACMsjB,EAAU5V,GADHqM,GAAK/Z,GACmBjjB,GAErC,MAAO,CACL02B,GAAI,OACJ/mB,KAAMuT,EAAmBD,GACzBA,KAAMC,EAAmB2Z,EAAWn0B,OAAO69B,IAE/C,KAAEj0B,EAICg0B,EAASl0B,KAAI,SAACxM,GAAQ,OAAA4gC,GAAS3J,EAAYj3B,EAAK,KAEtD,CACC,MAAU,IAAAyE,MAAM,wEAEpB,CA2DM,SAAUnH,GACd8iB,EACAqD,EACAgc,EACAxjB,GAEA,GAAIyd,GAAejW,GAAY,CAE7B,IAAM2d,EAAY5iB,GAA0BihB,EAAexjB,GACrDgb,EAAaC,EAAQzT,EAAUpG,MAC/B0H,EAASuP,EAAMlU,EAAM6W,GAK3B,OAAO4J,GAAO5J,EAJDt/B,OAAOyC,KAAK2qB,GACVqS,GAAK3T,EAAUpG,MACM,iBAAd+jB,EAAyBA,EAAY3B,EAG5D,CAED,GACE9F,GAAiBlW,IAChBmW,GAAiBnW,IAAciH,EAAQjH,EAAUqW,WAGlD,IACE,MAAO,CACL,CACEhJ,GAAI,UACJzT,KAAMC,EAAmB8c,GAAa3W,IACtChpB,MAAOikB,GAAiB+gB,GAAe,SAACrhC,UAASigB,GAAejgB,EAAM6d,EAAO,KAGlF,CAAC,MAAOL,GAEP,MAAO,CACL,CACEkV,GAAI,UACJzT,KAAMC,EAAmB8c,GAAa3W,IACtChpB,MAAOglC,GAGZ,CAGH,GAAI7F,GAAiBnW,GAAY,CAC/B,IAAM4d,EAAYC,GAAkB7B,EAAexjB,GAEnD,gBAnOFmE,EACAiM,EACAtO,GAEA,IAAMwjB,EAAYl2B,GAAMghB,GAClB4K,EAAaC,EAAQqK,GACrBxc,EAASuP,EAAMlU,EAAM6W,GAE3B,GAAId,EAAYpR,GAAS,CACvB,IAAMwc,EAAYl2B,GAAMghB,GAClBnO,EAASqjB,EAAYxmB,GAAIqc,GAAKmK,IAAwB,EAE5D,MAAA,GAAAz+B,OAAA4J,EAEK80B,GAAUnV,IAAM3f,EAGhBqR,EAAOvR,KAAI,SAACg0B,EAAOv0B,GAOpB,MANsC,CACpC6kB,GAAI,MACJzT,KAAMC,EAAmB2Z,EAAWn0B,OAAOqe,OAAOlV,EAAQiS,KAC1DzjB,MAAO+lC,EAAM/lC,MAIjB,KAEH,IAAUy7B,EAAanR,GAAS,CAI/B,IAAMmc,EAAW9J,GAAK/K,GAChB4K,EAAaC,EAAQgK,GACrBC,EAAY/J,GAAK8J,GACjB9mC,EAAiBzC,OAAOyC,KAAK2qB,GAC7B2b,OAAyBznC,IAAdkoC,EAA0BxI,GAAYv+B,EAAM+mC,GAAW,GAAS,GAC3EM,EAAa,IAAInnC,IAAI+xB,EAAM7f,KAAI,SAAC6Q,UAAS+Z,GAAK/Z,OAC9CqkB,EAAetnC,EAAK6J,QAAO,SAACjE,GAAQ,OAACyhC,EAAWlnC,IAAIyF,EAAI,IAE9D,MAAA8C,GAAAA,OAAA4J,EAEK80B,GAAUnV,IAAM3f,EAGhBqR,EAAOvR,KAAI,SAACg0B,GACb,IAAMG,EAAU5V,GAAeyV,EAAMxgC,IAAK0hC,GAC1C,MAAO,CACL5Q,GAAI,MACJzT,KAAMC,EAAmB2Z,EAAWn0B,OAAO69B,IAC3ClmC,MAAO+lC,EAAM/lC,MAEjB,KAAEiS,EAICg0B,EAASl0B,KAAI,SAACxM,GAAQ,OAAA4gC,GAAS3J,EAAYj3B,OAEjD,CACC,UAAUyE,MAAM,sEAEpB,CAuKW2R,CAAQgK,EAAM8Z,GAAkB9Z,EAAMqD,GAAY4d,EAC1D,CAED,GAAI7H,GAAiB/V,GAAY,CAC/B,IAAM4d,EAAYC,GAAkB7B,EAAexjB,GAC7CoB,EAAOoG,EAAUpG,KACjB4Z,EAAaC,EAAQ7Z,GACrB0H,EAASuP,EAAMlU,EAAM6W,GAE3B,GAAId,EAAYpR,GAAS,CACvB,IAAM9Y,EAAQ8O,GAAIqc,GAAK/Z,IAGvB,OAAO7f,GAAa4iB,EAFC6W,EAAWn0B,OAAOqe,OAAOlV,EAAQ,IAEdo1B,EACzC,CAAUnL,GAAAA,EAAanR,GAAS,CAE/B,IAAM/kB,EAAMmhB,OAAOiW,GAAK/Z,IAClBjjB,EAAiBzC,OAAOyC,KAAK2qB,GACnC,GAAI2F,EAAQtwB,IAASg9B,GAAKh9B,KAAU4F,EAClC,OAAOlE,GAAOskB,EAAM6W,EAAYoK,GAEhC,IAAMp1B,EAAQ7R,EAAK+F,QAAQH,GACrB2hC,EAAUvnC,EAAK6R,EAAQ,GAG7B,OAAOzO,GAAa4iB,EAFA6W,EAAWn0B,OAAO6+B,GAECN,EAE1C,CACC,UAAU58B,MAAM,qEAEnB,CAED,GAAIg1B,GAAkBhW,GAAY,CAChC,IAAM4d,EAAYC,GAAkB7B,EAAexjB,GAC7CoB,EAAOoG,EAAUpG,KACjB5iB,EAAQ65B,EAAMlU,EAAM/C,GAE1B,GAAI8Y,EAAY17B,GAEd,OAAO+C,GAAa4iB,EADE/C,EAAKva,OAAO,KACOu+B,GAChCnL,GAAAA,EAAaz7B,GAAQ,CAE9B,IAAML,EAAOzC,OAAOyC,KAAKK,GACzB,GAAIiwB,EAAQtwB,GACV,OAAO0B,GAAOskB,EAAM/C,EAAMgkB,GAE1B,IAAMO,EAAWv2B,GAAMjR,GAGvB,OAAOoD,GAAa4iB,EAFC/C,EAAKva,OAAO8+B,GAEOP,EAE3C,CACC,MAAU,IAAA58B,MAAM,qEAEnB,CAGD,MAAU,IAAAA,MAAM,gDAAkDic,KAAKtE,UAAUqH,GACnF,CA6IM,SAAU+d,GAAUnV,GACxB,OAAOA,EACJ7f,KAAI,SAAC6Q,GAMJ,MALsC,CACpCyT,GAAI,SACJzT,KAAMC,EAAmBD,GAI7B,IACCwkB,SACL,CAIA,SAASjB,GAAS3J,EAAsBj3B,GACtC,MAAO,CACL8wB,GAAI,OACJ/mB,KAAMuT,EAAmB2Z,EAAWn0B,OAAO9C,IAC3Cqd,KAAMC,EAAmB2Z,EAAWn0B,OAAO9C,IAE/C,CAEgB,SAAAshC,GAAkB7B,EAAuBxjB,GACvD,IAAM6lB,EAAe,QAAQ3mB,KAAKskB,GAC5BsC,EAAc,SAAS5mB,KAAKskB,GAE5BuC,EAAoBxjB,GAA0BihB,EAAexjB,GAC7DgmB,OACkBhpC,IAAtB+oC,EACIA,EACAtjB,GAAiB+gB,GAAe,SAACrhC,GAAI,OAAKigB,GAAejgB,EAAM6d,EAAQ,IAE7E,OACG6lB,GAAgB1mB,GAAS6mB,IACzBF,GAAej4B,MAAMoS,QAAQ+lB,GAEvB,CAAC,CAAEjiC,IAAK,WAAYvF,MAAOwnC,IAGhCn4B,MAAMoS,QAAQ+lB,GACTA,EAAkBz1B,KAAI,SAAC/R,EAAOwR,GACnC,MAAO,CAAEjM,IAAK,YAAciM,EAAOxR,MAAAA,EACrC,IAGE2gB,GAAS6mB,GACJtqC,OAAOyC,KAAK6nC,GAAmBz1B,KAAI,SAACxM,GACzC,MAAO,CAAEA,IAAAA,EAAKvF,MAAOwnC,EAAkBjiC,GACzC,IAIK,CAAC,CAAEA,IAAK,WAAYvF,MAAOwnC,GACpC,CAGgB,SAAAC,GACd9hB,EACAqD,GAEA,GAAIiW,GAAejW,GAAY,CAE7B,IAAMwT,EAAaC,EAAQzT,EAAUpG,MAC/B0H,EAASuP,EAAMlU,EAAM6W,GAKrB3B,EAAauL,GAAO5J,EAJbt/B,OAAOyC,KAAK2qB,GACVqS,GAAK3T,EAAUpG,MACf,IAKf,MAAO,CAAEiY,WAAAA,EAAY6M,aAFArG,GAA8B1b,EAAMkV,GAG1D,CAED,GAAIqE,GAAiBlW,GASnB,MAAO,CAAE6R,WAR6B,CACpC,CACExE,GAAI,UACJzT,KAAMC,EAAmBmG,EAAUpG,MACnC5iB,MAAO,KAIU0nC,aAAc1e,GAGrC,GAAImW,GAAiBnW,GAAY,CAC/B,IAAM4I,EAAQ6N,GAAkB9Z,EAAMqD,GAChC6R,EAAakM,GAAUnV,GACvB6U,EAAW9J,GAAK/K,GAEtB,GAAI3B,EAAQwW,GAAW,CAMrB,MAAO,CAAE5L,WAJ6B,CAAC,CAAExE,GAAI,UAAWzT,KAAM,GAAI5iB,MAAO,KAIpD0nC,aAFA3G,GAAqB,IAAI,GAG/C,CAED,IAAMvE,EAAaC,EAAQgK,GACrBnc,EAASuP,EAAMlU,EAAM6W,GAE3B,GAAId,EAAYpR,GAAS,CACvB,IAAMwc,EAAYl2B,GAAMghB,GAClBpgB,EAAQ8O,GAAIqc,GAAKmK,IAMvB,MAAO,CAAEjM,WAAAA,EAAY6M,aAJT,IAAVl2B,EACIwwB,GAAsBxF,GACtByF,GAAqBzF,EAAWn0B,OAAOqe,OAAOlV,EAAQ,KAG7D,CAAM,GAAIiqB,EAAanR,GAAS,CAE/B,IAAM3qB,EAAOzC,OAAOyC,KAAK2qB,GACnBwc,EAAYl2B,GAAMghB,GAClBrsB,EAAMo3B,GAAKmK,GACXt1B,EAAQ7R,EAAK+F,QAAQH,GACrBoiC,EAAchoC,EAAK6R,EAAQ,GAMjC,MAAO,CAAEqpB,WAAAA,EAAY6M,aAJT,IAAVl2B,EACIwwB,GAAsBxF,GACtByF,GAAqBzF,EAAWn0B,OAAOs/B,IAG9C,CACC,UAAU39B,MAAM,qEAEnB,CAGD,MAAM,IAAIA,MAAM,gDAAkDic,KAAKtE,UAAUqH,GACnF,CAEgB,SAAA4e,GACdjiB,EACAkV,GAEA,OAAOgN,EAAgBliB,EAAMkV,EAAY,CACvCiN,OAAQ,SAACniB,EAAMuV,EAAW6M,GACxB,GAAI1M,EAAkBH,GAAY,CAChC,IAAMtY,EAAOG,EAAiBmY,EAAUtY,MACxC,MAAO,CACLmlB,iBAAgB,GAAA1/B,OAAA4J,EAAM81B,GAAgB91B,EAAK+1B,GAA2BriB,EAAM/C,KAE/E,CAED,GAAIiZ,EAAgBX,GAAY,CAC9B,IAAM5rB,EAAOyT,EAAiBmY,EAAU5rB,MACxC,MAAO,CACLy4B,oBAAgB1/B,OAAA4J,EAAM81B,GAAgB91B,EAAK+1B,GAA2BriB,EAAMrW,KAE/E,CAED,MAAO,CAAElN,SAAUujB,EACpB,GAEL,CAEA,SAASqiB,GAA2BriB,EAAe/C,GACjD,IAAM4Z,EAAaC,EAAQ7Z,GACrBojB,EAAWrJ,GAAK/Z,GAChB0H,EAASuP,EAAMlU,EAAM6W,GAC3B,OAAIf,EAAanR,GAEE4T,GADJhhC,OAAOyC,KAAK2qB,GACU0b,GAAU,GAG7Bj0B,KAAI,SAACxM,UAAQ4gC,GAAS3J,EAAYj3B,EAAI,IAGjD,EACT,UC3tBgB0iC,GACdtiB,EACAuiB,EACAC,GAEA,IAAMC,EAAaD,SAAAA,EAAgBE,WAC/BC,GAAoBH,EAAeE,iBACnC7pC,EAEE+pC,EAAsBL,EAAehZ,WAAU,SAAC2C,GACpD,OAAOiM,GAAQsK,EAAYE,GAAoBzW,GACjD,IAEM2W,GACqB,IAAzBD,EACIA,OACgC/pC,KAAhC2pC,aAAc,EAAdA,EAAgBK,eACdL,aAAAA,EAAAA,EAAgBK,aAAcN,EAAerpC,OAC7CspC,aAAc,EAAdA,EAAgBK,YAChBN,EAAerpC,OAAS,EACtB,GACC,EAEL4pC,EAAoCP,EAAen2B,KAAI,SAAC8f,EAAMrgB,GAClE,OAAA6F,EAAAA,KAAYwa,GAAI,CAAA,EAAA,CAAEjqB,OAAQ4J,IAAUg3B,GACtC,IAEMH,EAAaI,EAAMD,GAEzB,MAAO,CACLC,MAAAA,EACAC,SAAUC,GAAQF,GAAO,SAAC5W,UAAShP,EAAmBgP,EAAKjP,KAAK,IAChEylB,WAAAA,EACAG,YAAAA,EAEJ,CAGM,SAAUI,GAAWC,GACzB,IAAMC,EACJD,EAAaL,YAAcK,EAAaJ,MAAM5pC,OAAS,EACnDgqC,EAAaL,YAAc,EAC3BK,EAAaJ,MAAM5pC,OAAS,EAC1B,GACC,EAEHkqC,EAAiBF,EAAaJ,MAAMK,GAEpCL,EAAoCI,EAAaJ,MAAM12B,KAAI,SAAC8f,EAAMrgB,GACtE,OAAA6F,EAAAA,EAAA,CAAA,EAAYwa,GAAI,CAAA,EAAA,CAAEjqB,OAAQ4J,IAAUs3B,GACtC,IAEA,OAAAzxB,EAAAA,EAAA,CAAA,EACKwxB,GAAY,CAAA,EAAA,CACfJ,MAAAA,EACAC,SAAUC,GAAQF,GAAO,SAAC5W,GAAS,OAAAhP,EAAmBgP,EAAKjP,KAAM,IACjEylB,WAAYU,EACZP,YAAaM,GAEjB,CAGM,SAAUE,GAAeH,GAC7B,IAAMI,EACJJ,EAAaL,YAAc,EAAIK,EAAaL,YAAc,EAAIK,EAAaJ,MAAM5pC,OAAS,EAEtFqqC,EAAqBL,EAAaJ,MAAMQ,GAExCR,EAAoCI,EAAaJ,MAAM12B,KAAI,SAAC8f,EAAMrgB,GACtE,OAAA6F,EAAAA,EAAA,CAAA,EAAYwa,GAAMjqB,CAAAA,EAAAA,CAAAA,OAAQ4J,IAAUy3B,GACtC,IAEA,OAAA5xB,EAAAA,EACKwxB,CAAAA,EAAAA,GACHJ,CAAAA,EAAAA,CAAAA,MAAAA,EACAC,SAAUC,GAAQF,GAAO,SAAC5W,GAAI,OAAKhP,EAAmBgP,EAAKjP,KAAM,IACjEylB,WAAYa,EACZV,YAAaS,GAEjB,CAGM,SAAUE,GACdC,EACAzjB,GAC2B,IAAA0jB,EAA3BllC,yDAAyB,CAAA,EAEnBmlC,EAAsBF,EAAWxtB,cACjC2tB,EAAgCF,QAAtBA,EAAGllC,aAAO,EAAPA,EAASolC,sBAAUF,EAAAA,EAAI9iB,IACpCijB,EAAUrlC,aAAAA,EAAAA,EAASqlC,QACnBC,EAA8B,GAC9B7mB,EAAiB,GAEvB,SAAS8mB,EAAQlX,GACXiX,EAAQ5qC,QAAU0qC,GAItBE,EAAQr/B,KAAKooB,EACd,CAED,SAASmX,EAAgBL,EAA6BtpC,GACpD,GAAI07B,EAAY17B,GAAQ,CACtB,IAAM4pC,EAAQhnB,EAAK/jB,OACnB+jB,EAAKxY,KAAK,KAEV,IAAK,IAAItL,EAAI,EAAGA,EAAIkB,EAAMnB,OAAQC,IAKhC,GAJA8jB,EAAKgnB,GAASljB,OAAO5nB,GAErB6qC,EAAgBL,EAAqBtpC,EAAMlB,IAEvC2qC,EAAQ5qC,QAAU0qC,EACpB,OAIJ3mB,EAAKxW,KACN,MAAM,GAAIqvB,EAAaz7B,GAAQ,CAC9B,IAAML,EAAOzC,OAAOyC,KAAKK,GACnB4pC,EAAQhnB,EAAK/jB,OAEnB+jB,EAAKxY,KAAK,IAEV,QAAAy/B,EAAA,EAAAC,EAAkBnqC,EAAIkqC,EAAAC,EAAAjrC,OAAAgrC,IAAE,CAAnB,IAAMtkC,EAAGukC,EAAAD,GAOZ,GANAjnB,EAAKgnB,GAASrkC,EAEdwkC,GAA2BxkC,EAAK+jC,EAAqB1mB,EAAMxE,GAAY7Y,IAAKmkC,GAE5EC,EAAgBL,EAAqBtpC,EAAMuF,IAEvCkkC,EAAQ5qC,QAAU0qC,EACpB,MAEH,CAED3mB,EAAKxW,KACN,MAEC29B,GACErjB,OAAO1mB,GACPspC,EACA1mB,EACAxE,GAAYpe,MACZ0pC,EAGL,CAED,GAAmB,KAAfN,EACF,MAAO,GACEI,GAAAA,EAAS,CAClB,IAAKn6B,MAAMoS,QAAQkE,GACjB,MAAU,IAAA3b,MAAM,wDAGlB,IAAK,IAAIlL,EAAI,EAAGA,EAAI6mB,EAAK9mB,OAAQC,IAAK,CACpC8jB,EAAK,GAAK8D,OAAO5nB,GAIjB,IAFA,IAAM+yB,EAAOlM,EAAK7mB,GAETiC,EAAI,EAAGA,EAAIyoC,EAAQ3qC,OAAQkC,IAAK,CACvC,IAAMgkB,EAASykB,EAAQzoC,GAEvB,GAAsB,IAAlBgkB,EAAOlmB,OACT+jB,EAAK,GAAKmC,EAAO,QAEjB,IAAK,IAAI1lB,EAAI,EAAGA,EAAI0lB,EAAOlmB,OAAQQ,IACjCujB,EAAKvjB,EAAI,GAAK0lB,EAAO1lB,GAGzB,KAAOujB,EAAK/jB,OAASkmB,EAAOlmB,OAAS,GACnC+jB,EAAKxW,MAKPu9B,EAAgBL,EAFFzP,EAAMhI,EAAM9M,GAG3B,CAED,GAAI0kB,EAAQ5qC,QAAU0qC,EACpB,KAEH,CAED,OAAOE,CACR,CAEC,OADAE,EAAgBL,EAAqB3jB,GAC9B8jB,CAEX,CAKM,SAAUM,GACdpmC,EACA2lC,EACA1mB,EACAonB,EACAN,GAEA,IAAMO,EAAYtmC,EAAKiY,cAEnBsuB,EAAa,EACbltB,GAAY,EACZxL,GAAS,EAEb,IAGiB,KAFfA,EAAQy4B,EAAUvkC,QAAQ4jC,EAAqBtsB,MAG7CA,EAAWxL,EAAQ83B,EAAoBzqC,OAEvC6qC,EAAQ,CACN9mB,KAAMA,EAAKxkB,MAAM,GACjB4rC,MAAAA,EACAE,WAAAA,EACA77B,MAAOmD,EACPlD,IAAK0O,IAGPktB,YAEgB,IAAX14B,EACX,CAKM,SAAU24B,GAAYxmC,EAAcymC,EAAyB/7B,EAAeC,GAChF,OAAO3K,EAAK0gB,UAAU,EAAGhW,GAAS+7B,EAAkBzmC,EAAK0gB,UAAU/V,EACrE,UAKgB+7B,GACd1mC,EACAymC,EACAE,GAEA,IAAIC,EAAc5mC,EAMlB,OAJA6mC,GAAaF,GAAa,SAACG,GACzBF,EAAcJ,GAAYI,EAAaH,EAAiBK,EAAWp8B,MAAOo8B,EAAWn8B,IACvF,IAEOi8B,CACT,CAEM,SAAUG,GACd/kB,EACAkT,EACAuR,EACAO,EACAnpB,GAEA,IAAQwoB,EAA4BW,EAA5BX,MAAOpnB,EAAqB+nB,EAArB/nB,KAAMvU,EAAes8B,EAAft8B,MAAOC,EAAQq8B,EAARr8B,IAE5B,GAAI07B,IAAU5rB,GAAY7Y,IAAK,CAE7B,IAAMi3B,EAAaC,EAAQ7Z,GACrB0H,EAASuP,EAAMlU,EAAM6W,GACrB6J,EAAS1J,GAAK/Z,GAIdiY,EAAauL,GAAO5J,EAHbt/B,OAAOyC,KAAK2qB,GAGmB+b,EAF7B8D,GAAY9D,EAAQ+D,EAAiB/7B,EAAOC,IAK3D,MAAO,CACLo5B,aAHmBrG,GAA8B1b,EAAMkV,GAIvDA,WAAAA,EAEH,CAAUmP,GAAAA,IAAU5rB,GAAYpe,MAAO,CAEtC,IAAM4qC,EAAoC/Q,EAAMlU,EAAM/C,GACtD,QAAqBpkB,IAAjBosC,EACF,UAAU5gC,MAAK3B,kCAAAA,OAAmCwa,EAAmBD,KAEvE,IAAMioB,EAA2C,iBAAjBD,EAA4BA,EAAelkB,OAAOkkB,GAE5EvR,EAAUxW,EAAmBD,GAC7B8X,EAAgBsD,GACpB4M,EACA/R,EAAcE,iBACdM,EACA7X,GAGIxhB,EAAQmqC,GAAYU,EAAkBT,EAAiB/7B,EAAOC,GAE9DusB,EAAmC,CACvC,CACExE,GAAI,UACJzT,KAAMC,EAAmBD,GACzB5iB,MAAO06B,EAAgB16B,EAAQ8hB,GAAc9hB,EAAOwhB,KAMxD,MAAO,CACLkmB,aAHmBrG,GAA8B1b,EAAMkV,GAIvDA,WAAAA,EAEH,CACC,MAAU,IAAA7wB,MAAK3B,uDAAAA,OAAwD2hC,GAE3E,CAEM,SAAUc,GACdnlB,EACAkT,EACAuQ,EACAgB,EACA5oB,GAcA,IAXA,IAAMupB,EAAoB5B,GAAOC,EAAYzjB,EAAM,CAAE4jB,WAAYhjB,MAU3DykB,EAA+B,GAC5BlsC,EAAI,EAAGA,EAAIisC,EAAkBlsC,OAAQC,IAAK,CACjD,IAAMmsC,EAAeF,EAAkBjsC,EAAI,GACrC+yB,EAAOkZ,EAAkBjsC,GACrB,IAANA,GAAW+yB,EAAKmY,QAAUiB,EAAajB,OAAUlM,GAAQjM,EAAKjP,KAAMqoB,EAAaroB,MAOjF+Z,GAAKqO,GAA+BvC,MAAMr+B,KAAKynB,GANjDmZ,EAAoB5gC,KAAK,CACvBwY,KAAMiP,EAAKjP,KACXonB,MAAOnY,EAAKmY,MACZvB,MAAO,CAAC5W,IAKb,CAKDmZ,EAAoBrtB,MAAK,SAACjgB,EAAGC,GAE3B,OAAID,EAAEssC,QAAUrsC,EAAEqsC,MACZtsC,EAAEssC,QAAU5rB,GAAY7Y,IACnB,GAEC,EAKL5H,EAAEilB,KAAK/jB,OAASnB,EAAEklB,KAAK/jB,MAChC,IAGA,IAAIqsC,EAAmC,GACnCC,EAAyC,KAmD7C,OAlDAH,EAAoB1tC,SAAQ,SAACk1B,GAE3B,IAAQwX,EAAuBxX,EAAvBwX,MAAOpnB,EAAgB4P,EAAhB5P,KAAM6lB,EAAUjW,EAAViW,MAErB,GAAIuB,IAAU5rB,GAAY7Y,IAAK,CAE7B,IAAMi3B,EAAaC,EAAQ7Z,GACrB0H,EAASuP,EAAMlU,EAAM6W,GACrB6J,EAAS1J,GAAK/Z,GAIdiY,EAAauL,GAAO5J,EAHbt/B,OAAOyC,KAAK2qB,GAGmB+b,EAF7BgE,GAAehE,EAAQ+D,EAAiB3B,IAGvDyC,EAAgBA,EAAc7iC,OAAOwyB,GAErCsQ,EAAmB9J,GAA8B1b,EAAMkV,EACxD,KAAUmP,IAAAA,IAAU5rB,GAAYpe,MA8B/B,MAAU,IAAAgK,MAAK3B,uDAAAA,OAAwD2hC,IA5BvE,IAAMY,EAAoC/Q,EAAMlU,EAAM/C,GACtD,QAAqBpkB,IAAjBosC,EACF,MAAU,IAAA5gC,MAAK,kCAAA3B,OAAmCwa,EAAmBD,KAEvE,IAAMioB,EACoB,iBAAjBD,EAA4BA,EAAelkB,OAAOkkB,GAErDvR,EAAUxW,EAAmBD,GAC7B8X,EAAgBsD,GACpB4M,EACA/R,EAAcE,iBACdM,EACA7X,GAGIxhB,EAAQqqC,GAAeQ,EAAkBT,EAAiB3B,GAE1D5N,EAAmC,CACvC,CACExE,GAAI,UACJzT,KAAMC,EAAmBD,GACzB5iB,MAAO06B,EAAgB16B,EAAQ8hB,GAAc9hB,EAAOwhB,KAGxD0pB,EAAgBA,EAAc7iC,OAAOwyB,GAErCsQ,EAAmB9J,GAA8B1b,EAAMkV,EAGxD,CACH,IAEO,CACLA,WAAYqQ,EACZxD,aAAcyD,EAElB,CAoDA,SAAS7C,GAAoBqC,GAC3B,OAAOA,EAAiB/nB,KAAKva,OAAOsiC,EAAiBX,MAAOtjB,OAAOikB,EAAiBT,YACtF,CAGgB,SAAAkB,GACdr5B,EACAsnB,GAAoB,IAAAgS,EAEd5C,EAAQ12B,SAAc,QAAXs5B,EAAHt5B,EAAMsnB,UAAQ,IAAAgS,OAAA,EAAdA,EAAgB7hC,QAAO,SAACqoB,GAAsB,OAAKA,EAAKmY,QAAU5rB,GAAY7Y,GAAI,IAEhG,GAAKkjC,GAA0B,IAAjBA,EAAM5pC,OAIpB,OAAO4pC,CACT,CAGgB,SAAA6C,GACdv5B,EACAsnB,GAAoBkS,IAAAA,EAEd9C,EAAQ12B,SAAcw5B,QAAXA,EAAHx5B,EAAMsnB,UAANkS,IAAcA,OAAdA,EAAAA,EAAgB/hC,QAAO,SAACqoB,GAA2B,OAAAA,EAAKmY,QAAU5rB,GAAYpe,KAAK,IAEjG,GAAKyoC,GAA0B,IAAjBA,EAAM5pC,OAIpB,OAAO4pC,CACT,obC/fgEtgB,GAAiBnqB,EAAI,GAAC2F,MAAI,yFAAxC+C,GAAA8kC,EAAA,aAAAxtC,KAAK4J,yBAAnD/E,GAA8FvB,EAAAkqC,EAAA1oC,wCAAlCqlB,GAAiBnqB,EAAI,GAAC2F,MAAI,KAAAiC,GAAAwC,EAAAqjC,QAAxC/kC,GAAA8kC,EAAA,aAAAxtC,KAAK4J,iDAFlD,MAAA6jC,EAAAztC,KAAK2F,KAAI,2EAAT,EAAArF,GAAAmtC,KAAAA,EAAAztC,KAAK2F,KAAI,KAAAiC,GAAAwC,EAAAqjC,wEADO,WAAdztC,EAAI,GAAC8I,KAAiBqQ,qPADtBnZ,EAAK,iBAAVa,OAAIC,GAAA,sNAACd,EAAK,YAAVa,OAAIC,GAAA,EAAA,yHAAJD,6EANW8E,EAAY6U,EAAZ7U,KACAonC,EAA6CvyB,EAA7CuyB,iKAEVxuB,EAAA,EAAEmvB,EDgcW,SAAW/nC,EAAc65B,GACvC,IAI2BmO,EAJrBD,EAA0B,GAE5BE,EAAc,EAACC,EAAAzR,EAECoD,OAApB,IAAAqO,EAAAxR,MAAAsR,EAAAE,EAAA57B,KAAAqqB,MAA6B,CAAlB,IAAA9H,EAAKmZ,EAAA3rC,MACR8rC,EAAgBnoC,EAAKvF,MAAMwtC,EAAapZ,EAAMnkB,OAC9B,KAAlBy9B,GACFJ,EAAMthC,KAAK,CACTtD,KAAM,SACNnD,KAAMmoC,EACNlkC,QAAQ,IAIZ,IAAMmkC,EAAepoC,EAAKvF,MAAMo0B,EAAMnkB,MAAOmkB,EAAMlkB,KACnDo9B,EAAMthC,KAAK,CACTtD,KAAM,YACNnD,KAAMooC,EACNnkC,OAAQ4qB,EAAM5qB,SAGhBgkC,EAAcpZ,EAAMlkB,GACrB,CAAA,CAAA6S,MAAAA,GAAA0qB,EAAA1/B,EAAAgV,WAAA0qB,EAAA7qC,GAAA,CAED,IAAMgrC,EAAYrP,GAAKa,GASvB,OARIwO,GAAaA,EAAU19B,IAAM3K,EAAK9E,QACpC6sC,EAAMthC,KAAK,CACTtD,KAAM,SACNnD,KAAMA,EAAKvF,MAAM4tC,EAAU19B,KAC3B1G,QAAQ,IAIL8jC,CACT,CCneaO,CAAWvlB,OAAO/iB,GAAOonC,66CCiDjC,MAAAU,EAAAtjB,GAAiBnqB,EAAc,GAAAupB,YAAYvpB,EAAK,KAAA,2EAAhD,EAAAM,GAAAmtC,KAAAA,EAAAtjB,GAAiBnqB,EAAc,GAAAupB,YAAYvpB,EAAK,KAAA,KAAA4H,GAAAwC,EAAAqjC,2FAFlBztC,EAAa,GAACupB,YAAYvpB,EAAK,qIAA/BA,EAAa,GAACupB,YAAYvpB,EAAK,sOAD3DA,EAAiB,GAAA,oKALfwlC,GAAcxlC,EAAK,GAAEA,EAAM,KAAA,kCAG3BA,EAAU,GAAG,qDAAuD,uBAP7E6E,GAcKvB,EAAAisB,EAAAzqB,2CATO9E,EAAgB,oBACbA,EAAsB,yMAF5BwlC,GAAcxlC,EAAK,GAAEA,EAAM,KAAA,uDAG3BA,EAAU,GAAG,qDAAuD,wJApChE4kB,EAAcpK,EAAdoK,KACA5iB,EAAcwY,EAAdxY,MACAm2B,EAAiB3d,EAAjB2d,SACAiP,EAAiC5sB,EAAjC4sB,cACA5jB,EAAkBhJ,EAAlBgJ,OACA8jB,EAAsB9sB,EAAtB8sB,SAEAyF,EAAyDvyB,EAAzDuyB,2UAERxuB,EAAA,EAAA2vB,EAAarqB,GAAM7hB,gBAEb,SAAiBiE,GACH,iBAAVjE,GAAsBksC,GAAcjoC,EAAMyoB,UACnDzoB,EAAMM,iBACNN,EAAMU,kBAENtE,OAAOgc,KAAKrc,EAAO,YAId,SAAuBiE,GACzBkyB,IACHlyB,EAAMM,iBACN+gC,EAASvE,GAAqBne,GAAM,u1BClCvC5kB,EAAI,gEADP6E,GAEKvB,EAAAisB,EAAAzqB,8CADF9E,EAAI,+DAJM2F,EAAY6U,EAAZ7U,uLCaP,SAAUwoC,GACd5qC,EAAa6qC,GACkD,IAE3Dpd,EAFFrrB,EAAIyoC,EAAJzoC,KAAMwrB,EAAiBid,EAAjBjd,kBAAmBP,EAAkBwd,EAAlBxd,mBAI3B,SAASyd,IAMPrd,EAAUG,EAAkBmd,GALd,CACZ3oC,KAAAA,GAI0C,CAC1CqZ,SAAU,MACVR,MAAO,GAAK7Y,EAAK9E,OACjBovB,UAAW,EACXnrB,OAAQvB,EACRqY,mBAAmB,GAEtB,CAED,SAAS2yB,IACP3d,EAAmBI,EACpB,CAKD,OAHAztB,EAAK6C,iBAAiB,aAAcioC,GACpC9qC,EAAK6C,iBAAiB,aAAcmoC,GAE7B,CACLpsC,QAAO,WACLoB,EAAK8C,oBAAoB,aAAcgoC,GACvC9qC,EAAK8C,oBAAoB,aAAckoC,EACxC,EAEL,8OC/BcC,gHADd3pC,GAEKvB,EAAAisB,EAAAzqB,iDAFqCa,CAAAA,KAAA3F,EAAI,IAAKA,EAAoB,wFAA7B2F,CAAAA,KAAA3F,EAAI,IAAKA,EAAoB,4JAP/DyuC,EAAuB5hC,GAAiC,kBAEnD7K,EAAawY,EAAbxY,uGAER2D,EAAI,SAAA0E,OAAA,IAAgB7H,KAAKR,GAAO+nB,+ICLrB,SAAA2kB,GAAWC,GACzB,IAAA/pB,EAAI+pB,EAAJ/pB,KACA5iB,EAAK2sC,EAAL3sC,MACAm2B,EAAQwW,EAARxW,SACAuE,EAAaiS,EAAbjS,cACAqQ,EAAiB4B,EAAjB5B,kBACA6B,EAASD,EAATC,UACAprB,EAAMmrB,EAANnrB,OACA4jB,EAAauH,EAAbvH,cACAhP,EAAOuW,EAAPvW,QACAiP,EAAWsH,EAAXtH,YACAC,EAAQqH,EAARrH,SACAvB,EAAM4I,EAAN5I,OACAwB,EAAcoH,EAAdpH,eACAznB,EAAK6uB,EAAL7uB,MAEM+uB,EAA+C,GAiDrD,OA/CKD,G9BcD,SAAoB5sC,GACxB,OAAiB,IAAVA,IAA4B,IAAVA,CAC3B,C8BhBoB8sC,CAAU9sC,IAC1B6sC,EAAUziC,KAAK,CACb5C,UAAWulC,GACXvtC,MAAO,CAAEojB,KAAAA,EAAM5iB,MAAAA,EAAOm2B,SAAAA,EAAUC,QAAAA,EAAStY,MAAAA,MAIxC8uB,G9BoED,SAAkB5sC,GAEtB,MAAwB,iBAAVA,GAAsBA,EAAMnB,OADnB,MACgDuiB,GAAYphB,EACrF,C8BvEoBgtC,CAAQhtC,IACxB6sC,EAAUziC,KAAK,CACb5C,UAAWylC,GACXztC,MAAO,CAAEojB,KAAAA,EAAM5iB,MAAAA,EAAOm2B,SAAAA,EAAUC,QAAAA,EAAStY,MAAAA,KAIzC8uB,GACFC,EAAUziC,KAAK,CACb5C,UAAW0lC,GACX1tC,MAAO,CACLojB,KAAAA,EACA5iB,MAAAA,EACA06B,cAAAA,EACAlZ,OAAAA,EACA4jB,cAAAA,EACAhP,QAAAA,EACAiP,YAAAA,EACAC,SAAAA,EACAvB,OAAAA,EACAwB,eAAAA,EACAznB,MAAAA,KAKD8uB,GACHC,EAAUziC,KAAK,CACb5C,UAAW2lC,GACX3tC,MAAO,CAAEojB,KAAAA,EAAM5iB,MAAAA,EAAOm2B,SAAAA,EAAU3U,OAAAA,EAAQ4jB,cAAAA,EAAe2F,kBAAAA,EAAmBzF,SAAAA,MAIzEsH,GAAa/rB,GAAY7gB,IAC5B6sC,EAAUziC,KAAK,CACb5C,UAAW4lC,GACX5tC,MAAO,CAAEQ,MAAAA,KAIN6sC,CACT,CCjEO,IAAMQ,GAA4D,CAAA,EAO5DC,GAAuD,CAClEC,YAAY,EACZC,cAAc,GCVV1qB,GAAMnkB,KAAKmkB,IACXlkB,GAAMD,KAAKC,IACX6uC,GAAQ9uC,KAAK8uC,MACb1sB,GAAQpiB,KAAKoiB,MACb2sB,GAAe,SAAA34B,GAAC,MAAK,CACzBrY,EAAGqY,EACHsW,EAAGtW,EACJ,EACK44B,GAAkB,CACtBvwB,KAAM,QACN0O,MAAO,OACPuC,OAAQ,MACRnR,IAAK,UAED0wB,GAAuB,CAC3Bv/B,MAAO,MACPC,IAAK,SAEP,SAASu/B,GAAMx/B,EAAOrO,EAAOsO,GAC3B,OAAO1P,GAAIyP,EAAOyU,GAAI9iB,EAAOsO,GAC/B,CACA,SAASw/B,GAAS9tC,EAAO+tC,GACvB,MAAwB,mBAAV/tC,EAAuBA,EAAM+tC,GAAS/tC,CACtD,CACA,SAASguC,GAAQC,GACf,OAAOA,EAAU3kC,MAAM,KAAK,EAC9B,CACA,SAAS4kC,GAAaD,GACpB,OAAOA,EAAU3kC,MAAM,KAAK,EAC9B,CACA,SAAS6kC,GAAgBC,GACvB,MAAgB,MAATA,EAAe,IAAM,GAC9B,CACA,SAASC,GAAcD,GACrB,MAAgB,MAATA,EAAe,SAAW,OACnC,CACA,SAASE,GAAYL,GACnB,MAAO,CAAC,MAAO,UAAUpnB,SAASmnB,GAAQC,IAAc,IAAM,GAChE,CACA,SAASM,GAAiBN,GACxB,OAAOE,GAAgBG,GAAYL,GACrC,CACA,SAASO,GAAkBP,EAAWQ,EAAOC,QAC/B,IAARA,IACFA,GAAM,GAER,IAAMC,EAAYT,GAAaD,GACzBW,EAAgBL,GAAiBN,GACjCpvC,EAASwvC,GAAcO,GACzBC,EAAsC,MAAlBD,EAAwBD,KAAeD,EAAM,MAAQ,SAAW,QAAU,OAAuB,UAAdC,EAAwB,SAAW,MAI9I,OAHIF,EAAMK,UAAUjwC,GAAU4vC,EAAMM,SAASlwC,KAC3CgwC,EAAoBG,GAAqBH,IAEpC,CAACA,EAAmBG,GAAqBH,GAClD,CACA,SAASI,GAAsBhB,GAC7B,IAAMiB,EAAoBF,GAAqBf,GAC/C,MAAO,CAACkB,GAA8BlB,GAAYiB,EAAmBC,GAA8BD,GACrG,CACA,SAASC,GAA8BlB,GACrC,OAAOA,EAAUtyB,QAAQ,cAAc,SAAAgzB,UAAaf,GAAqBe,EAAU,GACrF,CAkBA,SAASS,GAA0BnB,EAAWoB,EAAe1iC,EAAW+hC,GACtE,IAAMC,EAAYT,GAAaD,GAC3Bn+B,EAnBN,SAAqBw/B,EAAMC,EAASb,GAClC,IAAMc,EAAK,CAAC,OAAQ,SACdC,EAAK,CAAC,QAAS,QAGrB,OAAQH,GACN,IAAK,MACL,IAAK,SACH,OAAIZ,EAAYa,EAAUE,EAAKD,EACxBD,EAAUC,EAAKC,EACxB,IAAK,OACL,IAAK,QACH,OAAOF,EATA,CAAC,MAAO,UACR,CAAC,SAAU,OASpB,QACE,MAAO,GAEb,CAGaG,CAAY1B,GAAQC,GAA0B,UAAdthC,EAAuB+hC,GAOlE,OANIC,IACF7+B,EAAOA,EAAKiC,KAAI,SAAAu9B,GAAQ,OAAAA,EAAO,IAAMX,CAAU,IAC3CU,IACFv/B,EAAOA,EAAKzH,OAAOyH,EAAKiC,IAAIo9B,OAGzBr/B,CACT,CACA,SAASk/B,GAAqBf,GAC5B,OAAOA,EAAUtyB,QAAQ,0BAA0B,SAAA2zB,GAAI,OAAI3B,GAAgB2B,EAAK,GAClF,CAUA,SAASK,GAAiBC,GACxB,MAA0B,iBAAZA,EAVhB,SAA6BA,GAC3B,OAAAv4B,EAAA,CACE6F,IAAK,EACL4O,MAAO,EACPuC,OAAQ,EACRjR,KAAM,GACHwyB,EAEP,CAEuCC,CAAoBD,GAAW,CAClE1yB,IAAK0yB,EACL9jB,MAAO8jB,EACPvhB,OAAQuhB,EACRxyB,KAAMwyB,EAEV,CACA,SAASE,GAAiB5kB,GACxB,OAAA7T,EAAAA,EAAA,CAAA,EACK6T,GAAI,CAAA,EAAA,CACPhO,IAAKgO,EAAKG,EACVjO,KAAM8N,EAAKxuB,EACXovB,MAAOZ,EAAKxuB,EAAIwuB,EAAK1O,MACrB6R,OAAQnD,EAAKG,EAAIH,EAAKxO,QAE1B,CC3HA,SAASqzB,GAA2BC,EAAM/B,EAAWS,GACnD,IAYIuB,EAXFnB,EAEEkB,EAFFlB,UACAC,EACEiB,EADFjB,SAEImB,EAAW5B,GAAYL,GACvBW,EAAgBL,GAAiBN,GACjCkC,EAAc9B,GAAcO,GAC5BU,EAAOtB,GAAQC,GACfmC,EAA0B,MAAbF,EACbG,EAAUvB,EAAUpyC,EAAIoyC,EAAUtyB,MAAQ,EAAIuyB,EAASvyB,MAAQ,EAC/D8zB,EAAUxB,EAAUzjB,EAAIyjB,EAAUpyB,OAAS,EAAIqyB,EAASryB,OAAS,EACjE6zB,EAAczB,EAAUqB,GAAe,EAAIpB,EAASoB,GAAe,EAEzE,OAAQb,GACN,IAAK,MACHW,EAAS,CACPvzC,EAAG2zC,EACHhlB,EAAGyjB,EAAUzjB,EAAI0jB,EAASryB,QAE5B,MACF,IAAK,SACHuzB,EAAS,CACPvzC,EAAG2zC,EACHhlB,EAAGyjB,EAAUzjB,EAAIyjB,EAAUpyB,QAE7B,MACF,IAAK,QACHuzB,EAAS,CACPvzC,EAAGoyC,EAAUpyC,EAAIoyC,EAAUtyB,MAC3B6O,EAAGilB,GAEL,MACF,IAAK,OACHL,EAAS,CACPvzC,EAAGoyC,EAAUpyC,EAAIqyC,EAASvyB,MAC1B6O,EAAGilB,GAEL,MACF,QACEL,EAAS,CACPvzC,EAAGoyC,EAAUpyC,EACb2uB,EAAGyjB,EAAUzjB,GAGnB,OAAQ6iB,GAAaD,IACnB,IAAK,QACHgC,EAAOrB,IAAkB2B,GAAe7B,GAAO0B,GAAc,EAAI,GACjE,MACF,IAAK,MACHH,EAAOrB,IAAkB2B,GAAe7B,GAAO0B,GAAc,EAAI,GAGrE,OAAOH,CACT,CASA,IAAMO,GAAe,WAAA,IAAAC,EAAA/Z,EAAAC,IAAAC,MAAG,SAAA8Z,EAAO5B,EAAWC,EAAUlhC,GAAM,IAAA8iC,EAAA1C,EAAA2C,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAvC,EAAAD,EAAAyC,EAAAx0C,EAAA2uB,EAAA8lB,EAAAC,EAAAC,EAAAvyC,EAAAwyC,EAAA/tC,EAAAvG,EAAAu0C,EAAAC,EAAAC,EAAA7tC,EAAA8tC,EAAAC,EAAA,OAAAhb,IAAApf,MAAA,SAAAq6B,iBAAAA,EAAAza,KAAAya,EAAAroC,MAAA,KAAA,EAQrC,OARqConC,EAMpD9iC,EAJFogC,UAAAA,WAAS0C,EAAG,SAAQA,EAAAC,EAIlB/iC,EAHFgjC,SAAAA,OAAQ,IAAAD,EAAG,WAAUA,EAAAE,EAGnBjjC,EAFFkjC,WAAAA,OAAU,IAAAD,EAAG,GAAEA,EACfE,EACEnjC,EADFmjC,SAEIC,EAAkBF,EAAWvnC,OAAOsP,SAAQ84B,EAAAroC,KAC/B,EAAkB,MAAlBynC,EAASa,WAAgB,EAASb,EAASa,MAAM9C,GAAS,KAAA,EAC3D,OADZL,EAAGkD,EAAAta,KAAAsa,EAAAroC,KACS,EAAAynC,EAASc,gBAAgB,CACzChD,UAAAA,EACAC,SAAAA,EACA8B,SAAAA,IACA,KAAA,EAJEpC,EAAKmD,EAAAta,KAAA4Z,EAQLnB,GAA2BtB,EAAOR,EAAWS,GAF/ChyC,EAACw0C,EAADx0C,EACA2uB,EAAC6lB,EAAD7lB,EAEE8lB,EAAoBlD,EACpBmD,EAAiB,CAAA,EACjBC,EAAa,EACRvyC,EAAI,EAAC,KAAA,GAAA,KAAEA,EAAImyC,EAAgBpyC,QAAM+yC,CAAAA,EAAAroC,cAGpC,OAHoC+nC,EAIpCL,EAAgBnyC,GAFlByE,EAAI+tC,EAAJ/tC,KACAvG,EAAEs0C,EAAFt0C,GAAE40C,EAAAroC,KAAA,GAOMvM,EAAG,CACXN,EAAAA,EACA2uB,EAAAA,EACA0mB,iBAAkB9D,EAClBA,UAAWkD,EACXN,SAAAA,EACAO,eAAAA,EACA3C,MAAAA,EACAuC,SAAAA,EACAgB,SAAU,CACRlD,UAAAA,EACAC,SAAAA,KAEFwC,KAAAA,GASA,GATAA,EAAAK,EAAAta,KAjBGka,EAAKD,EAAR70C,EACG+0C,EAAKF,EAARlmB,EACAznB,EAAI2tC,EAAJ3tC,KACA8tC,EAAKH,EAALG,MAeFh1C,EAAa,MAAT80C,EAAgBA,EAAQ90C,EAC5B2uB,EAAa,MAATomB,EAAgBA,EAAQpmB,EAC5B+lB,EAAc/5B,EAAAA,EACT+5B,CAAAA,EAAAA,GAAc99B,CAAAA,EAAAA,EAChB/P,CAAAA,EAAAA,EAAI8T,EAAAA,EAAA,CAAA,EACA+5B,EAAe7tC,IACfK,OAGH8tC,GAASL,GAAc,KAAEO,EAAAroC,KAAA,GAAA,KAAA,CACd,GAAb8nC,IACqB,WAAjBzzC,EAAO8zC,IAAkBE,EAAAroC,KAAA,GAAA,KAAA,CAG1B,GAFGmoC,EAAMzD,YACRkD,EAAoBO,EAAMzD,YAExByD,EAAMjD,MAAKmD,CAAAA,EAAAroC,KAAA,GAAA,KAAA,CAAA,IACW,IAAhBmoC,EAAMjD,MAAc,CAAAmD,EAAAroC,KAAAqoC,GAAAA,KAAAA,CAAS,OAATA,EAAAroC,KAAS,GAAAynC,EAASc,gBAAgB,CAC5DhD,UAAAA,EACAC,SAAAA,EACA8B,SAAAA,IACA,KAAA,GAAAe,EAAAra,GAAAqa,EAAAta,KAAAsa,EAAAroC,KAAA,GAAA,MAAA,KAAA,GAAAqoC,EAAAra,GAAGma,EAAMjD,cAJXA,EAAKmD,EAAAra,GAAA,KAAA,GAAAoa,EASH5B,GAA2BtB,EAAO0C,EAAmBzC,GAFvDhyC,EAACi1C,EAADj1C,EACA2uB,EAACsmB,EAADtmB,EAGJvsB,KAAAA,GAAO,OAAPA,GAAK,EAAE8yC,EAAAK,OAAA,WAAA,IAAA,KAAA,GAnDiCnzC,IAAG8yC,EAAAroC,6BAAAqoC,EAAAK,OAAA,SAuDxC,CACLv1C,EAAAA,EACA2uB,EAAAA,EACA4iB,UAAWkD,EACXN,SAAAA,EACAO,eAAAA,IACD,KAAA,GAAA,IAAA,MAAA,OAAAQ,EAAAM,OAAAxB,GAAAA,EACF,KAAA,OAAA,SAnFoByB,EAAAC,EAAAC,GAAA,OAAA5B,EAAAz+B,MAAA/K,KAAAA,YAAA,GAqFrB,SAQeqrC,GAAcC,EAAAC,GAAA,OAAAC,GAAAzgC,MAAAvN,KAAAwC,UAgP7B,CAAA,SAAAwrC,KA3LC,OA2LDA,GAAA/b,EAAAC,IAAAC,MAhPA,SAAA8b,EAA8Bl3B,EAAOrX,GAAOwuC,IAAAA,EAAAj2C,EAAA2uB,EAAA2lB,EAAAvC,EAAAuD,EAAAnB,EAAA+B,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAvxC,EAAAwxC,EAAAtoB,EAAAuoB,EAAAC,EAAAC,EAAA,OAAAhd,IAAApf,MAAA,SAAAq8B,GAAAA,cAAAA,EAAAzc,KAAAyc,EAAArqC,MAE1C,KAAA,EAqB0D,YArB1C,IAAZpF,IACFA,EAAU,CAAA,GAGVzH,EAME8e,EANF9e,EACA2uB,EAKE7P,EALF6P,EACA2lB,EAIEx1B,EAJFw1B,SACAvC,EAGEjzB,EAHFizB,MACAuD,EAEEx2B,EAFFw2B,SACAnB,EACEr1B,EADFq1B,SAAQ+B,EAQN9E,GAAS3pC,EAASqX,GAAMq3B,EAAAD,EAL1BE,SAAAA,OAAQ,IAAAD,EAAG,oBAAmBA,EAAAE,EAAAH,EAC9BI,aAAAA,OAAe,IAAHD,EAAG,WAAUA,EAAAE,EAAAL,EACzBM,eAAAA,WAAcD,EAAG,WAAUA,EAAAE,EAAAP,EAC3BQ,YAAAA,OAAW,IAAAD,GAAQA,EAAAE,EAAAT,EACnBhD,QAEI0D,EAAgB3D,QAFV,IAAH0D,EAAG,EAACA,GAGPE,EAAgC,aAAnBL,EAAgC,YAAc,WAC3DlxC,EAAUgwC,EAASoB,EAAcG,EAAaL,GAAeU,EAAArc,GACxCuY,GAAgB8D,EAAAvc,GAAO2Z,EAAQ4C,EAAArqC,KAAA,GACQ,MAAtBynC,EAAS6C,eAAoB,EAAS7C,EAAS6C,UAAU7xC,GAAQ,KAAA,GAA3E,GAA2E4xC,EAAApc,GAAhGmb,EAAqBiB,EAAAtc,KAAiF,MAAjFsc,EAAApc,GAAqF,CAAAoc,EAAArqC,KAAA,GAAA,KAAA,CAAAqqC,EAAAE,GAAGnB,EAAqBiB,EAAArqC,KAAAqqC,GAAAA,MAAAA,KAAAA,GAAAA,EAAAE,IAAG,EAAIF,KAAAA,GAAAA,IAAAA,EAAAE,GAAAF,CAAAA,EAAArqC,KAAA,GAAA,KAAA,CAAAqqC,EAAAG,GAAI/xC,EAAO4xC,EAAArqC,KAAA,GAAA,MAAA,KAAA,GAAyBqqC,GAAzBA,EAAAI,GAAGhyC,EAAQiyC,eAAcL,EAAAI,GAAAJ,CAAAA,EAAArqC,KAAAqqC,GAAAA,KAAAA,CAAY,OAAZA,EAAArqC,KAAY,GAA+B,MAA/BynC,EAASkD,wBAA6B,EAASlD,EAASkD,mBAAmBlC,EAASjD,kBAAS6E,EAAAI,GAAAJ,EAAAtc,KAAA,KAAA,GAAAsc,EAAAG,GAAAH,EAAAI,GAAA,KAAA,GAGzRJ,OAHyRA,EAAAO,GAAAP,EAAAG,GAAAH,EAAAQ,GACjStB,EAAQc,EAAAS,GACRrB,EAAYY,EAAAU,GACZzD,EAAQ+C,EAAAW,IAAA,CAHRvyC,QAAO4xC,EAAAO,GACPrB,SAAQc,EAAAQ,GACRpB,aAAYY,EAAAS,GACZxD,SAAQ+C,EAAAU,IAAAV,EAAArqC,KAAAqqC,GAAAA,EAAAvc,GAJiDmd,gBAAehwC,KAAAovC,EAAAvc,GAAAuc,EAAAW,KAAA,KAAA,GAW9C,OAX8CX,EAAAa,IAAAb,EAAAtc,KAApEkc,GAAkB,EAAAI,EAAArc,IAAAqc,EAAAa,KAMlBvpB,EAA0B,aAAnBgoB,EAA6B77B,EAAAA,KACrCo3B,EAAMM,UAAQ,CAAA,EAAA,CACjBryC,EAAAA,EACA2uB,EAAAA,IACEojB,EAAMK,UAAS8E,EAAArqC,KACS,GAA4B,MAA5BynC,EAAS0D,qBAA0B,EAAS1D,EAAS0D,gBAAgB1C,EAASjD,UAApG0E,KAAAA,GACsB,OADtBA,EAAYG,EAAAtc,KAAAsc,EAAArqC,KACU,GAAsB,MAAtBynC,EAAS6C,eAAoB,EAAS7C,EAAS6C,UAAUJ,GAAaG,KAAAA,GAAAA,IAAAA,EAAAtc,KAAAsc,CAAAA,EAAArqC,KAAAqqC,GAAAA,KAAAA,CAAa,OAAbA,EAAArqC,KAAa,GAAqB,MAArBynC,EAAS2D,cAAmB,EAAS3D,EAAS2D,SAASlB,GAAaG,KAAAA,GAAA,GAAAA,EAAAgB,IAAAhB,EAAAtc,KAAAsc,EAAAgB,IAAA,CAAAhB,EAAArqC,KAAA,GAAA,KAAA,CAAAqqC,EAAAgB,IAAM,CACvLl4C,EAAG,EACH2uB,EAAG,GACJuoB,KAAAA,GAAAA,EAAAiB,IAAAjB,EAAAgB,IAAAhB,EAAArqC,KAAA,GAAA,MAAA,KAAA,GAAAqqC,EAAAiB,IAAG,CACFn4C,EAAG,EACH2uB,EAAG,GACJ,KAAA,GAC0C2lB,GAPrC0C,EAAWE,EAAAiB,IAAAjB,EAAAkB,IAOShF,IAAiBkB,EAAS+D,sDAAqDnB,CAAAA,EAAArqC,KAAA,GAAA,KAAA,CAAA,OAAAqqC,EAAArqC,KAAA,GAASynC,EAAS+D,sDAAsD,CAC/K7pB,KAAAA,EACAuoB,aAAAA,EACA5C,SAAAA,IACA+C,KAAAA,GAAAA,EAAAoB,IAAApB,EAAAtc,KAAAsc,EAAArqC,KAAAqqC,GAAAA,MAAAA,KAAAA,GAAAA,EAAAoB,IAAG9pB,EAAI0oB,KAAAA,GAJc,OAIdA,EAAAqB,IAAArB,EAAAoB,IAJHrB,GAAiB,EAAAC,EAAAkB,KAAAlB,EAAAqB,KAAArB,EAAA3B,OAAA,SAKhB,CACL/0B,KAAMs2B,EAAmBt2B,IAAMy2B,EAAkBz2B,IAAMo2B,EAAcp2B,KAAOw2B,EAAYroB,EACxFgD,QAASslB,EAAkBtlB,OAASmlB,EAAmBnlB,OAASilB,EAAcjlB,QAAUqlB,EAAYroB,EACpGjO,MAAOo2B,EAAmBp2B,KAAOu2B,EAAkBv2B,KAAOk2B,EAAcl2B,MAAQs2B,EAAYh3C,EAC5FovB,OAAQ6nB,EAAkB7nB,MAAQ0nB,EAAmB1nB,MAAQwnB,EAAcxnB,OAAS4nB,EAAYh3C,IACjGk3C,KAAAA,GAAAA,IAAAA,MAAAA,OAAAA,EAAA1B,OAAAQ,GAAAA,EACF,KAAAD,GAAAzgC,MAAA/K,KAAAA,UAiMD,CAsTA,SAEeiuC,GAAoBC,EAAAC,GAAAC,OAAAA,GAAArjC,MAAA/K,KAAAA,UAyCnC,CAAA,SAAAouC,YAAAA,GAAA3e,EAAAC,IAAAC,MAzCA,SAAA0e,EAAoC95B,EAAOrX,OAAO8pC,EAAA+C,EAAAgB,EAAAtD,EAAAY,EAAAX,EAAAyB,EAAAmF,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAhH,EAAA,OAAAjY,IAAApf,MAAAs+B,SAAAC,GAAA,cAAAA,EAAA3e,KAAA2e,EAAAvsC,MAE9C0kC,KAAAA,EAIiB,OAJjBA,EAGEzyB,EAHFyyB,UACA+C,EAEEx1B,EAFFw1B,SACAgB,EACEx2B,EADFw2B,SAAQ8D,EAAAvsC,KAES,EAAkB,MAAlBynC,EAASa,WAAgB,EAASb,EAASa,MAAMG,EAASjD,UAAS,KAAA,EAyBrF,OAzBKL,EAAGoH,EAAAxe,KACHgY,EAAOtB,GAAQC,GACfU,EAAYT,GAAaD,GACzBmC,EAAwC,MAA3B9B,GAAYL,GACzBsH,EAAgB,CAAC,OAAQ,OAAO1uB,SAASyoB,IAAS,EAAI,EACtDkG,EAAiB9G,GAAO0B,GAAc,EAAI,EAC1CqF,EAAW3H,GAAS3pC,EAASqX,GAErCk6B,EAK0B,iBAAbD,EAAwB,CACjCE,SAAUF,EACVG,UAAW,EACXhH,cAAe,MAChBv3B,EACCs+B,CAAAA,SAAU,EACVC,UAAW,EACXhH,cAAe,MACZ6G,GAXHE,EAAQD,EAARC,SACAC,EAASF,EAATE,UACAhH,EAAa8G,EAAb9G,cAWED,GAAsC,iBAAlBC,IACtBgH,EAA0B,QAAdjH,GAAuC,EAAjBC,EAAqBA,GACxDkH,EAAA7D,gBACM7B,EAAa,CAClB1zC,EAAGk5C,EAAYJ,EACfnqB,EAAGsqB,EAAWJ,GACZ,CACF74C,EAAGi5C,EAAWJ,EACdlqB,EAAGuqB,EAAYJ,IAChB,KAAA,GAAA,IAAA,MAAA,OAAAM,EAAA5D,UAAAoD,EAAA,KACFD,GAAArjC,MAAAvN,KAAAwC,UASD,CC7vBA,SAAS8uC,GAAYx0C,GACnB,OAAIy0C,GAAOz0C,IACDA,EAAK8mB,UAAY,IAAIzM,cAKxB,WACT,CACA,SAAS8N,GAAUnoB,GACjB,IAAI00C,EACJ,OAAgB,MAAR10C,GAA8D,OAA7C00C,EAAsB10C,EAAKgB,oBAAyB,EAAS0zC,EAAoBrsB,cAAgBvpB,MAC5H,CACA,SAAS6zC,GAAmB3yC,GAC1B,IAAIyuC,EACJ,OAA0F,OAAlFA,GAAQgG,GAAOz0C,GAAQA,EAAKgB,cAAgBhB,EAAKa,WAAa/B,OAAO+B,eAAoB,EAAS4tC,EAAKkG,eACjH,CACA,SAASF,GAAOh2C,GACd,OAAOA,aAAiBm2C,MAAQn2C,aAAiB0pB,GAAU1pB,GAAOm2C,IACpE,CACA,SAAStC,GAAU7zC,GACjB,OAAOA,aAAiBo2C,SAAWp2C,aAAiB0pB,GAAU1pB,GAAOo2C,OACvE,CACA,SAASC,GAAcr2C,GACrB,OAAOA,aAAiBs2C,aAAet2C,aAAiB0pB,GAAU1pB,GAAOs2C,WAC3E,CACA,SAASC,GAAav2C,GAEpB,MAA0B,oBAAfw2C,aAGJx2C,aAAiBw2C,YAAcx2C,aAAiB0pB,GAAU1pB,GAAOw2C,WAC1E,CACA,SAASC,GAAkBz0C,GACzB,IAAA00C,EAKIrhC,GAAiBrT,GAJnBib,EAAQy5B,EAARz5B,SACA05B,EAASD,EAATC,UACAC,EAASF,EAATE,UACA/9B,EAAO69B,EAAP79B,QAEF,MAAO,kCAAkC6H,KAAKzD,EAAW25B,EAAYD,KAAe,CAAC,SAAU,YAAY9vB,SAAShO,EACtH,CACA,SAASg+B,GAAe70C,GACtB,MAAO,CAAC,QAAS,KAAM,MAAM6kB,SAASkvB,GAAY/zC,GACpD,CACA,SAAS80C,GAAkB90C,GACzB,IAAM+0C,EAASC,KACThoC,EAAMqG,GAAiBrT,GAG7B,MAAyB,SAAlBgN,EAAIioC,WAA4C,SAApBjoC,EAAIkoC,eAA2BloC,EAAImoC,eAAsC,WAAtBnoC,EAAImoC,gBAAwCJ,KAAW/nC,EAAIooC,gBAAwC,SAAvBpoC,EAAIooC,iBAAuCL,KAAW/nC,EAAIxF,QAAwB,SAAfwF,EAAIxF,QAA8B,CAAC,YAAa,cAAe,UAAUivB,MAAK,SAAAz4B,UAAUgP,EAAIqoC,YAAc,IAAIxwB,SAAS7mB,EAAM,KAAK,CAAC,QAAS,SAAU,SAAU,WAAWy4B,MAAK,SAAAz4B,GAAS,OAACgP,EAAIsoC,SAAW,IAAIzwB,SAAS7mB,KAC7b,CAYA,SAASg3C,KACP,QAAmB,oBAARO,MAAwBA,IAAIC,WAChCD,IAAIC,SAAS,0BAA2B,OACjD,CACA,SAASC,GAAsBl2C,GAC7B,MAAO,CAAC,OAAQ,OAAQ,aAAaslB,SAASkvB,GAAYx0C,GAC5D,CACA,SAAS8T,GAAiBrT,GACxB,OAAO0nB,GAAU1nB,GAASqT,iBAAiBrT,EAC7C,CACA,SAAS01C,GAAc11C,GACrB,OAAI6xC,GAAU7xC,GACL,CACL21C,WAAY31C,EAAQ21C,WACpBC,UAAW51C,EAAQ41C,WAGhB,CACLD,WAAY31C,EAAQ61C,YACpBD,UAAW51C,EAAQ81C,YAEvB,CACA,SAASC,GAAcx2C,GACrB,GAA0B,SAAtBw0C,GAAYx0C,GACd,OAAOA,EAET,IAAM9B,EAEN8B,EAAKy2C,cAELz2C,EAAK0B,YAELszC,GAAah1C,IAASA,EAAKiB,MAE3B0xC,GAAmB3yC,GACnB,OAAOg1C,GAAa92C,GAAUA,EAAO+C,KAAO/C,CAC9C,CACA,SAASw4C,GAA2B12C,GAClC,IAAM0B,EAAa80C,GAAcx2C,GACjC,OAAIk2C,GAAsBx0C,GACjB1B,EAAKgB,cAAgBhB,EAAKgB,cAAcwa,KAAOxb,EAAKwb,KAEzDs5B,GAAcpzC,IAAewzC,GAAkBxzC,GAC1CA,EAEFg1C,GAA2Bh1C,EACpC,CACA,SAASi1C,GAAqB32C,EAAMuO,EAAMqoC,GACxC,IAAIC,OACS,IAATtoC,IACFA,EAAO,SAEe,IAApBqoC,IACFA,GAAkB,GAEpB,IAAME,EAAqBJ,GAA2B12C,GAChD+2C,EAASD,KAAuE,OAA9CD,EAAuB72C,EAAKgB,oBAAyB,EAAS61C,EAAqBr7B,MACrHw7B,EAAM7uB,GAAU2uB,GACtB,OAAIC,EACKxoC,EAAKzH,OAAOkwC,EAAKA,EAAIC,gBAAkB,GAAI/B,GAAkB4B,GAAsBA,EAAqB,GAAIE,EAAIE,cAAgBN,EAAkBD,GAAqBK,EAAIE,cAAgB,IAE7L3oC,EAAKzH,OAAOgwC,EAAoBH,GAAqBG,EAAoB,GAAIF,GACtF,CCvHA,SAASO,GAAiB12C,GACxB,IAAMgN,EAAMqG,GAAiBrT,GAGzBwa,EAAQ0U,WAAWliB,EAAIwN,QAAU,EACjCE,EAASwU,WAAWliB,EAAI0N,SAAW,EACjCi8B,EAAYtC,GAAcr0C,GAC1B+W,EAAc4/B,EAAY32C,EAAQ+W,YAAcyD,EAChDxD,EAAe2/B,EAAY32C,EAAQgX,aAAe0D,EAClDk8B,EAAiBnL,GAAMjxB,KAAWzD,GAAe00B,GAAM/wB,KAAY1D,EAKzE,OAJI4/B,IACFp8B,EAAQzD,EACR2D,EAAS1D,GAEJ,CACLwD,MAAAA,EACAE,OAAAA,EACAm8B,EAAGD,EAEP,CAEA,SAASE,GAAc92C,GACrB,OAAQ6xC,GAAU7xC,GAAoCA,EAAzBA,EAAQiyC,cACvC,CAEA,SAASU,GAAS3yC,GAChB,IAAM+2C,EAAaD,GAAc92C,GACjC,IAAKq0C,GAAc0C,GACjB,OAAOrL,GAAa,GAEtB,IAAMxiB,EAAO6tB,EAAW5tB,wBACxB6tB,EAIIN,GAAiBK,GAHnBv8B,EAAKw8B,EAALx8B,MACAE,EAAMs8B,EAANt8B,OACAm8B,EAACG,EAADH,EAEEn8C,GAAKm8C,EAAIpL,GAAMviB,EAAK1O,OAAS0O,EAAK1O,OAASA,EAC3C6O,GAAKwtB,EAAIpL,GAAMviB,EAAKxO,QAAUwO,EAAKxO,QAAUA,EAUjD,OANKhgB,GAAMwkB,OAAOJ,SAASpkB,KACzBA,EAAI,GAED2uB,GAAMnK,OAAOJ,SAASuK,KACzBA,EAAI,GAEC,CACL3uB,EAAAA,EACA2uB,EAAAA,EAEJ,CAEA,IAAM4tB,GAAyBvL,GAAa,GAC5C,SAASwL,GAAiBl3C,GACxB,IAAMu2C,EAAM7uB,GAAU1nB,GACtB,OAAKg1C,MAAeuB,EAAIC,eAGjB,CACL97C,EAAG67C,EAAIC,eAAerqB,WACtB9C,EAAGktB,EAAIC,eAAevqB,WAJfgrB,EAMX,CAWA,SAAS9tB,GAAsBnpB,EAASm3C,EAAcC,EAAiB3F,QAChD,IAAjB0F,IACFA,GAAe,QAEO,IAApBC,IACFA,GAAkB,GAEpB,IAAMC,EAAar3C,EAAQmpB,wBACrB4tB,EAAaD,GAAc92C,GAC7B8yB,EAAQ4Y,GAAa,GACrByL,IACE1F,EACEI,GAAUJ,KACZ3e,EAAQ6f,GAASlB,IAGnB3e,EAAQ6f,GAAS3yC,IAGrB,IAAMs3C,EA7BR,SAAgCt3C,EAASu3C,EAASC,GAIhD,YAHgB,IAAZD,IACFA,GAAU,MAEPC,GAAwBD,GAAWC,IAAyB9vB,GAAU1nB,KAGpEu3C,CACT,CAqBwBE,CAAuBV,EAAYK,EAAiB3F,GAAgByF,GAAiBH,GAAcrL,GAAa,GAClIhxC,GAAK28C,EAAWj8B,KAAOk8B,EAAc58C,GAAKo4B,EAAMp4B,EAChD2uB,GAAKguB,EAAWn8B,IAAMo8B,EAAcjuB,GAAKyJ,EAAMzJ,EAC/C7O,EAAQ68B,EAAW78B,MAAQsY,EAAMp4B,EACjCggB,EAAS28B,EAAW38B,OAASoY,EAAMzJ,EACvC,GAAI0tB,EAIF,IAHA,IAAMR,EAAM7uB,GAAUqvB,GAChBW,EAAYjG,GAAgBI,GAAUJ,GAAgB/pB,GAAU+pB,GAAgBA,EAClFkG,EAAgBpB,EAAIE,aACjBkB,GAAiBlG,GAAgBiG,IAAcnB,GAAK,CACzD,IAAMqB,EAAcjF,GAASgF,GACvBE,EAAaF,EAAcxuB,wBAC3Bnc,EAAMqG,GAAiBskC,GACvBv8B,EAAOy8B,EAAWz8B,MAAQu8B,EAAcG,WAAa5oB,WAAWliB,EAAI+qC,cAAgBH,EAAYl9C,EAChGwgB,EAAM28B,EAAW38B,KAAOy8B,EAAcK,UAAY9oB,WAAWliB,EAAIirC,aAAeL,EAAYvuB,EAClG3uB,GAAKk9C,EAAYl9C,EACjB2uB,GAAKuuB,EAAYvuB,EACjB7O,GAASo9B,EAAYl9C,EACrBggB,GAAUk9B,EAAYvuB,EACtB3uB,GAAK0gB,EACLiO,GAAKnO,EACLy8B,EAAgBjwB,GAAUiwB,GAAelB,YAC1C,CAEH,OAAO3I,GAAiB,CACtBtzB,MAAAA,EACAE,OAAAA,EACAhgB,EAAAA,EACA2uB,EAAAA,GAEJ,CA0CA,SAAS6uB,GAAoBl4C,GAG3B,OAAOmpB,GAAsB+oB,GAAmBlyC,IAAUob,KAAOs6B,GAAc11C,GAAS21C,UAC1F,CAiEA,SAASwC,GAAkCn4C,EAASo4C,EAAkBvJ,GACpE,IAAI3lB,EACJ,GAAyB,aAArBkvB,EACFlvB,EA7CJ,SAAyBlpB,EAAS6uC,GAChC,IAAM0H,EAAM7uB,GAAU1nB,GAChBq4C,EAAOnG,GAAmBlyC,GAC1Bw2C,EAAiBD,EAAIC,eACvBh8B,EAAQ69B,EAAKC,YACb59B,EAAS29B,EAAKE,aACd79C,EAAI,EACJ2uB,EAAI,EACR,GAAImtB,EAAgB,CAClBh8B,EAAQg8B,EAAeh8B,MACvBE,EAAS87B,EAAe97B,OACxB,IAAM89B,EAAsBxD,OACvBwD,GAAuBA,GAAoC,UAAb3J,KACjDn0C,EAAI87C,EAAerqB,WACnB9C,EAAImtB,EAAevqB,UAEtB,CACD,MAAO,CACLzR,MAAAA,EACAE,OAAAA,EACAhgB,EAAAA,EACA2uB,EAAAA,EAEJ,CAsBWovB,CAAgBz4C,EAAS6uC,WACF,aAArBuJ,EACTlvB,EAlEJ,SAAyBlpB,GACvB,IAAMq4C,EAAOnG,GAAmBlyC,GAC1B04C,EAAShD,GAAc11C,GACvB+a,EAAO/a,EAAQO,cAAcwa,KAC7BP,EAAQ5d,GAAIy7C,EAAKM,YAAaN,EAAKC,YAAav9B,EAAK49B,YAAa59B,EAAKu9B,aACvE59B,EAAS9d,GAAIy7C,EAAKO,aAAcP,EAAKE,aAAcx9B,EAAK69B,aAAc79B,EAAKw9B,cAC7E79C,GAAKg+C,EAAO/C,WAAauC,GAAoBl4C,GAC3CqpB,GAAKqvB,EAAO9C,UAIlB,MAHyC,QAArCviC,GAAiB0H,GAAMpQ,YACzBjQ,GAAKkC,GAAIy7C,EAAKC,YAAav9B,EAAKu9B,aAAe99B,GAE1C,CACLA,MAAAA,EACAE,OAAAA,EACAhgB,EAAAA,EACA2uB,EAAAA,EAEJ,CAiDWwvB,CAAgB3G,GAAmBlyC,SACrC,GAAI6xC,GAAUuG,GACnBlvB,EAvBJ,SAAoClpB,EAAS6uC,GAC3C,IAAMwI,EAAaluB,GAAsBnpB,GAAS,EAAmB,UAAb6uC,GAClD3zB,EAAMm8B,EAAWn8B,IAAMlb,EAAQg4C,UAC/B58B,EAAOi8B,EAAWj8B,KAAOpb,EAAQ83C,WACjChlB,EAAQuhB,GAAcr0C,GAAW2yC,GAAS3yC,GAAW0rC,GAAa,GAKxE,MAAO,CACLlxB,MALYxa,EAAQs4C,YAAcxlB,EAAMp4B,EAMxCggB,OALa1a,EAAQu4C,aAAezlB,EAAMzJ,EAM1C3uB,EALQ0gB,EAAO0X,EAAMp4B,EAMrB2uB,EALQnO,EAAM4X,EAAMzJ,EAOxB,CAQWyvB,CAA2BV,EAAkBvJ,OAC/C,CACL,IAAMyI,EAAgBJ,GAAiBl3C,GACvCkpB,EAAI7T,EAAAA,EACC+iC,CAAAA,EAAAA,OACH19C,EAAG09C,EAAiB19C,EAAI48C,EAAc58C,EACtC2uB,EAAG+uB,EAAiB/uB,EAAIiuB,EAAcjuB,GAEzC,CACD,OAAOykB,GAAiB5kB,EAC1B,CACA,SAAS6vB,GAAyB/4C,EAASg5C,GACzC,IAAM/3C,EAAa80C,GAAc/1C,GACjC,QAAIiB,IAAe+3C,IAAanH,GAAU5wC,IAAew0C,GAAsBx0C,MAG9B,UAA1CoS,GAAiBpS,GAAY+Z,UAAwB+9B,GAAyB93C,EAAY+3C,GACnG,CA2EA,SAASC,GAA8Bj5C,EAASyxC,EAAc5C,GAC5D,IAAMqK,EAA0B7E,GAAc5C,GACxCyC,EAAkBhC,GAAmBT,GACrC8F,EAAuB,UAAb1I,EACV3lB,EAAOC,GAAsBnpB,GAAS,EAAMu3C,EAAS9F,GACvDiH,EAAS,CACX/C,WAAY,EACZC,UAAW,GAEPuD,EAAUzN,GAAa,GAC7B,GAAIwN,IAA4BA,IAA4B3B,EAI1D,IAHkC,SAA9BxD,GAAYtC,IAA4BgD,GAAkBP,MAC5DwE,EAAShD,GAAcjE,IAErByH,EAAyB,CAC3B,IAAME,EAAajwB,GAAsBsoB,GAAc,EAAM8F,EAAS9F,GACtE0H,EAAQz+C,EAAI0+C,EAAW1+C,EAAI+2C,EAAaqG,WACxCqB,EAAQ9vB,EAAI+vB,EAAW/vB,EAAIooB,EAAauG,SACzC,MAAU9D,IACTiF,EAAQz+C,EAAIw9C,GAAoBhE,IAGpC,MAAO,CACLx5C,EAAGwuB,EAAK9N,KAAOs9B,EAAO/C,WAAawD,EAAQz+C,EAC3C2uB,EAAGH,EAAKhO,IAAMw9B,EAAO9C,UAAYuD,EAAQ9vB,EACzC7O,MAAO0O,EAAK1O,MACZE,OAAQwO,EAAKxO,OAEjB,CAEA,SAAS2+B,GAAoBr5C,EAASs5C,GACpC,OAAKjF,GAAcr0C,IAAmD,UAAvCqT,GAAiBrT,GAASgb,SAGrDs+B,EACKA,EAASt5C,GAEXA,EAAQyxC,aALF,IAMf,CAIA,SAASiB,GAAgB1yC,EAASs5C,GAChC,IAAMj7C,EAASqpB,GAAU1nB,GACzB,IAAKq0C,GAAcr0C,GACjB,OAAO3B,EAGT,IADA,IAAIozC,EAAe4H,GAAoBr5C,EAASs5C,GACzC7H,GAAgBoD,GAAepD,IAA6D,WAA5Cp+B,GAAiBo+B,GAAcz2B,UACpFy2B,EAAe4H,GAAoB5H,EAAc6H,GAEnD,OAAI7H,IAA+C,SAA9BsC,GAAYtC,IAA0D,SAA9BsC,GAAYtC,IAAwE,WAA5Cp+B,GAAiBo+B,GAAcz2B,WAA0B85B,GAAkBrD,IACvKpzC,EAEFozC,GDrVT,SAA4BzxC,GAE1B,IADA,IAAIu5C,EAAcxD,GAAc/1C,GACzBq0C,GAAckF,KAAiB9D,GAAsB8D,IAAc,CACxE,GAAIzE,GAAkByE,GACpB,OAAOA,EAEPA,EAAcxD,GAAcwD,EAE/B,CACD,OAAW,IACb,CC2UyBC,CAAmBx5C,IAAY3B,CACxD,CAwBA,IAAM2wC,GAAW,CACf+D,sDAhSF,SAA+D/E,GAC7D,IACE9kB,EAGE8kB,EAHF9kB,KACAuoB,EAEEzD,EAFFyD,aACA5C,EACEb,EADFa,SAEIqK,EAA0B7E,GAAc5C,GACxCyC,EAAkBhC,GAAmBT,GAC3C,GAAIA,IAAiByC,EACnB,OAAOhrB,EAET,IAAIwvB,EAAS,CACX/C,WAAY,EACZC,UAAW,GAET9iB,EAAQ4Y,GAAa,GACnByN,EAAUzN,GAAa,GAC7B,IAAIwN,IAA4BA,GAAwC,UAAbrK,MACvB,SAA9BkF,GAAYtC,IAA4BgD,GAAkBP,MAC5DwE,EAAShD,GAAcjE,IAErB4C,GAAc5C,IAAe,CAC/B,IAAM2H,EAAajwB,GAAsBsoB,GACzC3e,EAAQ6f,GAASlB,GACjB0H,EAAQz+C,EAAI0+C,EAAW1+C,EAAI+2C,EAAaqG,WACxCqB,EAAQ9vB,EAAI+vB,EAAW/vB,EAAIooB,EAAauG,SACzC,CAEH,MAAO,CACLx9B,MAAO0O,EAAK1O,MAAQsY,EAAMp4B,EAC1BggB,OAAQwO,EAAKxO,OAASoY,EAAMzJ,EAC5B3uB,EAAGwuB,EAAKxuB,EAAIo4B,EAAMp4B,EAAIg+C,EAAO/C,WAAa7iB,EAAMp4B,EAAIy+C,EAAQz+C,EAC5D2uB,EAAGH,EAAKG,EAAIyJ,EAAMzJ,EAAIqvB,EAAO9C,UAAY9iB,EAAMzJ,EAAI8vB,EAAQ9vB,EAE/D,EA+PE6oB,mBAAAA,GACAM,gBAvHF,SAAyBxE,GACvB,IACEhuC,EAIEguC,EAJFhuC,QACA8wC,EAGE9C,EAHF8C,SACAE,EAEEhD,EAFFgD,aACAnC,EACEb,EADFa,SAEI4K,EAAwC,sBAAb3I,EAxCnC,SAAqC9wC,EAAS05C,GAC5C,IAAMC,EAAeD,EAAM9yC,IAAI5G,GAC/B,GAAI25C,EACF,OAAOA,EAQT,IANA,IAAIl8C,EAASy4C,GAAqBl2C,EAAS,IAAI,GAAOwH,QAAO,SAAAoyC,UAAM/H,GAAU+H,IAA2B,SAApB7F,GAAY6F,EAAe,IAC3GC,EAAsC,KACpCC,EAAwD,UAAvCzmC,GAAiBrT,GAASgb,SAC7Cu+B,EAAcO,EAAiB/D,GAAc/1C,GAAWA,EAGrD6xC,GAAU0H,KAAiB9D,GAAsB8D,IAAc,CACpE,IAAMQ,EAAgB1mC,GAAiBkmC,GACjCS,EAA0BlF,GAAkByE,GAC7CS,GAAsD,UAA3BD,EAAc/+B,WAC5C6+B,EAAsC,OAEVC,GAAkBE,IAA4BH,GAAuCG,GAAsD,WAA3BD,EAAc/+B,UAA2B6+B,GAAuC,CAAC,WAAY,SAASh1B,SAASg1B,EAAoC7+B,WAAay5B,GAAkB8E,KAAiBS,GAA2BjB,GAAyB/4C,EAASu5C,IAG5Y97C,EAASA,EAAO+J,QAAO,SAAAyyC,GAAQ,OAAIA,IAAaV,CAAW,IAG3DM,EAAsCE,EAExCR,EAAcxD,GAAcwD,EAC7B,CAED,OADAG,EAAMj2C,IAAIzD,EAASvC,GACZA,CACT,CAWsEy8C,CAA4Bl6C,EAASyC,KAAK03C,IAAM,GAAG9zC,OAAOyqC,GACxHsJ,EAAiB,GAAA/zC,OAAA4J,EAAOwpC,GAAwB,CAAEzI,IAClDqJ,EAAwBD,EAAkB,GAC1CE,EAAeF,EAAkB1gC,QAAO,SAAC6gC,EAASnC,GACtD,IAAMlvB,EAAOivB,GAAkCn4C,EAASo4C,EAAkBvJ,GAK1E,OAJA0L,EAAQr/B,IAAMte,GAAIssB,EAAKhO,IAAKq/B,EAAQr/B,KACpCq/B,EAAQzwB,MAAQhJ,GAAIoI,EAAKY,MAAOywB,EAAQzwB,OACxCywB,EAAQluB,OAASvL,GAAIoI,EAAKmD,OAAQkuB,EAAQluB,QAC1CkuB,EAAQn/B,KAAOxe,GAAIssB,EAAK9N,KAAMm/B,EAAQn/B,MAC/Bm/B,CACR,GAAEpC,GAAkCn4C,EAASq6C,EAAuBxL,IACrE,MAAO,CACLr0B,MAAO8/B,EAAaxwB,MAAQwwB,EAAal/B,KACzCV,OAAQ4/B,EAAajuB,OAASiuB,EAAap/B,IAC3CxgB,EAAG4/C,EAAal/B,KAChBiO,EAAGixB,EAAap/B,IAEpB,EAgGEw3B,gBAAAA,GACA5C,gBA3BmB,WAAA,IAAA0K,EAAA9lB,EAAAC,IAAAC,MAAG,SAAA6lB,EAAgBzM,GAAI,IAAAlB,EAAAC,EAAA8B,EAAA6L,EAAAC,EAAAhmB,OAAAA,IAAApf,eAAAqlC,iBAAAA,EAAAzlB,KAAAylB,EAAArzC,MAAA,KAAA,EASU,OAPlDulC,EAGEkB,EAHFlB,UACAC,EAEEiB,EAFFjB,SACA8B,EACEb,EADFa,SAEI6L,EAAoBj4C,KAAKiwC,iBAAmBA,GAC5CiI,EAAkBl4C,KAAKo4C,cAAaD,EAAArlB,GAE7B0jB,GAA6B2B,EAAAvlB,GAACyX,EAAS8N,EAAArzC,KAAA,EAAQmzC,EAAkB3N,GAAS,KAAA,EAG/E,OAH+E6N,EAAAplB,GAAAolB,EAAAtlB,KAAAslB,EAAA9I,GAAEjD,EAAQ+L,EAAA7I,IAAA6I,EAAAA,EAAArlB,IAAAqlB,EAAAvlB,GAAAulB,EAAAplB,GAAAolB,EAAA9I,IAAA8I,EAAA5I,GAAA38B,EAAAulC,EAAAzI,GAAA,CAE7Fz3C,EAAG,EACH2uB,EAAG,GAACuxB,EAAArzC,KAAA,GACMozC,EAAgB5N,GAAS6N,KAAAA,GAAA,OAAAA,EAAAxI,GAAAwI,EAAAtlB,KAAAslB,EAAAvI,MAAAuI,EAAA5I,IAAA4I,EAAAzI,GAAAyI,EAAAxI,IAAAwI,EAAA3K,iBAJrCnD,UAAS8N,EAAA7I,GACThF,SAAQ6N,EAAAvI,8BAAAuI,EAAA1K,OAAAuK,GAAAA,EAMXh4C,KAAA,KAAA,OAAA,SAhBoBq4C,GAAA,OAAAN,EAAAxqC,WAAA/K,UAAA,CAAA,CAAA,GA4BnBgS,eAjQF,SAAwBjX,GACtB,OAAOqN,MAAMC,KAAKtN,EAAQiX,iBAC5B,EAgQE4jC,cAjGF,SAAuB76C,GACrB,IAAA+6C,EAGIrE,GAAiB12C,GACrB,MAAO,CACLwa,MAJKugC,EAALvgC,MAKAE,OAJMqgC,EAANrgC,OAMJ,EAyFEi4B,SAAAA,GACAd,UAAAA,GACAhC,MAdF,SAAe7vC,GACb,MAA+C,QAAxCqT,GAAiBrT,GAAS2K,SACnC,GAiGA,SAASqwC,GAAWlO,EAAWC,EAAU7iC,EAAQ/H,QAC/B,IAAZA,IACFA,EAAU,CAAA,GAEZ,IAAA84C,EAMI94C,EAAO+4C,EAAAD,EALTE,eAAAA,OAAiB,IAAHD,GAAOA,EAAAE,EAAAH,EACrBI,eAAAA,OAAiB,IAAHD,GAAOA,EAAAE,EAAAL,EACrBM,cAAAA,OAAgB,IAAHD,EAA6B,mBAAnBE,eAA6BF,EAAAG,EAAAR,EACpDS,YAAAA,OAAc,IAAHD,EAAmC,mBAAzBE,qBAAmCF,EAAAG,EAAAX,EACxDY,eAAAA,OAAiB,IAAHD,GAAQA,EAElBE,EAAchF,GAAchK,GAC5BiP,EAAYZ,GAAkBE,EAAc,GAAAh1C,OAAA4J,EAAQ6rC,EAAc5F,GAAqB4F,GAAe,IAAE7rC,EAAMimC,GAAqBnJ,KAAa,GACtJgP,EAAUzgD,SAAQ,SAAA2+C,GAChBkB,GAAkBlB,EAAS73C,iBAAiB,SAAU8H,EAAQ,CAC5D8xC,SAAS,IAEXX,GAAkBpB,EAAS73C,iBAAiB,SAAU8H,EAC1D,IACE,IAsBI+xC,EAtBEC,EAAYJ,GAAeJ,EApGnC,SAAqB17C,EAASm8C,GAC5B,IACIC,EADAC,EAAK,KAEHh8C,EAAO6xC,GAAmBlyC,GAChC,SAASs8C,IACPC,aAAaH,GACbC,GAAMA,EAAGG,aACTH,EAAK,IACN,CA8DD,OA7DA,SAAShyB,EAAQoyB,EAAMC,QACR,IAATD,IACFA,GAAO,QAES,IAAdC,IACFA,EAAY,GAEdJ,IACA,IAAAK,EAKI38C,EAAQmpB,wBAJV/N,EAAIuhC,EAAJvhC,KACAF,EAAGyhC,EAAHzhC,IACAV,EAAKmiC,EAALniC,MACAE,EAAMiiC,EAANjiC,OAKF,GAHK+hC,GACHN,IAEG3hC,GAAUE,EAAf,CAGA,IAKMvY,EAAU,CACdy6C,YANe79B,GAAM7D,GAIQ,OAHZ6D,GAAM1e,EAAKi4C,aAAel9B,EAAOZ,IAGC,OAFjCuE,GAAM1e,EAAKk4C,cAAgBr9B,EAAMR,IAEuB,OAD1DqE,GAAM3D,GACyE,KAG/FshC,UAAW9/C,GAAI,EAAGkkB,GAAI,EAAG47B,KAAe,GAEtCG,GAAgB,EAoBpB,IACER,EAAK,IAAIV,qBAAqBmB,EAAaznC,EAAAA,EAAA,CAAA,EACtClT,GACX,CAAA,EAAA,CACQ9B,KAAMA,EAAKE,gBAEd,CAAC,MAAO4J,GACPkyC,EAAK,IAAIV,qBAAqBmB,EAAe36C,EAC9C,CACDk6C,EAAGU,QAAQ/8C,EAvCV,CAWD,SAAS88C,EAAcE,GACrB,IAAMC,EAAQD,EAAQ,GAAGE,kBACzB,GAAID,IAAUP,EAAW,CACvB,IAAKG,EACH,OAAOxyB,IAEJ4yB,EAKH5yB,GAAQ,EAAO4yB,GAJfb,EAAYe,YAAW,WACrB9yB,GAAQ,EAAO,KAChB,GAAE,IAIN,CACDwyB,GAAgB,CACjB,CAcF,CACDxyB,EAAQ,GACDiyB,CACT,CA6BiDc,CAAYtB,EAAa5xC,GAAU,KAC9EmzC,GAAkB,EAClBC,EAAiB,KACjB/B,IACF+B,EAAiB,IAAI9B,gBAAe,SAAAxN,GAClC,IAAKuP,EAAL5pB,EAAmBqa,EAAI,GAAR,GACXuP,GAAcA,EAAWj+C,SAAWw8C,GAAewB,IAGrDA,EAAeE,UAAUzQ,GACzB0Q,qBAAqBJ,GACrBA,EAAiB1+C,uBAAsB,WACrC2+C,GAAkBA,EAAeP,QAAQhQ,EACnD,KAEM7iC,GACN,IACQ4xC,IAAgBD,GAClByB,EAAeP,QAAQjB,GAEzBwB,EAAeP,QAAQhQ,IAGzB,IAAI2Q,EAAc7B,EAAiB1yB,GAAsB2jB,GAAa,KAatE,OAZI+O,GAGJ,SAAS8B,IACP,IAAMC,EAAcz0B,GAAsB2jB,IACtC4Q,GAAgBE,EAAYljD,IAAMgjD,EAAYhjD,GAAKkjD,EAAYv0B,IAAMq0B,EAAYr0B,GAAKu0B,EAAYpjC,QAAUkjC,EAAYljC,OAASojC,EAAYljC,SAAWgjC,EAAYhjC,QACtKxQ,IAEFwzC,EAAcE,EACd3B,EAAUt9C,sBAAsBg/C,EACjC,CATCA,GAUFzzC,IACO,WACL6xC,EAAUzgD,SAAQ,SAAA2+C,GAChBkB,GAAkBlB,EAAS53C,oBAAoB,SAAU6H,GACzDmxC,GAAkBpB,EAAS53C,oBAAoB,SAAU6H,EAC/D,IACIgyC,GAAaA,IACboB,GAAkBA,EAAed,aACjCc,EAAiB,KACbzB,GACF4B,qBAAqBxB,EAE3B,CACA,CAeA,IAAM4B,GFiNQ,SAAU17C,GAItB,YAHgB,IAAZA,IACFA,EAAU,CAAA,GAEL,CACLZ,KAAM,QACNY,QAAAA,EACMnH,GAAEA,SAACwe,GAAOkb,OAAAA,EAAAC,IAAAC,MAAAkpB,SAAAA,IAAApjD,IAAAA,EAAA2uB,EAAA4iB,EAAA8R,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAArQ,EAAAhzB,EAAA24B,EAAAD,EAAA4K,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAApqB,OAAAA,IAAApf,MAAAypC,SAAAC,GAAA,cAAAA,EAAA9pB,KAAA8pB,EAAA13C,MAAA,KAAA,EA0Bb,OAxBC7M,EAGE8e,EAHF9e,EACA2uB,EAEE7P,EAFF6P,EACA4iB,EACEzyB,EADFyyB,UAAS8R,EAkBPjS,GAAS3pC,EAASqX,GAAMwkC,EAAAD,EAf1BpK,SAAUsK,WAAaD,GAAOA,EAAAE,EAAAH,EAC9BnK,UAAWuK,OAAc,IAAAD,GAAQA,EAAAE,EAAAL,EACjCM,QAAAA,OAAO,IAAAD,EAAG,CACRpjD,GAAI,SAAAgzC,GAKF,MAAO,CACLtzC,EAFEszC,EAFFtzC,EAKA2uB,EAHE2kB,EADF3kB,EAMH,GACF+0B,EACEE,EAAqBY,EAAAnB,EAAAoB,GAEpBlR,EAAS,CACbvzC,EAAAA,EACA2uB,EAAAA,GACD41B,EAAA13C,KAAA,EACsB+oC,GAAe92B,EAAO8kC,GAAvCrjC,KAAAA,EAuBJgkC,OAvBIhkC,EAAQgkC,EAAA3pB,KACRse,EAAYtH,GAAYN,GAAQC,IAChC0H,EAAWxH,GAAgByH,GAC7B2K,EAAgBtQ,EAAO0F,GACvB6K,EAAiBvQ,EAAO2F,GACxBqK,IAEIQ,EAAuB,MAAb9K,EAAmB,SAAW,QACxC7yB,EAAMy9B,EAAgBtjC,EAFC,MAAb04B,EAAmB,MAAQ,QAGrC/2C,EAAM2hD,EAAgBtjC,EAASwjC,GACrCF,EAAgB1S,GAAM/qB,EAAKy9B,EAAe3hD,IAExCuhD,IAEIM,EAAwB,MAAd7K,EAAoB,SAAW,QACzC9yB,EAAM09B,EAAiBvjC,EAFC,MAAd24B,EAAoB,MAAQ,QAGtCh3C,EAAM4hD,EAAiBvjC,EAASwjC,GACtCD,EAAiB3S,GAAM/qB,EAAK09B,EAAgB5hD,IAExCmiD,EAAgBV,EAAQrjD,GAAEqa,EAAAA,EAC3BmE,CAAAA,EAAAA,GAAKlI,CAAAA,EAAAA,EAAAA,EACPqiC,CAAAA,EAAAA,EAAW4K,GACX3K,EAAY4K,KACbS,EAAAhP,OAAA56B,SAAAA,EAAAA,KAEG0pC,GAAa,CAAA,EAAA,CAChBn9C,KAAM,CACJlH,EAAGqkD,EAAcrkD,EAAIA,EACrB2uB,EAAG01B,EAAc11B,EAAIA,MACtB,KAAA,GAAA,IAAA,MAAA,OAAA41B,EAAA/O,OAAA,GAAA4N,EAAA,IAxDWppB,EA0Df,EAEL,EE5QM9C,GFtMO,SAAUzvB,GAIrB,YAHgB,IAAZA,IACFA,EAAU,CAAA,GAEL,CACLZ,KAAM,OACNY,QAAAA,EACMnH,GAAE,SAACwe,GAAO,OAAAkb,EAAAC,IAAAC,MAAAwqB,SAAAA,IAAAC,IAAAA,EAAAC,EAAArT,EAAAmD,EAAA3C,EAAAsD,EAAAf,EAAAgB,EAAAuP,EAAAC,EAAAvB,EAAAwB,EAAAtB,EAAAuB,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA1S,EAAAiR,EAAAhR,EAAA0S,EAAAtT,EAAAuT,EAAAC,EAAAjlC,EAAAklC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAjsB,OAAAA,IAAApf,MAAAsrC,SAAAC,GAAA,cAAAA,EAAA3rB,KAAA2rB,EAAAv5C,MAGZ0kC,KAAAA,EAoBR,GApBQA,EAMEzyB,EANFyyB,UACAmD,EAKE51B,EALF41B,eACA3C,EAIEjzB,EAJFizB,MACAsD,EAGEv2B,EAHFu2B,iBACAf,EAEEx1B,EAFFw1B,SACAgB,EACEx2B,EADFw2B,SAAQuP,EAUNzT,GAAS3pC,EAASqX,GAAMgmC,EAAAD,EAP1B5L,SAAUsK,OAAa,IAAAuB,GAAOA,EAAAC,EAAAF,EAC9B3L,UAAWuK,OAAiB,IAAHsB,GAAOA,EACZC,EAA2BH,EAA/CU,mBAAkBN,EAAAJ,EAClBK,iBAAAA,OAAgB,IAAAD,EAAG,UAASA,EAAAE,EAAAN,EAC5BO,0BAAAA,OAA4B,IAAHD,EAAG,OAAMA,EAAAE,EAAAR,EAClClS,cAAAA,OAAa,IAAA0S,GAAOA,EACjBzB,EAAqBY,EAAAK,EAAAwB,GAO4B,OAAjD1B,EAAwBjQ,EAAe4R,SAAkB3B,EAAsB4B,gBAAe,CAAAH,EAAAv5C,KAAA,EAAA,KAAA,CAAA,OAAAu5C,EAAA7Q,OAAA,SAC1F,IAEH3C,KAAAA,EACgE,OADhEA,EAAOtB,GAAQC,GACf+T,EAAkBhU,GAAQ+D,KAAsBA,EAAgB+Q,EAAAv5C,KAAA,EACjC,MAAlBynC,EAASa,WAAgB,EAASb,EAASa,MAAMG,EAASjD,UAAS,KAAA,EAM/D,OANjBL,EAAGoU,EAAAxrB,KACH2qB,EAAqBP,IAAgCM,IAAoB3S,EAAgB,CAACL,GAAqB+C,IAAqB9C,GAAsB8C,IAC3J2P,GAA6D,SAA9BI,GAClCG,EAAmB73C,KAAI4H,MAAvBiwC,EAAkBhwC,EAASm9B,GAA0B2C,EAAkB1C,EAAeyS,EAA2BpT,KAE7GwT,EAAcnQ,CAAAA,GAAgB1pC,OAAA4J,EAAKgwC,IAAkBa,EAAAv5C,KACpC,GAAA+oC,GAAe92B,EAAO8kC,GAAvCrjC,KAAAA,GAeZ,GAfYA,EAAQ6lC,EAAAxrB,KACR6qB,EAAY,GACdC,GAAiE,OAA/Cd,EAAuBlQ,EAAexd,WAAgB,EAAS0tB,EAAqBa,YAAc,GACpHlC,GACFkC,EAAU/3C,KAAK6S,EAASqyB,IAEtB6Q,IACIkC,EAAQ7T,GAAkBP,EAAWQ,EAAOC,GAClDyT,EAAU/3C,KAAK6S,EAASolC,EAAM,IAAKplC,EAASolC,EAAM,MAEpDD,EAAa,GAAA/5C,OAAA4J,EAAOmwC,GAAa,CAAE,CACjCnU,UAAAA,EACAkU,UAAAA,KAIGA,EAAU7gB,OAAM,SAAAgO,GAAQ,OAAAA,GAAQ,CAAE,IAAA,CAAAwT,EAAAv5C,KAE/Bi5C,GAAAA,KAAAA,CAEFC,GAFED,IAA+D,OAAhDF,EAAwBlR,EAAexd,WAAgB,EAAS0uB,EAAsB9wC,QAAU,GAAK,IACpHixC,EAAgBP,EAAWM,IAChBM,CAAAA,EAAAv5C,KAAA,GAAA,KAAA,CAAA,OAAAu5C,EAAA7Q,gBAER,CACLruC,KAAM,CACJ4N,MAAOgxC,EACPL,UAAWC,GAEb1Q,MAAO,CACLzD,UAAWwU,KAKzB,KAAA,GAIA,GAFYC,EAAgJ,OAA9HH,EAAwBH,EAAc54C,QAAO,SAAAlG,GAAC,OAAIA,EAAE6+C,UAAU,IAAM,CAAE,IAACxkC,MAAK,SAACjgB,EAAGC,UAAMD,EAAEykD,UAAU,GAAKxkD,EAAEwkD,UAAU,MAAI,SAAc,EAASI,EAAsBtU,UAGvK6U,CAAAA,EAAAv5C,cAAAu5C,EAAAvrB,GACTqqB,EAAgBkB,EAAAv5C,KACjB,YADiBu5C,EAAAvrB,MAUjB,qBATSurB,EAAAvrB,uBAMT,OAHK0W,EAAyM,OAA5L0U,EAAwBP,EAAcrwC,KAAI,SAAAzO,GAAK,MAAA,CAACA,EAAE2qC,UAAW3qC,EAAE6+C,UAAU34C,QAAO,SAAAyT,GAAQ,OAAIA,EAAW,CAAE,IAACvB,QAAO,SAACwnC,EAAKjmC,GAAa,OAAAimC,EAAMjmC,IAAU,GAAG,IAAEU,MAAK,SAACjgB,EAAGC,GAAM,OAAAD,EAAE,GAAKC,EAAE,EAAG,IAAC,SAAc,EAASglD,EAAsB,GACjP1U,IACFyU,EAAiBzU,GAClB6U,EAAA7Q,OAAA,QAAA,IAAA,KAAA,GAI+B,OAAlCyQ,EAAiB3Q,EAAiB+Q,EAAA7Q,8BAIpChE,IAAcyU,EAAcI,CAAAA,EAAAv5C,KAAA,GAAA,KAAA,CAAA,OAAAu5C,EAAA7Q,OACvB,SAAA,CACLP,MAAO,CACLzD,UAAWyU,oBAEdI,EAAA7Q,OAGE,SAAA,IAAE6Q,KAAAA,GAAAA,IAAAA,MAAAA,OAAAA,EAAA5Q,UAAAkP,EAAA,IAjGK1qB,EAkGf,EAEL,EEmIM8Z,GAAkB,SAAC1B,EAAWC,EAAU5qC,GAI5C,IAAMu3C,EAAQ,IAAI/zC,IACZw7C,EAAa9rC,EACjB25B,CAAAA,SAAAA,IACG7sC,GAECi/C,EAAiB/rC,EAAAA,EAAA,CAAA,EAClB8rC,EAAcnS,UAAQ,CAAA,EAAA,CACzBmL,GAAIT,IAEN,OAAO2H,GAAkBvU,EAAWC,EAAQ13B,EAAAA,EACvC8rC,CAAAA,EAAAA,GACHnS,CAAAA,EAAAA,CAAAA,SAAUoS,IAEd,ECppBe,SAAS55C,GAAM85C,GAC1B,IAAAC,EAAWD,EAAXC,YACAC,EAAUF,EAAVE,WACA/a,EAAK6a,EAAL7a,MACAgb,EAAQH,EAARG,SACAzjD,EAAKsjD,EAALtjD,MACA0jD,EAAMJ,EAANI,OACA/a,EAAO2a,EAAP3a,QACAgb,EAAmBL,EAAnBK,oBACAC,EAAUN,EAAVM,WACAC,EAA2BP,EAA3BO,4BACAC,EAAkBR,EAAlBQ,mBACA9zB,EAAKszB,EAALtzB,MAEA,GAAIyY,GAAS8a,EAAa,OAAO9a,EACjC,IAAKA,EAAO,MAAO,GAEfA,GAASA,EAAM5pC,OAAS,GAAyB,WAApBjB,EAAO6qC,EAAM,MAC1CA,EAAQob,EAA4Bpb,IAGxC,IAAIsb,EAAgBtb,EAAMj/B,QAAO,SAACqoB,GAC9B,IAAImyB,EAAgBJ,EAAW/xB,EAAK7B,GAAQwzB,EAAY3xB,GAOxD,OANImyB,GAAiBP,GAAjBO,MAA6BhkD,GAAAA,EAAOnB,SACpCmlD,GAAiBhkD,EAAMy4B,MAAK,SAAC/7B,GACzB,QAAOinD,GAAsBjnD,EAAEgnD,KAAY7xB,EAAK6xB,EAChE,KAGeM,CACf,IAMI,OAJIrb,IACAob,EAAgBD,EAAmBC,IAGhCA,CACX,CAAA,SCrC8BE,GAAQC,GAAA,OAAAC,GAAAnyC,MAAA/K,KAAAA,yBAwBtCk9C,sBAxBe,SAAAC,EAAAC,GAAA,IAAA33C,EAAA62C,EAAAM,EAAAL,EAAAc,EAAA3tB,OAAAA,IAAApf,MAAAgtC,SAAAC,GAAAA,cAAAA,EAAArtB,KAAAqtB,EAAAj7C,MAAA,KAAA,EACK,OADqBmD,EAAQ23C,EAAR33C,SAAU62C,EAAWc,EAAXd,YAAaM,EAA2BQ,EAA3BR,4BAA6BL,EAAUa,EAAVb,WAAUgB,EAAAj7C,KACnF,EAAAg6C,EAAYC,GAAiB,OAAC,SAACriC,GAC3CvM,QAAQ2gB,KAAK,uCAAwCpU,GACrDzU,EAAS,QAAS,CAAE5F,KAAM,cAAe29C,QAAStjC,GAC1D,IAAM,KAAA,EAEEmjC,KALAA,EAAGE,EAAAltB,OAKKgtB,EAAII,UAASF,CAAAA,EAAAj7C,KACrB,EAAA,KAAA,CAQC,OARG+6C,GACIA,GAAOA,EAAIzlD,OAAS,GAAuB,WAAlBjB,EAAO0mD,EAAI,MACpCA,EAAMT,EAA4BS,IAGtC53C,EAAS,SAAU,CAAE+7B,MAAO6b,KAE5BA,EAAM,GACTE,EAAAvS,OAAA,SAEM,CACH0S,cAAeL,EACfM,SAAS,EACTC,SAAS,EACTC,UAAU,IACbN,KAAAA,EAAAA,IAAAA,MAAAA,OAAAA,EAAAtS,OAAA,GAAAkS,EAAA,KAETD,GAAAnyC,MAAAvN,KAAAwC,UAAA,8wBCxBApE,GAaKvB,EAAAsxB,EAAA9vB,GAPDzB,GAMuDuxB,EAAAhQ,+yBCZ3D/f,GAaKvB,EAAAsxB,EAAA9vB,GALDzB,GAICuxB,EAAAhQ,25BCZL/f,GAUKvB,EAAAsxB,EAAA9vB,GATDzB,GAQ4BuxB,EAAAmyB,spXC8vBsB/mD,EAAK,qMAlBGA,EAAI,WAASA,EAAC,qTAxChBA,EAAC,4LAtB5CgnD,EAAAhnD,MAAQ,iBAAcinD,GAAAjnD,qCACtB,OAAAA,MAAQ8R,KAAI,EACP9R,EAAa,IAACa,OAAS,EAAC,EA0BvBb,EAAc,qCAKpB,IAAAknD,EAAAlnD,MAAQ,gBAAamnD,GAAAnnD,yLA1C9B6E,GA2CKvB,EAAAisB,EAAAzqB,8HAtCU9E,EAAgB,6FAItBA,MAAQ,gSAiCRA,MAAQ,4yBAHL6E,GAAkCvB,EAAAisB,EAAAzqB,sTA3B/B9E,EAAa,kBAAlBa,OAAIC,GAAA,8SAACd,EAAa,aAAlBa,OAAIC,GAAA,EAAA,oHAAJD,OAAIC,EAAAgwB,EAAAjwB,OAAAC,GAAA,mDAAJD,OAAIC,GAAA,mhBAoBW2sC,WAAA2Z,EAAApnD,2BAAAonD,EAAOpnD,EAAK,MAAA,iFAAZ,SAAAM,EAAA,IAAAmtC,KAAAA,WAAA4Z,EAAArnD,cAAAqnD,WAAAA,EAAAA,EAAOrnD,EAAK,MAAA,KAAA4H,GAAAwC,EAAAqjC,mPAPO/kC,GAAAgP,EAAA,mBAAA1X,OAAKsnD,aACf5+C,GAAAgP,EAAA,SAAA1X,EAAa,IAAAA,EAAM,KAAAA,KAAOA,EAAM,MACjC0I,GAAAgP,EAAA,QA3FZ,IA2FwB1X,EAAC,MACb0I,GAAAgP,EAAA,QAAA1X,OAAmBA,EAAC,MACf0I,GAAAgP,EAAA,aAAA1X,OAAKunD,kCACoB,KAAjB,QAAJC,EAAAxnD,EAAI,YAAA,IAAAwnD,OAAA,EAAJA,EAAMC,gHAjBpC5iD,GAsBKvB,EAAAuU,EAAA/S,GAdDzB,GAaKwU,EAAAH,8DAZmBglC,OAAQ18C,EAAY,IAACA,EAAM,KAAAA,KAAOA,EAAM,KAAG0nD,QAAA1nD,EAAO,+BACnD08C,OAAQ18C,EAAiB,MAAKA,EAAC,KAAE0nD,QAAA1nD,EAAO,wUADvC08C,OAAQ18C,EAAY,IAACA,EAAM,KAAAA,KAAOA,EAAM,KAAG0nD,QAAA1nD,EAAO,4DACnD08C,OAAQ18C,EAAiB,MAAKA,EAAC,KAAE0nD,QAAA1nD,EAAO,2BAEnC0I,GAAAgP,EAAA,mBAAA1X,OAAKsnD,6CACf5+C,GAAAgP,EAAA,SAAA1X,EAAa,IAAAA,EAAM,KAAAA,KAAOA,EAAM,sBAEjC0I,GAAAgP,EAAA,QAAA1X,OAAmBA,EAAC,2BACf0I,GAAAgP,EAAA,aAAA1X,OAAKunD,sDACoB,KAAjB,QAAJI,EAAA3nD,EAAI,YAAA,IAAA2nD,OAAA,EAAJA,EAAMF,+eAkBjBznD,EAAa,8BAEnCA,EAAW,wIAFhB6E,GAA+CvB,EAAAskD,EAAA9iD,qBAC/CD,GAEMvB,EAAAukD,EAAA/iD,yCAHqB9E,EAAa,kBAEnCA,EAAW,8GAWXA,EAAQ,GAAA,wbA6BA,MAAAytC,EAAAztC,KAAMA,EAAK,KAAA,2EAAX,KAAAM,EAAA,IAAAmtC,KAAAA,EAAAztC,KAAMA,EAAK,KAAA,KAAA4H,GAAAwC,EAAAqjC,gJAFiCztC,EAAgB,sBAArE6E,GAIKvB,EAAAisB,EAAAzqB,wNAJgD9E,EAAgB,sIA1B9DA,EAAK,iBAAVa,OAAIC,GAAA,ySAACd,EAAK,YAAVa,OAAIC,GAAA,EAAA,oHAAJD,OAAIC,EAAAgwB,EAAAjwB,OAAAC,GAAA,mDAAJD,OAAIC,GAAA,mjBAeM+D,GAMKvB,EAAAisB,EAAAzqB,iWAXA,MAAA2oC,EAAAztC,OAAKA,EAAK,KAAA,2EAAV,KAAAM,EAAA,IAAAmtC,KAAAA,EAAAztC,OAAKA,EAAK,KAAA,KAAA4H,GAAAwC,EAAAqjC,oCAIbztC,EAAQ,MAAKA,EAAsB,KAAI8nD,IAASC,GAAA/nD,6NAXxC0I,GAAA6mB,EAAA,SAAAvvB,QAAgBA,EAAC,8CAFnC6E,GAsBKvB,EAAAisB,EAAAzqB,GAfDzB,GAIMksB,EAAAie,kRAEAxtC,EAAQ,KAAKA,EAAsB,MAAI8nD,uIAX/Bp/C,GAAA6mB,EAAA,SAAAvvB,QAAgBA,EAAC,+kBA8C3C6E,GAIKvB,EAAAisB,EAAAzqB,0nBAILD,GAIQvB,EAAA2V,EAAAnU,0CAJkD9E,EAAW,knBAQrE6E,GAIKvB,EAAAisB,EAAAzqB,+aAULD,GAAoEvB,EAAA8E,EAAAtD,8VA9IvE9E,EAAQ,IAAAgoD,GAAAhoD,KAgDJA,EAAO,IAAAioD,GAAAjoD,wCAaPA,EAAQ,KAAAkoD,GAAAloD,mBAwCEA,EAAU,KACjBA,EAAgB,iBAGPA,EAAe,YACrBA,EAAW,mEAKjBA,EAAO,IAAAmoD,GAAAnoD,KAQPA,EAAS,KAAAooD,GAAApoD,KAQTA,EAAW,KAAAyX,GAAAzX,yJAUmBA,EAAK,GAAGioB,KAAKtE,UAAU3jB,EAAK,IAAI,oDAAnE6E,GAA0EvB,EAAA+kD,EAAAvjD,+DAAvC9E,EAAK,GAAGioB,KAAKtE,UAAU3jB,EAAK,IAAI,iDAGlEsoD,EAAAtoD,SAAcA,EAAK,IAAqB,IAAjBA,EAAM,GAAAa,SAAYsY,GAAAnZ,sjBAxJxBA,EAAgB,IAAA,+BAO/BA,EAAe,sCANTA,EAAQ,iEAGJA,EAAQ,wBACLA,EAAW,kBAClBA,EAAQ,sBAPzB6E,GA8JKvB,EAAAgV,EAAAxT,0BAlGDzB,GAOMiV,EAAAk1B,0BAENnqC,GAEKiV,EAAAZ,0BAELrU,GAgDKiV,EAAAT,0BAXDxU,GAUgBwU,EAAAwwC,wCAHAroD,EAAU,YAM9BqD,GAwBKiV,EAAAH,qJArJgBnY,EAAkB,yBAAcA,EAAa,oBAiH9CA,EAAa,iBAChBA,EAAU,kBACTA,EAAW,6CAxGAA,EAAW,qDAInCA,EAAQ,gHAgDJA,EAAO,yIAaPA,EAAQ,8JAwCEA,EAAU,OAAA,CAAAm4B,SAAAowB,mBACjBvoD,EAAgB,+BAGPA,EAAe,+BACrBA,EAAW,6DAFNA,EAAU,SAAVA,EAAU,6BAOrBA,EAAO,gHAQPA,EAAS,gHAQTA,EAAW,gQAafA,OAAcA,EAAK,IAAqB,IAAjBA,EAAM,GAAAa,qKAxJZb,EAAgB,IAAA,mEAO/BA,EAAe,sCANTA,EAAQ,6HAGJA,EAAQ,4CACLA,EAAW,sCAClBA,EAAQ,0SA7iBZ,SAAA6lD,GAA4B2C,GAC1B,OAAAA,EAAOz0C,KAAK,SAAA8f,EAAMrgB,GAEjB,MAAA,CAAAA,MAAAA,EACAxR,MAAO6xB,EACP7B,MAAK3nB,GAAAA,OAAKwpB,gDAhElB40B,EAkBAC,EACAC,EACAC,EACAC,EAcAC,ExD3EqB9pD,8CNkOtB,SAAuB+pD,GAC7B,IAAMtnD,EAAS,CAAA,EACf,IAAK,IAAM8F,KAAOwhD,EACjBtnD,EAAO8F,IAAO,EAEf,OAAO9F,CACR,K8D1PUiN,EAAWnC,KASNy8C,EAAgBxuC,EAAhByuC,UAAAA,OAAS,IAAAD,EAAG,KAAIA,EAEhBE,EAAgB1uC,SAAhBhP,OAAS29C,IAAHD,EAAGC,GAAOD,EAChBE,EAAoB5uC,WAApByrC,OAAWE,IAAHiD,EAAGjD,GAASiD,EAEpBC,EAAS7uC,EAATvW,GAAAA,OAAE,IAAAolD,EAAG,KAAIA,EACTC,EAAW9uC,EAAXjV,KAAAA,OAAO,IAAH+jD,EAAG,KAAIA,EACXC,EAAqB/uC,EAArB+Q,UAAAA,OAAS,IAAAg+B,OAAG/oD,EAAS+oD,EACrBC,EAAiBhvC,EAAjB1S,MAAAA,WAAK0hD,OAAGhpD,EAASgpD,EACjBC,EAAgBjvC,EAAhBirC,SAAAA,OAAQ,IAAAgE,GAAQA,EAChBC,EAA8BlvC,EAA9BmvC,uBAAAA,OAAsB,IAAAD,GAAQA,EAC9BE,EAAgBpvC,EAAhBI,SAAAA,WAAQgvC,GAAQA,EAChBC,EAAervC,EAAfqsC,QAAAA,OAAO,IAAAgD,GAAQA,EACfC,EAAYtvC,EAAZxY,MAAAA,QAAK,IAAA8nD,EAAG,KAAIA,EACZC,GAAevvC,EAAfgrC,WAAAA,YAAUuE,GAAG,GAAEA,GACfC,GAA6BxvC,EAA7ByvC,YAAAA,QAAW,IAAAD,GAAG,gBAAeA,GAC7BE,GAA6B1vC,EAA7B2vC,sBAAAA,QAAqB,IAAAD,IAAQA,GAC7BE,GAAY5vC,EAAZiwB,MAAAA,YAAK2f,GAAG,KAAIA,GACZC,GAAe7vC,EAAfwX,MAAAA,QAAK,IAAAq4B,GAAG,QAAOA,GACfC,GAAoG9vC,EAApGorC,WAAAA,YAAU0E,GAAI,SAAAt4B,EAAOwzB,EAAYl9C,GAAM,MAAA,GAAA+B,OAAQ2nB,GAAQpU,cAAciL,SAAS28B,EAAW5nC,gBAAW0sC,GACpGC,GAAmB/vC,EAAnBmwB,QAAAA,QAAO,IAAA4f,QAAG/pD,EAAS+pD,MACa/vC,EAAhCgwC,YAAAA,YAAWC,GAAI,SAAAC,UAAWA,GAAMD,GAChCE,GAA6BnwC,EAA7BowC,sBAAAA,QAAqB,IAAAD,IAAQA,GAC7BE,GAAgBrwC,EAAhBkrC,OAAAA,QAAS,IAAHmF,GAAG,QAAOA,GAChBC,GAAuBtwC,EAAvB+qC,YAAAA,QAAW,IAAAuF,QAAGtqD,EAASsqD,GACvBC,GAAoBvwC,EAApBwwC,gBAAAA,QAAkB,IAAHD,GAAG,GAAEA,GACpBE,GAAgBzwC,EAAhB0wC,SAAAA,QAAW,IAAHD,IAAQA,GAChBE,GAA0B3wC,EAA1BmrC,oBAAAA,QAAmB,IAAAwF,IAAOA,GAC1BC,GAAgB5wC,EAAhB6wC,SAAAA,QAAW,IAAHD,IAAQA,GAChBE,GAAwB9wC,EAAxB+wC,kBAAAA,QAAiB,IAAAD,IAAOA,GACxBE,GAA4BhxC,EAA5BixC,sBAAAA,YAAqBD,IAAOA,QAE5BE,sBAAAA,QAAqB,IAAAC,GAAA,SAAIC,EAAY/3B,GAExC,OAAAve,EAAA,CAAAtT,MAAO4pD,GACN55B,GAAQ45B,OAQNC,GAAiBrxC,EAAjBsxC,WAAAA,QAAU,IAAAD,IAAOA,GACjBE,GAAgBvxC,EAAhBwxC,YAAAA,QAAW,IAAAD,GAAG,GAAEA,GAChBE,GAAgBzxC,EAAhB0xC,UAAAA,QAAY,IAAHD,IAAOA,GAChBE,GAAe3xC,EAAfosC,QAAAA,QAAO,IAAAuF,IAAQA,GACfC,GAAgB5xC,EAAhBssC,SAAAA,QAAQ,IAAAsF,IAAQA,GAGhBC,KAAAC,SAAAA,QAAQ,IAAAD,GAAI,SAAArtD,OAAIutD,EAAItjD,UAAApI,OAAA,QAAAL,IAAAyI,UAAAzI,GAAAyI,UAAA,GAAG,EAC9Bs3C,aAAakI,GACbA,EAAUtH,WAAWniD,EAAIutD,OAGlBC,GAAkBhyC,EAAlBiyC,aAAAA,YAAYD,GAAG,IAAGA,GAClBE,GAAsBlyC,EAAtBmyC,eAAAA,QAAiB,IAAHD,IAAQA,MACPlyC,EAAfoyC,gBAAAA,QAAe,IAAAC,GAAA,GAAAA,GACfC,GAAoBtyC,EAApBuyC,cAAAA,QAAgB,IAAHD,IAAOA,GACpBE,GAAmBxyC,EAAnByyC,YAAAA,YAAWD,IAAQA,GACnBE,GAAc1yC,EAAd2yC,WAAAA,QAAa,IAAHD,GAAG,EAACA,GACdE,GAAkB5yC,EAAlB6yC,eAAAA,QAAc,IAAAD,GAAG,EAACA,MACJ5yC,EAAd8yC,eAAAA,YAAcC,GAAA,GAAAA,GAIrBC,GAAqBhzC,EAAA,MAArBizC,YAAgBD,GAAG,GAAEA,GAoDhB,SAAA1H,GAAmB0C,OAClBkF,EAAW,GACXhD,EAAM,CAAA,EAEZlC,EAAOlpD,SAAS,SAAAu0B,OACN+3B,EAAajhB,GAAQ9W,GAEtB65B,EAAY7kC,SAAS+iC,KACtB8B,EAAYthD,KAAKw/C,GACjBlB,EAAOkB,GAAU,GAEbA,GACAlB,EAAOkB,GAAYx/C,KACflN,OAAOP,OAAO+sD,GAAsBE,EAAY/3B,GAAI,CAChD5vB,GAAI2nD,EACJtE,aAAa,EACbG,WAAYmD,OAM5BF,EAAOkB,GAAYx/C,KAAKlN,OAAOP,OAAS,CAAA4oD,YAAaqE,GAAc/3B,WAGjE85B,EAAkB,UAExBnD,GAAYkD,GAAapuD,SAAS,SAAAssD,GAC1BlB,EAAOkB,IAAa+B,EAAmBvhD,KAAI4H,MAAvB25C,EAAkB15C,EAASy2C,EAAOkB,QAGvD+B,EAwDF,SAAAC,SAAqBC,EAAa5kD,UAAApI,OAAAoI,QAAAzI,IAAAyI,aAAAA,UAAG,GAAA,EAAG6kD,EAAW7kD,UAAApI,OAAA,EAAAoI,UAAAzI,QAAAA,EACxD+d,EAAA,EAAA8uC,GAAiBQ,EAAgB,EAAI,EAAIA,IACpCC,GAAenjB,IAAWgc,EAAc0G,MAAoB1G,EAAc0G,IAAgB5F,YAC3FsG,GAAc,YA6FbC,KACD,IAAAC,GAAe,KACfjsD,GAAK,KACCuyB,EAAG,GACH25B,EAAY,GAElBlsD,GAAM1C,SAAS,SAAA6uD,GACN55B,EAAI1L,SAASslC,EAAIzI,KAIlBuI,GAAe,GAHf15B,EAAInoB,KAAK+hD,EAAIzI,KACbwI,EAAa9hD,KAAK+hD,OAMrBF,GAAY1vC,EAAA,EAAEvc,GAAQksD,UAExBD,EAGF,SAAAG,GAASpjC,OACVqjC,EAAUrjC,EAAYA,EAAU06B,IAAU1jD,GAAM0jD,WAC7Cjb,GAAM6jB,MAAM,SAAAz6B,GAAS,OAAAA,EAAK6xB,MAAY2I,CAAO,aAczCE,GAAoBC,UAAAC,GAAAz6C,MAAA/K,KAAAA,UAAAwlD,CAAAA,SAAAA,YAAAA,GAAA/1B,EAAAC,IAAAC,MAApB,SAAA81B,EAAqB5tD,GAAC6tD,IAAAA,SAAAh2B,IAAApf,MAAAq1C,SAAAC,GAAA,cAAAA,EAAA11B,KAAA01B,EAAAtjD,MAC3BojD,KAAAA,EAAAA,EAAe3sD,GAAMlB,GAEN,IAAjBkB,GAAMnB,OACN0d,EAAA,EAAAvc,QAAQxB,GAER+d,EAAA,EAAAvc,GAAQA,GAAMwJ,QAAQ,SAAAqoB,GACX,OAAAA,IAAS86B,MAIxBjgD,EAAS,QAASigD,GAAY,wBAAAE,EAAA3a,OAAAwa,GAAAA,8BA4FzB,SAAAI,GAAY3gD,GAAC4gD,IAAAA,EAAAC,EACdnI,GAAW/+C,aAAKinD,EAAK3qD,gBAAQ,IAAA2qD,OAAA,EAARA,EAAUnvC,iBAC/BzR,GAAGO,EAAS,QAASP,GACpB,QAAL6gD,EAAAlnD,SAAAknD,IAAKA,GAALA,EAAOlvC,QACPvB,EAAA,EAAAsoC,GAAU,aAGCoI,GAAUC,GAAAC,OAAAA,GAAAn7C,MAAAvN,KAAAwC,UAAAkmD,CAAAA,SAAAA,YAAAA,GAAAz2B,EAAAC,IAAAC,MAAV,SAAAw2B,EAAWjhD,GAACkhD,IAAAA,SAAA12B,IAAApf,MAAA,SAAA+1C,GAAA,cAAAA,EAAAn2B,KAAAm2B,EAAA/jD,MAAA,KAAA,EAAA,IACnBgkD,GAAWD,CAAAA,EAAA/jD,KAAA,EAAA,KAAA,CAAA,OAAA+jD,EAAArb,yBACX6S,IAAYD,KACZn4C,EAAS,OAAQP,GACjBqhD,KACAjxC,EAAA,EAAAsoC,GAAU,GACVtoC,EAAA,GAAAmqC,OAAcloD,GACT6uD,QAALA,EAAAvnD,aAAKunD,GAALA,EAAOI,mFAuCND,KACD/D,IACAltC,EAAA,EAAAinC,GAAa,IAEjBjnC,EAAA,EAAAuoC,IAAW,GxDxeU9nD,EwDyRb05B,EAAAC,IAAAC,MAAA,SAAA82B,IAAA,OAAA/2B,IAAApf,eAAAo2C,iBAAAA,EAAAx2B,KAAAw2B,EAAApkD,aACRgT,EAAA,GAAAoqC,EAAa3mD,IACbuc,EAAA,GAAAqqC,EAAkBpD,IAClBjnC,EAAA,GAAAsqC,EAAgBpD,GAAQ,KAAA,EAAA,IAAA,MAAA,OAAAkK,EAAAzb,OAAAwb,GAAAA,OxD3R/B3jD,KAAwBG,GAAGsC,cAAcpC,KAAKpN,GwD6c3CiN,IAAO,WACC66C,IAAQvoC,EAAA,EAAEsoC,GAAU,GACpBA,GAAW/+C,GAAOA,EAAMgY,WA2BrB,IAAA8vC,KAAAC,WAAAA,QAAc,IAAJD,GAAI,SAAAtqC,0BACJA,EAAM,wBAGhBwqC,aAAAA,QAAY,IAAAC,GAAA,SAAI/9B,EAAOxM,GACgB,MAAA,uCAAAnb,OAAA2nB,kBAAK3nB,OAAemb,kCAG3DwqC,YAAAA,QAAW,IAAAC,GAAA,4FA2BlB,IAEAC,GAFAp+C,GAAO,cAGFq+C,KACL5P,aAAa2P,IACbA,GAAmB/O,uBACfoO,IAAc,IACf,KASPljD,IAAS,eAAA+jD,EACD,QAAJA,EAAAt+C,UAAAs+C,IAAIA,GAAJA,EAAMC,YAGN,IAAAd,IAAc,EAET,SAAAe,GAAaz8B,GACbA,IAA4B,IAApBA,EAAK4zB,YAlFb,SAAaz8B,MACdA,EAAS,CACTzM,EAAA,EAAAinC,GAAa,IACP,IAAA3xB,EAAO30B,OAAOP,UAAWqsB,GAE3B,GAAA6I,EAAKyzB,cAAgBzzB,EAAK4zB,WAAU,OACxClpC,EAAA,EAAAvc,GAAQyjD,EAAYzjD,GAAQA,GAAMqI,OAAQ,CAAAwpB,KAAUA,GAAUtV,EAAA,EAAAvc,GAAQ6xB,IAEtEstB,YAAU,WACFoK,IAAmBiE,KACvBjxC,EAAA,GAAAmqC,OAAcloD,GACdkO,EAAS,SAAU1M,IACnB0M,EAAS,SAAUsc,OAuE3BulC,CAAa18B,GAGR,SAAA28B,GAAY1vD,GACbyuD,IACJhxC,EAAA,EAAA8uC,GAAiBvsD,GAGZ,SAAA2vD,GAAgB/5C,OACbmd,EAAYnd,EAAZmd,KAAM/yB,EAAM4V,EAAN5V,MACW,KAArB+yB,aAAAA,EAAAA,EAAM4zB,mBACNzlD,KAAUyjD,GAAYzjD,GAAM0jD,MAAY7xB,EAAK6xB,IAAgB8J,UAyC5D,SAAiB37B,GACd,OAAAA,EAAKyzB,aAAezzB,EAAK4zB,YAAe5zB,EAAK4zB,aAAe5zB,EAAK0R,eAAe,cAzCpFmrB,CAAiB78B,KACjBtV,EAAA,EAAA8uC,GAAiBvsD,GACjBwvD,GAAaz8B,KAIZ,SAAAk6B,GAAc4C,MAKoB,IAJThK,EAAcn7C,QACvC,SAAAqoB,UAAU30B,OAAO0xD,OAAO/8B,EAAM,gBAAqC,IAApBA,EAAK4zB,cAG7B5mD,OAChB,OAAA0d,EAAA,EAAA8uC,GAAiB,GAGzBsD,EAAY,GAAKtD,KAAmB1G,EAAc9lD,OAAS,EAC3D0d,EAAA,EAAA8uC,GAAiB,GAEjB9uC,EAAA,EADOoyC,EAAY,GAAwB,IAAnBtD,GACxBA,GAAiB1G,EAAc9lD,OAAS,EAExCwsD,IAAkCsD,OAGhCE,EAAQlK,EAAc0G,IAExBwD,IAA8B,IAArBA,EAAMpJ,aACG,IAAdkJ,IAAkC,IAAfA,GAAkB5C,GAAc4C,IAkBzD,IAAAG,GAAeC,GACfC,GAAcD,GAEX,SAAAA,GAAaxtD,UAEd2K,OAAM,SAACwI,GACCA,EAAKgmC,SACLyT,KACA5sD,EAAK0tD,eAAiB,CAAA5xC,SAAU,OAAQjQ,MAAO,mBRgI1CjJ,GQrHjB+qD,GAAe,CACfre,SAAU,WACV5C,UAAW,eACX8C,aRkHiB5sC,GQlHGgnD,QRmHV,IAAZhnD,KACFA,GAAU,GAEL,CACLZ,KAAM,SACNY,QAAAA,GACMnH,GAAEA,SAACwe,GAAO,OAAAkb,EAAAC,IAAAC,MAAAu4B,SAAAA,QAAAC,EAAA/N,EAAA3kD,EAAA2uB,EAAA4iB,EAAAmD,EAAAie,EAAA14B,OAAAA,IAAApf,MAAA,SAAA+3C,iBAAAA,EAAAn4B,KAAAm4B,EAAA/lD,aAME,OAHd7M,EAIE8e,EAJF9e,EACA2uB,EAGE7P,EAHF6P,EACA4iB,EAEEzyB,EAFFyyB,UACAmD,EACE51B,EADF41B,eAAcke,EAAA/lD,KAAA,EAES2rC,GAAqB15B,EAAOrX,IAAQ,KAAA,KAAvDkrD,EAAUC,EAAAh4B,KAIZ2W,KAAkE,OAAlDmhB,EAAwBhe,EAAe3tB,aAAkB,EAAS2rC,EAAsBnhB,YAAgE,OAAjDoT,EAAwBjQ,EAAe4R,SAAkB3B,EAAsB4B,gBAAeqM,CAAAA,EAAA/lD,KAAA,EAAA,KAAA,CAAA,OAAA+lD,EAAArd,OAChN,SAAA,IAAEqd,KAAAA,EAAAA,OAAAA,EAAArd,OAAA,SAEJ,CACLv1C,EAAGA,EAAI2yD,EAAW3yD,EAClB2uB,EAAGA,EAAIgkC,EAAWhkC,EAClBznB,KAAIyT,EAAAA,EAAA,CAAA,EACCg4C,GACHphB,CAAAA,EAAAA,CAAAA,UAAAA,MAEHqhB,KAAAA,EAAAA,IAAAA,MAAAA,OAAAA,EAAApd,UAAAid,EAAA,IAtBaz4B,EAuBf,IQhJoC9C,KAAQisB,MACzC7C,YAAY,GAGTuS,GC1oBJ,SAA+BC,GAClC,IAAIC,EACAC,EACEC,EAAiB,CACnB3S,YAAY,GAEZ74C,EAAUqrD,EACRI,EAAa,SAACC,GAChB,OAAAx4C,EAAAA,EAAAA,EAAYs4C,CAAAA,EAAAA,GAAoBH,GAAe,CAAA,GAASK,GAAS,CAAA,EACzE,EACUC,EAAiB,SAACC,GAChBN,GAAoBC,IACpBvrD,EAAUyrD,EAAWG,GACrBvf,GAAgBif,EAAkBC,EAAiBvrD,GAC9CsH,MAAK,SAAAsJ,GAAK,IAAAi7C,EACX9yD,OAAOP,OAAO+yD,EAAgB3tD,MAAO,CACjCib,SAAUjI,EAAE87B,SACZzzB,KAAI/U,GAAAA,OAAK0M,EAAErY,EAAC,MACZwgB,IAAG7U,GAAAA,OAAK0M,EAAEsW,EAC9B,SACuB,QAAP2kC,EAAA7rD,SAAO,IAAA6rD,OAAA,EAAPA,EAASC,aAAc9rD,EAAQ8rD,WAAWl7C,EAC1D,IAEA,EA2CUm7C,EAA8B,SAAC3uD,GAYjC8I,GAXoB9I,EAAK4uD,WAAU,SAACC,QACP5xD,IAArBixD,GACAA,EAAmBW,EACnBN,MAIA5yD,OAAOP,OAAO8yD,EAAkBW,GAChCN,IAEhB,IAEA,EACI,MAAO,CAxDiB,SAAAvuD,GACpB,GAAI,cAAeA,EAEf,OADA2uD,EAA4B3uD,GACrB,GAGPkuD,EAAmBluD,EACnBuuD,GAEZ,EAC0B,SAACvuD,EAAM8uD,GACzB,IAAIC,EACJZ,EAAkBnuD,EAClB4C,EAAUyrD,EAAWS,GACrBlR,YAAW,WAAA,OAAM2Q,EAAeO,EAAe,GAAE,GACjDP,EAAeO,GACf,IAAME,EAAoB,WAClBD,IACAA,IACAA,OAAoB9xD,EAEpC,EACcgyD,EAAiB,WAAoCC,IAAjCzT,GAAiC/1C,UAAApI,OAAA,QAAAL,IAAAyI,UAAA,GAAAA,aAAlB9C,GAAW,CAAA,GAA5B64C,WACpBuT,KACmB,IAAfvT,GACArxC,KAAOF,MAAK,WACR,OAAOilD,GAAYjB,EAAkBC,GAAiB,WAAA,OAAMI,EAAe3rD,EAAW64C,IAAe,IAAfA,EAAsB,CAAE,EAAGA,EACrI,GAGA,EAEQ,OADAsT,EAAoBE,IACb,CACHtkD,OAAMA,SAACmkD,GACHP,EAAeO,GACfC,EAAoBE,EAAeH,EACtC,EACDlwD,QAAOA,WACHowD,GACH,EAEb,EAkBQT,EAER,CDqjB2Da,CAAsBzB,IAAe0B,GAAAj7B,EAAA45B,GAArFsB,GAAAA,GAAWD,GAAA,GAAEE,GAAeF,GAAEG,GAAAA,GAAcH,GAAA,GAM/CI,IAAW,qgEA9bN,MAwTDxqD,IAqHIgW,0CAjcGxc,eA5GA,GAAU,iBAAVA,GAAkB,KACrB6xB,GAAQ4W,IAAK,IAAQ6jB,MAAM,SAAAz6B,GAAS,OAAAA,EAAK6xB,MAAY1jD,EAAK,QAC9DA,GAAQ6xB,GAAIve,EAAAA,KACPowC,GAAS1jD,IACHA,QAAAA,UAEJyjD,GAAYp0C,MAAMoS,QAAQzhB,KAAUA,GAAMnB,OAAS,OAC1DmB,GAAQA,GAAM+R,KAAK,SAAA8f,GAAI,MAAsB,iBAATA,EAAsB,CAAA7xB,MAAO6xB,EAAM7B,MAAO6B,GAASA,CAAI,KAqG5Eo/B,6CAChBrG,IAAoBd,UAhGvBhD,EAAmB5pD,OAAOP,QAElBu0D,eAAgB,OAChBC,aAAc,MACdC,YAAa,MACbC,YAAY,EACZC,SAAU,EACVxqD,KAAM,OACN,oBAAqB,QAEzB8jD,KAGA3oD,QACA6kD,EAAqB,GAAI7kD,EAAE6kD,GAG1BgD,SACDhD,EAA2B,UAAI,EAAIA,wBA+EpCrD,GAfCzjD,KACIqP,MAAMoS,QAAQzhB,IACduc,EAAA,EAAAvc,GAAKiS,EAAOjS,KAEZuc,EAAA,EAAAvc,IAASA,8CAYd6mD,IAAkBpD,GANjBzjD,IAAKuc,EAAA,EAAEvc,GAAQ,yBAOhByjD,GAAYzjD,IAASA,GAAMnB,OAAS,GAAGmtD,sBACvChsD,KAjCCyjD,EACIx9B,KAAKtE,UAAU3hB,MAAWimB,KAAKtE,UAAUglC,IACrCqF,MACAt/C,EAAS,QAAS1M,IAMzB2mD,GAAc1gC,KAAKtE,UAAU3hB,GAAM0jD,OAAaz9B,KAAKtE,UAAUglC,EAAWjD,MAC3Eh3C,EAAS,QAAS1M,6CAwBlBA,IAASyjD,GAAYkD,GAAYj6C,EAAS,QAAS1M,sBACnD6kD,GAAW/+C,GAAO0nD,4CACnBhK,KAAeoD,IAwBbrD,IAAqC,IAAtBC,GAAW3kD,UAE3B0kD,GACA+G,GAAQ5zB,EAAAC,IAAAC,0FACU,OAAdra,EAAA,EAAAqoC,IAAU,GAAI2M,EAAAhoD,KAAA,EACE06C,EAAQ,CACpBv3C,SAAAA,EACA62C,YAAAA,GACAM,4BAAAA,GACAL,WAAAA,aAJAc,EAAGiN,EAAAj6B,WAQHstB,GAAUN,EAAIM,SACdroC,EAAA,EAAAuoC,GAAWA,GAAWR,EAAIQ,SAAWtB,GAAW3kD,OAAS,GACzD0d,EAAA,EAAAsoC,EAAUC,IAAYR,EAAIO,SAC1BtoC,EAAA,GAAAksB,GAAQE,GAAUmb,GAAmBQ,EAAIK,eAAiBL,EAAIK,iBAE9DpoC,EAAA,EAAAqoC,IAAU,GACVroC,EAAA,EAAAsoC,GAAU,GACVtoC,EAAA,EAAAuoC,IAAW,+CAEhB2F,KAEHluC,EAAA,EAAAuoC,IAAW,GAEPrB,GACAlnC,EAAA,GAAAmqC,OAAcloD,kEAqBzB+d,EAAA,GAAEooC,EAAgBn7C,EAAM,CACrB+5C,YAAAA,GACAC,WAAAA,GACA/a,MAAAA,GACAgb,SAAAA,EACAzjD,MAAAA,GACA0jD,OAAAA,GACA/a,QAAAA,GACA3Y,MAAAA,GACA2zB,oBAAAA,GACAC,WAAAA,GACAC,4BAAAA,GACAC,mBAAAA,+BAnFIL,GAAYqB,IAAY9kD,IAAS2kD,GAQrCiH,GAJmBjH,EAAcz1B,WAAW,SAAApwB,GACjC,OAAAA,EAAE4kD,MAAY1jD,GAAM0jD,QAGE,sBAoF9BoB,IAAYrB,GAAUlnC,EAAA,EAAA8uC,GAAiB,qBAEvC7H,IAAYjnC,EAAA,EAAA8uC,GAAiB,sBAlFhC3+C,EAAS,YAXI2+C,uBAsDd9uC,EAAA,GAAAi1C,EAAW/N,EAAWzjD,IAASA,GAAMnB,OAAS,EAAImB,4BACpDuc,EAAA,GAAEk1C,EAAmBD,GAAYhO,GAAW3kD,OAAS,4CACrD0d,EAAA,GAAEm1C,EAAYF,GAAYtH,KAActxC,IAAagsC,gDACnDroC,EAAA,GAAAo1C,EACCxJ,IAAyB1E,GAEnBA,GAA8B,KAAbmO,QAALA,EAAA5xD,cAAK4xD,SAALA,EAAO/yD,QADnBopD,GAGAjoD,GACA,GACAioD,wBACT1rC,EAAA,GAAEs1C,EAAgB7xD,IAiQXwG,OAAWhI,EAGXgI,EApQuCi9C,GAmQ1BzjD,GAAMnB,OAAS,EACjBmB,GAAM+R,KAAK,SAAAgD,UAAMA,EAAEib,OAAQrmB,KAAK,MAEhC3J,GAAMgwB,IAGd69B,GAAWrnD,IAzQqC,4BAC1D+V,EAAA,GAAEu1C,aA4QM,IAAAnN,GAA0C,IAAzBA,EAAc9lD,aAAqB,OACrDkzD,EAAQpN,EAAc0G,IACtB,GAAAvG,IAAYiN,EAAK,CACb,IAAAvuC,EAAQmhC,EAAgBA,EAAc9lD,OAAS,EAC5C,OAAAivD,GAAaiE,EAAM/hC,IAAQxM,UAE3BwqC,KAlREgE,2BAqER,SAAmBvpB,GACnBA,GAA0B,IAAjBA,EAAM5pC,SAAgB4pC,EAAMhQ,MAAM,SAAA5G,GAAI,MAAqB,WAATj0B,EAAAi0B,OAC3D7xB,KAAUyjD,GAAWzjD,GAAMy4B,MAAM,SAAAzP,UAAeA,IAAcA,EAAU06B,GAAM,IAAM1jD,GAAM0jD,OAE3Fr0C,MAAMoS,QAAQzhB,QACdA,GAAQA,GAAM+R,KAAK,SAAAiX,GAAS,OAAKojC,GAASpjC,IAAcA,CAAS,SAEjEhpB,GAAQosD,MAAcpsD,KA3E3BiyD,CAAmBxpB,wBACrBlsB,EAAA,GAAE0qC,EAsCKxD,EAAiBzjD,GAAQA,GAAM+R,KAAK,SAAA8f,UAASA,EAAK6xB,OAAW,KAC1D1jD,GAAQA,GAAM0jD,IAAU1jD,4CAtC3ByjD,IAAYkD,GAAe3mD,IAAO0M,EAAS,QAAS1M,6BAerD8kD,IAAYH,IAAkBlB,IAAazjD,IAAO4rD,6BAWhD,SAAkBnjB,GACnBqc,IAAUp4C,EAAS,SAAU+7B,GAXlCypB,CAAkBvN,yCA+Wdp7B,QAA4C/qB,KAAjB,QAAd2zD,EAAA7G,UAAA6G,IAAcA,OAAdA,EAAAA,EAAgBnV,kBAChCkS,GAAgBlS,YAAa,EAAIkS,2CA/W9B3lC,GAAa+hC,IAAgByF,GAAe7zD,OAAOP,OAAOuyD,GAAiB5D,4BACjF/uC,EAAA,GAAEmpC,IAAY51C,oCAkXMA,EAAMg1C,GAClB,IAAAh1C,IAASg1C,EAAkB,OAAAvoC,EAAA,GAAAy0C,IAAW,GAC3C7R,uBACI5iC,EAAA,GAAAy0C,IAAW,KACZ,GArXJoB,CAAYtiD,GAAMg1C,2BACdA,IAAYv7B,GAAazZ,KA8VpB0M,EAAU+M,EAAU4B,wBAApB3O,WACR1M,GAAK/N,MAAMya,MAAQuuC,GAAgBvuC,EAAQ,KAAO,OAAM1M,wBA9V3DyM,EAAA,GAAE81C,EAAoBhH,sBAEhBvlD,GAASg/C,KAAaD,GAASiI,6EAsLlCpgD,EAAS,QAAS1M,IAClBuc,EAAA,EAAAvc,QAAQxB,GACRgvD,KACAV,qCArHK,SAAc3gD,MACd04C,EAEG,OADR14C,EAAExH,kBACMwH,EAAE5G,SACD,SACD4G,EAAE5H,iBACFipD,eAEC,WACDrhD,EAAE5H,iBAEEugD,GAAQ,IACqB,IAAzBH,EAAc9lD,OAAY,UACxByzD,EAAY3N,EAAc0G,OAE5BrrD,KAAUyjD,GAAYzjD,GAAM0jD,MAAY4O,EAAU5O,IAAM,CACxD8J,WAGAc,GAAa3J,EAAc0G,eAKlC,YACDl/C,EAAE5H,iBAEEugD,GACAiH,GAAc,IAEdxvC,EAAA,EAAAuoC,IAAW,GACXvoC,EAAA,GAAAmqC,OAAcloD,cAIjB,UACD2N,EAAE5H,iBAEEugD,GACAiH,IAAe,IAEfxvC,EAAA,EAAAuoC,IAAW,GACXvoC,EAAA,GAAAmqC,OAAcloD,cAIjB,MACG,GAAAsmD,IAAYD,EAAO,CAEf,GAAyB,IAAzBF,EAAc9lD,QACbmB,IAASA,GAAM0jD,MAAYiB,EAAc0G,IAAgB3H,WAEnD8J,KAEXrhD,EAAE5H,iBACF+pD,GAAa3J,EAAc0G,KAC3BmC,eAIH,YACI,IAAA/J,GAAYD,GAAW3kD,OAAS,EAAC,OAElC,GAAA4kD,GAAYzjD,IAASA,GAAMnB,OAAS,EAAC,CAEjC,GADJ0tD,QAAqC/tD,IAAhBkoD,EAA4BA,EAAc1mD,GAAMnB,OAAS,GAC1D,IAAhB6nD,QAAqCloD,IAAhBkoD,EAAyB,WAClDA,EAAc1mD,GAAMnB,OAAS6nD,EAAcA,EAAc,OAAIloD,aAIhE,YACI,IAAAwB,KAAUyjD,GAAYD,GAAW3kD,OAAS,EAAC,YAC5BL,IAAhBkoD,EACAnqC,EAAA,GAAAmqC,EAAc1mD,GAAMnB,OAAS,GACtBmB,GAAMnB,OAAS6nD,GAA+B,IAAhBA,GACrCnqC,EAAA,GAAAmqC,GAAe,aAGlB,iBACI1mD,KAAUyjD,GAAYD,GAAW3kD,OAAS,QAAqBL,IAAhBkoD,EAAyB,OACzEA,IAAgB1mD,GAAMnB,OAAS,EAC/B0d,EAAA,GAAAmqC,OAAcloD,GACPkoD,EAAc1mD,GAAMnB,OAAS,GACpC0d,EAAA,GAAAmqC,GAAe,0BAyBvB9tC,EACA,OAAA4qC,GAAW3kD,OAAS,EAAU0d,EAAA,EAAAuoC,IAAW,QAC7CvoC,EAAA,EAAAuoC,IAAYA,QAoFP,SAAmB7gD,GAAK,IAAAsuD,EACxBzN,IAAaD,IAAWt7B,GAAcA,EAAUipC,SAASvuD,EAAM3C,mBAAYwO,UAAI,IAAAyiD,GAAJA,EAAMC,SAASvuD,EAAM3C,SACjG2rD,YAuDC,SAAap7B,EAAM7xB,EAAO0jD,OAC3BD,EACG,OAAAzjD,GAASA,EAAM0jD,KAAY7xB,EAAK6xB,8DArjBd,kBAClBiB,0KAsoB6B,SAAA7lD,GAAA,OAAA0vD,GAAY1vD,EAAC,EACjB,SAAAA,UAAA0vD,GAAY1vD,yBACI2vD,GAAe,CAAG58B,KAAAA,EAAM/yB,EAAAA,GAAC,sDAd1DgR,GAAIiO,OA6EwD,SAAAjf,GAAA,OAAAytD,GAAqBztD,uBAZhD6oD,EAAyB4E,GAAqBztD,GAAC,EAAA,qDAmChFgH,EAAKiY,kBACJylC,GAAU/+C,KAAAzE,kEA3GnBupB,EAASxL,ivGExjBmC/f,EAAY,gCAAwB,IAAVA,EAAU,aAAVA,EAAU,8HAI9EA,EAAqB,gCACF,IAAdA,EAAc,aAAdA,EAAc,wHAUqBA,EAAY,gCAAsB,IAARA,EAAQ,aAARA,EAAQ,6HAI1EA,EAAoB,gCACF,IAAbA,EAAa,aAAbA,EAAa,2IAalBA,EAAiB,gBACG,IAAfA,EAAe,aAAfA,EAAe,8xBAvCrC6E,GA4COvB,EAAAmxD,EAAA3vD,GA3CLzB,GAcIoxD,EAAAC,GAbFrxD,GAAcqxD,EAAAC,WACdtxD,GAWIqxD,EAAAE,GAVFvxD,GASKuxD,EAAAl9C,6CADHrU,GAA0DqU,EAAA5P,QAAd9H,EAAW,YAI7DqD,GAaIoxD,EAAAI,GAZFxxD,GAAYwxD,EAAAC,WACZzxD,GAUIwxD,EAAAE,GATF1xD,GAQK0xD,EAAAl9C,6CAGTxU,GAaIoxD,EAAAO,GAZF3xD,GAAY2xD,EAAAC,WACZ5xD,GAUI2xD,EAAAE,GATF7xD,GAQK6xD,EAAA/8C,2GApCgDnY,EAAY,2BAAcA,EAAU,4EAKzEA,EAAc,2DAEgBA,EAAW,SAAXA,EAAW,6BAQNA,EAAY,2BAAcA,EAAQ,6EAKrEA,EAAa,oEAalBA,EAAiB,4BACZA,EAAe,+YAxI7B8V,EAAQH,GAAY,8BAEfgS,EAAanN,EAAbmN,OACYnN,EAAZ4Y,aAAAA,OAAY,IAAA+hC,EAAA,GAAAA,EACZ58B,EAAsD/d,EAAtD+d,SASL68B,EAAqB,CAAI,KAAM,KAAM,IAAK,KAAM,IAAK,MAAMrhD,KAAK,SAAAwf,SAAQ,CAC5EvxB,MAAOuxB,EACPvB,MAAOuB,EAAA,IAGH8hC,EACF,CAAA,CAAArzD,MAAO,MAAOgwB,MAAO,aAAW,CAChChwB,MAAO,OAAQgwB,MAAO,eAItBiM,EAAyBq3B,QAAZA,EAAAliC,SAAYkiC,IAAAA,GAAQA,QAARA,EAAZA,EAAc9pD,kBAAM8pD,GAApBA,EAAsB1wC,KAAOmN,GAAaqB,EAAa5nB,OAAOoZ,MAAQ,KACnF2wC,EAA6B,QAAZC,EAAApiC,SAAY,IAAAoiC,GAAQA,QAARA,EAAZA,EAAchqD,kBAAMgqD,GAApBA,EAAsBjiC,SACvC6hC,EAAsB9G,MAAM,SAAAhmD,GAAMmtD,IAAAA,SAAKntD,EAAOtG,SAA6B,QAAxByzD,EAAKriC,EAAa5nB,cAAM,IAAAiqD,OAAA,EAAnBA,EAAqBliC,aAC7E,KACAE,GAA0B,QAAZiiC,EAAAtiC,SAAY,IAAAsiC,GAAQA,QAARA,EAAZA,EAAclqD,cAAdkqD,IAAoBA,OAApBA,EAAAA,EAAsB1zD,QAAS,GAC7C2zD,UAAWC,EAAAxiC,SAAY,IAAAwiC,GAAM,QAANA,EAAZA,EAAcj2C,YAAI,IAAAi2C,GAAlBA,EAAoBhxC,KAAOmN,GAAaqB,EAAazT,KAAKiF,MAAQ,KAC7EixC,EAA4BC,QAAZA,EAAA1iC,SAAY0iC,IAAAA,GAAM,QAANA,EAAZA,EAAcn2C,YAAdm2C,IAAkBA,GAAlBA,EAAoBnnD,UACpC0mD,EAAqB/G,MAAM,SAAAhmD,GAAM,IAAAytD,EAAA,OAAKztD,EAAOtG,SAA2B+zD,QAAtBA,EAAK3iC,EAAazT,gBAAIo2C,SAAjBA,EAAmBpnD,UAAS,IACnF,yKASsBiW,EAA0BoxC,IAQtBziC,EAA4B0iC,EAQ/Bj0D,EAAyBk0D,MAgBvBvnD,EAA6BwnD,yBAlEvDC,EAAc/kD,MAAMoS,QAAQkE,2BAC5BiM,EAAQwiC,EAAc9xC,GAAeqD,GAAI,sBAC3CpJ,EAAA,GAAE83C,EAAwBD,EAAc9xC,GAAeqD,GAAM,GAAI,0BAC/D2uC,EAAe1iC,EAAM7f,IAAIge,sBAC3BxT,EAAA,EAAEg4C,EAAoBF,EAAwBA,EAAsBtiD,IAAIge,0BAuBxExT,EAAA,EAAEi4C,EACW,QAAZC,EAAArjC,SAAY,IAAAqjC,GAAY,QAAZA,EAAZA,EAAcpjC,kBAAU,IAAAojC,GAAxBA,EAA0B7iC,OAAS2iC,EAC9BnjC,EAAaC,WAAWO,MACtB7f,KAAK,SAAA6Q,GAAI,OAAK2xC,EAAkBjI,MAAM,SAAAhmD,GAAW,OAAAw3B,GAAQx3B,EAAOtG,MAAO4iB,EAAI,GAAA,IAC3EpZ,QAAQ,SAAAlD,GAAM,QAAOA,CAAM,IAC9B,qBAEoBsc,EAgDI8xC,QAAXA,EAACz4B,SAAAy4B,IAAUA,OAAVA,EAAAA,EAAY10D,MA/CzB89B,WAAOk2B,EAAC5iC,SAAY,IAAA4iC,GAAQ,QAARA,EAAZA,EAAcxqD,cAAM,IAAAwqD,OAAA,EAApBA,EAAsBpxC,KAAMA,KACvC9O,EAAM,mBAAoB8O,QAC1BwO,EAAeujC,EAAMvjC,EAAY,CAAG,SAAU,QAASxO,GAAM,IAC7D2T,EAASnF,oBAIiBG,EAyCQ,QAAfqjC,EAACrB,SAAc,IAAAqB,OAAA,EAAdA,EAAgB50D,MAxCjC89B,GAAoBm2B,QAAbA,EAAC7iC,aAAY6iC,GAAQ,QAARA,EAAZA,EAAczqD,cAAdyqD,IAAoBA,OAApBA,EAAAA,EAAsB1iC,SAAUA,KAC3Czd,EAAM,uBAAwByd,QAC9BH,EAAeujC,EAAMvjC,EAAY,CAAG,SAAU,YAAaG,GAAU,IACrEgF,EAASnF,qBAIcpxB,EAkCNyxB,EAjCdqM,GAAoB,QAAbo2B,EAAC9iC,SAAY,IAAA8iC,GAAQA,QAARA,EAAZA,EAAc1qD,cAAd0qD,IAAoBA,OAApBA,EAAAA,EAAsBl0D,MAAOA,KACxC8T,EAAM,oBAAqB9T,QAC3BoxB,EAAeujC,EAAMvjC,EAAY,CAAG,SAAU,SAAUpxB,GAAO,IAC/Du2B,EAASnF,oBAIJ,SAAexO,GAA0B,IAAAiyC,EAC3C/2B,GAAoB+2B,QAAbA,EAACzjC,aAAYyjC,WAAAA,EAAZA,EAAcl3C,YAAI,IAAAk3C,OAAA,EAAlBA,EAAoBjyC,KAAMA,KACrC9O,EAAM,iBAAkB8O,QACxBwO,EAAeujC,EAAMvjC,EAAY,CAAG,OAAQ,QAASxO,GAAM,IAC3D2T,EAASnF,IAuBV0jC,CAAuBC,QAATA,EAACpB,aAAQoB,SAARA,EAAU/0D,uBAnBC2M,EAoBO,QAAdqoD,EAACnB,SAAAmB,IAAaA,OAAbA,EAAAA,EAAeh1D,MAnB/B89B,GAAoBq2B,QAAbA,EAAC/iC,SAAY+iC,IAAAA,GAAM,QAANA,EAAZA,EAAcx2C,YAAI,IAAAw2C,OAAA,EAAlBA,EAAoBxnD,UAAWA,KAC1CmH,EAAM,sBAAuBnH,QAC7BykB,EAAeujC,EAAMvjC,EAAY,CAAG,OAAQ,aAAczkB,GAAW,IACrE4pB,EAASnF,oBAIJ,SAAsBQ,GAA2BqjC,IAAAA,EACnDn3B,WAAOm3B,EAAC7jC,SAAY,IAAA6jC,GAAYA,QAAZA,EAAZA,EAAc5jC,kBAAd4jC,IAAwBA,OAAxBA,EAAAA,EAA0BrjC,MAAOA,KAC5C9d,EAAM,wBAAyB8d,QAC/BR,EAAeujC,EAAMvjC,EAAY,CAAG,aAAc,SAAUQ,GAAO,IACnE2E,EAASnF,IASV8jC,CAAsBV,EAAkBA,EAAgBziD,KAAK,SAAA8f,GAAS,OAAAA,EAAK7xB,KAAK,SAAIxB,qDAQJy9B,EAAUj8B,oBAKzEuzD,EAAcvzD,eAEgByxB,EAAWhtB,KAAAzE,8BAQoB2zD,EAAQ3zD,oBAKrE6zD,EAAa7zD,oBAcbw0D,EAAex0D,07CCxHfg2B,wOAFAD,2NAIbo/B,EAAAn3D,KAAcuF,KAAI,yCALdvF,EAAa,GAACiE,KAAOjE,EAAe,GAAA,iMAFxB4G,GAAAqS,EAAA,QAAAm+C,EAAA,UAAA/sD,OAAArK,KAAcuF,KAAI,uCADnBvF,EAAa,GAACiE,KAAOjE,EAAe,qBAJtD6E,GAaQvB,EAAA2V,EAAAnU,uNADL4T,GAAA,EAAApY,IAAA62D,KAAAA,EAAAn3D,KAAcuF,KAAI,KAAAqC,GAAAyxB,EAAA89B,KAPFz+C,GAAA,EAAApY,GAAA82D,KAAAA,YAAA/sD,OAAArK,KAAcuF,KAAI,oEADnBvF,EAAa,GAACiE,KAAOjE,EAAe,2IALjDA,EAAc,iBAAnBa,OAAIC,GAAA,kTAFV+D,GAmBKvB,EAAAuU,EAAA/S,GAlBHzB,GAiBKwU,EAAAH,iHAhBI1X,EAAc,YAAnBa,OAAIC,GAAA,EAAA,4GAAJD,OAAIC,EAAAgwB,EAAAjwB,OAAAC,GAAA,mDAAJD,OAAIC,GAAA,uJAZGu2D,EAA+B78C,EAA/B68C,eACAC,EAAuB98C,EAAvB88C,gBACAC,EAA4C/8C,EAA5C+8C,sBAEF,SAAAC,EAA0BC,GACjCl5C,EAAA,EAAA+4C,EAAkBG,GAClBF,EAAsBE,8MASF,OAAAD,EAA0BE,EAAczzD,uyBCY9CjE,EAAU,GAAG23D,GAA+BC,4KAN1D/yD,GAOQvB,EAAA2V,EAAAnU,2FADM9E,EAAU,GAAG23D,GAA+BC,wNAPvD53D,EAAgB,IAAAmZ,GAAAnZ,gCAqBP63D,iDAxBX73D,EAAK,+OAFV6E,GA4BKvB,EAAAuU,EAAA/S,GA3BHzB,GAEKwU,EAAAH,iEAYLrU,GAYQwU,EAAAoB,qGAzBLjZ,EAAK,qEAGHA,EAAgB,0VAbV83D,EAAet9C,EAAfu9C,MAAAA,WAAKD,EAAG,QAAOA,EACfE,EAAiCx9C,EAAjCy9C,iBAAAA,OAAgB,IAAAD,GAAiBA,EACjCE,EAA2B19C,EAA3B29C,WAAAA,OAAsB,IAAZD,GAAiBA,EAC3BE,EAA6C59C,EAA7C0D,QAAAA,WAAOk6C,OAA6B53D,EAAS43D,EAEhDv5C,EAAUhS,GAAoB,gBAA9BgS,qOAaa,WAAA,OAAAN,EAAA,EAAA45C,GAAcA,EAAU,aASrCj6C,EACFA,IAEAW,oeCUQw5C,+LAJAr4D,EAAc,GAACa,QAAU,oBALvCgE,GAUQvB,EAAA2V,EAAAnU,gDAJI9E,EAAU,kDADRA,EAAc,GAACa,QAAU,sOANG,UAA+Bb,EAAK,qfA1B1Es4D,EACAtnC,EANOqmC,EAA+B78C,EAA/B68C,eACAC,EAAuB98C,EAAvB88C,gBACAC,EAA4C/8C,EAA5C+8C,sBACAY,EAAmB39C,EAAnB29C,WAKHt5C,EAAUhS,GAAoB,gBAA9BgS,MACA05C,EACN1rD,GAAiC,kBAD3BskB,EAAiBonC,EAAjBpnC,kBAAmBP,EAAkB2nC,EAAlB3nC,uQAInBpvB,EAAK,CACT61D,eAAAA,EACAC,gBAAAA,EACAC,sBAAwB,SAAAD,GACtB1mC,EAAmBI,GACnBumC,EAAsBD,KAI1BtmC,EAAUG,EAAkBqnC,GAAqBh3D,EAAK,CACpDyuB,WAAY,EACZE,WAAY,EACZrrB,OAAQwzD,EACR18C,mBAAmB,4DASV08C,EAAev4C,uNCtCxBjK,GAAQH,GAAY,gCCH1B,IAAe8iD,GAAA,SAACruD,EAAWzK,EAAWoD,EAAWuC,GAE/C,OADA8E,GAAK9E,EAAI,GACD,EACEvC,EAAI,EAAKqH,EAAIA,EAAIzK,GAGlBoD,EAAI,KADbqH,GACwBA,EAAI,GAAK,GAAKzK,CACxC,ECEa+4D,GAAa,WAIxB,IAAIntC,EACAvnB,EAEAqM,EACA6jC,EAEAzuB,EACA5U,EACA8nD,EAEArrC,EACAxjB,EAEA8uD,EACAC,EAIAxqD,EAEAyqD,EAUJ,SAAS55C,EAAIlb,GAIX,OAHmBA,EAAQmpB,wBAAwBjO,KAC9BqM,EAAU4B,sBAAwB5B,EAAU4B,wBAAwBjO,IAAM,GAE5D7O,CACpC,CAID,SAAS8O,EAASD,GAChBqM,EAAUpM,SACNoM,EAAUpM,SAASoM,EAAUouB,WAAYz6B,GACxCqM,EAAUquB,UAAY16B,CAC5B,CAID,SAAS65C,EAAKC,GAEPJ,IACHA,EAAYI,GAUd75C,EAHOtO,EAHPgoD,EAAcG,EAAcJ,EAGDvoD,EAAOid,EAAUxjB,IAK5CgvD,GAAY,EAGZD,EAAc/uD,EACVnH,sBAAsBo2D,GAM5B,WAKE,GAHA55C,EAAS9O,EAAQid,GAGbtpB,GAAW20D,EAAM,CAEnB30D,EAAQgD,aAAa,WAAY,MAGbhD,EACR8b,OACb,CAGuB,mBAAbzR,GACTA,IAIFuqD,EAAY,EAGZE,GAAY,CACb,CA7BKx8B,EACL,CAgHD,OAhFA,SAAch5B,GAAmC,IAAA6C,yDAAuB,GAStE,OAPA2D,EAAW,IACX2b,EAAStf,EAAQsf,QAAU,EAC3BpX,EAAWlI,EAAQkI,SACnBwC,EAAS1K,EAAQ0K,QAAU4nD,GAC3BE,EAAOxyD,EAAQwyD,OAAQ,EAGvB/4D,EAAeuG,EAAQolB,YACrB,IAAK,SAEHA,EAAYplB,EAAQolB,UACpB,MAEF,IAAK,SACHA,EAAYnnB,SAAS60D,cAAc9yD,EAAQolB,WAC3C,MAEF,QACEA,EAAYlpB,OAAO+B,SAAS8zC,gBAOhC,OAHA7nC,EAnGOkb,EAAUquB,UAsGjBh6C,EAAe0D,IAEb,IAAK,SACHU,OAAUxD,EACVm4D,GAAO,EACPzkB,EAAO7jC,EAAQ/M,EACf,MAIF,IAAK,SAEH4wC,EAAOh1B,EADPlb,EAAUV,GAEV,MAIF,IAAK,SACHU,EAAUI,SAAS60D,cAAc31D,GACjC4wC,EAAOh1B,EAAIlb,GAUf,OAHAspB,EAAW4mB,EAAO7jC,EAAQoV,EAG1B7lB,EAAeuG,EAAQ2D,WAErB,IAAK,SACHA,EAAW3D,EAAQ2D,SACnB,MAGF,IAAK,WACHA,EAAW3D,EAAQ2D,SAASwjB,GAO3BwrC,EAIHF,EAAY,EAHZj2D,sBAAsBo2D,EAKzB,CAIH,ECrMMG,GAAoB,IAEpBpjD,GAAQH,GAAY,sBA2BV,SAAAwjD,SAAiBhzD,EAAA8C,UAAApI,eAAAL,IAAAyI,UAAA,GAAAA,UAAA,GAA0B,GACnDmwD,EAAWjzD,EAAQizD,UAAYF,GAKjCzuB,EAAa,GAEbj3B,EAAQ,EAEZ,SAAS6lD,IACP,OAAO7lD,EAAQi3B,EAAM5pC,MACtB,CAED,SAASy4D,IACP,OAAO9lD,EAAQ,CAChB,CAED,SAAS+lD,IACP,MAAO,CACLF,QAASA,IACTC,QAASA,IACTz4D,OAAQ4pC,EAAM5pC,OAEjB,CAED,SAAS24D,IACHrzD,EAAQoyB,UACVpyB,EAAQoyB,SAASghC,IAEpB,CAkDD,MAAO,CACLjrD,IAjDF,SAAaulB,GACX/d,GAAM,MAAO+d,GAEb4W,EAAQ,CAAC5W,GAAMxpB,OAAOogC,EAAMrqC,MAAMoT,IAAQpT,MAAM,EAAGg5D,GAEnD5lD,EAAQ,EAERgmD,GACD,EA0CC3tD,MAxCF,WACEiK,GAAM,SAEN20B,EAAQ,GACRj3B,EAAQ,EAERgmD,GACD,EAkCCD,SAAAA,EACAE,KAjCF,WACE,GAAIJ,IAAW,CACb,IAAMxlC,EAAO4W,EAAMj3B,GAOnB,OANAA,GAAS,EAETsC,GAAM,OAAQ+d,GAEd2lC,IAEO3lC,CACR,CAGF,EAqBC6lC,KAnBF,WACE,GAAIJ,IAOF,OAJAxjD,GAAM,OAAQ20B,EAFdj3B,GAAS,IAITgmD,IAEO/uB,EAAMj3B,EAIhB,EASH,CCjHgB,SAAAmmD,GAAWtrD,EAAmBurD,GAC5C,IAAMvpD,EAAQ7N,KAAKF,MACbb,EAAS4M,IAKf,OAFAurD,EAFYp3D,KAAKF,MAEA+N,GAEV5O,CACT,CCIA,IAAMqU,GAAQH,GAAY,cAwCpB,SAAUkkD,GACdlyC,EACAmyC,EACAt2C,EACAu2C,GAIA,GAFAjkD,GAAM,iBAEDgkD,EACH,MAAO,GAGT,GAAIt2C,IAAWu2C,EAAkB,CAG/B,IAAMp0D,EAAO6d,EAAOG,UAAUgE,GAE9B,OAAOmyC,OADwBt5D,IAATmF,EAAqBo0D,EAAiB91C,MAAMte,QAAQnF,EAE3E,CACC,OAAOs5D,EAAUnyC,EAErB,CAEM,SAAUqyC,GACdr0D,EACAm0D,EACAt2C,EACAu2C,GAIA,GAFAjkD,GAAM,gBAEFnQ,EAAK9E,OAASmgB,GAOhB,MAAO,CACLi5C,iBAAkB,CAPqB,CACvCr1C,KAAM,GACNqC,QAAS,mDACTizC,SAAU/5C,GAAmBtV,QAQjC,GAAoB,IAAhBlF,EAAK9E,OAEP,OAAW,KAGb,IAGE,IAAM8mB,EAAOgyC,IACX,WAAM,OAAAn2C,EAAOS,MAAMte,EAAK,IACxB,SAACmE,GAAQ,OAAKgM,+BAAKzL,OAA6BP,EAAQ,OACzD,IAED,IAAKgwD,EACH,OAAO,KAIT,IAAMK,EACJ32C,IAAWu2C,EACPpyC,EACAgyC,IACE,WAAM,OAAAI,EAAiB91C,MAAMte,EAAK,IAClC,SAACmE,UAAagM,GAAKzL,sDAAAA,OAAuDP,EAAa,WAIzFmwD,EAAmBN,IACvB,WAAA,OAAMG,EAAUK,EAAc,IAC9B,SAACrwD,GAAagM,OAAAA,GAAK,+BAAAzL,OAAgCP,EAAQ,OAAM,IAGnE,OAAQmoB,EAAQgoC,GAA2C,KAAvB,CAAEA,iBAAAA,EACvC,CAAC,MAAO92C,GACP,IAAMi3C,EAAeT,IACnB,WAAA,OAgBN,SAAuBh0D,EAAc6d,GACnC,GAAI7d,EAAK9E,OAASogB,GAChB,OAAO,EAGT,IAGE,OAFAuC,EAAOS,MAAM6B,EAAWngB,KAEb,CACZ,CAAC,MAAOwd,GACP,QACD,CACH,CA5BYk3C,CAAc10D,EAAM6d,EAAO,IACjC,SAAC1Z,UAAagM,GAAKzL,2CAAAA,OAA4CP,EAAa,OAC7E,IAOD,MAAO,CACLwwD,WANiBh0C,GACjB3gB,EACCwd,EAAc8D,SAAY9D,EAAc4G,YAKzCqwC,aAAAA,EAEH,CACH,CCnJA,IAAMtkD,GAAQH,GAAY,2BAWV,SAAA4kD,GAAkBC,GAOd,IACdC,EAPJxuD,EAAOuuD,EAAPvuD,QACAI,EAASmuD,EAATnuD,UACAqf,EAAS8uC,EAAT9uC,UACAwb,EAAQszB,EAARtzB,SACAwzB,EAAOF,EAAPE,QACAC,EAAMH,EAANG,OAGI76C,GAAQ,EAEZ,SAAS86C,IACP,IAAMC,EAAW3zB,IAEb2zB,IACFta,aAAaka,GACR36C,IACHhK,GAAM,SACN4kD,IACA56C,EAAQ+6C,GAGb,CAED,SAASC,IACHh7C,IAIFygC,aAAaka,GACbA,EAAoBtZ,YAAW,WACxBja,MACHpxB,GAAM,QACNgK,GAAQ,EACR66C,IAEJ,IAEH,CAED1uD,GAAQ,WACN6J,GAAM,sBACN,IAAMzT,EAASqpB,IACXrpB,IACFA,EAAO+D,iBAAiB,UAAWw0D,GAAe,GAClDv4D,EAAO+D,iBAAiB,WAAY00D,GAAgB,GAExD,IAEAzuD,GAAU,WACRyJ,GAAM,wBACN,IAAMzT,EAASqpB,IACXrpB,IACFA,EAAOgE,oBAAoB,UAAWu0D,GAAe,GACrDv4D,EAAOgE,oBAAoB,WAAYy0D,GAAgB,GAE3D,GACF,6lECjCoB96D,EAAI,6GAAJA,EAAI,0JAwBF+6D,EAAA,IAAAC,GAAA,CAAAx5D,MAAA,CAAAoE,KAAA5F,KAAO43B,kGAAP,EAAAt3B,IAAA26D,EAAAr1D,KAAA5F,KAAO43B,mKAEpBu/B,EAAAn3D,KAAO2F,KAAI,GAHP4R,EAAAvX,KAAO43B,MAAIze,GAAAnZ,yNAHT4G,GAAAqS,EAAA,QAAAm+C,EAAAp3D,KAAO+3D,OACJ9+C,EAAA2B,SAAAsgD,EAAAl7D,KAAO4a,0BAdnB/V,GAoBQvB,EAAA2V,EAAAnU,2HAJM8yB,gHAGXlf,GAAA,EAAApY,IAAA62D,KAAAA,EAAAn3D,KAAO2F,KAAI,KAAAiC,GAAAyxB,EAAA89B,KANLz+C,GAAA,EAAApY,GAAA82D,KAAAA,EAAAp3D,KAAO+3D,2BACJr/C,GAAA,EAAApY,GAAA46D,KAAAA,EAAAl7D,KAAO4a,iLAtBd5a,EAAI,IAAAyX,GAAAzX,QAOJA,EAAO,iBAAZa,OAAIC,GAAA,iKAJHd,EAAO,wMAPaA,EAAO,gFANLA,EAAI,GAAA,mCAAjC6E,GAyCKvB,EAAAgV,EAAAxT,GAvCHzB,GAaKiV,EAAAT,GANHxU,GAKKwU,EAAAH,0CAEPrU,GAwBKiV,EAAAH,4EAjCOnY,EAAW,8CAGdA,EAAI,4HAGRA,EAAO,uCAPaA,EAAO,wBAWvBA,EAAO,YAAZa,OAAIC,GAAA,EAAA,4GAAJD,OAAIC,EAAAgwB,EAAAjwB,OAAAC,GAAA,gDAjBmBd,EAAI,GAAA,gFAiB3Ba,OAAIC,GAAA,2KAnCG,IAAAq6D,EAA0D3gD,EAA1D1R,KAAAA,OAAI,IAAAqyD,EAA6C,UAASA,EAC1DC,EAA4C5gD,EAA5Cod,KAAAA,OAAmCp3B,IAA/B46D,OAA+B56D,EAAS46D,EAC5CC,EAAuC7gD,EAAvCyM,QAAAA,OAAO,IAAAo0C,OAAuB76D,EAAS66D,IAChC7gD,EAAP8gD,QAAAA,OAAO,IAAAC,EAAA,GAAAA,EACPC,EAA6ChhD,EAA7CihD,QAAAA,OAAoCj7D,IAA7Bg7D,OAA6Bh7D,EAASg7D,EAC7CE,EAA6ClhD,EAA7C0D,QAAAA,OAAO,IAAAw9C,OAA6Bl7D,EAASk7D,EAEpDx9C,GACF7R,GAAU6R,yOAINu9C,GACFA,mBA0BQE,EAAOF,SACTE,EAAOF,uBAILE,EAAOC,aACTD,EAAOC,iwFCVV57D,EAAQ,IAAc,IAAVA,EAAK,mJADxB6E,GA+DKvB,EAAAisB,EAAAzqB,+VAZmB+2D,4BAKEC,+GAFb97D,EAAK,SAAC,mPALgB4G,GAAAm1D,EAAA,QAAAC,EAAA,kBAAAh8D,KAAeA,EAAgB,IAAA,4GAF9D6E,GAcOvB,EAAAmxD,EAAA3vD,GAbLzB,GAYOoxD,EAAAwH,GAXL54D,GAUI44D,EAAAF,GATF14D,GAEI04D,EAAAnH,wBACJvxD,GAKI04D,EAAAhH,mBAHF1xD,GAEK0xD,EAAAxlC,wCAR+DvvB,EAAM,2CAKzEA,EAAK,MALiB0Y,GAAA,EAAApY,GAAA07D,KAAAA,EAAA,kBAAAh8D,KAAeA,EAAgB,IAAA,qPA7CnDklB,GAAMllB,EAAgB,GAAE6gB,kBAA7BhgB,OAAIC,GAAA,oFAgCDyW,EAAAvX,KAAQ6gB,IAAqBunC,GAAApoD,gMAlCtC6E,GA2COvB,EAAAmxD,EAAA3vD,GA1CLzB,GAyCOoxD,EAAAwH,yHAxCE/2C,GAAMllB,EAAgB,GAAE6gB,aAA7BhgB,OAAIC,GAAA,EAAA,yGAAJD,OAAIC,EAAAgwB,EAAAjwB,OAAAC,GAAA,YAgCDd,KAAQ6gB,mGAhCXhgB,OAAIC,GAAA,mMAyBgBo7D,qMANdr3D,GAOQvB,EAAA2V,EAAAnU,2CAJoB9E,EAAQ,iMAVrCoxB,GAAkBpxB,EAAe,GAAC4kB,MAAI,GAGtCu3C,EAAAn8D,KAAgBinB,QAAO,yBANZ40C,MASP,IAAAtkD,EAAU,IAAVvX,OAAeA,EAAiB,GAAAa,OAAS,GAACsnD,GAAAnoD,sZAhB1B4G,GAAAm1D,EAAA,QAAAC,EAAA,kBAAAh8D,KAAgBk6D,SAAQ,oCADjDr1D,GA4BIvB,EAAAy4D,EAAAj3D,GArBFzB,GAEI04D,EAAAnH,wBACJvxD,GAEI04D,EAAAhH,mBACJ1xD,GAEI04D,EAAA7G,mBACJ7xD,GAWI04D,EAAAK,0FAhBDhrC,GAAkBpxB,EAAe,GAAC4kB,MAAI,KAAAhd,GAAAyxB,EAAA89B,KAGtCz+C,GAAA,EAAApY,IAAA67D,KAAAA,EAAAn8D,KAAgBinB,QAAO,KAAArf,GAAAkuC,EAAAqmB,GAGT,IAAVn8D,OAAeA,EAAiB,GAAAa,OAAS,gHAhBzB6X,GAAA,EAAApY,GAAA07D,KAAAA,EAAA,kBAAAh8D,KAAgBk6D,SAAQ,iOAkCrCiC,EAAAn8D,KAAQ6gB,GAAqB,sFAAnC,sBAAoC,oOAH1Chc,GAKIvB,EAAAy4D,EAAAj3D,GAJFzB,GAAK04D,EAAAnH,WACLvxD,GAAK04D,EAAAhH,WACL1xD,GAAyD04D,EAAA7G,mCACzD7xD,GAAK04D,EAAAK,oBADK,EAAA97D,GAAA67D,KAAAA,EAAAn8D,KAAQ6gB,GAAqB,KAAAjZ,GAAAkuC,EAAAqmB,4CAzC/C,QAAAE,GAAApqC,EAAQjyB,EAAgB,gIAAxB,EAAAM,IAAA+7D,GAAApqC,EAAQjyB,EAAgB,iPA1BjBi6D,EAAmCz/C,EAAnCy/C,iBACAqC,EAA6C9hD,EAA7C8hD,YAIPC,GAAW,6JAFZh+C,EAAA,EAAAiH,EAAQy0C,EAAiBp5D,6BAK1B0d,EAAA,EAAAg+C,GAAW,eAIXh+C,EAAA,EAAAg+C,GAAW,IAGJ,SAAeC,GAOf,MANS,CACdr8C,GAAmBnK,MACnBmK,GAAmBs8C,QACnBt8C,GAAmBtV,MAGHyjD,MAAM,SAAA4L,UAAasC,EAAO/hC,MAAM,SAAAzkB,GAAK,OAAKA,EAAMkkD,WAAaA,IAAQ,iBAc3E/Y,YAAU,kBAAOmb,EAAYI,EAAe,wJCnD/CC,GACU,oBAAdC,WAA4BA,UAAU5pB,SAASzoB,cAAc7iB,QAAQ,QAAU,ECIpF+E,GAAwB,GAE5B,SAASowD,GAAc52D,GACrB,GAAkB,WAAdA,EAAMsB,IAAkB,CAC1B,IAAM8G,EAAWswB,GAAKlyB,IAClB4B,GACFA,GAEH,CACH,CASgB,SAAAyuD,GAAS94D,EAAyBqK,GAOhD,OANI4jB,EAAQxlB,KACVpK,OAAO+D,iBAAiB,UAAWy2D,IAGrCpwD,GAAUL,KAAKiC,GAER,CACLlM,QAAS,WACPsK,GAAYA,GAAUjB,QAAO,SAACzI,GAAC,OAAKA,IAAMsL,CAAS,IAE/C4jB,EAAQxlB,KACVpK,OAAOgE,oBAAoB,UAAWw2D,GAEzC,EAEL,0yHChBW78D,EAAI,GAAA,WACF,6EAKFA,EAAI,GAAA,WACF,4EAKFA,EAAI,GAAA,WACF,+iBAtBb6E,GA+BKvB,EAAAy5D,EAAAj4D,wBA5BHzB,GA2BK05D,EAAAC,GA1BH35D,GAAiE25D,EAAAtlD,WAEjErU,GAmBK25D,EAAAC,GAlBH55D,GAKK45D,EAAA9kD,GAJH9U,GAEK8U,EAAAN,mBAGPxU,GAKK45D,EAAAC,GAJH75D,GAEK65D,EAAA5kD,mBAGPjV,GAKK45D,EAAAE,GAJH95D,GAEK85D,EAAAC,mBAKT/5D,GAEK25D,EAAAK,GADHh6D,GAAkFg6D,EAAApkD,0NAjC9E4F,EAAUhS,GAAoB,gBAA9BgS,eAEK89C,GAAS,IAAM,yBA+BkC99C,gBA5BN,OAAAA,GAAK,qHCGzD,SAAUy+C,GAAYzpC,GAI1B,QAAOA,IAAwB,UAAjBA,EAAW,OAAmC,IAAlBA,EAAY,MACxD,CAEM,SAAU0pC,GAAgB1pC,GAI9B,QAAOA,IAAwB,cAAjBA,EAAW,OAA2C,IAAtBA,EAAgB,UAChE,CAEM,SAAU2pC,GAAY3pC,GAG1B,QAAOA,IAAwB,UAAjBA,EAAW,MAAyC,iBAAjBA,EAAW,KAC9D,CAEM,SAAU4pC,GAAa5pC,GAI3B,QAAOA,GAAkC,mBAApBA,EAAc,OACrC,CAEM,SAAU6pC,GAAqB7pC,GACnC,QAAOA,IAGc,oBAAjBA,EAAW,MAGT4pC,GAAa5pC,EAAW,OAGxBxiB,MAAMoS,QAAQoQ,EAAY,OAElC,CAEM,SAAU8pC,GAAiB9pC,GAG/B,QAAOA,IAAwB,QAAjBA,EAAW,MAAexiB,MAAMoS,QAAQoQ,EAAY,OACpE,CAEM,SAAU+pC,GAAoB/pC,GAGlC,QAAOA,IAAwB,WAAjBA,EAAW,MAAkBxiB,MAAMoS,QAAQoQ,EAAY,OACvE,CAEM,SAAUgqC,GAAoBC,GAClC,OAAOn7C,GAASm7C,IAAkBn7C,GAASm7C,EAA0B,WACvE,CAEM,SAAUC,GACdD,GAEA,OAAOn7C,GAASm7C,IAAkBzsD,MAAMoS,QAAQq6C,EAAgC,iBAClF,CAEM,SAAUE,GAAkBh8D,GAChC,OACE2gB,GAAS3gB,IACTqP,MAAMoS,QAAQzhB,EAAM4iB,OACK,iBAAlB5iB,EAAMilB,SACb,aAAcjlB,CAElB,CAEM,SAAUi8D,GAAwBj8D,GACtC,OAAO2gB,GAAS3gB,IAAUg8D,GAAkBh8D,IAAwC,kBAAvBA,EAAMk8D,YACrE,CAEM,SAAUC,GAA0Bn8D,GACxC,OAAO2gB,GAAS3gB,IAAU,cAAeA,GAAS2gB,GAAS3gB,EAAMR,MACnE,CAEM,SAAU48D,GAAuBp8D,GACrC,OAAO2gB,GAAS3gB,IAAkC,mBAAjBA,EAAM25D,QAAyBh5C,GAAS3gB,EAAMR,MACjF,skFC5DO,MAAAisC,EAAA4wB,GAAgBr+D,EAAI,IAAA,2EAApB,EAAAM,GAAAmtC,KAAAA,EAAA4wB,GAAgBr+D,EAAI,IAAA,KAAA4H,GAAAwC,EAAAqjC,0EARduZ,EAAAhnD,KAAK43B,MAAIswB,GAAAloD,GAGTs+D,EAAAt+D,KAAK2F,MAAIwiD,GAAAnoD,qFARK4G,GAAAqS,EAAA,QAAAF,EAAA,cAAA/Y,KAAKk1B,UAAS,kBAE1BtuB,GAAAqS,EAAA,QAAAm+C,EAAAp3D,KAAK+3D,oBACF/3D,EAAI,GAAC4a,WAAY,mBAL7B/V,GAaQvB,EAAA2V,EAAAnU,6EAVIvF,GAAAS,EAAK,GAAAy7D,UAALz7D,KAAKy7D,QAAOznD,MAAAvN,KAAAwC,8CAIZ2uB,8GAGL53B,KAAK2F,iEARS+S,GAAA,EAAApY,GAAAyY,KAAAA,EAAA,cAAA/Y,KAAKk1B,UAAS,sCAE1Bxc,GAAA,EAAApY,GAAA82D,KAAAA,EAAAp3D,KAAK+3D,0CACF/3D,EAAI,GAAC4a,WAAY,8OAP7B/V,GAAwBvB,EAAAisB,EAAAzqB,4JAFxBD,GAA4BvB,EAAAisB,EAAAzqB,0EAYZ8yB,EAAA,IAAAojC,GAAA,CAAAx5D,MAAA,CAAAoE,KAAA5F,KAAK43B,kGAAL,EAAAt3B,IAAA43B,EAAAtyB,KAAA5F,KAAK43B,6IAGhB,MAAA6V,EAAAztC,KAAK2F,KAAI,2EAAT,EAAArF,GAAAmtC,KAAAA,EAAAztC,KAAK2F,KAAI,KAAAiC,GAAAwC,EAAAqjC,oJAhBX,MAAA4uB,IAAAA,IAAAkB,GAAgBv9D,EAAI,UAEf,MAAAu+D,IAAAA,IAAAjB,GAAYt9D,EAAI,UAEhB,MAAAw+D,IAAAA,IAAAf,GAAaz9D,EAAI,2bALtBA,EAAK,iBAAVa,OAAIC,GAAA,gRAHR+D,GA6BKvB,EAAAisB,EAAAzqB,+NA1BI9E,EAAK,YAAVa,OAAIC,GAAA,EAAA,yGAAJD,OAAIC,EAAAgwB,EAAAjwB,OAAAC,GAAA,0HAAJD,OAAIC,GAAA,4KATG,SAAAu9D,GAAgBxqC,UACvBjd,QAAQZ,MAAM,4BAA6B6d,GACpC,yEAJOrZ,EAALiwB,MAAAA,OAAK,IAAAg0B,EAAA,GAAAA,q0CCgId55D,GAA4EvB,EAAAisB,EAAAzqB,uJAcjE9E,EAAc,iHAAdA,EAAc,6LARjB67D,GACyB50C,8BAAA5c,OAAArK,KAAMinB,iBAC5BjnB,EAAY,gGADU,EAAAM,IAAAo+D,EAAAz3C,QAAA5c,sBAAAA,OAAArK,KAAMinB,2BAC5BjnB,EAAY,gRALpBA,EAAK,gIAiBEA,EAAQ,2IAIEA,EAAI,6EA1B5B6E,GA4BKvB,EAAAisB,EAAAzqB,+CATHzB,GAQAksB,EAAAovC,oCANY3+D,EAAY,uRACZA,EAAQ,wBAIEA,EAAI,sMArItB4+D,EAkEAn0B,EA5EOo0B,EAASrkD,EAAT7U,KAAAA,OAAI,IAAAk5D,EAAG,GAAEA,EACTC,EAAgBtkD,EAAhB2d,SAAAA,OAAQ,IAAA2mC,GAAQA,EAChBC,EAA+BvkD,EAA/BukD,QACAC,EAAkCxkD,EAAlCwkD,SACAC,EAAuDzkD,EAAvD+d,SAAAA,OAAmD,IAA3C0mC,EAA2C,KAAIA,EACvDC,EAAuC1kD,EAAvC0kD,QACAp5B,EAAoBtrB,EAApBsrB,SAELhwB,EAAQH,GAAY,kCAmDjBwpD,IACPD,EAAQv5D,ySAhDP4Y,EAAA,EAAAvI,EAKM,SAAgB6P,cAErBk5C,EAAQl5C,GACG,WACJ1C,GACA,OAAAmD,GAAwBT,EAAW1C,EAAc8D,UAVjDm4C,CAAgBz5D,kBACxB4Y,EAAA,GAAA8gD,EAaM,SAAax5C,cAElBm5C,EAASn5C,IACF,QACA1C,aAjBKi3C,CAAaz0D,kBAE1BmQ,EAAM,QAASE,wBA8Dfy0B,EAAK,CAEJ,CAAA3hC,KAAM,UAGNA,KAAM,SACN8uB,KAAMigC,GACNE,MAAO,gBACP7iC,UAAW,aACXumC,QAAS31B,uBAkBZvnB,EAAA,EAAE+gD,EAAeD,GAAcE,EAAYC,GAAY,CAAKD,sBAE1DE,EAAc,EAEb7nC,KAAM8nC,GACN/5D,KAAM,QACNoyD,MAAO,mBACPn9C,SAAUud,EACVsjC,QAAS0D,WAtBVI,EAAU,CACX3nC,KAAM+nC,GACNh6D,KAAM,UACNoyD,MAAO,+BACP0D,mBA1DI,GAAAmD,GAAe5oD,EAAK,KAChBgJ,EAA6B,MAAlBhJ,EAAMgJ,SAAmBhJ,EAAMgJ,SAAW,EAC3D4/C,EAAYgB,kBAAkB5gD,EAAUA,GACxC4/C,EAAY9+C,iBA0Db0/C,EAAY,CACb5nC,KAAMioC,GACNl6D,KAAM,cACNoyD,MAAO,4BACP0D,2BAnCE91D,EAAOq5D,EAASr5D,IAEZ4yB,GACFA,EAAS5yB,SAEJwd,uBA5BF,SAAald,GACpB6P,EAAM,gBAEA,IAAA9T,EAASiE,EAAM3C,OAA+BtB,MAEhD2D,IAAS3D,IAIbuc,EAAA,EAAA5Y,EAAO3D,GAEHu2B,GACFA,EAAS5yB,wEAkFAi5D,EAAW7+C,stBC3Hb/f,EAAW,YACVA,EAAY,yNAN1B6E,GAQKvB,EAAAisB,EAAAzqB,6CAR2C9E,EAAK,uTAjBxC2F,EAAY6U,EAAZ7U,KACAo5D,EAA+BvkD,EAA/BukD,QACAC,EAAkCxkD,EAAlCwkD,SACAE,EAAuC1kD,EAAvC0kD,QAEHrgD,EAAUhS,GAAoB,gBAA9BgS,uKAEC,SAAYihD,GACnBjhD,IACAqgD,EAAQY,eAIRjhD,m/ECyBUs4C,EAAAn3D,MAAmBqQ,MAAK,GAAG8rD,EAAAn8D,MAAmBsQ,IAAG,4EADzD,sBACiC,0GALczL,GAMvCvB,EAAA2V,EAAAnU,4FADA,GAAAxE,GAAA62D,KAAAA,EAAAn3D,MAAmBqQ,MAAK,KAAAzI,GAAAyxB,EAAA89B,GAAG,GAAA72D,GAAA67D,KAAAA,EAAAn8D,MAAmBsQ,IAAG,KAAA1I,GAAAkuC,EAAAqmB,sFALpDn8D,EAAmB,iBAAxBa,OAAIC,GAAA,kFADgB,eAAOd,EAAU,SAAC,UAAEA,EAAQ,iLALhCA,EAAQ,mBAEbA,EAAI,GAACa,OAAS,oBAL/BgE,GAkBKvB,EAAA6U,EAAArT,GAXHzB,GAUK8U,EAAAN,GATHxU,GAAwDwU,EAAAH,mHAJ5CqoD,wDAIiB//D,EAAU,cAAGA,EAAQ,yBAC3CA,EAAmB,YAAxBa,OAAIC,GAAA,EAAA,iHAAJD,iCANgBb,EAAQ,wBAEbA,EAAI,GAACa,OAAS,wDAZpB,SAAAk/D,GAAgB95D,GAGvBA,EAAMU,mDApBG60B,EAAiChhB,EAAjCghB,gBACAwkC,EAAoBxlD,EAApBwlD,aACAC,EAAazlD,EAAbylD,MACAr7C,EAAcpK,EAAdoK,KACAoG,EAA+BxQ,EAA/BwQ,UACAk1C,EAA2D1lD,EAA3D0lD,gBACAtzD,EAA0B4N,EAA1B5N,gVAER2R,EAAA,GAAA4hD,EAAiB3kC,EAAgBwkC,qBAEjCzhD,EAAA,EAAA4jB,EAAag+B,EAAe7vD,yBAC5B+xB,EAAW7G,EAAgBwkC,EAAe,GAAKxkC,EAAgBwkC,EAAe,GAAG3vD,MAAQ4vD,wBAEzFz3D,EAAWu8B,GAAgBn4B,EAAQwzD,UAAWp1C,EAAWpG,EAAKva,OAAOqe,OAAOyZ,yBAE5Ek+B,E/CfW,SAAuBl+B,EAAoBE,GAEzD,IAAMi+B,EAAW,CACfjwD,MAAO8xB,EACP7xB,IAAK3P,KAAKmkB,IAAI4V,GAAgByH,GAAaE,IAIvCk+B,EAAS5/D,KAAKC,IAAI+5B,IAAoBwH,EAAaE,GAAY,GAAIF,GACnEq+B,EAAW,CACfnwD,MAAOkwD,EACPjwD,IAAK3P,KAAKmkB,IAAI4V,GAAgB6lC,GAASl+B,IAInCo+B,EAAe9lC,GAAmB0H,GAClCq+B,EAAgBD,IAAiBp+B,EAAWo+B,EAAe7/C,GAAqB6/C,EAChFE,EAAW,CACftwD,MAAO1P,KAAKC,IAAI8/D,EAAev+B,GAC/B7xB,IAAK+xB,GAGDpI,EAAW,CAACqmC,GAEZM,EAAeJ,EAASnwD,OAASiwD,EAAShwD,KAAOkwD,EAASlwD,KAAOqwD,EAAStwD,MAUhF,OATIuwD,GACF3mC,EAAS7tB,KAAKo0D,GAGKG,EAAStwD,QAAUuwD,EAAeJ,EAASlwD,IAAMgwD,EAAShwD,MAE7E2pB,EAAS7tB,KAAKu0D,GAGT1mC,CACT,C+CpB2B4mC,CAAuB1+B,EAAYE,0CAqBtC,OAAA69B,EAAgBt7C,EAAMk8C,8oCCDhCC,+IAHLt/C,wBADazhB,EAAQ,qBAH9B6E,GAQQvB,EAAA2V,EAAAnU,wCAHI9E,EAAW,0EAFDA,EAAQ,yJA3BjBwI,EAAiBgS,EAAjBhS,SACAw4D,EAA4BxmD,EAA5BwmD,2HAEF,SAAY/6D,GAEZ,QADHg7D,EAA6Bh7D,EAAM3C,OAChC29D,GAAsC,WAAxBA,EAAW52C,UAC9B42C,EAAaA,EAAWh8D,WAGtBg8D,GACFD,EAAa,CACXl8D,OAAQm8D,EACR7hD,KAAM,EACNF,IAAK,EACLV,MAAOwD,GACPtD,OAAQqD,GACRkO,UAAW,EACXE,WAAY,EACZ+wC,SAAS,w+BCmDRlhE,EAAiB,GAAA,wHAHf4G,GAAA2oB,EAAA,QAAAkW,EAAA1jC,GAAA/B,KAAYA,EAAG,KAAA,oCAHxB6E,GAWKvB,EAAAisB,EAAAzqB,6CAPU9E,EAAoB,0KAD1B0Y,GAAA,EAAApY,GAAAmlC,KAAAA,EAAA1jC,GAAA/B,KAAYA,EAAG,KAAA,yLAVfgC,MAAAhC,EAAQ,GAAAonC,cAAc7d,YAAYvpB,EAAG,0BAElCA,EAAiB,YACjBA,EAAkB,GACpB+lC,OAAA/lC,KAAQ+lC,oGAJT,EAAAzlC,IAAA6gE,EAAAn/D,MAAAhC,EAAQ,GAAAonC,cAAc7d,YAAYvpB,EAAG,KAIpC,EAAAM,IAAA6gE,EAAAp7B,OAAA/lC,KAAQ+lC,+IAYb,MAAA0H,EAAAtjB,GAAiBnqB,EAAO,GAAConC,cAAc7d,YAAYvpB,EAAG,KAAA,2EAAtD,EAAAM,GAAAmtC,KAAAA,EAAAtjB,GAAiBnqB,EAAO,GAAConC,cAAc7d,YAAYvpB,EAAG,KAAA,KAAA4H,GAAAwC,EAAAqjC,sFAFxB9nC,KAAA3F,EAAQ,GAAAonC,cAAc7d,YAAYvpB,EAAG,wHAArC,EAAAM,IAAA8gE,EAAAz7D,KAAA3F,EAAQ,GAAAonC,cAAc7d,YAAYvpB,EAAG,sNAO1C,EAAqBghE,cAAAhhE,KAAQghE,2GAAR,EAAA1gE,IAAA+gE,EAAAL,cAAAhhE,KAAQghE,0MAvBvDhhE,EAAO,GAACm4B,UAAYn4B,EAAY,GAAA,0BAsBhC,IAAAs+D,GAAAt+D,EAAQ,GAAAm4B,UAAYn4B,OAAkBA,EAAY,IAAAmZ,GAAAnZ,wSAAlDA,EAAQ,GAAAm4B,WAAYn4B,MAAkBA,EAAY,8QArE3C4kB,EAAcpK,EAAdoK,KACArd,EAAWiT,EAAXjT,IACAyjB,EAA+BxQ,EAA/BwQ,UACA+hB,EAAyDvyB,EAAzDuyB,kBACAu0B,EAAuD9mD,EAAvD8mD,YAEA10D,EAAwB4N,EAAxB5N,gSAEV2R,EAAA,EAAEgjD,IAAgBv2C,IAAYiW,GAAejW,IAAc8U,GAAQ9U,EAAUpG,KAAMA,0BACjF48C,EAAeD,GAAiBh9B,GAAmBvZ,gBAE7C,SACP/kB,GAEKu7D,GAAiB50D,EAAQurB,WAC5BlyB,EAAMM,iBACNqG,EAAQ06B,SAAStE,GAAmBpe,GAAM,MAIrC,SAAYrd,GACZ,OAAAy9B,GAAW,UAAS,CACzB,YAAqB,KAARz9B,cAIU+gC,EAAgBb,OACnCg6B,EAAaH,EAAY/5D,EAAKqF,EAAQw6B,cAAc1d,cAAc4e,IAClEo5B,EAAcjjC,EAAQ7Z,GAAMva,OAAOo3D,GAEzC70D,EAAQ06B,SACNG,IAAoBnnB,GAA2BwmB,WAC3C/D,GAAqB2+B,GAAa,GAClC1+B,GAAmB0+B,GAAa,IAGlCj6B,IAAoBnnB,GAA2B6mB,MACjDv6B,EAAQkT,oBAKVlT,EAAQ06B,SAAStE,GAAmBpe,GAAM,IAC1ChY,EAAQkT,6QCbF,QAAA6hD,EAAA3hE,KAASwJ,6GAAT,EAAAlJ,GAAAT,GAAA8hE,EAAAA,EAAA3hE,KAASwJ,gMAVT,MAAAm4D,EAAA3hE,KAAS27D,qGAAT,EAAAr7D,GAAAT,GAAA8hE,EAAAA,EAAA3hE,KAAS27D,gIAWmCtsC,EAAA,CAAArvB,KAASwB,OAAjC0X,EAAAlZ,KAASwJ,iGAAe8lB,EAAA3wB,GAAA2wB,EAAArc,GAAAoc,EAAA,CAAAhc,GAAArT,KAASwB,sJAAjC,GAAA,EAAAlB,GAAA4Y,KAAAA,EAAAlZ,KAASwJ,WAAS,+KAAMyJ,GAAAoc,EAAA,CAAAhc,GAAArT,KAASwB,kWAVzDqD,GAMCvB,EAAAisB,EAAAzqB,OADa88D,EAAA3/D,GAAA4/D,EAAA7hE,EAAA,IAAAwG,KAAA,KAAA+oB,EAAAvvB,KAASwB,mCAATqgE,GAAAtiE,GAAAsiE,EAAA3zD,SAAA,EAAA5N,GAAAuhE,EAAA3zD,OAAA1H,KAAA,KAAAxG,KAASwB,2HARtB,MAAA66D,IAAAA,IAAA+B,GAAuBp+D,EAAQ,oEACjB8hE,EAAAtvD,KAASmpD,8bAFvB37D,EAAS,iBAAda,OAAIC,GAAA,0RAACd,EAAS,YAAda,OAAIC,GAAA,EAAA,oHAAJD,OAAIC,EAAAgwB,EAAAjwB,OAAAC,GAAA,mDAAJD,OAAIC,GAAA,2JA5BO8jB,EAAcpK,EAAdoK,KACA5iB,EAAcwY,EAAdxY,MACA4K,EAA0B4N,EAA1B5N,QACA8vB,EAAsBliB,EAAtBkiB,cACA1R,EAA+BxQ,EAA/BwQ,UACA+hB,EAAiDvyB,EAAjDuyB,8SAEVxuB,EAAA,EAAEqwB,EAAY1N,GAAiBlW,IAAcuZ,GAAmBvZ,oBAE9DzM,EAAA,EAAAswB,EAAYjiC,EAAQm1D,cAAa,CAClCn9C,KAAAA,EACA5iB,MAAAA,EACAm2B,SAAUvrB,EAAQurB,SAClBuE,cAAAA,EACAkS,UAAAA,EACAprB,OAAQ5W,EAAQ4W,OAChB4jB,cAAex6B,EAAQw6B,cACvBpc,UAAAA,EACA+hB,kBAAAA,EACA3U,QAASxrB,EAAQwrB,QACjBiP,YAAaz6B,EAAQy6B,YACrBC,SAAU16B,EAAQ06B,SAClBvB,OAAQn5B,EAAQm5B,OAChBwB,eAAgB36B,EAAQ26B,eACxBznB,MAAOlT,EAAQkT,yNC7BNkiD,GAAuB,CAClCC,WAAW,EACXC,gBAAiB,KACjBC,oBAAqB,KACrBC,eAAgB,KAEhBC,UAAU,GCkBN,SAAUC,GAAeC,GAKV,IAJnB56C,EAAI46C,EAAJ56C,KACAkT,EAAa0nC,EAAb1nC,cACA2nC,EAAMD,EAANC,OACA/3B,EAAK83B,EAAL93B,MAEA,IAAK5P,EAAc7P,UACjB,MAAO,CACL6R,gBAAYr8B,EACZiiE,iBAAkB,KAClBh9C,OAAQ,GAIZ,IAAMuF,EAAY6P,EAAc7P,UAC1B03C,EACJF,EAAS,EAuCb,SAAuBG,GAKL,IAJhBh7C,EAAIg7C,EAAJh7C,KACA8iB,EAAKk4B,EAALl4B,MACAzf,EAAS23C,EAAT33C,UACAw3C,EAAMG,EAANH,OAEMI,EAAc5gC,GAAara,EAAMqD,GACjC63C,EAAep4B,EAAMvZ,WAAU,SAAC2C,GAAS,OAAAiM,GAAQjM,EAAKjP,KAAMg+C,EAAY,IAExEE,EAAa,WAAHC,IAAAA,EAAAA,OAAyBA,QAAzBA,EAASt4B,EAAMj3B,EAAQ,cAAEuvD,SAAhBA,EAAkBrkD,MAAM,EAE7ClL,EAAQqvD,EACRG,EAAmB,EAEvB,UAAwBxiE,IAAjBsiE,KAA8BniE,KAAKyP,IAAIoyD,GAAUQ,EAAmBF,IAAe,GACxFE,GAAoBF,IACpBtvD,GAAS,EAGX,IAAMyvD,EAAax4B,EAAMj3B,GAAOoR,KAC1Ba,EAASjS,EAAQqvD,EAEvB,OAAOrvD,IAAUqvD,QAAiCriE,IAAjBiqC,EAAMj3B,GAAuB,CAAEyvD,WAAAA,EAAYx9C,OAAAA,QAAWjlB,CACzF,CA7DQ0iE,CAAe,CAAEv7C,KAAAA,EAAMqD,UAAAA,EAAWw3C,OAAAA,EAAQ/3B,MAAAA,IA+DlD,SAAyB04B,GAKP,IAAAC,EAJhBz7C,EAAIw7C,EAAJx7C,KACA8iB,EAAK04B,EAAL14B,MACAzf,EAASm4C,EAATn4C,UACAw3C,EAAMW,EAANX,OAEMI,EAAc1gC,GAAWva,EAAMqD,GAC/B63C,EAAep4B,EAAMvZ,WAAU,SAAC2C,GAAS,OAAAiM,GAAQjM,EAAKjP,KAAMg+C,EAAY,IAE1EI,EAAmB,EACnBxvD,EAAQqvD,EAENQ,EAAa,eAAHC,EAAA,OAAyB,QAAzBA,EAAS74B,EAAMj3B,EAAQ,UAAE,IAAA8vD,OAAA,EAAhBA,EAAkB5kD,MAAM,EAEjD,UAAwBle,IAAjB6iE,KAA8B1iE,KAAKyP,IAAIoyD,GAAUQ,EAAmBK,IAAe,GACxFL,GAAoBK,IACpB7vD,GAAS,EAGX,IAAMgrB,EAAaC,EAAQmkC,GACrBt2C,EAASuP,EAAMlU,EAAM6W,GACrB/a,EAAUpS,MAAMoS,QAAQ6I,GAExB22C,EAA+BG,QAArBA,EAAG34B,EADChnB,EAAUjQ,EAAQA,EAAQ,UAC3B4vD,IAAkBA,OAAlBA,EAAAA,EAAoBx+C,KACjCa,EAASjS,EAAQqvD,EAEvB,OAAOI,EAAa,CAAEA,WAAAA,EAAYx9C,OAAAA,GAAW,CAAEpiB,QAAQ,EAAMoiB,OAAAA,EAC/D,CAzFQ89C,CAAiB,CAAE57C,KAAAA,EAAMqD,UAAAA,EAAWw3C,OAAAA,EAAQ/3B,MAAAA,IAElD,IAAKi4B,GAAgD,IAA5BA,EAAiBj9C,OACxC,MAAO,CACLoX,gBAAYr8B,EACZiiE,iBAAkB,KAClBh9C,OAAQ,GAIZ,IAAMoX,W7CuYNlV,EACAqD,EACA03C,GAEA,IAAK13C,EACH,MAAO,GAGT,IAAMi4C,EAAa,eAAgBP,EAAmBA,EAA6B,gBAAIliE,EACjF6C,EAAS,WAAYq/D,EAAmBA,EAAyB,YAAIliE,EAErEg+B,EAAaC,EAAQkD,GAAa3W,IAClCsB,EAASuP,EAAMlU,EAAM6W,GAE3B,KACGn7B,GACC4/D,GAAcp/B,GAAeo/B,EAAYzkC,IAAeykC,EAAWpiE,OAAS29B,EAAW39B,QAEzF,MAAO,GAGT,IAAMkhC,EAAYC,GAAara,EAAMqD,GAC/BiX,EAAUC,GAAWva,EAAMqD,GAC3Bw4C,EAAW7kC,GAAKoD,GAChB0hC,EAAS9kC,GAAKsD,GACdyhC,EAA4BT,EAAaA,EAAWzkC,EAAW39B,aAAUL,EAE/E,IAAIi9B,EAAanR,GAuBNoR,IAAAA,EAAYpR,GAAS,CAE9B,IAAM6V,EAAa7f,GAAIkhD,GACjBnhC,EAAW/f,GAAImhD,GACfE,OAAoBnjE,IAAVkjE,EAAsBphD,GAAIohD,GAASp3C,EAAOzrB,OAG1D,OAES+iE,GAJKvhC,EAAWF,EAAa,EAElCwhC,EAAUxhC,EAEQ,SAAC1c,GACnB,MAAO,CACL4S,GAAI,OACJ/mB,KAAMuT,EAAmB2Z,EAAWn0B,OAAOqe,OAAOyZ,EAAa1c,KAC/Db,KAAMC,EAAmB2Z,EAAWn0B,OAAOqe,OAAOi7C,EAAUl+C,KAEhE,EAGoB,WAClB,MAAO,CACL4S,GAAI,OACJ/mB,KAAMuT,EAAmB2Z,EAAWn0B,OAAOqe,OAAOyZ,KAClDvd,KAAMC,EAAmB2Z,EAAWn0B,OAAOqe,OAAOi7C,KAEtD,EAEH,CACC,MAAU,IAAA33D,MAAM,mEACjB,CAlDC,IAAMrK,EAAOzC,OAAOyC,KAAK2qB,GACnB6V,EAAaxgC,EAAK+F,QAAQ87D,GAC1BnhC,EAAW1gC,EAAK+F,QAAQ+7D,GACxBE,EAAUtgE,EAAS1B,EAAKd,YAAmBL,IAAVkjE,EAAsB/hE,EAAK+F,QAAQg8D,IAAU,EAEpF,OAAoB,IAAhBvhC,IAAmC,IAAdE,IAAgC,IAAbshC,EACtCA,EAAUxhC,EAIL,GAAA93B,OAAA4J,EAAItS,EAAKvB,MAAM+hC,EAAYE,EAAW,IAAEpuB,EAAKtS,EAAKvB,MAAMujE,EAAShiE,EAAKd,UAASkT,KACpF,SAACxM,GAAG,OAAK4gC,GAAS3J,EAAYj3B,EAC/B,IAKM,GAAA8C,OAAA4J,EAAItS,EAAKvB,MAAMujE,EAASxhC,IAAWluB,EAAKtS,EAAKvB,MAAMiiC,EAAW,EAAG1gC,EAAKd,UAASkT,KACpF,SAACxM,UAAQ4gC,GAAS3J,EAAYj3B,EAC/B,IAiCA,EACT,C6CxdqBs8D,CAAiBl8C,EAAMqD,EAAW03C,GAE/C99C,EAAO6Z,EAAQuD,GAAara,EAAMqD,IAClChpB,EAAQ65B,EAAMlU,EAAM/C,GAC1B,GAAIvT,MAAMoS,QAAQzhB,GAAQ,CACxB,IAAMygE,EAmFV,SAAoCqB,GAKPC,IAAAA,EAAAC,EAJ3Bv5B,EAAKq5B,EAALr5B,MACA9iB,EAAIm8C,EAAJn8C,KACAqD,EAAS84C,EAAT94C,UACAvF,EAAMq+C,EAANr+C,OAEMsc,EAAYC,GAAara,EAAMqD,GAC/BiX,EAAUC,GAAWva,EAAMqD,GAE3BmX,EAAasI,EAAMvZ,WAAU,SAAC2C,GAAI,OAAKiM,GAAQjM,EAAKjP,KAAMmd,EAAU,IACpEM,EAAWoI,EAAMvZ,WAAU,SAAC2C,GAAS,OAAAiM,GAAQjM,EAAKjP,KAAMqd,EAAQ,IAEhEX,EAAuCyiC,QAA7BA,EAAGt5B,EAAMtI,EAAa1c,UAAnBs+C,IAA0BA,OAA1BA,EAAAA,EAA4Bn/C,KACzCyc,EAAoC,QAA3B2iC,EAAGv5B,EAAMpI,EAAW5c,UAAO,IAAAu+C,OAAA,EAAxBA,EAA0Bp/C,KAE5C,OAAOkd,GAAqBR,EAAYD,EAC1C,CAnG6B4iC,CAA4B,CACnDx5B,MAAAA,EACA9iB,KAAAA,EACAqD,UAAAA,EACAvF,OAAQi9C,EAAiBj9C,SAG3B,MAAO,CACLoX,WAAAA,EACA4lC,iBAAAA,EACAh9C,OAAQi9C,EAAiBj9C,OAE5B,CAEC,MAAO,CACLoX,WAAAA,EACA4lC,iBAAkB,KAClBh9C,OAAQi9C,EAAiBj9C,OAG/B,CCvDgB,SAAAy+C,GACdnwD,EACAsnB,GAEA,OAxBc,SACdtnB,EACAvI,GAEA,GAAKuI,EAAL,CAMA,IAFA,IAAMmrB,EAAiC,CAAA,EAEvCilC,EAAA,EAAAC,EAAgBllE,OAAOyC,KAAKoS,GAAIowD,EAAAC,EAAAvjE,OAAAsjE,IAAE,CAA7B,IAAM9iE,EAAC+iE,EAAAD,GACN34D,EAAOnK,EAAG0S,EAAI1S,MAChB69B,EAAY79B,GAAK0S,EAAI1S,GAExB,CAED,OAAOnC,OAAOyC,KAAKu9B,GAAar+B,OAAS,EAAIq+B,OAAc1+B,CAV1D,CAWH,CAOS6jE,CAAqBtwD,GAAK,SAAC1S,GAAM,OAAA49B,EAAsB59B,EAAGg6B,EAAQ,GAC3E,i0CCLcwgC,2EAJWj1D,GAAAqS,EAAA,QAAAF,EAAA,kBAAA/Y,KAAgBk6D,SAAQ,oCAFjDr1D,GAOQvB,EAAA2V,EAAAnU,qDAJIvF,GAAAS,OAAAA,EAAQ,GAAAgU,MAAAvN,KAAAwC,qCACHtD,KAAA3F,EAAI,IAAKA,EAAoB,oDAFrB0Y,GAAA,EAAApY,GAAAyY,KAAAA,EAAA,kBAAA/Y,KAAgBk6D,SAAQ,iFAEhCv0D,KAAA3F,EAAI,IAAKA,EAAoB,8JAftCyuC,EAAuB5hC,GAAiC,kBAEnD6vD,EAAwDliD,EAAxDkiD,gBACA4H,EAAqC9pD,EAArC8pD,4JAEV/lD,EAAA,EAAE5Y,EACDs4D,GAAwBvB,IAAoBA,EAAgBwB,aACxD,wBACAxB,EAAgBz1C,6sbC62BVjnB,EAAO,GAACm4B,UAAYn4B,EAAc,KAAIA,EAAc,KAAAkhC,GAAiBlhC,EAAc,KAAAmhC,GAAiBnhC,EAAS,OAAOukC,GAAmBvkC,EAAS,KAAK8/B,GAAQ6B,GAAa3hC,EAAS,IAAGA,EAAI,6CAX1LA,EAAI,KAAAukE,2CAMO7nC,cAAA18B,QAAiB,YACrBA,EAAc,IAAGA,EAAS,GAAG,uBACrBstC,GAAyBttC,EAAoB,GAAEA,EAAO,qCASxEA,EAAe,KAAAwkE,GAAAxkE,MAGdA,EAAI,KAAAykE,GAAAzkE,8PAvBZ6E,GA+BKvB,EAAAuU,EAAA/S,GA9BHzB,GAkBKwU,EAAAH,+NAhBG1X,EAAI,wGAMO,KAAAM,EAAA,KAAAokE,EAAAhoC,cAAA18B,QAAiB,4BACrBA,EAAc,IAAGA,EAAS,GAAG,qCACrBstC,GAAyBttC,EAAoB,GAAEA,EAAO,0DAGrEA,EAAO,GAACm4B,UAAYn4B,EAAc,KAAIA,EAAc,KAAAkhC,GAAiBlhC,EAAc,KAAAmhC,GAAiBnhC,EAAS,OAAOukC,GAAmBvkC,EAAS,KAAK8/B,GAAQ6B,GAAa3hC,EAAS,IAAGA,EAAI,0HAM7LA,EAAe,oHAGdA,EAAI,mUA1GFA,EAAO,GAACm4B,UAAYn4B,EAAc,KAAIA,EAAc,KAAAkhC,GAAiBlhC,EAAc,KAAAmhC,GAAiBnhC,EAAS,OAAOukC,GAAmBvkC,EAAS,KAAK8/B,GAAQ6B,GAAa3hC,EAAS,IAAGA,EAAI,0CAxBzLA,EAAQ,2EAOTA,EAAI,KAAA2kE,4BAKD3kE,EAAQ,IAAA4kE,mCAkBdC,EAAA7kE,EAAqB,OAAAA,EAAa,MAAAA,MAAgBk+D,eAAY4G,GAAA9kE,0BAG9DA,EAAQ,IAAA+kE,GAOF/kE,EAAI,WAAAglE,0BASZhlE,EAAQ,KAAAinD,GAAAjnD,4kBAzDb6E,GAwDKvB,EAAAgV,EAAAxT,GAvDHzB,GAoCKiV,EAAAH,GAnCH9U,GAWQ8U,EAAAc,wEAKR5V,GAaK8U,EAAAN,GAZHxU,GAWKwU,EAAAH,4IAzBK1X,EAAY,4NAUlBA,EAAI,kIAiBJA,EAAO,GAACm4B,UAAYn4B,EAAc,KAAIA,EAAc,KAAAkhC,GAAiBlhC,EAAc,KAAAmhC,GAAiBnhC,EAAS,OAAOukC,GAAmBvkC,EAAS,KAAK8/B,GAAQ6B,GAAa3hC,EAAS,IAAGA,EAAI,2HAM7LA,EAAqB,KAAAA,EAAa,KAAAA,MAAgBk+D,mMAmBpDl+D,EAAQ,6ZAlJHA,EAAO,GAACm4B,UAAYn4B,EAAc,KAAIA,EAAc,KAAAkhC,GAAiBlhC,EAAc,KAAAmhC,GAAiBnhC,EAAS,OAAOukC,GAAmBvkC,EAAS,KAAK8/B,GAAQ6B,GAAa3hC,EAAS,IAAGA,EAAI,0CA7BzLA,EAAQ,IAAA,uEAOTA,EAAI,KAAAilE,4BAKDjlE,EAAQ,IAAAmnD,mCAuBd0d,EAAA7kE,EAAqB,OAAAA,EAAa,MAAAA,MAAgBk+D,eAAYjW,GAAAjoD,0BAG9DA,EAAQ,IAAA+nD,0BAgBV/nD,EAAQ,KAAAooD,GAAApoD,wkBA9Db6E,GA6DKvB,EAAAgV,EAAAxT,GA5DHzB,GAyCKiV,EAAAH,GAxCH9U,GAWQ8U,EAAAc,wEAKR5V,GAkBK8U,EAAAN,GAjBHxU,GAgBKwU,EAAAH,yIA9BK1X,EAAY,4NAUlBA,EAAI,kIAsBJA,EAAO,GAACm4B,UAAYn4B,EAAc,KAAIA,EAAc,KAAAkhC,GAAiBlhC,EAAc,KAAAmhC,GAAiBnhC,EAAS,OAAOukC,GAAmBvkC,EAAS,KAAK8/B,GAAQ6B,GAAa3hC,EAAS,IAAGA,EAAI,2HAM7LA,EAAqB,KAAAA,EAAa,KAAAA,MAAgBk+D,6LAmBpDl+D,EAAQ,oeAuLP6E,GAAiCvB,EAAAisB,EAAAzqB,wFAYD,EAAqBk8D,cAAAhhE,KAAQghE,4IAD7Dn8D,GAEKvB,EAAAisB,EAAAzqB,+CADgD,IAAAxE,EAAA,KAAA+gE,EAAAL,cAAAhhE,KAAQghE,4NAKdhhE,EAAY,6cAG7D6E,GAKCvB,EAAAisB,EAAAzqB,sBADW9E,EAAiB,uGApIbklE,wOAFAnE,wTAOdl8D,GAAiCvB,EAAAisB,EAAAzqB,oEAS1BqgE,EAAAjmE,OAAOyC,KAAK3B,MAAOa,OAAM,GACzBukE,EAA8B,IAA9BlmE,OAAOyC,KAAK3B,EAAO,IAAAa,OAAe,OAAS,6SAH9CgE,GAAsCvB,EAAAoU,EAAA5S,aACtCD,GAGQvB,EAAA2V,EAAAnU,qCACRD,GAAsCvB,EAAAuU,EAAA/S,sBAJU9E,EAAY,4BACzD,EAAAM,EAAA,IAAA6kE,KAAAA,EAAAjmE,OAAOyC,KAAK3B,MAAOa,OAAM,KAAA+G,GAAA4xB,EAAA2rC,GACzB,EAAA7kE,EAAA,IAAA8kE,KAAAA,EAA8B,IAA9BlmE,OAAOyC,KAAK3B,EAAO,IAAAa,OAAe,OAAS,UAAO+G,GAAAmuC,EAAAqvB,+MALrDvgE,GAAmDvB,EAAAisB,EAAAzqB,6FAavB,EAAqBk8D,cAAAhhE,KAAQghE,4IAD7Dn8D,GAEKvB,EAAAisB,EAAAzqB,+CADgD,IAAAxE,EAAA,KAAA+gE,EAAAL,cAAAhhE,KAAQghE,4NAKdhhE,EAAY,6cAU7D6E,GAKCvB,EAAAisB,EAAAzqB,sBADW9E,EAAiB,mQAX7B6E,GAKCvB,EAAAisB,EAAAzqB,sBADW9E,EAAkB,2FAaxBA,EAAO,GAACm4B,WAAan4B,EAAK,MAAK0hB,IAAwB1hB,EAAc,KAAIghC,GAAkBhhC,EAAS,gBAenGqlE,EAAAl0D,GAAAnR,MAASA,EAAI,GAAEA,EAAK,GAAEA,EAAa,GAAAA,EAAkB,GAAAA,KAAoBA,EAAmB,GAAEA,EAAsB,GAAAA,KAAWA,EAAQ,mBAA5Ia,OAAIC,GAAA,uFA8BAd,EAAI,KAAAslE,GAAAtlE,0XA9CZ6E,GAyCKvB,EAAAoU,EAAA5S,qFACLD,GAYKvB,EAAAgV,EAAAxT,GAXHzB,GAEKiV,EAAAH,mEA5CCnY,EAAO,GAACm4B,WAAan4B,EAAK,MAAK0hB,IAAwB1hB,EAAc,KAAIghC,GAAkBhhC,EAAS,iJAenGqlE,EAAAl0D,GAAAnR,MAASA,EAAI,GAAEA,EAAK,GAAEA,EAAa,GAAAA,EAAkB,GAAAA,KAAoBA,EAAmB,GAAEA,EAAsB,GAAAA,KAAWA,EAAQ,cAA5Ia,OAAIC,GAAA,EAAA,4GAAJD,OAAIC,EAAAgwB,EAAAjwB,OAAAC,GAAA,YA8BAd,EAAI,0GA9BRa,OAAIC,GAAA,gOALUd,EAAc,KAAIghC,GAAkBhhC,EAAS,kBACxCA,EAAiC,0KAJ3CwhB,IAJY9Y,GAAA6mB,EAAA,cAAAvvB,QAAU0hB,wBACT1hB,EAAc,KAAIghC,GAAkBhhC,EAAS,oBAElDA,EAAI,GAACa,OAAS,oBAL/BgE,GAYKvB,EAAAisB,EAAAzqB,uEAHS9E,EAAc,KAAIghC,GAAkBhhC,EAAS,gCAPtC0I,GAAA6mB,EAAA,cAAAvvB,QAAU0hB,0CACT1hB,EAAc,KAAIghC,GAAkBhhC,EAAS,4BAElDA,EAAI,GAACa,OAAS,2KAwBnB+jB,KAAA5kB,MAAK4kB,KACNrd,IAAAvH,MAAKuH,IACCyjB,UAAAhrB,MAAKgrB,UACG+hB,kBAAA/sC,MAAKulE,iDAEXvlE,EAAe,kJAPhC6E,GASKvB,EAAAisB,EAAAzqB,uDAPK,KAAAxE,EAAA,KAAAklE,EAAA5gD,KAAA5kB,MAAK4kB,MACN,KAAAtkB,EAAA,KAAAklE,EAAAj+D,IAAAvH,MAAKuH,KACC,KAAAjH,EAAA,KAAAklE,EAAAx6C,UAAAhrB,MAAKgrB,WACG,KAAA1qB,EAAA,KAAAklE,EAAAz4B,kBAAA/sC,MAAKulE,kOAhBrBvjE,MAAAhC,MAAKgC,MACN4iB,KAAA5kB,MAAK4kB,KACEkW,YAAA96B,MAAK86B,YACAC,iBAAA/6B,MAAK+6B,iBACHC,mBAAAh7B,MAAKg7B,mBACJyqC,oBAAAzlE,MAAKylE,oBACJC,qBAAA1lE,MAAK2lE,0BAChB36C,UAAAhrB,MAAKgrB,4CAEMhrB,EAAwB,2IATvC,KAAAM,EAAA,KAAAslE,EAAA5jE,MAAAhC,MAAKgC,OACN,KAAA1B,EAAA,KAAAslE,EAAAhhD,KAAA5kB,MAAK4kB,MACE,KAAAtkB,EAAA,KAAAslE,EAAA9qC,YAAA96B,MAAK86B,aACA,KAAAx6B,EAAA,KAAAslE,EAAA7qC,iBAAA/6B,MAAK+6B,kBACH,KAAAz6B,EAAA,KAAAslE,EAAA5qC,mBAAAh7B,MAAKg7B,oBACJ,KAAA16B,EAAA,KAAAslE,EAAAH,oBAAAzlE,MAAKylE,qBACJ,KAAAnlE,EAAA,KAAAslE,EAAAF,qBAAA1lE,MAAK2lE,2BAChB,KAAArlE,EAAA,KAAAslE,EAAA56C,UAAAhrB,MAAKgrB,0ZAsBlBnmB,GAKCvB,EAAAisB,EAAAzqB,sBADW9E,EAAiB,uGAhOfklE,wOAFAnE,wTAOdl8D,GAAiCvB,EAAAisB,EAAAzqB,oEAc1BqgE,EAAAnlE,KAAMa,OAAM,GACZukE,EAAiB,IAAjBplE,KAAMa,OAAe,OAAS,6SAHjCgE,GAA+BvB,EAAAoU,EAAA5S,aAC/BD,GAGQvB,EAAA2V,EAAAnU,qCACRD,GAA+BvB,EAAAuU,EAAA/S,sBAJiB9E,EAAY,4BACzD,EAAAM,EAAA,IAAA6kE,KAAAA,EAAAnlE,KAAMa,OAAM,KAAA+G,GAAA4xB,EAAA2rC,GACZ,EAAA7kE,EAAA,IAAA8kE,KAAAA,EAAiB,IAAjBplE,KAAMa,OAAe,OAAS,UAAO+G,GAAAmuC,EAAAqvB,iGARrCD,EAAAnlE,KAAMa,OAAM,GACZukE,EAAiB,IAAjBplE,KAAMa,OAAe,OAAS,0GAC3B,mIAJNgE,GAA+BvB,EAAAisB,EAAAzqB,aAC/BD,GAGMvB,EAAAkqC,EAAA1oC,sDAFH,EAAAxE,EAAA,IAAA6kE,KAAAA,EAAAnlE,KAAMa,OAAM,KAAA+G,GAAA4xB,EAAA2rC,GACZ,EAAA7kE,EAAA,IAAA8kE,KAAAA,EAAiB,IAAjBplE,KAAMa,OAAe,OAAS,UAAO+G,GAAAmuC,EAAAqvB,4GAeZ,EAAqBpE,cAAAhhE,KAAQghE,4IAD7Dn8D,GAEKvB,EAAAisB,EAAAzqB,+CADgD,IAAAxE,EAAA,KAAA+gE,EAAAL,cAAAhhE,KAAQghE,4NAKdhhE,EAAY,6cAU7D6E,GAKCvB,EAAAisB,EAAAzqB,sBADW9E,EAAiB,mQAX7B6E,GAKCvB,EAAAisB,EAAAzqB,sBADW9E,EAAkB,2FAaxBA,EAAO,GAACm4B,WAAan4B,EAAK,MAAK0hB,IAAwB1hB,EAAc,KAAIghC,GAAkBhhC,EAAS,+BAenGm2B,EAAAhlB,GAAAnR,OAAmB+gB,yBAA0D/gB,EAAY,GAAA,UAA9Fa,OAAIC,GAAA,EAAA,qDAoCAd,EAAI,KAAAmoD,GAAAnoD,4XApDZ6E,GA+CKvB,EAAAoU,EAAA5S,qFACLD,GAYKvB,EAAA6U,EAAArT,GAXHzB,GAEK8U,EAAAN,gEAlDC7X,EAAO,GAACm4B,WAAan4B,EAAK,MAAK0hB,IAAwB1hB,EAAc,KAAIghC,GAAkBhhC,EAAS,wIAenGm2B,EAAAhlB,GAAAnR,OAAmB+gB,mDAoCpB/gB,EAAI,0GApCRa,OAAIC,GAAA,yOALUd,EAAc,KAAIghC,GAAkBhhC,EAAS,kBACxCA,EAAiC,0KAJ3CwhB,IAJY9Y,GAAA6mB,EAAA,cAAAvvB,QAAU0hB,wBACT1hB,EAAc,KAAIghC,GAAkBhhC,EAAS,oBAElDA,EAAI,GAACa,OAAS,oBAL/BgE,GAYKvB,EAAAisB,EAAAzqB,uEAHS9E,EAAc,KAAIghC,GAAkBhhC,EAAS,gCAPtC0I,GAAA6mB,EAAA,cAAAvvB,QAAU0hB,0CACT1hB,EAAc,KAAIghC,GAAkBhhC,EAAS,4BAElDA,EAAI,GAACa,OAAS,iJAwBD4sC,EAAAztC,MAAKwT,MAAK,uLADpC3O,GAEKvB,EAAAuU,EAAA/S,GADHzB,GAAwCwU,EAAAH,4BAAhB,MAAApX,EAAA,IAAAmtC,KAAAA,EAAAztC,MAAKwT,MAAK,KAAA5L,GAAAwC,EAAAqjC,gFAZ7BzrC,MAAAhC,MAAKgC,MACN4iB,KAAA5kB,MAAK4kB,KACEkW,YAAA96B,MAAK86B,YACAC,iBAAA/6B,MAAK+6B,iBACHC,mBAAAh7B,MAAKg7B,mBACJyqC,oBAAAzlE,MAAKylE,oBACJC,qBAAA1lE,MAAK0lE,qBAChB16C,UAAAhrB,MAAKgrB,4CAEMhrB,EAAwB,8LATvC,MAAAM,EAAA,KAAAslE,EAAA5jE,MAAAhC,MAAKgC,OACN,MAAA1B,EAAA,KAAAslE,EAAAhhD,KAAA5kB,MAAK4kB,MACE,MAAAtkB,EAAA,KAAAslE,EAAA9qC,YAAA96B,MAAK86B,aACA,MAAAx6B,EAAA,KAAAslE,EAAA7qC,iBAAA/6B,MAAK+6B,kBACH,MAAAz6B,EAAA,KAAAslE,EAAA5qC,mBAAAh7B,MAAKg7B,oBACJ,MAAA16B,EAAA,KAAAslE,EAAAH,oBAAAzlE,MAAKylE,qBACJ,MAAAnlE,EAAA,KAAAslE,EAAAF,qBAAA1lE,MAAK0lE,sBAChB,MAAAplE,EAAA,KAAAslE,EAAA56C,UAAAhrB,MAAKgrB,qQAWCwQ,gBAAAx7B,OAAmB+gB,sBAE7Bk/C,MAAAjgE,KAAMa,iBAEIq/D,gBAAAlgE,KAAQkgE,yIAJR,MAAA5/D,EAAA,KAAAulE,EAAArqC,gBAAAx7B,OAAmB+gB,uCAE7B,EAAAzgB,EAAA,KAAAulE,EAAA5F,MAAAjgE,KAAMa,8BAEI,IAAAP,EAAA,KAAAulE,EAAA3F,gBAAAlgE,KAAQkgE,iPAxBtBjqC,EAAA9kB,GAAAnR,MAASA,EAAI,GAAEA,EAAO,GAAAA,MAAgBA,EAAW,GAAEA,EAAkB,GAAAA,KAAoBA,EAAmB,GAAEA,EAAsB,GAAAA,KAAWA,EAAQ,MAAW4R,EAAA,SAAA5R,UAAAA,MAAKwT,KAAK,UAAjL3S,OAAIC,GAAA,EAAA,8CAkBD,IAAAyW,EAAAvX,EAAe,IAAAsQ,IAAMtQ,KAAMa,QAAMqnD,GAAAloD,2QAlB/Bi2B,EAAA9kB,GAAAnR,MAASA,EAAI,GAAEA,EAAO,GAAAA,MAAgBA,EAAW,GAAEA,EAAkB,GAAAA,KAAoBA,EAAmB,GAAEA,EAAsB,GAAAA,KAAWA,EAAQ,6DAkBzJA,EAAe,IAAAsQ,IAAMtQ,KAAMa,wKAlB9BA,OAAIC,GAAA,4XAoCN+D,GAKCvB,EAAAisB,EAAAzqB,sBADW9E,EAAiB,6GAmKrBA,EAAc,KAAI+gC,GAAiB/gC,EAAS,kBACvCA,EAAgC,wKAJ1CwhB,IAHY9Y,GAAA6mB,EAAA,cAAAvvB,QAAU2hB,wBACT3hB,EAAc,KAAI+gC,GAAiB/gC,EAAS,sBAHlE6E,GAWKvB,EAAAisB,EAAAzqB,uEAHS9E,EAAc,KAAI+gC,GAAiB/gC,EAAS,gCANrC0I,GAAA6mB,EAAA,cAAAvvB,QAAU2hB,0CACT3hB,EAAc,KAAI+gC,GAAiB/gC,EAAS,sKAJ9DA,EAAO,GAACm4B,WAAan4B,EAAK,MAAK2hB,IAAuB3hB,EAAc,KAAI+gC,GAAiB/gC,EAAS,8FAnRnGqR,MAAMoS,QAAQzjB,EAAK,UA8Hd,MAAAw+D,IAAAA,IAAA77C,GAAS3iB,EAAK,6JAnJjB4G,GAAA2oB,EAAA,QAAAkW,EAAA1jC,GAAAijC,GACL,gBACE,CAAA,eAAgBhlC,EAClB,KAAAA,EAAQ,GAAA8lE,YAAY9lE,KAAMA,EAAK,MAAA,kBAEtB4G,GAAA2oB,EAAA,YAAAw2C,EAAA55C,GAAensB,EAAI,0BACfA,EAAc,qBAEbA,EAAI,yBACAA,EAAc,KAAImhC,GAAiBnhC,EAAS,6BACxCA,EAAc,KAAIihC,GAAejhC,EAAS,+BACxCA,EAAc,KAAIkhC,GAAiBlhC,EAAS,KAClD0I,GAAA6mB,EAAA,eAAAvvB,KAAQm4B,UACTzvB,GAAA6mB,EAAA,cAAAvvB,QAAU4hB,IANd7Z,GAAAwnB,EAAA,UAAAvvB,KAAKa,yBAVtBgE,GAyTKvB,EAAAisB,EAAAzqB,sEAxSW9E,EAAe,sBACfA,EAAe,sBACfA,EAAe,qBAChBA,EAAc,uBACjBQ,oBACDA,uLAqRHR,EAAO,GAACm4B,WAAan4B,EAAK,MAAK2hB,IAAuB3hB,EAAc,KAAI+gC,GAAiB/gC,EAAS,6HAxSjG0Y,GAAA,KAAApY,EAAA,IAAAmlC,KAAAA,EAAA1jC,GAAAijC,GACL,gBACE,CAAA,eAAgBhlC,EAClB,KAAAA,EAAQ,GAAA8lE,YAAY9lE,KAAMA,EAAK,MAAA,sCAEtB0Y,GAAA,EAAApY,EAAA,IAAAylE,KAAAA,EAAA55C,GAAensB,EAAI,kEACfA,EAAc,wCAEbA,EAAI,2CACAA,EAAc,KAAImhC,GAAiBnhC,EAAS,+CACxCA,EAAc,KAAIihC,GAAejhC,EAAS,iDACxCA,EAAc,KAAIkhC,GAAiBlhC,EAAS,sBAClD0I,GAAA6mB,EAAA,eAAAvvB,KAAQm4B,2BACTzvB,GAAA6mB,EAAA,cAAAvvB,QAAU4hB,YANd7Z,GAAAwnB,EAAA,UAAAvvB,KAAKa,6JA7gBhBw6B,EAGAkhC,EAGA7/B,EAGAlB,EAGAkhC,EAGAsJ,4CAtCOhkE,EAAcwY,EAAdxY,MACA4iB,EAAcpK,EAAdoK,KACAkW,EAAgDtgB,EAAhDsgB,YACAC,EAAqDvgB,EAArDugB,iBACAC,EAAgExgB,EAAhEwgB,mBACAyqC,EAAsEjrD,EAAtEirD,oBACAC,EAA4ElrD,EAA5EkrD,qBACA16C,EAA+BxQ,EAA/BwQ,UACApe,EAAwB4N,EAAxB5N,QACAq5D,EAEFzrD,EAFEyrD,qBAILnwD,EAAQH,GAAY,uBAEtBk7C,OAA4BrwD,EAC5B0lE,OAAiC1lE,EACjC6hE,OAAsC7hE,EAIpC2lE,EhEuECC,GAAQ,SAACxhD,UAASA,IAAMwM,IgE6KtB,SAAAi1C,EAAsBpgE,GAC7B2G,EAAQ05D,OAAOrgE,GAGR,SAAAsgE,EAAoBtgE,GACvB+7D,GAAUC,YACZD,GAAUC,WAAY,EAEtBh8D,EAAMU,mBAGRiG,EAAQ45D,YAERpiE,SAASiC,oBAAoB,YAAaggE,GAAuB,GACjEjiE,SAASiC,oBAAoB,UAAWkgE,YAGjCE,IAAc,IAAAC,EACd,OAAmB,QAAnBA,EAAA95D,EAAQ+5D,YAAW,WAAA,IAAAD,GAA+BA,QAA/BA,EAAnBA,EAAyBv5C,+BAAzBu5C,IAAkDA,OAAlDA,EAAAA,EAAkDxnD,MAAO,WAGzD0nD,EAAgBvE,EAAyBp8D,GAE1C,IACA4gE,EADaJ,IACgBpE,EAASyE,kBAKrC,OAFc7gE,EAAM8gE,QAAU1E,EAAS2E,eAExBH,EA4Df,SAAAI,EAAoBhhE,MACvBo8D,EAAQ,KACJ16C,EAAO/a,EAAQwzD,UACjB,QAAS5/D,IAATmnB,aAGEkT,EAAgBjuB,EAAQs6D,mBAExB1E,EAASoE,EAAgBvE,EAAUp8D,GACjCwf,EAAW68C,GAAe,CAChC36C,KAAAA,EACAkT,cAAAA,EACA2nC,OAAAA,EACA/3B,MAAO43B,EAAS53B,QAJVhlB,OAOJA,IAAW48C,EAAS58C,SACtB3P,EAAM,iBAAkB2P,EAAQ+8C,GAEhCjkD,EAAA,GAAA8jD,EAAQhpD,EAAAA,EAAA,CAAA,EACHgpD,GAAQ,CAAA,EAAA,CACX58C,OAAAA,EACA0hD,cAAc,OAMb,SAAAC,EAAuBnhE,MAC1Bo8D,EAAQ,KACJ16C,EAAO/a,EAAQwzD,UACjB,QAAS5/D,IAATmnB,eAKqC26C,GAAe,CACtD36C,KAAAA,EACAkT,cAJoBjuB,EAAQs6D,mBAK5B1E,OAJaoE,EAAgBvE,EAAUp8D,GAKvCwkC,MAAO43B,EAAS53B,QAJV5N,EAAUwqC,EAAVxqC,WAAY4lC,EAAgB4E,EAAhB5E,oBAOhB5lC,EACFjwB,EAAQwrB,QAAQyE,GAAa,SAAAnI,EAAGiT,GAAY,MAAA,CAC1CnqB,MAAKnE,EAAAA,EAAA,CAAA,EACAsuB,GAAY,CAAA,EAAA,CACf3c,UAAWy3C,GAAoBz3C,gBAM/B/kB,EAAM3C,SAAW++D,EAASiF,gBAAkBjF,EAAS8E,aAAY,CAC7D,IAAAtiC,EAAgB9Y,GAA2B9lB,EAAM3C,QACjDshB,EAAOyH,GAAsBpmB,EAAM3C,QACrCshB,GACFhY,EAAQ06B,SAAS1C,GAAkBjd,EAAMkd,EAAejgB,IAK9DrG,EAAA,GAAA8jD,OAAW7hE,GACXwhE,GAAUK,UAAW,EAErBj+D,SAASiC,oBAAoB,YAAa4gE,GAAqB,GAC/D7iE,SAASiC,oBAAoB,UAAW+gE,giBA5YzC7oD,EAAA,EAAA8c,EAAUxW,EAAmBD,uBAG/BrG,EAAA,GAAEg+C,IAAWzhC,IAAuC,IAAzBA,EAAYO,uBAGrC9c,EAAA,GAAAme,EAAgBsD,GAAiBh+B,EAAO+4B,EAAkBM,EAASzuB,EAAQ4W,4BAG7EjF,EAAA,GAAEid,EAAkBR,EAAqBA,EAAmBK,QAAW76B,sBAGvE+d,EAAA,GAAEm+C,EAAkB+I,EAAsBA,EAAoBpqC,QAAW76B,sBAGzE+d,EAAA,GAAEynD,EAAiBjhC,GAAgBn4B,EAAQwzD,UAAWp1C,EAAWpG,0BAE/DvgB,EAAuB,IAAhBugB,EAAK/jB,uDAIb+jB,EACAS,EACAyV,EACAC,EACAC,EACAyqC,EACAC,EACA16C,EACAq3C,OAEI7gE,EAAQtC,OAAOyC,KAAK0jB,GAAQtR,KAAK,SAAAxM,GAC7B,IAAAggE,EAAUpB,EAAYvhD,EAAKva,OAAO9C,IAClCigE,EAAaC,EAAoBpsC,EAAS9zB,UAE9CA,IAAAA,EACAvF,MAAOqjB,EAAO9d,GACdqd,KAAM2iD,EACNzsC,YAAaopC,GAAyBppC,EAAa0sC,GACnDzsC,iBAAkBmpC,GAAyBnpC,EAAkBysC,GAC7DxsC,mBAAoBkpC,GAAyBlpC,EAAoBwsC,GACjE/B,oBAAqBvB,GAAyBuB,EAAqB+B,GACnEjC,wBAAyBn4B,GAAuBs4B,EAAsB8B,GACtE7B,0BAA2BzB,GAAyBwB,EAAsB8B,GAC1Ex8C,UAAW8Z,GAAuBl4B,EAAQwzD,UAAWp1C,EAAWu8C,cAKhElF,GAAgC,IAApBA,EAAS58C,SACvBjkB,EAAQ+jB,GACN/jB,EACA6gE,EAASqF,oBACTrF,EAASsF,oBACTtF,EAAS58C,SAINjkB,YAKPojB,EACAL,EACA47C,EACArlC,EACAC,EACAC,EACAyqC,EACAC,EACA16C,EACAq3C,GAMS,QAJHhyD,EAAQ8vD,EAAe9vD,MACvBC,EAAM3P,KAAKmkB,IAAIq7C,EAAe7vD,IAAKiU,EAAM1jB,QAC3C4pC,EAAK,GAEAj3B,EAAQnD,EAAOmD,EAAQlD,EAAKkD,IAAK,KAClCmsB,EAAWwmC,EAAYvhD,EAAKva,OAAOqe,OAAOlV,KAC1CwrB,EAAcyoC,EAAoBpsC,EAAS7nB,GAEjDi3B,EAAMr+B,KAAI,CACRoH,MAAAA,EACAxR,MAAOuiB,EAAM/Q,GACboR,KAAM+a,EACN7E,YAAaopC,GAAyBppC,EAAakE,GACnDjE,iBAAkBmpC,GAAyBnpC,EAAkBiE,GAC7DhE,mBAAoBkpC,GAAyBlpC,EAAoBgE,GACjEymC,oBAAqBvB,GAAyBuB,EAAqBzmC,GACnE0mC,qBAAsBxB,GAAyBwB,EAAsB1mC,GACrEhU,UAAW8Z,GAAuBl4B,EAAQwzD,UAAWp1C,EAAW2U,KAKhE,GAAA0iC,GAAgC,IAApBA,EAAS58C,OAAY,KAC7BmiD,EAAkBn9B,EAAM12B,KAAK,SAAA8f,UAASA,EAAKrgB,KAAK,IAEtDi3B,EAAQllB,GACNklB,EACA43B,EAASqF,oBACTrF,EAASsF,oBACTtF,EAAS58C,gBAKF3kB,EAAI,EAAGA,EAAI2pC,EAAM5pC,OAAQC,IAChC2pC,EAAM3pC,GAAG0S,MAAQo0D,EAAgB9mE,UAI9B2pC,GAGA,SAAaxkC,GACpBA,EAAMU,sBAEAkhE,EAAY5hE,EAAMyoB,QACxB9hB,EAAQ03D,SAAS1/C,GAAO23C,EAAUsL,IAG3B,SAAa5hE,GACpBA,EAAMU,kBAENiG,EAAQ03D,SAAS1/C,GAAM,aAGAyjB,EAAgBC,GACjC,IAAAzL,EAAauL,GAAOxjB,EAAM1lB,OAAOyC,KAAKK,GAAmCqmC,EAAQC,GAKhF,OAJP17B,EAAQwrB,QAAQyE,GAIT8B,GAAK5Z,EAAiB8X,EAAW,GAAGjY,QAGpC,SAAgB3e,GAGrB,KpEjFA,SAA+BjC,GACnC,MAA4B,QAArBA,EAAQqmB,UAAkD,SAA5BrmB,EAAQ8jE,eAC/C,CoE+EMC,CAAqB9hE,EAAM3C,SACV,IAAhB2C,EAAM+hE,OAAe59C,GAAkBnkB,EAAM3C,OAAmB,WADjE,CAMF2C,EAAMU,kBACNV,EAAMM,iBAINqG,EAAQkT,QAIR1b,SAASgC,iBAAiB,YAAaigE,GAAuB,GAC9DjiE,SAASgC,iBAAiB,UAAWmgE,GAE/B,IAAA0B,EAAal8C,GAA2B9lB,EAAM3C,QAC9CqkB,EAAO/a,EAAQwzD,UACfvlC,EAAgBjuB,EAAQs6D,mBAG5B,IAAAl8C,GACAi9C,IAAehoD,GAAcgM,OAC7Bg8C,IAAehoD,GAAc+L,QAC5BhB,EAAUliB,OAASm/D,GAAcj9C,EAAUliB,OAASmX,GAAciM,QACnE6Y,GAAgBpd,EAAMqD,EAAWpG,GAiB/B,GALJo9C,GAAUC,WAAY,EACtBD,GAAUE,gBAAkBt9C,EAC5Bo9C,GAAUG,oBAAsB8F,EAChCjG,GAAUI,eAAiBx9C,EAEvB3e,EAAM4Z,SAAQ,CAEV,IAAAqoD,EAAgBt7D,EAAQs6D,mBAAmBl8C,UAC7Ck9C,GACFt7D,EAAQ06B,SAASxF,GAAqBJ,GAAcwmC,GAAgBtjD,YAGlEqjD,IAAehoD,GAAciM,MAC3B,GAAA7nB,GAAS4B,EAAM3C,OAAmBmnB,aAAa,aAAW,CACtD,IAAA09C,EAAoBxpC,GACxB2B,GAAyBt+B,EAAO64B,IAElCjuB,EAAQ06B,SAAS5C,GAAkByjC,SAEnCv7D,EAAQ06B,SAASxF,GAAqBld,EAAMA,cAE5BpkB,IAATmnB,GACT/a,EAAQ06B,SAAS1C,GAAkBjd,EAAMsgD,EAAYrjD,SA9BlC,IAAjB3e,EAAMgT,QACRgtD,EAAqBhgE,KAkClB,SAAgBA,GACnB,GAAA+7D,GAAUC,UAAS,CACrBh8D,EAAMM,iBACNN,EAAMU,kBAE0B,MAA5Bq7D,GAAUI,gBAGR//D,OAAO4oB,cAGT5oB,OAAO4oB,eAAellB,QAIpB,IAAA8+B,EAAgB9Y,GAA2B9lB,EAAM3C,QAGpDw8B,GAAQlb,EAAMo9C,GAAUI,iBACzBv9B,IAAkBm9B,GAAUG,sBAE5BH,GAAUI,eAAiBx9C,EAC3Bo9C,GAAUG,oBAAsBt9B,EAEhCj4B,EAAQ06B,SACNxF,GACEkgC,GAAUE,iBAAmBF,GAAUI,eACvCJ,GAAUI,oBAuCX,SACPn8D,OAEI2G,EAAQurB,UAAanN,GAInB,IAAAo9C,EAAsB3pC,EAAQkD,GAAa3W,OAC5C8U,GAAQlb,EAAMwjD,IAUb,IAAA39B,WAmHNzf,EACAwQ,OAEMiP,EAAK,GAEF,SAAA49B,EAAUz2C,GACX,IAAA+N,EAAW/a,EAAKva,OAAOunB,GACvB5tB,EAAU4I,EAAQ+5D,YAAYhnC,GACrB,MAAX37B,GACFymC,EAAMr+B,KAAI,CACRwY,KAAM+a,EACNjhB,OAAQ1a,EAAQu4C,kBAKlBlrC,MAAMoS,QAAQzhB,GAAK,KACf2lB,EAAO/a,EAAQwzD,UACjB,QAAS5/D,IAATmnB,SACK,KAEH,IAAAoa,EAAYC,GAAara,EAAMqD,GAC/BiX,EAAUC,GAAWva,EAAMqD,GAC3BmX,EAAa5f,SAASoc,GAAKoD,GAAsB,IACjDM,EAAW9f,SAASoc,GAAKsD,GAAoB,IAM7CqmC,EAAiB9sC,EAAgB8yB,MAAM,SAAA6R,UACpCh+B,GAAcg+B,EAAe9vD,OAASgyB,GAAY89B,EAAe7vD,WAGrEg4D,kBAIGj4D,EAAei4D,EAAfj4D,MAAOC,EAAQg4D,EAARh4D,IACf0U,GAAa3U,EAAO1P,KAAKmkB,IAAI9iB,EAAMnB,OAAQyP,IAAO,SAAAkD,GAAK,OAAK60D,EAAU3/C,OAAOlV,YAG7EtU,OAAOyC,KAAKK,GAAkC1C,QAAQ+oE,UAGjD59B,EAhKO89B,CAA2Bv9C,EAAWwQ,GAAmBza,OAEvEjL,EAAM,qBAAwB,CAAAkV,UAAAA,EAAWyf,MAAAA,IAEpCA,OAKC9iB,EAAO/a,EAAQwzD,UACjB,QAAS5/D,IAATmnB,EAAA,CAGE,IAAAi7C,EAAc5gC,GAAara,EAAMqD,GACjC08C,EAAsBj9B,EAAMvZ,WAAW,SAAA2C,UAASiM,GAAQjM,EAAKjP,KAAMg+C,EAAW,IAE5En9C,EAAW68C,GAAe,CAChC36C,KAAAA,EACAkT,cAHoBjuB,EAAQs6D,mBAI5B1E,OAAQ,EACR/3B,MAAAA,IAJMhlB,YAOR48C,EAAQ,CACNiF,cAAerhE,EAAM3C,OACrB0jE,eAAgB/gE,EAAM8gE,QACtBD,kBAAmBL,IACnBiB,oBAAAA,EACAC,oBAAqBlmC,GAAkB9Z,EAAMqD,GAAWnqB,OACxD4pC,MAAAA,EACAhlB,OAAAA,EACA0hD,cAAc,IAEhBnF,GAAUK,UAAW,EAErBj+D,SAASgC,iBAAiB,YAAa6gE,GAAqB,GAC5D7iE,SAASgC,iBAAiB,UAAWghE,SA/BnCtxD,EAAM,mFAbNmwD,EAAqBhgE,KA2KhB,SAAgBA,GACnB+7D,GAAUC,WAAaD,GAAUK,WAIrCp8D,EAAMU,kBAEF6jB,GAAmBvkB,EAAM3C,OAAmB,YAAa,oBAC3Dib,EAAA,GAAAsyC,EAAQjvC,IAER4I,GAAmBvkB,EAAM3C,OAAmB,YAAa,gCAEzDib,EAAA,GAAAsyC,EAAQnvC,IAER8I,GAAmBvkB,EAAM3C,OAAmB,YAAa,gCAEzDib,EAAA,GAAAsyC,EAAQlvC,IAGV4+B,aAAa2lB,KAGN,SAAejgE,GACtBA,EAAMU,kBAKNu/D,EAAa7jE,OAAO8+C,YAAkB,WAAA,OAAA5iC,EAAA,GAAAsyC,OAAQrwD,EAAS,KAGhD,SAAmByF,GACrBA,EAAM4Z,WACT5Z,EAAMU,kBACNV,EAAMM,iBAENqG,EAAQ06B,SAAStD,GAAsBpf,MAIlC,SAAkB3e,GACpBA,EAAM4Z,WACT5Z,EAAMU,kBACNV,EAAMM,iBAENqG,EAAQ06B,SAASrD,GAAqBrf,MAIjC,SAAkC4jD,GACzC57D,EAAQ06B,SAAStD,GAAsBpf,IACvChY,EAAQo0D,cAAcwH,IAGf,SAAiCA,GACxC57D,EAAQ06B,SAASrD,GAAqBrf,IACtChY,EAAQo0D,cAAcwH,0SC9lBbC,GAAqC,CAChDC,OAAQ,MACRjxC,SAAU,oBACVG,KAAM,CACJ,IACA,IACA,GACA,GACA,0GAOS+wC,GAAuC,CAClDD,OAAQ,MACRjxC,SAAU,sBACVG,KAAM,CACJ,IACA,IACA,GACA,GACA,kFAISgxC,GAAqC,CAChDF,OAAQ,MACRjxC,SAAU,oBACVG,KAAM,CACJ,IACA,IACA,GACA,GACA,mHAOSixC,GAAsC,CACjDH,OAAQ,MACRjxC,SAAU,qBACVG,KAAM,CACJ,IACA,IACA,GACA,GACA,4ZCPEkxC,EAUAC,EAUAC,EAUAC,EAxDOthD,EAAanN,EAAbmN,KACAqD,EAA+BxQ,EAA/BwQ,UAEAmN,EAAiB3d,EAAjB2d,SACA+wC,EAAkB1uD,EAAlB2uD,WAAAA,OAAa,IAAHD,GAAQA,EAClBE,EAA0B5uD,EAA1B4uD,aAEAC,EAAuB7uD,EAAvB6uD,YACAC,EAAyB9uD,EAAzB8uD,cACAC,EAAkB/uD,EAAlB+uD,OACAC,EAAkBhvD,EAAlBgvD,OACAC,EAAkBjvD,EAAlBivD,OACAC,EAAuBlvD,EAAvBkvD,YACA1I,EAA0CxmD,EAA1CwmD,cACA2I,EAAkBnvD,EAAlBmvD,OACAC,EAAkCpvD,EAAlCovD,sBAEFC,IACPtrD,EAAA,EAAA4qD,GAAcA,mkBAGb5qD,EAAA,GAAAurD,OAAmBtpE,IAATmnB,uBACVpJ,EAAA,GAAAimB,EACDslC,IACC3oC,GAAiBnW,IAAciW,GAAejW,IAAckW,GAAiBlW,yBAG7E89C,EAAc,CACfhgE,KAAM,SACN8uB,KAAM6wC,GACN1Q,MAAO,aACP7iC,UAAW,iBACXumC,QAAS4N,EACTzuD,UAAWgI,GAAgB+E,0BAI1BohD,EAAgB,CACjBjgE,KAAM,SACN8uB,KAAM+wC,GACN5Q,MAAO,eACP7iC,UAAW,mBACXumC,QAAS6N,EACT1uD,UAAWgI,GAAgB+E,wBAI1BqhD,EAAc,CACflgE,KAAM,SACN8uB,KAAMmyC,GACNhS,MAAO,kBACP7iC,UAAW,aACXumC,QAASoO,EACTjvD,cAAmBpa,IAATmnB,uBAIXpJ,EAAA,GAAE0qD,EAAgB9wC,GAuDb2wC,EACAC,EAEE,CAAAjgE,KAAM,cAGNA,KAAM,SACN8uB,KAAMoyC,GACNjS,MAAO,gBACP7iC,UAAW,WACXumC,QAASkO,EACT/uD,UAAW4pB,GAGX,CAAA17B,KAAM,aAERkgE,EAEE,CAAAlgE,KAAM,WAvERggE,EACAC,EAEE,CAAAjgE,KAAM,cAGNA,KAAM,SACN8uB,KAAMqyC,GACNlS,MAAO,OACP7iC,UAAW,WACXumC,QAASgO,EACT7uD,SAAUud,QAAqB33B,IAATmnB,IAGtB7e,KAAM,SACN8uB,KAAMsyC,GACNnS,MAAO,6CACP7iC,UAAW,gBACXumC,QAASiO,EACT9uD,SAAUud,QAAqB33B,IAATmnB,GAExBqhD,GAEElgE,KAAM,SACN8uB,KAAMuyC,GACNpS,MAAOt2C,GACPyT,UAAW,kBACXumC,QAASuF,GAGT,CAAAl4D,KAAM,cAGNA,KAAM,SACN8uB,KAAMwyC,GACNrS,MAAO,gBACP7iC,UAAW,WACXumC,QAAS8N,EACT3uD,UAAWwuD,EAAa/P,UAGxBvwD,KAAM,SACN8uB,KAAMyyC,GACNtS,MAAO,sBACP7iC,UAAW,WACXumC,QAAS+N,EACT5uD,UAAWwuD,EAAa9P,SAGxB,CAAAxwD,KAAM,8BA0BXyV,EAAA,EAAAksB,EAAQm/B,EAAaX,o8ECxIX,sFAIA,yFARTpkE,GAEKvB,EAAAisB,EAAAzqB,aACLD,GAGAvB,EAAAgnE,EAAAxlE,aACAD,GAGAvB,EAAAinE,EAAAzlE,6KAXI9E,EAAQ,IAAAmZ,GAAAnZ,iZAJlB6E,GAmBKvB,EAAA45D,EAAAp4D,GAlBHzB,GAAmC65D,EAAAxlD,WACnCrU,GAeK65D,EAAA/kD,GAdH9U,GAAkD8U,EAAAN,kCAepDxU,GAAkC65D,EAAA5kD,mEAd1BtY,EAAQ,0IAVLm4B,EAAiB3d,EAAjB2d,SACAqyC,EAAyBhwD,EAAzBgwD,cACAC,EAA0BjwD,EAA1BiwD,eACAhP,EAAmBjhD,EAAnBihD,2NAa2BgP,GAAc,aAId,OAAAD,GAAa,aAdZ,OAAA/O,GAAO,0KCQhC,SAAAiP,GAA8BhrE,EAAYC,GACxD,IAAMgrE,EAAsB,iBAANjrE,EAAiBA,EAAEke,cAAgBle,EACnDkrE,EAAsB,iBAANjrE,EAAiBA,EAAEie,cAAgBje,EAEzD,OAAOkrE,GAAeF,EAAQC,EAChC,CAYgB,SAAAE,GACdnjD,GAGqB,IAFrBojD,EAAA9hE,UAAApI,OAAAoI,QAAAzI,IAAAyI,UAAAzI,GAAAyI,UAAqB,GAAA,GACrB02B,EAAqB12B,UAAApI,OAAA,QAAAL,IAAAyI,UAAAzI,GAAAyI,UAAA,GAAA,GACrB0F,EAAA1F,UAAApI,OAAA,QAAAL,IAAAyI,UAAA,GAAAA,UAAA,GAAoB,EAEpB,GAAIy0B,EAAY7B,EAAMlU,EAAMojD,IAAY,CACtC,QAAiBvqE,IAAbm/B,EACF,MAAU,IAAA3zB,MAAM,gEAGlB,OAyDY,SACd2b,GACA,IAAAojD,EAAA9hE,UAAApI,OAAA,QAAAL,IAAAyI,UAAA,GAAAA,UAAA,GAAqB,GACrBu3B,EAAyBv3B,UAAApI,eAAAL,IAAAyI,UAAA,GAAAA,UAAA,GAAA,GACzB0F,EAAA1F,UAAApI,OAAAoI,QAAAzI,IAAAyI,UAAAzI,GAAAyI,UAAoB,GAAA,EAEd+hE,EAgBR,SAAgCxqC,EAAwB7xB,GACtD,gBAA2BjP,EAAYC,GACrC,IAAMsrE,EAASpvC,EAAMn8B,EAAG8gC,GAClB0qC,EAASrvC,EAAMl8B,EAAG6gC,GAExB,YAAehgC,IAAXyqE,EACKt8D,OAEMnO,IAAX0qE,GACMv8D,EAGY,iBAAXs8D,GAAyC,iBAAXC,EAIhCD,EAASC,EAASv8D,EAAYs8D,EAASC,GAAUv8D,EAAY,EAG/DA,EAAY+7D,GAA8BO,EAAQC,EAC3D,CACF,CArCqBC,CAAuB3qC,EAAc7xB,GAGlD4V,EAAQsX,EAAMlU,EAAMojD,GAC1B,MAAO,CACL,CACE1yC,GAAI,UACJzT,KAAMC,EAAmBkmD,GACzB/oE,MAAOuiB,EAAMnkB,MAAM,GAAGuf,KAAKqrD,IAGjC,CA1EWI,CAAUzjD,EAAMojD,EAAUprC,EAAUhxB,EAC5C,CAED,GAAIgU,GAASgF,GACX,OAeE,SACJA,GAEqB,IADrBojD,EAAqB9hE,UAAApI,eAAAL,IAAAyI,UAAA,GAAAA,aAAA,GACrB0F,EAAA1F,UAAApI,eAAAL,IAAAyI,UAAA,GAAAA,aAAoB,EAEdoc,EAASwW,EAAMlU,EAAMojD,GAErBM,EADOnsE,OAAOyC,KAAK0jB,GACDjlB,QAExBirE,EAAW1rD,MAAK,SAAC2rD,EAAMC,GACrB,OAAO58D,EAAY+7D,GAA8BY,EAAMC,EACzD,IAIA,IADA,IAAM1uC,EAAgC,GAC7B/7B,EAAI,EAAGA,EAAIuqE,EAAWxqE,OAAQC,IAAK,CAC1C,IAAMyG,EAAM8jE,EAAWvqE,GACjB8jB,EAAOC,EAAmBkmD,EAAS1gE,OAAO9C,IAChDs1B,EAAWzwB,KAAK,CACdisB,GAAI,OACJ/mB,KAAMsT,EACNA,KAAAA,GAEH,CAED,OAAOiY,CACT,CAzCW2uC,CAAe7jD,EAAMojD,EAAUp8D,GAGxC,MAAM,IAAI3C,MAAM,kCAClB,g9CC9BOyhC,EAAA/a,GAAS1yB,EAAK,GAAA+pB,WAAY0hD,IAAmB,oLAFvC7kE,GAAAqS,EAAA,QAAAm+C,EAAAp3D,KAAK+pB,YAFQrhB,GAAAuQ,EAAA,eAAAjZ,OAASA,EAAY,kCAH3C6E,GAQQvB,EAAA2V,EAAAnU,gEADL,EAAAxE,GAAAmtC,KAAAA,EAAA/a,GAAS1yB,EAAK,GAAA+pB,WAAY0hD,IAAmB,KAAA7jE,GAAAwC,EAAAqjC,GAFvC,EAAAntC,GAAA82D,KAAAA,EAAAp3D,KAAK+pB,kCAFQrhB,GAAAuQ,EAAA,eAAAjZ,OAASA,EAAY,sGAY3C,wHADqB0rE,GAAS,2BAH9B7mE,GAMQvB,EAAA2V,EAAAnU,yFAlBHogB,GAAMllB,EAAK,GAAE0rE,0BAAoB1rE,EAAI,YAA1Ca,OAAIC,GAAA,EAAA,oDAWDd,EAAK,GAACa,OAAS6qE,IAASvyD,sKAZ/BtU,GAqBKvB,EAAAisB,EAAAzqB,uHApBIogB,GAAMllB,EAAK,GAAE0rE,uCAWf1rE,EAAK,GAACa,OAAS6qE,8IAhBd,IAAAA,GAAY,IACZD,GAAsB,0BALjBhhC,EAA0BjwB,EAA1BiwB,MACAkhC,EAA6BnxD,EAA7BmxD,aACArkC,EAAyC9sB,EAAzC8sB,oJAYyB,SAAAzT,GAAA,OAAAyT,EAASzT,EAAI,m7CC8C5C7zB,EAAY,mGALf6E,GAMQvB,EAAA2V,EAAAnU,qEADL9E,EAAY,8FARH87D,MAET,IAAAvkD,OAAiB/W,IAAjBR,MAA0BmZ,GAAAnZ,2MALbA,EAAI,2EAJxB6E,GAkBKvB,EAAAisB,EAAAzqB,GAjBHzB,GAOQksB,EAAAtW,wEAHIjZ,EAAY,sEADNA,EAAI,SAKAQ,IAAjBR,6OA1CD4rE,EAEA56C,EAVI66C,EACNh/D,GAAiC,kBAD3BskB,EAAiB06C,EAAjB16C,kBAAmBP,EAAkBi7C,EAAlBj7C,mBAGhBhM,EAAcpK,EAAdoK,KACApR,EAAagH,EAAbhH,MACA8zB,EAAkC9sB,EAAlC8sB,SACA2e,EAAsCzrC,EAAtCyrC,SAGP5nC,GAAO,EAMF,SAAAytD,EAAiBj4C,GACxBjD,EAAmBI,GACnBsW,EAAS3H,EAASt1B,OAAOwpB,iMALxB8L,EAAW/a,EAAKxkB,MAAM,EAAGoT,mBACzB+K,EAAA,EAAAotD,EAAe/mD,EAAKpR,4BAQjBo4D,EAAoB,CACtBrtD,EAAA,EAAAF,GAAO,OAED7c,EAAK,CACTipC,MAAOwb,EAAStmB,GAChBgsC,aAAAA,EACArkC,SAAUwkC,GAGZ96C,EAAUG,EAAkB46C,GAAuBvqE,EAAK,CACtDsD,OAAQ8mE,EACRhwD,mBAAmB,EACnBsC,QAAO,WACLK,EAAA,EAAAF,GAAO,gBAoBK,WAAA,OAAAytD,EAAiBH,uDAbSC,EAAoB7rD,8JCnD5C,SAAAisD,GAAgBrmE,GAAY,IAAAsmE,EAAAC,EAClD,GAAItP,UAAUj0B,UACZ,OAAOi0B,UAAUj0B,UAAUwjC,UAAUxmE,GAIlC,GAAkC,QAAlCsmE,GAAIC,EAAA9nE,UAASgoE,6BAATH,IAA8BA,GAA9BA,EAAAzlE,KAAA0lE,EAAiC,QAAS,CACjD,IAAMvN,EAAWv6D,SAASoB,cAAc,YACxCm5D,EAAS38D,MAAQ2D,EAEjBg5D,EAAS56D,MAAMib,SAAW,QAC1B2/C,EAAS56D,MAAMuT,QAAU,IAEzBlT,SAAS2a,KAAKvb,YAAYm7D,GAC1BA,EAASv2D,SAGT,IACEhE,SAASioE,YAAY,OACtB,CAAC,MAAOl+D,GACPyI,QAAQZ,MAAM7H,EACf,CAAA,QACC/J,SAAS2a,KAAK7Z,YAAYy5D,EAC3B,CACF,MACC/nD,QAAQZ,MAAM,eAElB,s+CCuFkB6lD,+JARdh3D,GASQvB,EAAA2V,EAAAnU,kDALJa,KAAM+iB,OAAO1oB,MAAwB,KAClCA,EAAA,wEADH2F,CAAAA,KAAM+iB,OAAO1oB,MAAwB,KAClCA,EAAA,gRAOP6E,GAAyCvB,EAAAisB,EAAAzqB,sEAbtC9E,EAAoB,IAAAyX,GAAAzX,KAYpBA,EAAM,IAAAmZ,kCAUG6wD,yMA3BLhqE,EAAS,mOAJqCA,EAAoB,qBAA7E6E,GAiCKvB,EAAAisB,EAAAzqB,GAhCHzB,GAOCksB,EAAAznB,kEAgBDzE,GAQQksB,EAAAtW,8CA1BsBjZ,EAAa,kBAC/BA,EAAW,iBAsBXA,EAAU,gEAzBbA,EAAS,cAATA,EAAS,IAKbA,EAAoB,4GAYpBA,EAAM,wGArB4CA,EAAoB,uMA7EvEssE,EACAC,EAVE99B,EAAuB5hC,GAAiC,kBAEnD+X,EAAcpK,EAAdoK,KACA4nD,EAA0BhyD,EAA1BgyD,WACAj0C,EAAyC/d,EAAzC+d,SACAra,EAAmB1D,EAAnB0D,QACAuuD,EAAgBjyD,EAAhBiyD,QACAC,EAAuClyD,EAAvCkyD,WAIPC,GAAmB,EAInBC,OAAkCpsE,EAClCqsE,GAAS,WAWJ/sD,IACPwsD,EAASxsD,QAGF,SAAAgtD,EAAiBv7C,OAKhB,IAAA3M,EAAO4nD,EAAWvoD,MAAMsN,UAczB,SAAmB3M,GACrB,IAAA8nD,EAAW9nD,GACJ,UAAA5Y,MAAM,2CAfhB+gE,CAAmBnoD,IAEjBA,KAAAA,EACA5O,WAAOxV,SAEFwV,UAEL4O,UAAMpkB,EACCwV,MAAAA,WA1Bb/J,IAAO,WACL6T,OAGFzT,IAAS,WACPk0C,aAAaqsB,kRAZZL,EAAYC,EAAW7oD,UAAUiB,sBACnCrG,EAAA,EAAEyuD,EAAuBL,EAAmBG,EAAiBP,GAAWv2D,WAAQxV,eA2CxE,SAAYyF,GACnBsY,EAAA,EAAAguD,EAAYtmE,EAAMgnE,cAAcjrE,QAGzB,SAAciE,OACf4gC,EAAQtY,GAAkBtoB,GAM5B,GAJU,WAAV4gC,GACF3oB,IAGY,UAAV2oB,EAAiB,CACnBtoB,EAAA,GAAAouD,GAAmB,OACblrE,EAASqrE,EAAiBP,QACZ/rE,IAAhBiB,EAAOmjB,KACT2T,EAAS92B,EAAOmjB,MAEhB6nD,EAAQhrE,EAAOuU,oBAMnBg2D,GAAgBO,GAChBhuD,EAAA,EAAAsuD,GAAS,GACTD,EAAcvqE,OAAO8+C,kCAAkB0rB,GAAS,KAhE9B,KAiElB/sD,sEASWwsD,EAAQvsD,y2DCER/f,EAAiB,aAChBA,EAAgB,yXAVrBA,EAAI,yBAAiBA,EAAK,aAA/Ba,OAAIC,GAAA,EAAA,oDAGDd,EAAW,IAAAyX,GAAAzX,qNAHTA,EAAI,2DAGNA,EAAW,8JAHda,OAAIC,GAAA,wQACmDd,EAAY,mYAGvBwT,MAAAxT,KAAKa,gBAAkBb,EAAY,mHAAnC,EAAAM,IAAA4sE,EAAA15D,MAAAxT,KAAKa,+KAuB/C+hB,GAAgB5iB,EAAI,KAAMA,EAAO,GAAsB,IAAnB,uDA7BpCA,EAAO,KAAA,qDAgCCA,EAAO,GAAGmtE,GAAUC,8PARzBptE,EAAO,GAAG,mCAAqC,uCAFzCA,EAAO,4FAvBxB6E,GAmCKvB,EAAAisB,EAAAzqB,0BAfHzB,GAcQksB,EAAAtW,GANN5V,GAGM4V,EAAAu0B,iEALIxtC,EAAa,qMAInB4iB,GAAgB5iB,EAAI,KAAMA,EAAO,GAAsB,IAAnB,mBAA2B4H,GAAAyxB,EAAA89B,0BAGvDn3D,EAAO,GAAGmtE,GAAUC,gCARzBptE,EAAO,GAAG,mCAAqC,qEAFzCA,EAAO,+NA1FlBqtE,EAREv3D,EAAQH,GAAY,4BAEfgS,EAAanN,EAAbmN,KACAqD,EAA+BxQ,EAA/BwQ,UACAsc,EAAsB9sB,EAAtB8sB,SACAmlC,EAAgBjyD,EAAhBiyD,QACAD,EAA0BhyD,EAA1BgyD,WAGPc,GAAU,EA8CL,SAAAhd,EAAa1rC,GACpB9O,EAAM,cAAemS,KAAKtE,UAAUiB,IAEpC0iB,EAASxF,GAAqBld,EAAMA,aAO7B2oD,IACPhvD,EAAA,EAAA+uD,GAAU,mPAvDT1oD,EAAOoG,EAAY2W,GAAa3W,GAAS,kBAC3CzM,EAAA,EAAEivD,EAAc5qD,GAAgBiZ,EAAMlU,EAAM/C,mBAM3Cu8B,YAAU,cACJksB,GAAoBA,EAAiBluD,SAAQ,CACzC,IAAAC,EAAOiuD,EAAiB1wB,YAAc0wB,EAAiB/wB,YACzDl9B,EAAO,IACTtJ,EAAM,YAAasJ,GACnBiuD,EAAiBluD,SAAQ,CAAGC,KAAAA,EAAMC,SAAU,gCAS3C,SAASuF,GAChB9O,EAAM,qBAAsB8O,GAEtB,IAAArhB,EAAOs4B,EAAMlU,EAAM/C,MACrBvT,MAAMoS,QAAQlgB,UACTunB,GAAM,EAAGvnB,EAAK1C,QAAQkT,IAAI2U,WACxB/F,GAASpf,GAAI,CAChB,IAEA8nE,EAFOnsE,OAAOyC,KAAK4B,GAEDnD,MAAM,UAC9BirE,EAAW1rD,KAAK+qD,IAETW,YAOF,SAAWzmD,UACXgb,EAASjY,EAAM/C,iBAUtBrG,EAAA,EAAA+uD,GAAWA,MAOJ,SAAiB1oD,GACxB2oD,IACAjd,EAAa1rC,2DAI0ByoD,EAAgBttD,+6GC0N9Co8C,IAAiB,IAAjBn8D,EAAiB,IAAKA,EAAc,GAAAA,EAAA,GAAAqK,GAAAA,OAC9BrK,KAAc,EACjB,KAAA,IAAE,MAjCNA,EAAQ,IAAAmoD,GAAAnoD,yCAaHA,EAAS,GAAA,gDA4BFytE,4BAQAC,4BAQA7V,MAGX,IAAA3Q,EAAAlnD,OAAgBA,EAAQ,IAAAyX,GAAAzX,6KA3BjBA,EAAoB,kcAHmB0I,GAAAmP,EAAA,cAAS,KAAT7X,yjBAjCzD6E,GAqFKvB,EAAA45D,EAAAp4D,GAnFHzB,GAkFM65D,EAAAyQ,0BAvEJtqE,GAsEKsqE,EAAAr1D,GArEHjV,GAgDKiV,EAAAH,GA/CH9U,GAMK8U,EAAAT,0BACLrU,GAUO8U,EAAA6Z,GATL3uB,GAQC2uB,EAAAlqB,QAHa9H,EAAI,YAKpBqD,GAIK8U,EAAAN,2BACLxU,GAOQ8U,EAAAmyD,wBACRjnE,GAOQ8U,EAAAoyD,wBACRlnE,GAOQ8U,EAAAy1D,wGA/BM5tE,EAAW,kBAYbA,EAAU,kBAQVA,EAAc,kBAQdA,EAAW,oBAxDaA,EAAa,6BAC/CA,EAAQ,2PAyBMA,EAAI,SAAJA,EAAI,MAMjB0Y,GAAA,IAAApY,EAAA,KAAA67D,KAAAA,IAAiB,IAAjBn8D,EAAiB,IAAKA,EAAc,GAAAA,EAAA,MAAAqK,OAC9BrK,KAAc,OACjB,IAAE,KAAA4H,GAAAkuC,EAAAqmB,wBAAEn8D,EAAoB,kBAHmB0I,GAAAmP,EAAA,cAAS,KAAT7X,MA8B9CA,OAAgBA,EAAQ,sYArDfA,EAAW,GAAG+gE,GAAcmE,2MAN1CrgE,GAOQvB,EAAA2V,EAAAnU,wCAHI9E,EAAiB,oDAEfA,EAAW,GAAG+gE,GAAcmE,gMASxB6E,wOAFA8D,GAAav4C,MAAA,gvBA+C7BzwB,GAiBKvB,EAAAisB,EAAAzqB,GAhBHzB,GAOCksB,EAAAznB,QAFa9H,EAAW,YAGzBqD,GAIAksB,EAAA+6C,WACAjnE,GAEAksB,EAAAg7C,6CATcvqE,EAAoB,kBAKtBA,EAAa,kBAEuCA,EAAgB,gDARlEA,EAAW,SAAXA,EAAW,kEAvEhCA,EAAU,IAAAmZ,GAAAnZ,oGAAVA,EAAU,uNApFJ,SAAA8tE,GAAgB9pE,GACvBA,EAAQoE,sCAhJNyiC,EAlBE/0B,EAAQH,GAAY,wBAEfgS,EAAanN,EAAbmN,KACAkT,EAA4BrgB,EAA5BqgB,cACArX,EAAkBhJ,EAAlBgJ,OACA2lD,EAAmB3uD,EAAnB2uD,WACA4E,EAAoBvzD,EAApBuzD,YACA51C,EAAiB3d,EAAjB2d,SACAqT,EAA+BhxB,EAA/BgxB,QACAwiC,EAAoDxzD,EAApDwzD,SACAtT,EAA0ClgD,EAA1CkgD,QACAtiC,EAAgB5d,EAAhB4d,QACAla,EAAmB1D,EAAnB0D,QAEPvY,EAAO,GACPsoE,EAAe,GACf9hC,EAAc,GACd+hC,GAAY,EAYVC,EAAkC7hB,IAiKzB,SAAsB8hB,GAAAC,OAAAA,EAAAr6D,MAAAvN,KAAAwC,UAAA,GpFvNT,KoFyDtBqlE,EAA4BhiB,aAmKHiiB,UAAAC,EAAAx6D,MAAAvN,KAAAwC,apF5NH,coF4DnBwlE,QACPV,GAAeA,IAAgB51C,GA4DPu2C,SAAAA,WAAAA,EAAAh2C,EAAAC,IAAAC,oFAClB,cAAA,EAAAjrB,KAAI,KAAA,EACVwzC,YAAU,WAAO,OAAAgtB,EAAgCzgE,OAAK,IAAA,KAAA,EAAA,IAAA,MAAA,OAAAihE,EAAAz6B,OAAA,GAAA06B,EAAA,2BAGzC,CAAA,SAAAC,IAAaC,OAAAA,EAAA96D,MAAA/K,KAAAA,UAAA6lE,CAAAA,SAAAA,WAAAA,EAAAp2C,EAAAC,IAAAC,2FACtBT,KAAAA,EAAAA,IAAAA,EAAQ42C,CAAAA,EAAAxjE,KAAAwjE,EAAAA,KAAAA,CAAAA,OAAAA,EAAA96B,OAIN5J,UAAAA,KAAAA,EAC0C,GAD1CA,EAAyB2kC,QAAfA,EAAGnkC,SAAAmkC,IAAYA,OAAZA,EAAAA,EAAc3kC,WACjCv0B,EAAM,gBAAmB,CAAAq2B,YAAAA,EAAa9B,WAAAA,IAEjCQ,GAAiBR,QAAuB7pC,IAATmnB,EAAkBonD,CAAAA,EAAAxjE,KAAAwjE,EAAAA,KAAAA,CAAAA,OAAAA,EAAA96B,wBAuBhD,OAlBN11B,EAAA,GAAAssB,EAAYxxB,EAAAA,EAAA,CAAA,EACPuxB,GAAWC,QACdL,YAAAA,KAAWykC,EAGwBviC,GACnC/kB,EACAkT,EACAsR,EACA9B,EACA7mB,GALMqZ,EAAUoyC,EAAVpyC,WAAY6M,EAAYulC,EAAZvlC,aAQpBtR,EAAQyE,GAAa,SAAAnI,EAAGiT,GAAY,MAAA,CAClCnqB,MAAKnE,EAAAA,EAAOsuB,CAAAA,EAAAA,GAAc3c,CAAAA,EAAAA,CAAAA,UAAW0e,eAIjC,GAAA/7B,KAAIohE,KAAAA,GACJ,OADIA,EAAAxjE,KACJ,GAAA+iE,EAA0B5gE,QAAKqhE,KAAAA,UAAAA,EAAAxjE,QAG/BujD,IAAWigB,KAAAA,GAAAA,IAAAA,MAAAA,OAAAA,EAAA76B,UAAAg7B,EAAA,4BAGYC,SAAAA,WAAAA,EAAAz2C,EAAAC,IAAAC,uFACzBT,KAAAA,EAAAA,IAAAA,GAAQi3C,EAAA7jE,KAAA,EAAA,KAAA,CAAA,OAAA6jE,EAAAn7B,OAAA,UAAA,KAAA,SAIZn+B,EAAM,mBAAsB,CAAAnQ,KAAAA,EAAMwmC,YAAAA,IAAWkjC,EAERviC,GACnCnlB,EACAkT,EACAl1B,EACAwmC,EACA3oB,GALMqZ,EAAUwyC,EAAVxyC,WAAY6M,EAAY2lC,EAAZ3lC,aAQpBtR,EAAQyE,GAAa,SAAAnI,EAAGiT,GAAY,MAAA,CAClCnqB,MAAKnE,EAAAA,EAAOsuB,CAAAA,EAAAA,GAAc3c,CAAAA,EAAAA,CAAAA,UAAW0e,iBAGjColB,IAAW,KAAA,EAAA,IAAA,MAAA,OAAAsgB,EAAAl7B,OAAAo7B,GAAAA,6BAOJ,CAAA,SAAAC,WAAUC,EAAAx7D,MAAAvN,KAAAwC,UAAA,CAAA,SAAAumE,WAAAA,EAAA92C,EAAAC,IAAAC,oFAC2C,OAAlEra,EAAA,GAAAssB,EAAeA,EAAeD,GAAWC,QAAgBrqC,GAASivE,EAAAlkE,KAAA,EAE5DujD,IAAW,KAAA,EAAA,IAAA,MAAA,OAAA2gB,EAAAv7B,OAAAw7B,GAAAA,6BAGJ,CAAA,SAAAC,IAAc,OAAAC,EAAA57D,MAAAvN,KAAAwC,UAAA,CAAA,SAAA2mE,WAAAA,EAAAl3C,EAAAC,IAAAC,oFAGrB,OAFNra,EAAA,GAAAssB,EAAeA,EAAeG,GAAeH,QAAgBrqC,GAASqvE,EAAAtkE,KAEhE,EAAAujD,IAAW,KAAA,EAAA,IAAA,MAAA,OAAA+gB,EAAA37B,OAAA47B,GAAAA,6BAGJ,CAAA,SAAAhhB,IAAWihB,OAAAA,EAAA/7D,WAAA/K,UAAA,CAAA,SAAA8mE,WAAAA,EAAAr3C,EAAAC,IAAAC,4FAGmB,GAF3C9iB,EAAM,cAAe+0B,KAEfR,EAAyB2lC,QAAfA,EAAGnlC,SAAAmlC,IAAYA,OAAZA,EAAAA,EAAc3lC,kBACN7pC,IAATmnB,EAAkBsoD,CAAAA,EAAA1kE,KAAA0kE,EAAAA,KAAAA,CAAA,OAAAA,EAAA1kE,KAAA,EAC5BmvD,EAAQrwB,EAAWzlB,MAAIqrD,KAAAA,EAAAA,IAAAA,MAAAA,OAAAA,EAAA/7B,OAAAg8B,GAAAA,8BAII,SAAAC,WAAAA,EAAAz3C,EAAAC,IAAAC,MAAtB,SAAAw3C,EAAuBjH,GAAmB,OAAAxwC,IAAApf,MAAA,SAAA82D,iBAAAA,EAAAl3C,KAAAk3C,EAAA9kE,MAAA8kE,KAAAA,EAAA,OAAAA,EAAA9kE,KAAA,EACjD+kE,EAAYnH,EAAYxjE,EAAMgiB,GAAI0oD,KAAAA,EAAAA,IAAAA,MAAAA,OAAAA,EAAAn8B,OAAAk8B,GAAAA,8BAG3B,CAAsB,SAAA/B,WAAAA,EAAA31C,EAAAC,IAAAC,MAAtB,SAAA23C,EAAuB5qE,GAAY,OAAAgzB,IAAApf,MAAA,SAAAi3D,GAAA,cAAAA,EAAAr3C,KAAAq3C,EAAAjlE,MAAAilE,KAAAA,SAAAA,EAAAjlE,OAC1C+kE,EAAYnH,EAAYxjE,EAAMgiB,GAAI6oD,KAAAA,SAAAA,EAAAjlE,OAClCujD,IAAW0hB,KAAAA,EAAAA,IAAAA,MAAAA,OAAAA,EAAAt8B,UAAAq8B,EAAA,+DAGJ,SAAAE,EAAiB9oD,GAAa,OAAAgR,IAAApf,eAAAm3D,GAAAA,cAAAA,EAAAv3C,KAAAu3C,EAAAnlE,MAAAmlE,KAAAA,EAAA,OAAAA,EAAAnlE,KAAA,EACrC+kE,EAAYnH,EAAYxjE,EAAMgiB,GAAI,KAAA,EAAA,IAAA,MAAA,OAAA+oD,EAAAx8B,OAAAu8B,GAAAA,wCAK3BH,EAAWK,EAAAC,EAAAC,GAAAC,OAAAA,EAAA98D,MAAAvN,KAAAwC,UAAA6nE,CAAAA,SAAAA,WAAAA,EAAAp4C,EAAAC,IAAAC,MAAX,SAAAm4C,EAAY5H,EAAqBxjE,EAAcgiB,GAAa,OAAAgR,IAAApf,eAAAy3D,iBAAAA,EAAA73C,KAAA63C,EAAAzlE,MACpE49D,KAAAA,EAAAA,GAAAA,GAAU6H,EAAAzlE,oBACTs/B,GACFtsB,EAAA,GAAAssB,OAAerqC,6BAMoB,GAAvCsV,EAAM,cAAiB,CAAAqzD,WAAAA,EAAYxjE,KAAAA,IAEtB,KAATA,EAAWqrE,CAAAA,EAAAzlE,KACbuK,EAAAA,KAAAA,QAAAA,EAAM,+BAEetV,IAAjBqqC,GACFtsB,EAAA,GAAAssB,OAAerqC,YAMnB+d,UAAAA,KAAAA,EAAgB,OAAhBA,EAAA,EAAA2vD,GAAY,GAAI8C,EAAA/8B,OAAA,SAEL,IAAA5mC,SAAe,SAAAC,GACxB6zC,YAAU,eAEFjX,EAAiBiB,GAAOxlC,EAAMgiB,EAAI,CAAI4jB,WAAY5qB,GAAoB6qB,QAAAA,IAC5EjtB,EAAA,GAAAssB,EAAeZ,GAAmBtiB,EAAMuiB,EAAgBW,IAExDtsB,EAAA,EAAA2vD,GAAY,GACZ5gE,wFAKG2jE,IACPn7D,EAAM,eACNq4D,EAAgC7/C,SAChCggD,EAA0BhgD,SAC1BgiD,GAAY,EAAO3qE,EAAMgiB,GACzBzJ,qdA7NDK,EAAA,EAAE2yD,WAAcC,EAAAtmC,SAAY,IAAAsmC,GAAOA,QAAPA,EAAZA,EAAc1mC,iBAAK0mC,SAAnBA,EAAqBtwE,SAAU,+BAC7C2pC,WAAc4mC,EAAAvmC,SAAY,IAAAumC,OAAA,EAAZA,EAAc5mC,cAAe,qBAC3CjsB,EAAA,EAAA8yD,EACDH,GAAevwD,GAAkB,GAAAtW,OAAMsW,SAA4B+H,OAAOwoD,4BAEzElD,EAASnjC,6BAiKyBymC,GAAAnB,EAAAn8D,MAAAvN,KAAAwC,UAAA,CA/JlCsoE,CAAuBpI,oBAGvBgF,EAAgCxoE,yBAGhC2oE,EAA0B3mD,yBAMpB,SAAc1hB,GAGrBA,EAAMU,sBACAkgC,EAAQtY,GAAkBtoB,GAElB,UAAV4gC,IACF5gC,EAAMM,iBAEiBZ,IAASsoE,GAE9BE,EAAgCzgE,QAChCugE,EAAetoE,GAEf4pE,KAIU,gBAAV1oC,IACF5gC,EAAMM,iBACNopE,KAGY,eAAV9oC,IACF5gC,EAAMM,iBAEFwnE,EACFc,IAEAU,KAKU,WAAV1oC,IACF5gC,EAAMM,iBACNkoE,KAGY,WAAV5nC,IACF5gC,EAAMM,iBAEN0qE,MAIK,SAAqBhrE,GAGd,UAFAsoB,GAAkBtoB,KAG9BA,EAAMM,iBACNN,EAAMU,kBAENkoE,iBAIsBH,OAAAA,EAAA16D,MAAA/K,KAAAA,UAAAylE,eA2CK,OAAAS,EAAAn7D,MAAAvN,KAAAwC,UAAAkmE,qCAuIPxpE,EAAIc,KAAAzE,yBA0CJmqC,EAAW1lC,KAAAzE,yQC9T/BwvE,GAAYC,OAAO,QAEnB,SAAUC,GACdntD,EACAotD,GACA,IAAAC,EAAc3oE,UAAApI,OAAA,QAAAL,IAAAyI,UAAAzI,GAAAyI,aAAGsf,IAEX9nB,EAAuB,CAAA,EAEzB4Q,MAAMoS,QAAQc,ajFyIlBA,EACAqtD,EACAvjE,GAEA,GAAIkW,EAAM1jB,OAAS+wE,EACjBrtD,EAAMjlB,QAAQ+O,QAGd,IADA,IAAMnE,EAAO0nE,EAAiB,GAAKrtD,EAAM1jB,OAAS,IAAM+wE,EAAiB,GAAKrtD,EAAM1jB,OAC3EC,EAAI,EAAGA,EAAI8wE,EAAgB9wE,IAAK,CACvC,IAAM0S,EAAQ7S,KAAKoiB,MAAMjiB,EAAIoJ,GAC7BmE,EAASkW,EAAM/Q,GAAQA,EAAO+Q,EAC/B,CAEL,CiFlJIstD,CAActtD,EAAOqtD,GAAgB,SAAC/9C,GAChClR,GAASkR,GACXi+C,GAAej+C,EAAMpzB,EAAQkxE,GAE7BlxE,EAAO+wE,KAAa,CAExB,IAGF,IAAM59C,EAAoB,GAM1B,OALI49C,MAAa/wE,GACfmzB,EAAMxnB,KAAK,IAEb2lE,GAActxE,EAAQ,GAAImzB,EAAO+9C,GAE1B/9C,CACT,CAIA,SAASk+C,GAAezsD,EAAsB5kB,EAAsBkxE,GAClE,IAAK,IAAMpqE,KAAO8d,EAAQ,CACxB,IAAMrjB,EAAQqjB,EAAO9d,GACfyqE,EAAcvxE,EAAO8G,KAAS9G,EAAO8G,GAAO,CAAA,GAE9Cob,GAAS3gB,IAAU2vE,EACrBG,GAAe9vE,EAAOgwE,EAAaL,QAEJnxE,IAA3BwxE,EAAYR,MACdQ,EAAYR,KAAa,EAG9B,CACH,CAIA,SAASO,GACP1sD,EACAmZ,EACA5K,EACA+9C,GAEA,IAAK,IAAMpqE,KAAO8d,EAAQ,CACxB,IAAMT,EAAO4Z,EAAWn0B,OAAO9C,GACzBvF,EAAQqjB,EAAO9d,GAEjBvF,IAA8B,IAArBA,EAAMwvE,KACjB59C,EAAMxnB,KAAKwY,GAGT6Y,EAAaz7B,IAAU2vE,GACzBI,GAAc/vE,EAAO4iB,EAAMgP,EAAO+9C,EAErC,CACH,UA4DgBM,GACdr4B,EACAs4B,EACAvqD,EACAwqD,EACAC,EACAC,GAYA,IAXW,IAAXrlD,EAAM/jB,UAAApI,OAAAoI,QAAAzI,IAAAyI,UAAAzI,GAAAyI,aAAG,GAEHqpE,EAAY50C,EAAY/V,GAAQA,EAAK9mB,OAAS,EAC9C0xE,EA4FR,SACEJ,EACAC,GAEA,IAAM9sD,EAASpmB,OAAOomB,OAAO6sD,GAC7B,GAAIlgD,EAAQ3M,GACV,OAAO8sD,EAGT,IAAM9jE,EAAM,SAAC5O,EAAWC,GAAS,OAAKD,EAAIC,CAC1C,EACA,OADc2lB,EAAO5H,OAAOpP,GACbgX,EAAOzkB,MACxB,CAxG4B2xE,CAA2BL,EAAaC,GAC5DK,EAAc74B,EAAY5sB,EAC1B0lD,EAAiBR,EAAiB,EAAIllD,EAEtC2lD,EAAgB,SAACn/D,GAAkB,OAAA2+D,EAAY3+D,IAAU4+D,CAE/D,EAAIjwC,EAAa,EACbywC,EAAcP,EACXO,EAAcH,GAAetwC,EAAamwC,GAC/CM,GAAeD,EAAcxwC,GAC7BA,IAEEA,EAAa,IAGfywC,GAAeD,IADfxwC,IAMF,IAFA,IAAIE,EAAWF,EACX0wC,EAAgB,EACbA,EAAgBH,GAAkBrwC,EAAWiwC,GAClDO,GAAiBF,EAActwC,GAC/BA,IAIF,IADA,IAAIywC,EAAY,EACPhyE,EAAIuhC,EAAUvhC,EAAIwxE,EAAWxxE,IACpCgyE,GAAaH,EAAc7xE,GAK7B,MAAO,CACLqhC,WAAAA,EACAE,SAAAA,EACAuwC,YAAAA,EACAE,UAAAA,EACAP,kBAAAA,EACAM,cAAAA,EACAE,aATmBr1C,EAAY/V,GAAQA,EAAKvnB,MAAM+hC,EAAYE,GAAY,GAW9E,CAkCM,SAAU2wC,GACdpuD,EACA4mB,EACA2mC,EACAC,GAKA,IAHA,IAAQa,EAAaC,GAAoBtuD,EAAM4mB,GAAvCynC,SAEJ/zD,EAAM,EACDuhD,EAAe,EAAGA,EAAewS,EAAUxS,IAClDvhD,GAAOizD,EAAY1R,IAAiB2R,EAItC,OAAOlzD,CACT,CAoEgB,SAAAg0D,GAAoBtuD,EAAgB4mB,GAClD,MAAA2nC,MAA2BvuD,oBAApBpR,EAAK2/D,EAAKpsD,GAAAA,EAAMosD,EAAA/yE,MAEvB,GAAM6yE,EAAW1wD,SAAS/O,EAAO,IAEjC,MAAO,CACLy/D,SAAWjwD,MAAMiwD,IAAwB,EAAZA,EAC7BG,YAAa5nC,EAAQta,WAAU,SAACnuB,GAAM,OAAA8gC,GAAe9c,EAAQhkB,MAEjE,CAEgB,SAAAswE,GAAsBr0D,EAA0BwsB,GAC9D,IAAQynC,EAA0Bj0D,EAA1Bi0D,SAAUG,EAAgBp0D,EAAhBo0D,YAElB,MAAA,CAAQ1qD,OAAOuqD,IAAS5oE,OAAA4J,EAAKu3B,EAAQ4nC,IACvC,CAqBgB,SAAAE,GACdrZ,EACAzuB,GAEA,IAEC+nC,EAAA57C,EAFiC67C,GAAUvZ,GAAkB,SAACyC,GAC7D,OAAAl6C,GAASk6C,EAAgB93C,KAAK,GAAG,OAD5B6uD,EAAWF,EAAA,GAAEG,EAAUH,EAI9B,GAAMI,EAA6ChpC,GAAQ8oC,EAAaG,IAElEC,EAAqBC,GAAUH,GAAa,SAACnX,GACjD,IAAMuX,EAA2C,CAC/CC,IAAK,GACLxoC,QAAS,CAAE,GAgBb,OAbAgxB,EAAOl9D,SAAQ,SAAC0W,GACd,IAAMo9D,EAkDZ,SAAyBp9D,EAAwBw1B,GAC/C,IAAMxsB,EAAWk0D,GAAoBl9D,EAAM4O,KAAM4mB,GAEjD,IAA8B,IAA1BxsB,EAASo0D,YACX,OAAOp0D,EAASo0D,YAGlB,OAAQ,CACV,CA1D0Ba,CAAgBj+D,EAAOw1B,IAEtB,IAAjB4nC,QACsC5yE,IAApCuzE,EAAWvoC,QAAQ4nC,KACrBW,EAAWvoC,QAAQ4nC,GAAe,IAEpCW,EAAWvoC,QAAQ4nC,GAAahnE,KAAK4J,IAErC+9D,EAAWC,IAAI5nE,KAAK4J,EAExB,IAEO+9D,CACT,IAEA,MAAO,CACL1vE,KAAMqvE,EACNQ,KAAML,EAEV,CAEgB,SAAAM,GACdvvD,EACAq1C,GAEA,GAAKA,GAAgD,IAA5BA,EAAiBp5D,OAI1C,OAAgC,IAA5Bo5D,EAAiBp5D,OACZo5D,EAAiB,GAGnB,CACLr1C,KAAAA,EACAqC,QACE,+BACAgzC,EACGlmD,KAAI,SAACiC,GACJ,OAAOob,GAAkBpb,EAAM4O,MAAQ,IAAM5O,EAAMiR,OACrD,IACCtb,KAAK,MACVuuD,SAAU/5C,GAAmBs8C,QAEjC,CAEA,SAASmX,GAAa59D,GACpB,OAAOuM,SAASvM,EAAM4O,KAAK,GAAI,GACjC,UAegBwvD,GACdv5C,EACAgC,EACAw3C,GAMA,OAJsBx3C,EAAWpC,MAAK,SAACyC,GAAS,gBAehDjC,EACAiC,EACAsO,GAEA,IAAKvQ,EACH,OAAO,EAIT,GAAqB,YAAjBiC,EAAU7E,GAAkB,CAC9B,IACAi8C,EAAkCpB,GADrBnuD,EAAiBmY,EAAUtY,MACoB4mB,GAApDynC,EAAQqB,EAARrB,SAAUG,EAAWkB,EAAXlB,YACZmB,EAAsB/oC,EAAQta,WAAU,SAACnK,GAAM,OAAK+Y,GAAQ/Y,EAAQkU,EAAarW,KAAM,IAE7F,IAAkB,IAAdquD,IAAoC,IAAjBG,GAAsBA,IAAgBmB,EAC3D,OAAY,CAEf,CAKD,OAAO,CACT,CArCIC,CAA6B35C,EAAcI,aAAciC,EAAWm3C,EAAQ,IAI5Eh7D,EAAAA,EAAA,CAAA,EACKwhB,GACHI,CAAAA,EAAAA,CAAAA,aAAc,OAIXJ,CACT,CCnZA,IAAM/kB,GAAQH,GAAY,sBAW1B,SACsB8+D,GAAKC,GAAA,OAAAC,GAAA3gE,MAAA/K,KAAAA,UA2C3B,CAAA,SAAA0rE,KATC,OASDA,GAAAj8C,EAAAC,IAAAC,MA3CO,SAAAg8C,EAAAC,OAAAltD,EAAAkT,EAAA7S,EAAAmQ,EAAA3U,EAAA4U,EAAAuQ,EAAAmsC,EAAAj4C,EAAA6M,EAAA/Q,OAAAA,IAAApf,MAAAw7D,SAAAC,GAAA,cAAAA,EAAA77C,KAAA67C,EAAAzpE,MAAA,KAAA,EASH4sB,GARFxQ,EAAIktD,EAAJltD,KACAkT,EAAag6C,EAAbh6C,cACA7S,EAAW6sD,EAAX7sD,YACAmQ,EAAQ08C,EAAR18C,SACA3U,EAAMqxD,EAANrxD,OACA4U,EAAOy8C,EAAPz8C,SAGED,QACS33B,IAATmnB,GACCkT,EAAc7P,WACdwZ,GAAqB3J,EAAc7P,WAAUgqD,CAAAA,EAAAzpE,KAAAypE,EAAAA,KAAAA,CAAAA,OAAAA,EAAA/gC,OAK1CtL,UAAAA,KAAAA,EACFA,GAAa,OADXA,EAAYxE,GAAuBxc,EAAMkT,EAAc7P,UAAWhD,EAAaxE,IAChEwxD,CAAAA,EAAAzpE,KAAAypE,EAAAA,KAAAA,CAAAA,OAAAA,EAAA/gC,OAIrBn+B,UAAAA,KAAAA,EAEMm/D,OAFNn/D,GAAM,MAAO,CAAEkV,UAAW6P,EAAc7P,UAAW2d,UAAAA,EAAW3gB,YAAAA,IAAcgtD,EAAAzpE,KAEtE0pE,EAAAA,GAAgBtsC,GAAUmsC,KAAAA,EAAAA,EAEKrrC,GAAuB9hB,EAAMkT,EAAc7P,WAAxE6R,EAAUi4C,EAAVj4C,WAAY6M,EAAYorC,EAAZprC,aAEpBtR,EAAQyE,GAAY,SAAC6K,EAAaC,GAAY,MAAM,CAClDnqB,MAAKnE,EAAAA,EACAsuB,CAAAA,EAAAA,GACH3c,CAAAA,EAAAA,CAAAA,UAAW0e,IAEd,IAAE,KAAAsrC,GAAAA,IAAAA,MAAAA,OAAAA,EAAA9gC,OAAA0gC,GAAAA,EACJ,KAAAD,GAAA3gE,MAAAvN,KAAAwC,UAAA,CAAA,SAUqB0gE,GAAMuL,GAAAC,OAAAA,GAAAnhE,MAAA/K,KAAAA,UAwB5B,CAAA,SAAAksE,KAfCA,OAeDA,GAAAz8C,EAAAC,IAAAC,MAxBO,SAAAw8C,EAAAC,GAAA,IAAA1tD,EAAAkT,EAAA7S,EAAAxE,EAAAmlB,EAAA,OAAAhQ,IAAApf,MAAA,SAAA+7D,GAAA,cAAAA,EAAAn8C,KAAAm8C,EAAA/pE,MAAA,KAAA,EAEDo9B,GAFyBhhB,EAAI0tD,EAAJ1tD,KAAMkT,EAAaw6C,EAAbx6C,cAAe7S,EAAWqtD,EAAXrtD,YAAaxE,EAAM6xD,EAAN7xD,OAE9C,OADXmlB,EAAYxE,GAAuBxc,EAAMkT,EAAc7P,UAAWhD,EAAaxE,IAChE8xD,CAAAA,EAAA/pE,KAAA+pE,EAAAA,KAAAA,CAAAA,OAAAA,EAAArhC,OAIrBn+B,UAAAA,KAAAA,EAEMm/D,OAFNn/D,GAAM,OAAQ,CAAE6yB,UAAAA,EAAW3gB,YAAAA,IAAcstD,EAAA/pE,KAEnC0pE,EAAAA,GAAgBtsC,GAAU,KAAA,EAAA,IAAA,MAAA,OAAA2sC,EAAAphC,OAAA,GAAAkhC,EAAA,KACjCD,GAAAnhE,MAAA/K,KAAAA,oBAgBeg9B,GAAOsvC,GACrB,IAAAvuC,EAAauuC,EAAbvuC,cACArf,EAAI4tD,EAAJ5tD,KACAqD,EAASuqD,EAATvqD,UACAmN,EAAQo9C,EAARp9C,SACA3U,EAAM+xD,EAAN/xD,OACA4U,EAAOm9C,EAAPn9C,QACAo9C,EAAYD,EAAZC,aACAC,EAAeF,EAAfE,gBAEA,IAAIt9C,EA8CJ,IACEu9C,EAAQ1uC,EACT,CAAC,MAAO7jB,GACPsyD,EAAgBzuC,GAAe,SAAC84B,GAC9BhqD,GAAM,yBAA0BgqD,GAChC4V,EAAQ5V,EACV,GACD,CAjDD,SAAS4V,EAAQ9tC,GACf,QAAapnC,IAATmnB,EAAoB,CACtB,IAAMguD,EAAmB3qD,GAAa+X,GAAqB,IAAI,GAEzDlG,EAAah4B,GAAO8iB,EAAMguD,EAAkB/tC,EAAYpkB,GAE9D1N,GAAM,QAAS,CAAE8xB,WAAAA,EAAY/K,WAAAA,EAAY84C,iBAAAA,IAEzCv9C,EAAQyE,GAAY,SAAC6K,EAAaC,GAChC,IAAIvJ,EAAeuJ,EAcnB,OAXA9K,EACGrxB,QACC,SAAC0xB,GACC,OAACC,EAAeD,IAAcK,EAAmBL,KACjDta,GAAgBsa,EAAUl7B,MAC7B,IACA1C,SAAQ,SAAC49B,GACR,IAAMtY,EAAO2Z,EAAU5W,EAAMuV,EAAUtY,MACvCwZ,EAAeuC,GAAgB+G,EAAatJ,EAAcxZ,EAC5D,IAEK,CACLpH,MAAO4gB,EAEX,GACD,MAECtoB,GAAM,aAAc,CAAE8xB,WAAAA,IAEtB4tC,EAAaxuC,GAAe,SAACU,EAAaC,GACxC,GAAID,EAAa,CAEf,MAAO,CACLlqB,MAAOmjB,GAAgB+G,EAAaC,EAFf,IAIxB,CACH,GAEH,CAUH,UAagBiuC,GAAQC,GACtB,IAAAluD,EAAIkuD,EAAJluD,KACAhiB,EAAIkwE,EAAJlwE,KACAk1B,EAAag7C,EAAbh7C,cACAi7C,EAAaD,EAAbC,cACA39C,EAAQ09C,EAAR19C,SACAI,EAAQs9C,EAARt9C,SACAH,EAAOy9C,EAAPz9C,QAEA,IAAID,GAAa0C,EAAc7P,UAA/B,CAMA,IAAM+qD,OACKv1E,IAATmnB,IACCsZ,GAAepG,EAAc7P,YAAckW,GAAiBrG,EAAc7P,YACvE8W,GAAqBjH,EAAc7P,UAAUpG,KAAMiW,EAAc7P,UAAUpG,MAC3EiW,EAAc7P,UAEpB,GAAIiH,EAAQ0P,GAAa9G,EAAc7P,YAErClV,GAAM,cAAe,CAAEkV,UAAW6P,EAAc7P,YAE5CuN,GACFA,EACE,CAAE5yB,KAAM,GAAIgiB,UAAMnnB,QACTA,IAATmnB,EAAqB,CAAEhiB,UAAMnF,EAAWmnB,KAAAA,GAAS,CAAEhiB,KAAMA,GAAQ,GAAIgiB,KAAAA,GACrE,CACEm2C,cAAe,KACfkY,YAAa,YAMnB,QAAax1E,IAATmnB,EAAoB,CACtB,IAAAsuD,EAAqCxsC,GAAuB9hB,EAAMouD,GAA1Dl5C,EAAUo5C,EAAVp5C,WAAY6M,EAAYusC,EAAZvsC,aAEpB5zB,GAAM,SAAU,CAAE+mB,WAAAA,EAAY7R,UAAW6P,EAAc7P,UAAW0e,aAAAA,IAElEtR,EAAQyE,GAAY,SAAC6K,EAAaC,SAAkB,CAClDnqB,MAAKnE,EAAAA,EAAA,CAAA,EACAsuB,GACH3c,CAAAA,EAAAA,CAAAA,UAAW8qD,EAAgBj7C,EAAc7P,UAAY0e,IAExD,GACF,CArCF,CAuCH,CAegB,SAAAwsC,GAAcC,GAC5B,IAAAxuD,EAAIwuD,EAAJxuD,KACAkT,EAAas7C,EAAbt7C,cACA2Q,EAAO2qC,EAAP3qC,QACArT,EAAQg+C,EAARh+C,SACAC,EAAO+9C,EAAP/9C,QAEA,IACED,QACS33B,IAATmnB,GACCkT,EAAc7P,WACdwZ,GAAqB3J,EAAc7P,WAJtC,CASA,IAAAorD,EAAkClD,GAChCvxC,GAAa9G,EAAc7P,WAC3BwgB,GAFMynC,EAAQmD,EAARnD,SAAUG,EAAWgD,EAAXhD,YAKlBt9D,GAAM,gBAAiB,CAAEm9D,SAAAA,IAEzB,IAAMoD,EAAU,CAAC3tD,OAAOuqD,IAGxB76C,EAFmBoQ,GAAU7gB,EAAM,CAAC0uD,KAEhB,SAAC3uC,EAAaC,GAChC,IAEM+B,EAAe3G,GADLswC,GAAsB,CAAEJ,SADpBA,EAAYtrD,EAAwB9mB,OAASoyE,EAAW,EAAIA,EACjBG,YAAAA,GAAe5nC,IAC3B,GAEnD,MAAO,CACLhuB,MAAKnE,EAAAA,EAAA,CAAA,EACAsuB,GACH3c,CAAAA,EAAAA,CAAAA,UAAW0e,IAGjB,GAvBC,CAwBH,CAegB,SAAA4sC,GAAiBC,GAC/B,IAAA5uD,EAAI4uD,EAAJ5uD,KACAkT,EAAa07C,EAAb17C,cACA2Q,EAAO+qC,EAAP/qC,QACArT,EAAQo+C,EAARp+C,SACAC,EAAOm+C,EAAPn+C,QAEA,IACED,QACS33B,IAATmnB,GACCkT,EAAc7P,WACdwZ,GAAqB3J,EAAc7P,WAJtC,CASA,IAAQioD,EAAaC,GAAoBvxC,GAAa9G,EAAc7P,WAAYwgB,GAAxEynC,SAERn9D,GAAM,oBAAqB,CAAEm9D,SAAAA,IAO7B76C,EAFmBrzB,GAAa4iB,EAHhB,CAACe,OAAOuqD,IAET,CAAC,CAAE1rE,IAAK,GAAIvF,MADVy7B,EAAc9V,EAAwB,IAAM,CAAE,EAAG,MAPjE,CAYH,CAegB,SAAA6uD,GAAgBC,GAC9B,IAAA9uD,EAAI8uD,EAAJ9uD,KACAkT,EAAa47C,EAAb57C,cACA2Q,EAAOirC,EAAPjrC,QACArT,EAAQs+C,EAARt+C,SACAC,EAAOq+C,EAAPr+C,QAEA,IACED,QACS33B,IAATmnB,GACCkT,EAAc7P,WACdwZ,GAAqB3J,EAAc7P,WAJtC,CASA,IAAA0rD,EAAkCxD,GAChCvxC,GAAa9G,EAAc7P,WAC3BwgB,GAFMynC,EAAQyD,EAARzD,SAAUG,EAAWsD,EAAXtD,YAKlBt9D,GAAM,mBAAoB,CAAEm9D,SAAAA,IAE5B,IAAM0D,EAAe1D,EAAW,EAC1B2D,EAAc,CAACluD,OAAOiuD,IAEtBrxD,EAAS,CAAC,CAAE/d,IAAK,GAAIvF,MADVy7B,EAAc9V,EAAwB,IAAM,CAAE,EAAG,KAQlEyQ,EAJEu+C,EAAgBhvD,EAAwB9mB,OACpCkE,GAAa4iB,EAAMivD,EAAatxD,GAChCjiB,GAAOskB,EAAM,GAAIrC,IAEH,SAACoiB,EAAaC,GAChC,IACM+B,EAAe3G,GADJswC,GAAsB,CAAEJ,SAAU0D,EAAcvD,YAAAA,GAAe5nC,IAC5B,GAEpD,MAAO,CACLhuB,MAAKnE,EAAAA,EACAsuB,CAAAA,EAAAA,GACH3c,CAAAA,EAAAA,CAAAA,UAAW0e,IAGjB,GA7BC,CA8BH,CAegB,SAAAmtC,GAAWC,OACzBnvD,EAAImvD,EAAJnvD,KACAkT,EAAai8C,EAAbj8C,cACA2Q,EAAOsrC,EAAPtrC,QACArT,EAAQ2+C,EAAR3+C,SACAC,EAAO0+C,EAAP1+C,QAEA,IACED,QACS33B,IAATmnB,GACCkT,EAAc7P,WACdwZ,GAAqB3J,EAAc7P,WAJtC,CASA,IAAA+rD,EAAkC7D,GAChCvxC,GAAa9G,EAAc7P,WAC3BwgB,GAFMynC,EAAQ8D,EAAR9D,SAAUG,EAAW2D,EAAX3D,YAKlBt9D,GAAM,aAAc,CAAEm9D,SAAAA,IAKtB76C,EAFmB2Q,GAAU,CADb,CAACrgB,OAAOuqD,OAGJ,SAACvrC,EAAaC,GAChC,IAAMqvC,EACJ/D,EAAYvrC,EAA+B7mC,OACvCoyE,EACAA,EAAW,EACTA,EAAW,OACXzyE,EAEFkpC,OACYlpC,IAAhBw2E,EACIj0C,GACEswC,GAAsB,CAAEJ,SAAU+D,EAAa5D,YAAAA,GAAe5nC,IAC9D,GAEF,KAIN,OAFA11B,GAAM,2BAA4B,CAAEm9D,SAAAA,EAAU+D,YAAAA,EAAattC,aAAAA,IAEpD,CACLlsB,MAAKnE,EAAAA,KACAsuB,GAAY,CAAA,EAAA,CACf3c,UAAW0e,IAGjB,GApCC,CAqCH,CAeM,SAAUutC,GAAQC,GAUb,IATTC,EAAUD,EAAVC,WACAC,EAAYF,EAAZE,aACAC,EAAaH,EAAbG,cACA1vD,EAAIuvD,EAAJvvD,KACAqD,EAASksD,EAATlsD,UACAmN,EAAQ++C,EAAR/+C,SACA3U,EAAM0zD,EAAN1zD,OACA4U,EAAO8+C,EAAP9+C,QACAk/C,EAAaJ,EAAbI,cAEA,IAAIn/C,EAAJ,CAIA,IAAMuO,W5DoBN/e,EACAqD,EACAzH,GAEA,GAAkB,WAAdA,EACF,MAAO,GAGT,GAAkB,UAAdA,EACF,MAAO,GAGT,GAAkB,cAAdA,QAAsC/iB,IAATmnB,EAAoB,CACnD,IAAM6W,EAAaxT,EAAYuX,GAAcvX,GAAa,GACpDsB,EAASuP,EAAMlU,EAAM6W,GAE3B,GAAIntB,MAAMoS,QAAQ6I,KAAY2F,EAAQ3F,GAAS,CAC7C,IAAMirD,EAAc3kE,GAAM0Z,GAC1B,OAAI1J,GAAgB20D,GACXC,GAAcD,GAAa,SAACv1E,GACjC,OAAOqP,MAAMoS,QAAQzhB,GACjB,GACA2gB,GAAS3gB,QACPxB,EACA,EACR,IAGO,EAEV,CACF,CAKD,MAAO,EACT,C4DzDmBi3E,CAAe9vD,EAAMqD,EAAWmsD,GAEjD,QAAa32E,IAATmnB,EAAoB,CACtB,IAAM/hB,EAAO4d,EAAOG,UAAU+iB,GACxB7J,EAAah4B,GAAO8iB,EAAMqD,EAAWplB,EAAM4d,GACjD1N,GAAM,WAAY,CAAEqhE,WAAAA,EAAYt6C,WAAAA,EAAY6J,SAAAA,EAAU9gC,KAAAA,IAEtD,IAAMs3B,EAAYyB,GAChB9B,EAAWrxB,QAAO,SAAC0xB,GAAc,MAAiB,QAAjBA,EAAU7E,IAAiC,YAAjB6E,EAAU7E,OAGvED,EAAQyE,GAAY,SAAC6K,EAAaC,GAEhC,GAAIzK,EAAJ,CACE,IAAMtY,EAAO2Z,EAAUmJ,EAAaxK,EAAUtY,MAE9C,GAAIhC,GAAgB8jB,GAClB,MAAO,CACLlpB,MAAKnE,EAAAA,EAAA,CAAA,EACA8hB,GAAmBuM,EAAaC,EAAc/iB,EAAMic,KACvD7V,CAAAA,EAAAA,CAAAA,UAAWosD,EAAepzC,GAAsBpf,GAAQ+iB,EAAa3c,aAK3E,GAAiB,KAAb0b,EAAiB,CAEnB,IAAMpa,EAAU2F,EAAQrN,GAA4C,KAApCiX,EAAM6L,EAAajJ,EAAQ7Z,IAE3D,MAAO,CAELpH,MAAOke,GACLgM,EAAWruB,EAAAA,EAAA,CAAA,EAENsuB,GAAY,CAAA,EAAA,CACf3c,UAAWrI,GAAS2J,GAChB0W,GAAmBpe,GAAM,GACzBme,GAAqBne,GAAM,KAEjCA,GAGL,CAGF,MACH,IAEA9O,GAAM,eAEFonB,GACe,KAAbwJ,GAEFgxC,IAAM,WAAM,OAAApsD,GAA4B+rD,EAAe,IAAI,EAAMM,GAAoB,GAG1F,KAAM,CAEL7hE,GAAM,WAAY,CAAEqhE,WAAAA,EAAYzwC,SAAAA,IAEhC,IAAM9hB,EAAiB,GACvB0yD,EAAc5wC,GAAU,SAACgB,EAAaC,GAAY,MAAM,CACtDnqB,MAAKnE,EAAAA,EAAA,CAAA,EACAsnB,GAAgB+G,EAAaC,EAAc/iB,IAAK,CAAA,EAAA,CACnDoG,UAAWpI,GAAgB8jB,GACvB1C,GAAsBpf,GACtBme,GAAqBne,GAAM,KAElC,GACF,CAvEA,CAwEH,CAeA,SACsBgzD,GAAiBC,UAAAC,GAAA9jE,MAAAvN,KAAAwC,UAAA,CAAA,SAAA6uE,KAuFtC,OAvFsCA,GAAAp/C,EAAAC,IAAAC,MAAhC,SAAAm/C,EAAAC,GAAA,IAAAC,EAAAb,EAAAC,EAAA1vD,EAAAqD,EAAAmN,EAAA3U,EAAA4U,EAAAk/C,EAAAhwC,EAAA9b,EAAA0sD,EAAA,OAAAv/C,IAAApf,MAAA4+D,SAAAC,GAAA,cAAAA,EAAAj/C,KAAAi/C,EAAA7sE,MACLsmB,KAAAA,KAAAA,EAAImmD,OACJZ,EAAYY,EAAZZ,aACAC,EAAaW,EAAbX,cACA1vD,EAAIqwD,EAAJrwD,KACAqD,EAASgtD,EAAThtD,UACAmN,EAAQ6/C,EAAR7/C,SACA3U,EAAMw0D,EAANx0D,OACA4U,EAAO4/C,EAAP5/C,QACAk/C,EAAaU,EAAbV,cACAhwC,EAAQ0wC,EAAR1wC,UAIInP,EAAQ,CAAAigD,EAAA7sE,KAAA,EAAA,KAAA,CAAA,OAAA6sE,EAAAnkC,OAIRhT,UAAAA,KAAAA,EAAAA,IAAAA,GAAejW,GAAU,CAAAotD,EAAA7sE,aAS1B,OANKigB,GAAmBR,EAAU+Y,KAEnCuD,EAAQjuB,EAAAA,KAAM2R,GAAS,CAAA,EAAA,CAAE+Y,MAAM,KAC/B2zC,IAAM,kBAEJpsD,GAA4B+rD,EAAexlD,EAAMrG,EAAiBmsD,OACnES,EAAAnkC,OAICpiB,UAAAA,KAAAA,EAAAA,GAAS,MAATA,EAAYumD,CAAAA,EAAA7sE,cACd0rE,GAAS,CACPE,WAAY,SACZC,aAAAA,EACAC,cAAAA,EACA1vD,KAAAA,EACAqD,UAAAA,EACAmN,SAAAA,EACA3U,OAAAA,EACA4U,QAAAA,EACAk/C,cAAAA,IACAc,EAAA7sE,KAAA,GAAA,MAAA,KAAA,GAAA,GACgB,MAATsmB,EAAYumD,CAAAA,EAAA7sE,KACrB0rE,GAAAA,KAAAA,CAAAA,GAAS,CACPE,WAAY,QACZC,aAAAA,EACAC,cAAAA,EACA1vD,KAAAA,EACAqD,UAAAA,EACAmN,SAAAA,EACA3U,OAAAA,EACA4U,QAAAA,EACAk/C,cAAAA,IACAc,EAAA7sE,KAEE21B,GAAAA,MAAAA,KAAAA,GAAAA,IAAAA,GAAiBlW,SAAuBxqB,IAATmnB,EAAkB,CAAAywD,EAAA7sE,KACnD,GAAA,KAAA,CAAKqX,GAAgBiZ,EAAMlU,EAAMqD,EAAUpG,SAGnC4G,GAAmBR,EAAU+Y,KAEnCuD,EAAQjuB,EAAAA,KAAM2R,GAAS,CAAA,EAAA,CAAE+Y,MAAM,KAC/B2zC,IAAM,kBAEJpsD,GAA4B+rD,EAAexlD,EAAMrG,EAAiBmsD,QAOrES,EAAA7sE,sBAE4C,OAA7CuK,GAAM,6BAA8B,CAAE+b,KAAAA,IAAOumD,EAAA7sE,KAAA,GACvC8sE,GAA2B,CAC/BxmD,KAAAA,EACAwlD,cAAAA,EACA1vD,KAAAA,EACAqD,UAAAA,EACAmN,SAAAA,EACA3U,OAAAA,EACA4U,QAAAA,EACAk/C,cAAAA,IACAc,KAAAA,GAAAA,IAAAA,MAAAA,OAAAA,EAAAlkC,OAAA,GAAA6jC,EAGP,KAAAD,GAAA9jE,WAAA/K,UAAA,CAAA,SAacovE,GAA0BC,GAAAC,OAAAA,GAAAvkE,MAAAvN,KAAAwC,UAkCzC,CAAA,SAAAsvE,KAFCA,OAEDA,GAAA7/C,EAAAC,IAAAC,MAlCA,SAAA4/C,EAAAC,OAAAC,EAAArB,EAAA1vD,EAAAqD,EAAAmN,EAAA3U,EAAA4U,EAAAk/C,EAAA9rD,EAAA,OAAAmN,IAAApf,MAAA,SAAAo/D,GAAA,cAAAA,EAAAx/C,KAAAw/C,EAAAptE,MACEsmB,KAAAA,EAOa,GAPbA,EAAI4mD,OACJpB,EAAaoB,EAAbpB,cACA1vD,EAAI8wD,EAAJ9wD,KACAqD,EAASytD,EAATztD,UACAmN,EAAQsgD,EAARtgD,SACA3U,EAAMi1D,EAANj1D,OACA4U,EAAOqgD,EAAPrgD,QACAk/C,EAAamB,EAAbnB,eAEIn/C,EAAQ,CAAAwgD,EAAAptE,KAAAotE,EAAAA,KAAAA,CAAAA,OAAAA,EAAA1kC,wBAKZgjC,GAAS,CACPE,WAAY,QACZC,cAAc,EACdC,cAAAA,EACA1vD,KAAAA,EACAqD,UAAAA,EACAmN,SAAAA,EACA3U,OAAAA,EACA4U,QAAAA,EACAk/C,cAAAA,IAKI9rD,GAAmB+Y,GAAmBvZ,GAE5C0sD,IAAM,WAAA,OAAMpsD,GAA4B+rD,EAAexlD,EAAMrG,EAAiBmsD,GAAmB,IAAC,KAAA,EAAA,IAAA,MAAA,OAAAgB,EAAAzkC,OAAA,GAAAskC,EAAA,KACnGD,GAAAvkE,MAAA/K,KAAAA,UAOD,CAAA,SAASyuE,GAAMrpE,GACb8yC,YAAW,WAAM,OAAAA,WAAW9yC,EAAU,GACxC,CAEA,SAASspE,GAAmB3zE,GAO1BA,SAAAA,EAASqqB,SACX,uiBC3tBGruB,EAAS,oEADZ6E,GAEKvB,EAAAisB,EAAAzqB,8CADF9E,EAAS,mEAVC2F,EAAwB6U,EAAxB7U,KACAgiB,EAAyBnN,EAAzBmN,KACAK,EAA4BxN,EAA5BwN,YACAxE,EAAkBhJ,EAAlBgJ,kMAERjF,EAAA,EAAAmJ,OAAmBlnB,IAATmnB,EAAuB,CAAAA,KAAAA,GAAW,CAAAhiB,KAAMA,GAAQ,oBAC1D4Y,EAAA,EAAAq6D,EAAYlmD,GAASvK,GAAQT,EAASM,EAAaxE,GAAS1C,qmCCSjD8W,EAAA,IAAAojC,GAAA,CAAAx5D,MAAA,CAAAoE,KAAA5F,KAAK43B,kGAAL,EAAAt3B,IAAA43B,EAAAtyB,KAAA5F,KAAK43B,6IAGhB,MAAA6V,EAAAztC,KAAK2F,KAAI,2EAAT,EAAArF,GAAAmtC,KAAAA,EAAAztC,KAAK2F,KAAI,KAAAiC,GAAAwC,EAAAqjC,gEAJPuZ,EAAAhnD,KAAK43B,MAAIngB,GAAAzX,GAGTs+D,EAAAt+D,KAAK2F,MAAIwT,GAAAnZ,qFAXP4G,GAAAqS,EAAA,QAAAF,EAAAhX,GAAAijC,GAAW,0BAA2BhlC,EAAW,GAAAA,KAAKk1B,YAAS,kBAK/DtuB,GAAAqS,EAAA,QAAAm+C,EAAAp3D,KAAK+3D,oBACF/3D,EAAI,GAAC4a,WAAY,mBAR7B/V,GAgBQvB,EAAA2V,EAAAnU,8GAND9E,KAAK43B,8GAGL53B,KAAK2F,iEAXH+S,GAAA,EAAApY,GAAAyY,KAAAA,EAAAhX,GAAAijC,GAAW,0BAA2BhlC,EAAW,GAAAA,KAAKk1B,YAAS,sCAK/Dxc,GAAA,EAAApY,GAAA82D,KAAAA,EAAAp3D,KAAK+3D,0CACF/3D,EAAI,GAAC4a,WAAY,yJAbhBiZ,EAAgBrZ,EAAhBqZ,KACAglD,EAAyCr+D,EAAzC0a,UAAAA,OAAgC10B,IAAvBq4E,OAAuBr4E,EAASq4E,EACzCC,EAA0Bt+D,EAA1Bs+D,8JAMA,SAAA7yE,GACT6yE,IACAjlD,EAAK4nC,QAAQx1D,2/FC2DS2xB,EAAA,IAAAojC,GAAA,CAAAx5D,MAAA,CAAAoE,KAAA5F,MAAK43B,kGAAL,EAAAt3B,IAAA43B,EAAAtyB,KAAA5F,MAAK43B,uKAElBu/B,EAAAn3D,MAAK2F,KAAI,GAHL4R,EAAAvX,MAAK43B,MAAIze,GAAAnZ,uOAJP4G,GAAAqS,EAAA,QAAAm+C,EAAAp3D,MAAK+3D,OACF9+C,EAAA2B,SAAAsgD,EAAAl7D,MAAK4a,SACRhU,GAAAqS,EAAA,QAAAF,EAAAhX,GAAA/B,MAAKk1B,WAAS,iEANzBrwB,GAaIvB,EAAAy1E,EAAAj0E,GAZFzB,GAWQ01E,EAAA9/D,sGAJI2e,gHAGTlf,GAAA,EAAApY,IAAA62D,KAAAA,EAAAn3D,MAAK2F,KAAI,KAAAiC,GAAAyxB,EAAA89B,KAPHz+C,GAAA,EAAApY,GAAA82D,KAAAA,EAAAp3D,MAAK+3D,2BACFr/C,GAAA,EAAApY,GAAA46D,KAAAA,EAAAl7D,MAAK4a,6BACRlC,GAAA,EAAApY,GAAAyY,KAAAA,EAAAhX,GAAA/B,MAAKk1B,WAAS,2OAZjB6rC,mBAKH/gE,EAAK,iBAAVa,OAAIC,GAAA,+VAPEd,EAAgB,sBAFPA,EAAO,gGAO+CA,EAAK,uBAA7BA,EAAO,qIAd5D6E,GAkCKvB,EAAAuU,EAAA/S,0BA/BHzB,GASQwU,EAAAoB,wBAER5V,GAmBKwU,EAAAH,GAlBHrU,GAiBIqU,EAAAshE,6EAxBMh5E,EAAU,iBARsDA,EAAW,yIAS3EA,EAAgB,kCAFPA,EAAO,wBASjBA,EAAK,YAAVa,OAAIC,GAAA,EAAA,4GAAJD,OAAIC,EAAAgwB,EAAAjwB,OAAAC,GAAA,oCAFiEd,EAAK,kCAA7BA,EAAO,oGAEpDa,OAAIC,GAAA,4PAvDM0Z,EAALiwB,MAAAA,OAAK,IAAAwuC,EAAA,GAAAA,EACLC,EAAqC1+D,EAArCu9C,MAAAA,OAAK,IAAAmhB,OAAuB14E,EAAS04E,EACrCC,EAAe3+D,EAAfgE,MAAAA,OAAK,IAAA26D,EAAG,QAAOA,EAEtBC,GAAU,WAWLC,IACP96D,EAAA,EAAA66D,GAAU,GAGH,SAAAvc,EAAc52D,GAEP,WADAsoB,GAAkBtoB,KAE9BA,EAAMM,iBACNgY,EAAA,EAAA66D,GAAU,IAIdntE,IAAO,WACL7H,SAASgC,iBAAiB,QAASizE,GACnCj1E,SAASgC,iBAAiB,UAAWy2D,MAGvCxwD,IAAS,WACPjI,SAASiC,oBAAoB,QAASgzE,GACtCj1E,SAASiC,oBAAoB,UAAWw2D,2LA5BvCt+C,EAAA,EAAA+6D,EAAmB7uC,EAAMnH,OAAO,SAAAzP,GAAI,OAAuB,IAAlBA,EAAKjZ,oCAGzC,IAAA2+D,EAAaH,EAGnBj4B,YAAU,WAAA,OAAA5iC,EAAA,EAAQ66D,GAAWG,aA+CV,SAAA1lD,EAAA5tB,UAAU4tB,EAAK4nC,QAAQx1D,EAAK,6lCCpCjCjG,EAAI,GAACw5E,KAAK5hD,+GAAV53B,EAAI,GAACw5E,KAAK5hD,qKAEvB53B,EAAI,GAACw5E,KAAK7zE,KAAI,KAHV3F,EAAI,GAACw5E,KAAK5hD,MAAIze,GAAAnZ,gFAVZglC,GAAW,0BAA2BhlC,KAAWA,EAAI,GAACw5E,KAAKtkD,YAAS,kFAGpEl1B,EAAI,GAACw5E,KAAKzhB,OAKP9+C,EAAA2B,SAAAsgD,EAAAl7D,EAAK,GAAAw5E,KAAK5+D,WAAY,mBATlC/V,GAeQvB,EAAA2V,EAAAnU,uFAJD9E,EAAI,GAACw5E,KAAK5hD,gIAGd53B,EAAI,GAACw5E,KAAK7zE,KAAI,KAAAiC,GAAAyxB,EAAA89B,uBAbRnyB,GAAW,0BAA2BhlC,KAAWA,EAAI,GAACw5E,KAAKtkD,YAAS,qDAGpEl1B,EAAI,GAACw5E,KAAKzhB,2BAKPr/C,GAAA,EAAApY,GAAA46D,KAAAA,EAAAl7D,EAAK,GAAAw5E,KAAK5+D,WAAY,wKAVb4D,MAAAxe,KAAKwe,qKAAL,EAAAle,IAAAm5E,EAAAj7D,MAAAxe,KAAKwe,8MAbfqV,EAAwBrZ,EAAxBqZ,KACA6lD,EAAyCl/D,EAAzC0a,UAAAA,OAAgC10B,IAAvBk5E,OAAuBl5E,EAASk5E,EACzCZ,EAA0Bt+D,EAA1Bs+D,4LAEVv6D,EAAA,EAAEksB,EAAQ5W,EAAK4W,MAAM12B,KAAK,SAAA8f,GAAIxa,OAAAA,EAAAA,KAC1Bwa,GAAI,CAAA,EAAA,CACP4nC,QAAU,SAAAx1D,GACR6yE,IACAjlD,EAAK4nC,QAAQx1D,oBAWJ,SAAAA,GACT6yE,IACAjlD,EAAK2lD,KAAK/d,QAAQx1D,4kEC6FjB,MAAAwnC,EAAA4wB,GAAgBr+D,EAAI,IAAA,2EAApB,EAAAM,GAAAmtC,KAAAA,EAAA4wB,GAAgBr+D,EAAI,IAAA,KAAA4H,GAAAwC,EAAAqjC,uJAFrB5oC,GAA4BvB,EAAAisB,EAAAzqB,uEA/BnBmxB,EAAA9kB,GAAAnR,KAAKyqC,oBAAV5pC,OAAIC,GAAA,gNADR+D,GA8BKvB,EAAAisB,EAAAzqB,4FA7BImxB,EAAA9kB,GAAAnR,KAAKyqC,eAAV5pC,OAAIC,GAAA,EAAA,4GAAJD,OAAIC,EAAAgwB,EAAAjwB,OAAAC,GAAA,mDAAJD,OAAIC,GAAA,mzBA0BD,MAAA2sC,EAAA4wB,GAAgBr+D,EAAO,KAAA,2EAAvB,EAAAM,GAAAmtC,KAAAA,EAAA4wB,GAAgBr+D,EAAO,KAAA,KAAA4H,GAAAwC,EAAAqjC,uJAFxB5oC,GAA4BvB,EAAAisB,EAAAzqB,uEAjBnBugE,EAAAl0D,GAAAnR,MAAQyqC,oBAAb5pC,OAAIC,GAAA,mNADR+D,GAgBKvB,EAAAisB,EAAAzqB,4FAfIugE,EAAAl0D,GAAAnR,MAAQyqC,eAAb5pC,OAAIC,GAAA,EAAA,4GAAJD,OAAIC,EAAAgwB,EAAAjwB,OAAAC,GAAA,mDAAJD,OAAIC,GAAA,oLAHyBd,EAAO,kIAAPA,EAAO,8MAFfA,EAAO,kIAAPA,EAAO,yKAiBzB,MAAAytC,EAAA4wB,GAAgBr+D,EAAU,KAAA,2EAA1B,EAAAM,GAAAmtC,KAAAA,EAAA4wB,GAAgBr+D,EAAU,KAAA,KAAA4H,GAAAwC,EAAAqjC,8DAHxBA,EAAAztC,MAAW2F,KAAI,oGADlBd,GAEKvB,EAAAisB,EAAAzqB,4BADF,EAAAxE,GAAAmtC,KAAAA,EAAAztC,MAAW2F,KAAI,KAAAiC,GAAAwC,EAAAqjC,uJAHlB5oC,GAA4BvB,EAAAisB,EAAAzqB,iHAFsB9E,EAAU,kIAAVA,EAAU,+NAFlBA,EAAU,kIAAVA,EAAU,oSADjD,MAAAq8D,IAAAA,IAAAoB,GAAaz9D,EAAU,WAElB,MAAAu+D,IAAAA,IAAAb,GAAqB19D,EAAU,WAE/B,MAAAw+D,IAAAA,IAAAjB,GAAgBv9D,EAAU,WAE1B,MAAA25E,IAAAA,IAAAnc,GAAYx9D,EAAU,qgBAbjC,MAAAq8D,IAAAA,IAAAoB,GAAaz9D,EAAO,WAEf,MAAAu+D,IAAAA,IAAAb,GAAqB19D,EAAO,WAE5B,MAAAw+D,IAAAA,IAAAZ,GAAoB59D,EAAO,WAkB3B,MAAA25E,IAAAA,IAAApc,GAAgBv9D,EAAO,qgBA7BlC,MAAAq8D,IAAAA,IAAAoB,GAAaz9D,EAAI,UAEZ,MAAAu+D,IAAAA,IAAAb,GAAqB19D,EAAI,UAEzB,MAAAw+D,IAAAA,IAAAb,GAAiB39D,EAAI,UAgCrB,MAAA25E,IAAAA,IAAApc,GAAgBv9D,EAAI,0bAWZ45E,kGAEa55E,EAAG,yKALlC6E,GAOKvB,EAAAgV,EAAAxT,GANHzB,GAKKiV,EAAAH,GAJH9U,GAEK8U,EAAAT,wBACLrU,GAAoC8U,EAAAN,iDAAT7X,EAAG,+JAlD7BA,EAAK,iBAAVa,OAAIC,GAAA,sFA4CDd,EAAG,IAAAmZ,GAAAnZ,iMAnDV6E,GA6DKvB,EAAAisB,EAAAzqB,6GAxDS9E,EAAa,kEAElBA,EAAK,YAAVa,OAAIC,GAAA,EAAA,yGAAJD,OAAIC,EAAAgwB,EAAAjwB,OAAAC,GAAA,YA4CDd,EAAG,qJA5CNa,OAAIC,GAAA,yKAbG,SAAAu9D,GAAgBxqC,UACvBjd,QAAQZ,MAAM,oCAAqC6d,GAC5C,6BA7CLgmD,EAJOpvC,EAAwBjwB,EAAxBiwB,MACAquC,EAA0Bt+D,EAA1Bs+D,eACAgB,EAAuBt/D,EAAvBs/D,IAIX7tE,IAAO,WACC,IAAA8tE,EAAqB1oE,MAAMC,KAAKuoE,EAAep6D,iBAAiB,WAAW6uC,MAC9E,SAAAr1C,GAAY,OAAAA,EAAO2B,QAAQ,IAG1Bm/D,GACFA,EAAmBj6D,eAIjBk6D,EAAgB,CACpBC,QAAS,KACTC,UAAW,OACXC,UAAW,OACXC,WAAY,gJAGL,SAAcn0E,OACf4gC,EAAQtY,GAAkBtoB,GAC1B0I,EAA0DqrE,EAAiBnzC,MAE7El4B,GAAa1I,EAAM3C,OAAM,CAC3B2C,EAAMM,qBAKAynB,EAAUvB,GAAkB,CAChCE,YAJmCtb,MAAMC,KACzCuoE,EAAep6D,iBAAiB,2BAIhCmN,eAAgB3mB,EAAM3C,OACtBqL,UAAAA,EACAme,QAAU,SAAA9oB,GACD,MAAsC,sBAAtCA,EAAQ+C,aAAa,gBAG5BinB,GACFA,EAAQlO,6DAeH+5D,EAAc95D,y/DC03DViL,UAAAhrB,MAAcgrB,uDAIZhrB,EAAe,kBACbA,EAAiB,WACxBA,EAAU,WACVA,EAAU,WACVA,EAAa,gBACRA,EAAkB,kBAChBA,EAA6B,WACpCA,EAAU,8PAXP,KAAAM,EAAA,KAAA+5E,EAAArvD,UAAAhrB,MAAcgrB,mWAmBdA,UAAAhrB,MAAcgrB,mBACfhrB,EAAyB,wJADxB,KAAAM,EAAA,KAAAg6E,EAAAtvD,UAAAhrB,MAAcgrB,waAyI3BnmB,GAGKvB,EAAA6U,EAAArT,gHA1HA,YAAStE,IAATR,MAAkB,+HAPT,gIAHd6E,GASOvB,EAAA0uB,EAAAltB,GARLzB,GAOC2uB,EAAAlqB,oEADW9H,EAAW,odA+CVQ,WACCR,EAAY,YACbA,EAAiB,YACjBA,EAAW,YACXA,EAAiB,8BAKnBA,EAAI,YAEE86B,YAAA96B,MAAc86B,YACTC,iBAAA/6B,MAAc+6B,iBACZC,mBAAAh7B,MAAcg7B,6CAEZ0qC,6BAAA6U,EAAAv6E,0BAAAu6E,EAAc7vC,SACzB1f,UAAAhrB,MAAcgrB,6CAEHxsB,YAIrBwB,EAAU,KAAAkoD,GAAAloD,KA0BVA,EAAc,KAAAmoD,GAAAnoD,8DAwBuCA,EAA2B,iSAjEtB,oBAf/D6E,GAcKvB,EAAAoU,EAAA5S,0BACLD,GAaKvB,EAAAuU,EAAA/S,oVAXM9E,EAAI,KAEE,KAAAM,EAAA,KAAAslE,EAAA9qC,YAAA96B,MAAc86B,aACT,KAAAx6B,EAAA,KAAAslE,EAAA7qC,iBAAA/6B,MAAc+6B,kBACZ,KAAAz6B,EAAA,KAAAslE,EAAA5qC,mBAAAh7B,MAAcg7B,iEAEZ,QAAA16B,EAAA,KAAAslE,EAAAF,+BAAA1lE,0BAAAw6E,EAAc9vC,UACzB,KAAApqC,EAAA,KAAAslE,EAAA56C,UAAAhrB,MAAcgrB,mDAMxBhrB,EAAU,gIA0BVA,EAAc,giBA3Fd,MAAS,KAATA,EAAS,UAAeQ,IAATR,MAAkB,saAqEhCinB,6BAAA5c,OAAAgH,MAAMoS,QAAQzjB,MAAW8nC,UAAY,QAAU,SAAO,sBAIpDlQ,KAAMioC,GACNl6D,KAAM,wBACNoyD,MAAO,yCAKP6D,YAAa57D,EAAA,MAGb2F,KAAM,cACNoyD,MAAO,sCACP0D,QAASz7D,EAAA,mGAhBX,OAAAM,EAAA,KAAAo+D,EAAAz3C,QAAA5c,qBAAAA,OAAAgH,MAAMoS,QAAQzjB,MAAW8nC,UAAY,QAAU,SAAO,gRA0B9CwzB,QAAAt7D,EAAA,QAGF43B,KAAM8nC,GACN/5D,KAAM,KACNoyD,MAAO,+BACP0D,QAASz7D,EAAA,KAGT43B,KAAM6iD,GACN90E,KAAM,0BACNoyD,MAAO,8DACP0D,QAASz7D,EAAA,cAIRA,EAAK,gGAhBJ,EAAAM,EAAA,KAAAo+D,EAAApD,QAAAt7D,EAAA,QAGF43B,KAAM8nC,GACN/5D,KAAM,KACNoyD,MAAO,+BACP0D,QAASz7D,EAAA,KAGT43B,KAAM6iD,GACN90E,KAAM,0BACNoyD,MAAO,8DACP0D,QAASz7D,EAAA,sRAtFPs7D,QAAAt7D,EAAA,QAGF43B,KAAM6iD,GACN90E,KAAM,kBACNoyD,MAAO,0DACP0D,QAASz7D,EAAA,uNANP,EAAAM,EAAA,KAAAo+D,EAAApD,QAAAt7D,EAAA,QAGF43B,KAAM6iD,GACN90E,KAAM,kBACNoyD,MAAO,0DACP0D,QAASz7D,EAAA,+rBApEpBA,EAAW,IAAA+nD,GAAA/nD,KAmBXA,EAAa,IAAA06E,GAAA16E,gDAUZA,EAAK,MAAA,iMAnCUA,EAAW,qBAJlC6E,GA8KKvB,EAAAisB,EAAAzqB,uGAhLwB9E,EAAqB,oBAOpCA,EAAa,sBACXA,EAAe,wBACbA,EAAiB,6BAG5BA,EAAW,+GAmBXA,EAAa,2JAzBGA,EAAW,0LAhyD1B8V,EAAQH,GAAY,uBAEpBglE,EAA0B,oBAAXt4E,OACrByT,EAAM,SAAU6kE,OASZC,EACAlqD,EACA2mD,EAsDA1vD,EACAhiB,EAhEI0Y,EAASxR,GAAoB,gBAA7BwR,KACFw8D,EAAcx4D,KACdy4D,EAAmBz4D,KAEjB04D,EACNluE,GAAiC,kBAD3BskB,EAAiB4pD,EAAjB5pD,kBAAmBP,EAAkBmqD,EAAlBnqD,mBAMvBsW,GAAW,EACT8zC,EAAOtiB,KAEFvgC,EAAiB3d,EAAjB2d,SACA8iD,EAAwBzgE,EAAxBygE,gBACAC,EAA6C1gE,EAA7C0gE,kBACAC,EAAoB3gE,EAApB2gE,YACAC,EAAsB5gE,EAAtB4gE,cACAnyD,EAAgCzO,EAAhCyO,wBACAC,EAAgC1O,EAAhC0O,wBACA1F,EAAkBhJ,EAAlBgJ,OACA63D,EAAoC7gE,EAApC6gE,gBACAvhB,EAA2Bt/C,EAA3Bs/C,UACAC,EAA4Bv/C,EAA5Bu/C,iBACAyS,EAA0BhyD,EAA1BgyD,WACAxkD,EAA4BxN,EAA5BwN,YACAykD,EAAgBjyD,EAAhBiyD,QACAl0C,EAAkB/d,EAAlB+d,SACA+iD,EAA0B9gE,EAA1B8gE,aACAh0C,EAAkB9sB,EAAlB8sB,SACAy6B,EAA4BvnD,EAA5BunD,cACA6H,EAAkCpvD,EAAlCovD,aACA2R,EAAgD/gE,EAAhD+gE,oBACAzV,EAAoCtrD,EAApCsrD,YACApL,EAAgBlgD,EAAhBkgD,QACAC,GAAcngD,EAAdmgD,OACA6gB,GAAwBhhE,EAAxBghE,YACAC,GAAkCjhE,EAAlCihE,iBACAC,GAAoClhE,EAApCkhE,kBAIPC,IAAY,EAEhBphB,GAAkB,CAChBtuD,QAAAA,GACAI,UAAAA,GACAqf,UAAS,WAAA,OAAQA,GAAU2rD,EAAa,EACxCnwC,SAAQ,WAAA,OAASy0C,IAAav3E,SAAS8iC,YAAerb,GAAuBwrD,EAAa,EAC1F3c,QAAO,WACLxzB,GAAW,EACPwzB,GACFA,KAGJC,OAAM,WACJzzB,GAAW,EACPyzB,IACFA,QAOF,IAAAL,QAAqC95D,EAEhC,SAAAinC,GACPzc,GAKAlV,EAAM,kBAAmBkV,OAEnBy3C,EACiB,mBAAdz3C,EAA2BA,EAAU6P,GAAc7P,YAAc,KAAOA,EAE5E8U,GAAQ2iC,EAAkB5nC,GAAc7P,kBAC3C6P,GAAaxhB,EAAAA,EACRwhB,CAAAA,EAAAA,IACH7P,CAAAA,EAAAA,CAAAA,UAAWy3C,KAGbn7B,EAASm7B,IAIT,IAGAr7B,GAQAS,GAEAgD,GAbA+wC,IAA2B,EAC3B/gD,GAAgBD,KAahBuuC,IAAa,EACb4E,IAAc,EA2Bc8N,SAAAA,YAAAA,GAAAnjD,EAAAC,IAAAC,MAAjB,SAAAkjD,EAAkBl3D,GAAc+T,OAAAA,IAAApf,MAAAwiE,SAAAC,GAAA,cAAAA,EAAA7iD,KAAA6iD,EAAAzwE,aAKvC,YAJNsvB,GAAaxhB,EAAAA,EACRqiB,CAAAA,EAAAA,GAAW/T,EAAMkT,GAAejW,IAAI,CAAA,EAAA,CACvCoG,UAAW,eAEP,EAAA7L,GAASyF,GAAI,KAAA,EAAA,IAAA,MAAA,OAAAo3D,EAAA9nC,OAAA4nC,GAAAA,8BAgBf,IAAAG,GAAU9iB,GAAa,CAC3B5gC,SAAW,SAAA/a,GACTe,EAAA,GAAA6qD,GAAe5rD,MAGf4rD,GAAe6S,GAAQ1iB,WAqBvB,IAKAkM,GAokDA74D,GAzkDAsvE,IAAiB,EAEjBjiB,GAAgB,GAQdkiB,GAAmBC,GAAWviB,IAE3B,SAAAwiB,GACP10D,EACAmyC,EACAt2C,EACAu2C,GAEAJ,mBAEQ2iB,MAEFA,EAAsBH,GAAiBx0D,EAAMmyC,EAAWt2C,EAAQu2C,SACzD52C,GACPm5D,EAAmB,EAEf13D,KAAI,GACJqC,QAAS,uBAA0B9D,EAAc8D,QACjDizC,SAAU/5C,GAAmBs8C,UAK9B38B,GAAQw8C,EAAqBriB,MAChCnkD,EAAM,4BAA6BwmE,GACnC/9D,EAAA,GAAA07C,GAAmBqiB,OAGtB,SAAAxyE,GAAQ,OAAKgM,EAAKzL,+BAAAA,OAAgCP,SAAQ,aAI/CyyE,YACdzmE,EAAM,YAEFwkD,IAEAA,WAAAA,GACAF,cAAc,IAMlBiiB,GAAuB10D,EAAMmyC,EAAWt2C,EAAQu2C,GACxC9nC,EAAQgoC,IAA2C,KAArB,CAAAA,iBAAAA,cAGxBmG,YACPz4C,WAGAu/C,YACArsC,GAGA,SAAA2hD,GAAqBC,GACxB30D,GAAc20D,GAOX,SAAkB3/C,GACrB,QAAgBt8B,IAAhBs8B,SAKE,IAAA4/C,GAAa58C,GAAQnY,EAAMmV,MAEjChnB,EAAM,uBAAsB,CAAI4mE,UAAAA,EAAWC,mBAAwBn8E,IAATmnB,KAErD+0D,SAKC,IAAAE,EAAgB/hD,GAChBgiD,EAAel1D,EACfsmD,EAAetoE,EACfm3E,EAAyBZ,GAE/B39D,EAAA,GAAAoJ,EAAOmV,GACPigD,GAAyBp1D,GACzBpJ,EAAA,GAAA5Y,OAAOnF,GACP+d,EAAA,GAAA29D,IAAiB,GACjB5hB,QAAa95D,EACbw8E,GAA8Br1D,GAE9Bs1D,GAAc,CACZJ,aAAAA,EACAD,cAAAA,EACA3O,aAAAA,EACA6O,uBAAAA,IArCAI,CAAkBT,EAAe90D,MACxBE,GAAc40D,IAwClB,SAAkBlwC,GACrB,QAAgB/rC,IAAhB+rC,GAA6BzkB,GAAcmzD,cAIzCyB,EAAYnwC,IAAgB5mC,KAElCmQ,EAAM,uBAAsB,CAAI4mE,UAAAA,KAE3BA,SAKC,IAAAG,EAAel1D,EACfi1D,EAAgB/hD,GAChBozC,EAAetoE,EACfm3E,EAAyBZ,YAG7Bv0D,EAAO0zD,EAAgB9uC,IACvBwwC,GAAyBp1D,GACzBpJ,EAAA,GAAA5Y,EAAO4mC,GACPhuB,EAAA,GAAA29D,IAAiB,GACjB5hB,QAAa95D,QACN2iB,OAEL5E,EAAA,GAAAoJ,EAAO0zD,EAAgBv1D,EAAWymB,KAClCwwC,GAAyBp1D,GACzBpJ,EAAA,GAAA5Y,EAAO4mC,GACPhuB,EAAA,GAAA29D,IAAiB,GACjB5hB,QAAa95D,EACbw8E,GAA8Br1D,SACvBw1D,GAEP5+D,EAAA,GAAAoJ,OAAOnnB,QACPmF,EAAOs1E,EAAsB,MAC7B18D,EAAA,GAAA29D,IAAiB,GACjB5hB,QACW95D,IAATmF,GAA+B,KAATA,EAClB2gB,GAAwB3gB,EAAOwd,EAAc8D,SAAWyB,OAAOvF,SAC/D3iB,GAIVw8E,GAA8Br1D,GAE9Bs1D,GAAc,CACZJ,aAAAA,EACAD,cAAAA,EACA3O,aAAAA,EACA6O,uBAAAA,IA1FAM,CAAkBX,EAAe92E,MAwG5B,SAAAo3E,GAAyBp1D,GAC3Bi0D,KACHA,IAA2B,OAC3B/gD,GAAgBM,GAAmBxT,EAAMkT,GAAa,GxEuVtD,SAA2BlT,GAC/B,OAAOS,GAAe,CAAET,KAAAA,GAAQxG,IAAgC2f,GAAgBD,EAClF,CwEzVkEw8C,CAAiB11D,MAIxE,SAAAq1D,GAA8Br1D,GAChCkT,GAAc7P,YAKjB4U,EAASjY,EAAM+Z,GAAc7G,GAAc7P,aAC3C4U,EAASjY,EAAMga,GAAa9G,GAAc7P,cAK5ClV,EAAM,kDAAmD+kB,GAAc7P,gBACvE6P,GAAaxhB,EAAAA,KACRwhB,IAAa,CAAA,EAAA,CAChB7P,UAAWoY,GAAoBzb,EAAMkT,SAIhC,SAAAoiD,GAAcK,GACrB,IAAAT,EAAYS,EAAZT,aACAD,EAAaU,EAAbV,cACA3O,EAAYqP,EAAZrP,aACA6O,EAAsBQ,EAAtBR,4BAOqBt8E,IAAjBq8E,QAA+Cr8E,IAAjBytE,SAKrBztE,IAATmnB,OACmBnnB,IAAjBq8E,EAEFZ,GAAQ3tE,IAAG,CACTmrD,KAAI,CACF8jB,MAAK,EAAKllD,GAAI,UAAWzT,KAAM,GAAI5iB,MAAO66E,IAC1Cr/D,MAAOsmB,GAA4B84C,GACnCj1D,UAAMnnB,EACNmF,KAAMsoE,EACNiO,eAAgBY,GAElBpjB,KAAI,CACF6jB,MAAK,CAAA,CAAKllD,GAAI,UAAWzT,KAAM,GAAI5iB,MAAO2lB,IAC1CnK,MAAOsmB,GAA4BjJ,IACnClT,UAAMnnB,EACNmF,KAAAA,EACAu2E,eAAAA,MAIJD,GAAQ3tE,IAAG,CACTmrD,KAAI,CACF8jB,WAAO/8E,EACPmnB,UAAMnnB,EACNmF,KAAMsoE,EACNzwD,MAAOsmB,GAA4B84C,GACnCV,eAAgBY,GAElBpjB,KAAI,CACF6jB,WAAO/8E,EACPmnB,KAAAA,EACAnK,MAAOsmB,GAA4BjJ,IACnCl1B,KAAAA,EACAu2E,eAAAA,WAKe17E,IAAjBq8E,GACFZ,GAAQ3tE,IAAG,CACTmrD,KAAI,CACF8jB,WAAO/8E,EACPmnB,KAAMk1D,EACNr/D,MAAOsmB,GAA4B84C,GACnCj3E,KAAMsoE,EACNiO,eAAgBY,GAElBpjB,KAAI,CACF6jB,WAAO/8E,EACPmnB,UAAMnnB,EACNmF,KAAAA,EACAu2E,eAAAA,GACA1+D,MAAOsmB,GAA4BjJ,iBAkB7B0iD,GACd1gD,EACA2gD,GAII,GAFJ1nE,EAAM,QAAS+mB,EAAY2gD,QAEdh9E,IAATmnB,EACQ,UAAA3b,MAAM,+BAGZ,IAAA6wE,EAAel1D,EACfi1D,EAAgB/hD,GAChBozC,EAAetoE,EACfm3E,EAAyBZ,GAGzBziB,EAA0B7vB,GAC9BjiB,EACAkV,GAEI4gD,EAAU7gD,GAAmBjV,EAAMkT,GAAegC,GAGlD4lC,EAAmBp/B,GAA8B1b,EAAMkV,GACvD6gD,EvE+DJ,SACJ7iD,EACA7P,GAGA,OAAKA,KAFa/hB,UAAApI,OAAA,QAAAL,IAAAyI,UAAA,KAAAA,UAAG,GAMrBoQ,EAAAA,EAAA,CAAA,EACKwhB,GACH7P,CAAAA,EAAAA,CAAAA,UAAAA,IALO6P,CAOX,CuE5EiC8iD,CAC3BF,EAAQ5iD,cACR4nC,GACA,GAEF3sD,EAAM,yBAA0B2sD,OAE1Bp0D,EACkB,mBAAfmvE,EAA4BA,EAAWC,EAAQ91D,KAAM+1D,QAAwBl9E,EAEtF+d,EAAA,GAAAoJ,EAAOtZ,QAA8B7N,IAAlB6N,EAASsZ,KAAqBtZ,EAASsZ,KAAO81D,EAAQ91D,MACnE,IAAAi2D,EACJvvE,QAA+B7N,IAAnB6N,EAASmP,MAAsBnP,EAASmP,MAAQkgE,SAC9Dn/D,EAAA,GAAAsc,GAAgB+iD,GAChBr/D,EAAA,GAAA5Y,OAAOnF,GACP+d,EAAA,GAAA29D,IAAiB,GACjB39D,EAAA,GAAAspB,QAAarnC,GACb85D,QAAa95D,EAGbw8E,GAA8Br1D,GAE9Bs0D,GAAQ3tE,IAAG,CACTmrD,KAAI,CACF8jB,MAAO9jB,EACP9xC,UAAMnnB,EACNmF,KAAMsoE,EACNzwD,MAAOsmB,GAA4B84C,GACnCV,eAAgBY,GAElBpjB,KAAI,CACF6jB,MAAO1gD,EACPlV,UAAMnnB,EACNgd,MAAOsmB,GAA4B85C,GACnCj4E,KAAAA,EACAu2E,eAAAA,MAIa,CACfv0D,KAAAA,EACAk1D,aAAAA,EACApjB,KAAAA,EACAC,KAAM78B,YAWDghD,MACH1lD,GAAa0C,GAAc7P,WAI/Byc,GAAgBzE,GAAmBrB,GAAa9G,GAAc7P,YAAY,aAGnE8yD,SACH3lD,GAAa0C,GAAc7P,WAIzB,IAAApG,EAAO+c,GAAa9G,GAAc7P,WAClChpB,EAAQ65B,EAAMlU,EAAM/C,GACtBhC,GAAgB5gB,YAgfO4iB,EAAgB5iB,GAC3C8T,EAAM,sBAAyB,CAAA8O,KAAAA,EAAM5iB,MAAAA,IAErC25E,IAAY,EAGZD,GAAiB,CACfh0D,QAAO,CACLC,KAAM3lB,GAER4iB,KAAAA,EACAwT,QAASxrB,GAAQwrB,QACjBla,QAAO,WACLy9D,IAAY,EACZ77D,QA7fFi+D,CAAoBn5D,EAAM5iB,GAE1BylC,GAAgB1E,GAAqBne,GAAM,cAItCo5D,KACH,IAAA7lD,GAAa+I,GAAiBrG,GAAc7P,WAA5C,CAIE,IAAApG,EAAO+c,GAAa9G,GAAc7P,WAClCqQ,EAAUxW,EAAmBD,GAC7B5iB,EAAQ65B,EAAMlU,EAAM/C,GACpB8X,GAAiBsD,GAAiBh+B,EAAO64B,GAAcE,iBAAkBM,EAAS7X,GAClFqc,EAAenD,EAAgBhU,OAAO1mB,GAAS8hB,GAAc4E,OAAO1mB,GAAQwhB,GAElF1N,EAAM,4BAA2B,CAAI4mB,cAAAA,EAAe16B,MAAAA,EAAO69B,aAAAA,IAE3Do+C,KAGM5lD,GAAI,UACJzT,KAAMyW,EACNr5B,MAAO69B,KAGV,SAAA6H,EAAaC,UAEVnqB,MAAOif,GAAiBkL,EAActM,EAASqB,iBAcxCwhD,KAAS,OAAAC,GAAAnqE,MAAAvN,KAAAwC,UAAAk1E,CAAAA,SAAAA,YAAAA,GAAAzlD,EAAAC,IAAAC,sGAAc,OAAbwlD,IAAMC,EAAAx9E,eAAAL,IAAA69E,EAAA,KAAAA,EAAG,GAAIC,EAAA/yE,KAAA,EAC9BkpE,GAAK,CACT9sD,KAAAA,EACAkT,cAAAA,GACA7S,YAAao2D,EAASp2D,OAAcxnB,EACpC23B,SAAAA,EACA3U,OAAAA,EACA4U,QAAS6lD,wEAIE,CAAA,SAAAM,KAAU,OAAAC,GAAAxqE,WAAA/K,UAAA,CAAA,SAAAu1E,YAAAA,GAAA9lD,EAAAC,IAAAC,yGAACwlD,IAAMK,EAAA59E,OAAA49E,QAAAj+E,IAAAi+E,OAAAA,EAAG,QACpBj+E,IAATmnB,EAAkB+2D,CAAAA,EAAAnzE,KAAA,EAAA,KAAA,CAAA,OAAAmzE,EAAAzqC,wBAAA,OAAAyqC,EAAAnzE,KAAA,EAIhBo+D,GAAM,CACVhiD,KAAAA,EACAkT,cAAAA,GACA7S,YAAao2D,EAASp2D,OAAcxnB,EACpCgjB,OAAAA,uEAIK,UAoBAm7D,KACPtgE,EACEugE,aAGKx9D,IACHnF,CAAAA,EAAAA,CAAAA,YAAW,CACTuC,MAAO,WAIT,CAAAN,0BAAe4B,IAAK,aAKjB21D,GAAgB9vE,EAAcu5D,GACrC7gD,EACEwgE,IAEEl5E,KAAAA,EACAo5D,QAAU,SAAAp5D,GAAiB,OAAAsgB,GAAiBtgB,GAAO,SAAAyE,UAAMwb,GAAexb,EAAGoZ,EAAM,GAAA,EACjFw7C,SAAU74C,GACV+4C,QAAAA,UAGG99C,IACHnF,CAAAA,EAAAA,CAAAA,aACEuC,MAAO,QACPE,OAAQ,SAEVvC,cACEy1B,QAAS,EACTlzB,OAAQ,UAIV,CAAAR,0BAAe4B,IAAK,aAKjBg/D,KACPlJ,GAAQ,CACNjuD,KAAAA,EACAhiB,KAAAA,EACAk1B,cAAAA,GACAi7C,eAAe,EACf39C,SAAAA,EACAI,SAAAA,EACAH,QAAS6lD,cAIJc,MAEL5mD,QACS33B,IAATmnB,GACCkT,GAAc7P,WACdwZ,KACDvS,EAAQ0P,GAAa9G,GAAc7P,cAKrClV,EAAM,YAAW,CAAIkV,UAAW6P,GAAc7P,YAI9CizD,GAFmBz1C,GAAU7gB,EAAM8Z,GAAkB9Z,EAAMkT,GAAc7P,uBAKlEg0D,SAEL7mD,GACC0C,GAAc7P,YACbmW,GAAiBtG,GAAc7P,YAAekW,GAAiBrG,GAAc7P,cAC/EiH,EAAQ0P,GAAa9G,GAAc7P,aAKrClV,EAAM,UAAS,CAAIkV,UAAW6P,GAAc7P,YAEtC,IAAA6R,ElE7lBM,SAAQlV,EAAeqD,GACrC,GAAIkW,GAAiBlW,GACnB,MAAO,CACL,CACEqN,GAAI,OACJ/mB,KAAMuT,EAAmBmG,EAAUpG,MACnCA,KAAM,KAKZ,IAAIuc,GAAiBnW,GAkCnB,MAAM,IAAIhf,MAAM,uEAjChB,IAAMwyB,EAAaC,EAAQzT,EAAUqW,WAC/B/U,EAASuP,EAAMlU,EAAM6W,GAE3B,GAAId,EAAYpR,GAMd,MAAO,CACL,CACE+L,GAAI,UACJzT,KAAM,GACN5iB,MATUy/B,GAAkB9Z,EAAMqD,GAAWjX,KAAI,SAAC6Q,GACpD,IAAMpR,EAAQ8O,GAAIqc,GAAK/Z,IACvB,OAAO0H,EAAO9Y,EAChB,MASK,GAAIiqB,EAAanR,GAAS,CAE/B,IAAMtqB,EAAiC,CAAA,EAMvC,OALAy/B,GAAkB9Z,EAAMqD,GAAW1rB,SAAQ,SAACslB,GAC1C,IAAMrd,EAAMmhB,OAAOiW,GAAK/Z,IACxB5iB,EAAMuF,GAAO+kB,EAAO/kB,EACtB,IAEO,CACL,CACE8wB,GAAI,UACJzT,KAAM,GACN5iB,MAAAA,GAGL,CAMH,MAAU,IAAAgK,MAAM,iDAAmDic,KAAKtE,UAAUqH,GACpF,CkE2iBuBi0D,CAAQt3D,EAAMkT,GAAc7P,WAE/CizD,GAAYphD,GAAa,SAAA6K,EAAaC,GAChC,GAAA/kB,GAAgB8kB,GAAW,QAI3BlqB,MAAOmjB,GAAgB+G,EAAaC,EAF5B,UAQP,SAAAu3C,GAAa/H,GACpBF,GAAQ,CACNE,WAAAA,EACAC,cAAc,EACdC,cAAAA,EACA1vD,KAAAA,EACAqD,UAAW6P,GAAc7P,UACzBmN,SAAAA,EACA3U,OAAAA,EACA4U,QAAS6lD,GACT3G,cAAe6H,KAIV,SAAAC,GAA4Bt2E,GAC/Bm4B,GAAepG,GAAc7P,YAE/Byc,GAAgB1E,GAAqBlI,GAAc7P,UAAUpG,MAAM,IAGhEiW,GAAc7P,WACjByc,GAAgBrE,GAAoBzb,EAAMkT,KAG5CqkD,GAAap2E,GAGN,SAAAu2E,GAAcv2E,OACjBqvB,GAAa0C,GAAc7P,aAI1ByZ,GAAW5J,GAAc7P,eAMtB,IAAApG,EAAO8c,GAAc7G,GAAc7P,WACnC4hB,EAAwB/Q,EAAMlU,EAAM/C,GACpC06D,WvFrsBVt9E,EACA8G,EACA0a,GAGA,GAAa,UAAT1a,EAAkB,CACpB,GAAIuI,MAAMoS,QAAQzhB,GAEhB,OAAOA,EAGT,GAAI2gB,GAAS3gB,GACX,OAAOojB,GAAcpjB,GAGvB,GAAqB,iBAAVA,EACT,IACE,IAAMu9E,EAAc/7D,EAAOS,MAAMjiB,GAEjC,GAAIqP,MAAMoS,QAAQ87D,GAChB,OAAOA,EAGT,GAAI58D,GAAS48D,GAGX,OAAOn6D,GAAcm6D,EAExB,CAAC,MAAOpxE,GAEP,MAAO,CAACnM,EACT,CAIH,MAAO,CAACA,EACT,CAED,GAAa,WAAT8G,EAAmB,CACrB,GAAIuI,MAAMoS,QAAQzhB,GAChB,OAAOmjB,GAAcnjB,GAGvB,GAAI2gB,GAAS3gB,GAEX,OAAOA,EAGT,GAAqB,iBAAVA,EACT,IACE,IAAMu9E,EAAc/7D,EAAOS,MAAMjiB,GAEjC,GAAI2gB,GAAS48D,GACX,OAAOA,EAGT,GAAIluE,MAAMoS,QAAQ87D,GAChB,OAAOp6D,GAAco6D,EAExB,CAAC,MAAOpxE,GAEP,MAAO,CAAEnM,MAAOA,EACjB,CAIH,MAAO,CAAEA,MAAOA,EACjB,CAED,GAAa,UAAT8G,EACF,OAAI8Z,GAAgB5gB,GACXwhB,EAAOG,UAAU3hB,GAInBA,EAGT,UAAUgK,MAAK3B,kBAAAA,OAAmBkZ,GAAUvhB,EAAOwhB,GAAOnZ,QAAAA,OAAOvB,GACnE,CuFsnB6B02E,CACrB5yC,EACA9jC,EACA0a,GAEE,GAAA87D,IAAmB1yC,aAKjB/P,EAAU,EACZxE,GAAI,UAAWzT,KAAMC,EAAmBD,GAAO5iB,MAAOs9E,IAG1DxpE,EAAM,gBAAe,CAAIkV,UAAW6P,GAAc7P,UAAWpG,KAAAA,EAAM9b,KAAAA,EAAM+zB,WAAAA,IAEzEohD,GAAYphD,GAAa,SAAA6K,EAAaC,UAGlCnqB,MAAOqd,GAAc7P,UACjB2V,GAAgB+G,EAAaC,EAAchG,GAAa9G,GAAc7P,YACtE6P,aAGD1X,GACPspD,EAAQtpD,QAhCRspD,EAAO,IAAKzgE,MAAK3B,uCAAAA,OAAwCvB,cAoCpD22E,KACF,GAAA5kD,GAAc7P,UAAd,CAIC,IAAA00D,EAAkBj9C,GAAe9a,EAAMkT,IAAe,GACtD2D,EAAaC,EAAQkD,GAAa9G,GAAc7P,YAGpD00D,IACCztD,EAAQ0P,GAAa+9C,KACtB5/C,GAAQtB,EAAYC,EAAQkD,GAAa+9C,KAEzCj4C,GAAgBxD,GAAqBtC,GAAa+9C,KAElDj4C,GAAgBzD,GAAsBxF,IAGxC1oB,EAAM,gBAAe,CAAIkV,UAAW6P,GAAc7P,UAAW00D,gBAAAA,EAAiBlhD,WAAAA,IAE9E7wB,KAAOF,MAAI,WAAO,OAAAkyE,IAAiB,cAG5BC,KACF,GAAA/kD,GAAc7P,UAAd,CAIC,IAAApG,EAAOsd,GAAWva,EAAMkT,GAAc7P,WAE5ClV,EAAM,eAAgB8O,GAEtB6iB,GAAgBxD,GAAqBrf,IAErCjX,KAAOF,MAAI,WAAO,OAAAkyE,kBAGLE,GAAqBC,GAAAC,OAAAA,GAAA/rE,MAAAvN,KAAAwC,UAAA,CAAA,SAAA82E,YAAAA,GAAArnD,EAAAC,IAAAC,MAArB,SAAAonD,EAAsBnuD,GAAY8G,OAAAA,IAAApf,MAAA,SAAA0mE,GAAAA,cAAAA,EAAA9mD,KAAA8mD,EAAA10E,MAAA,KAAA,EACzC,OADyC00E,EAAA10E,KACzC,EAAAqsE,GAAiB,CACrB/lD,KAAAA,EACAulD,cAAc,EACdC,cAAAA,EACA1vD,KAAAA,EACAqD,UAAW6P,GAAc7P,UACzBmN,SAAAA,EACA3U,OAAAA,EACA4U,QAAS6lD,GACT3G,cAAe6H,GACf73C,SAAUG,gFAILy4C,SACH/nD,GAIC8jD,GAAQ1iB,WAAWF,aAIlBxlC,EAAOooD,GAAQxiB,UAChB5lC,OAICssD,EAAe,CAAKx4D,KAAAA,EAAMhiB,KAAAA,GAEhC4Y,EAAA,GAAAoJ,EAAOkM,EAAK4lC,KAAK8jB,MAAQxgD,EAAmBpV,EAAMkM,EAAK4lC,KAAK8jB,OAAS1pD,EAAK4lC,KAAK9xC,MAC/EpJ,EAAA,GAAAsc,GAAgBhH,EAAK4lC,KAAKj8C,OAC1Be,EAAA,GAAA5Y,EAAOkuB,EAAK4lC,KAAK9zD,MACjB4Y,EAAA,GAAA29D,GAAiBroD,EAAK4lC,KAAKyiB,gBAC3B5hB,QAAa95D,EAEbsV,EAAM,OAAM,CAAI+d,KAAAA,EAAMlM,KAAAA,EAAMkT,cAAAA,KAY5BulD,GAAaD,EATXtsD,EAAK4lC,KAAK8jB,OAAS1pD,EAAK6lC,KAAK6jB,OAEvB51D,KAAAA,EACAk1D,aAAcsD,EAAgBx4D,KAC9B+xC,KAAM7lC,EAAK4lC,KAAK8jB,MAChB9jB,KAAM5lC,EAAK6lC,KAAK6jB,OAElB,MAINz9D,KACI+a,GAAc7P,WAChB7L,GAASwiB,GAAa9G,GAAc7P,YAAY,cAI3Cq1D,SACHloD,GAIC8jD,GAAQ1iB,WAAWD,aAIlBzlC,EAAOooD,GAAQviB,UAChB7lC,OAICssD,EAAe,CAAKx4D,KAAAA,EAAMhiB,KAAAA,GAEhC4Y,EAAA,GAAAoJ,EAAOkM,EAAK6lC,KAAK6jB,MAAQxgD,EAAmBpV,EAAMkM,EAAK6lC,KAAK6jB,OAAS1pD,EAAK6lC,KAAK/xC,MAC/EpJ,EAAA,GAAAsc,GAAgBhH,EAAK6lC,KAAKl8C,OAC1Be,EAAA,GAAA5Y,EAAOkuB,EAAK6lC,KAAK/zD,MACjB4Y,EAAA,GAAA29D,GAAiBroD,EAAK6lC,KAAKwiB,gBAC3B5hB,QAAa95D,EAEbsV,EAAM,OAAM,CAAI+d,KAAAA,EAAMlM,KAAAA,EAAMkT,cAAAA,KAY5BulD,GAAaD,EATXtsD,EAAK4lC,KAAK8jB,OAAS1pD,EAAK6lC,KAAK6jB,OAEvB51D,KAAAA,EACAk1D,aAAcsD,EAAgBx4D,KAC9B+xC,KAAM7lC,EAAK6lC,KAAK6jB,MAChB9jB,KAAM5lC,EAAK4lC,KAAK8jB,OAElB,MAINz9D,KACI+a,GAAc7P,WAChB7L,GAASwiB,GAAa9G,GAAc7P,YAAY,KAI3C,SAAAs1D,GAAcvV,GAWb,IAAAwV,EAVJpoD,QAAqB33B,IAATmnB,IAIhBg0D,IAAY,EAEZH,GAAW,CACTv3E,GAAI42E,EACJlzD,KAAAA,EACAojD,SAAAA,EACAtB,QAAM8W,EAAA7nD,EAAAC,IAAAC,oFAAWiE,KAAAA,EAAAA,EAAU2jD,EAAV3jD,WACf/mB,EAAM,SAAUi1D,EAAUluC,GAE1BohD,GAAYphD,GAAa,SAAA6K,EAAaC,GAAY,MAAA,CAEhDnqB,MAAKnE,EAAAA,EAAA,CAAA,EACAsnB,GAAgB+G,EAAaC,EAAcojC,QAC9C//C,UAAW+X,GAAqBgoC,GAAU,iGAIhD7sD,QAAO,WACLy9D,IAAY,EACZ77D,kBAKG2gE,KACF5lD,GAAc7P,WAKnBs1D,GADiB18C,GAAajc,EAAMkT,GAAc7P,YAYpC,SAAA01D,GAAmBv6E,GAC7B,QAAS3F,IAATmnB,EAAA,CAII,IAAA1jB,EAA6BkC,EAA7BlC,GAAIylE,EAAyBvjE,EAAzBujE,YAAaxrD,EAAY/X,EAAZ+X,QACnB6sD,EAAW5kE,EAAQ4kE,UAAQ,GAEjC4Q,IAAY,EAEZF,GAAgB,CACdx3E,GAAIA,GAAM62E,EACVnzD,KAAAA,EACAojD,SAAAA,EACArB,YAAc,SAAA7sC,GACR6sC,EACFA,EAAW,CACT7sC,WAAAA,EACAlV,KAAAA,EACAg5D,gBAAiB5jD,EAAmBpV,EAAMkV,MAG5C/mB,EAAM,cAAei1D,EAAUluC,GAE/BohD,GAAYphD,GAAa,SAAA6K,EAAaC,GAAY,MAAA,CAEhDnqB,MAAKnE,EAAAA,EACAsnB,CAAAA,EAAAA,GAAgB+G,EAAaC,EAAcojC,IAC9C//C,CAAAA,EAAAA,CAAAA,UAAW+X,GAAqBgoC,GAAU,WAKlD7sD,QAAO,WACLy9D,IAAY,EACZ77D,KACI5B,GACFA,iBAMC0iE,KACF/lD,GAAc7P,WAKnB01D,GACE,CAAA3V,SAFennC,GAAajc,EAAMkT,GAAc7P,sBAmC9B7L,GAAQ0hE,GAAAC,OAAAA,GAAA9sE,MAAAvN,KAAAwC,UAAA,CAAA,SAAA63E,YAAAA,GAAApoD,EAAAC,IAAAC,MAAR,SAAAmoD,EAASn8D,GAAco8D,IAAAA,EAAAC,EAAAC,EAAAC,EAAA17D,EAAA27D,EAAAn4E,UAAA0vB,OAAAA,IAAApf,MAAA,SAAA8nE,GAAAA,cAAAA,EAAAloD,KAAAkoD,EAAA91E,MAAEy1E,KAAAA,EAEvC,OAFuCA,IAAmBI,EAAAvgF,OAAA,QAAAL,IAAA4gF,EAAA,KAAAA,EAAA,GAChE7iE,EAAA,GAAAsc,GAAgBa,GAAW/T,EAAMkT,GAAejW,IAAIy8D,EAAA91E,KAC9C,EAAAoC,KAAI,KAAA,EAIiC,GAFrCszE,EAAOta,GAAY/hD,GAEzB9O,EAAM,WAAU,CAAI8O,KAAAA,EAAMq8D,KAAAA,EAAMrG,YAAAA,IAE3BqG,GAASrG,GAAWyG,EAAA91E,KAAA81E,EAAAA,KAAAA,CAAAA,OAAAA,EAAAptC,OAAA,SAChB5mC,QAAQC,WAGX4zE,KAAAA,EACqC,GADrCA,EAAetG,EAAYztD,wBAC3Bg0D,EAAWF,EAAK9zD,wBACjB6zD,EAAmBK,CAAAA,EAAA91E,KAAA,GAAA,KAAA,CAAA,KAClB41E,EAAS9wD,OAAS6wD,EAAahiE,KAAOiiE,EAASjiE,IAAMgiE,EAAa7wD,SAAMgxD,EAAA91E,KAAA81E,GAAAA,KAAAA,CAAAA,OAAAA,EAAAptC,OAAA,SAEnE5mC,QAAQC,WAIbmY,KAAAA,GAAkC,OAAlCA,GAAWy7D,EAAaxiE,OAAS,EAAC2iE,EAAAptC,gBAE7B,IAAA5mC,SAAe,SAAAC,GACxB0tE,EAAKiG,EAAI,CACP11D,UAAWqvD,EACXn1D,OAAAA,EACA3b,S5F9uCuB,I4F+uCvBuE,oBAAgB,OAAAf,gFASN,SAAAq5D,GAAY/hD,GACnB,OAAAg2D,EACHA,EAAY3hB,cAAa,kBAAA5uD,OAAmB8hB,GAAevH,UAC3D,KAOG,SAAAqsC,GAAersC,OAChBq8D,EAAOta,GAAY/hD,GAEpB,GAAAq8D,GAASrG,EAAT,KAICsG,EAAetG,EAAYztD,wBAC3Bg0D,EAAWF,EAAK9zD,wBAEhBm0D,EAAa1+D,GAAgBiZ,EAAMlU,EAAM/C,IADhC,GAGXu8D,EAASziE,OAETyiE,EAASjiE,IAAMgiE,EAAahiE,IALjB,GAOb87D,EAAKiG,EAAI,CACP11D,UAAWqvD,EACXn1D,QATW,GAUX3b,SAAU,IAEHq3E,EAASjiE,IAAMoiE,EAAaJ,EAAa7wD,OAZrC,IAcb2qD,EAAKiG,EAAI,CACP11D,UAAWqvD,EACXn1D,SAAUy7D,EAAaxiE,OAAS4iE,EAhBrB,IAiBXx3E,SAAU,cAKPs2E,GAAaD,EAA0BnK,OAUxBuL,UAPO/gF,IAAzB2/E,EAAgBx4D,WAAgDnnB,KAA1B2/E,eAAAA,EAAiBx6E,MAOvD,QAASnF,IAATmF,EAEM47E,QAARA,EAAAhpD,aAAQgpD,GAARA,EADkB,CAAA57E,KAAAA,EAAMgiB,UAAMnnB,GACV2/E,GAClBriB,cAAeye,KACfvG,YAAAA,SAEOruD,QAASnnB,IAATmnB,EAAkB,CAAA65D,IAAAA,EAEnBA,QAARA,EAAAjpD,SAAAipD,IAAQA,GAARA,EADkB,CAAA77E,UAAMnF,EAAWmnB,KAAAA,GACfw4D,GAClBriB,cAAeye,KACfvG,YAAAA,cAKGiI,GACPphD,EACA2gD,GAEA1nE,EAAM,cAAe+mB,EAAY2gD,OAE3B2C,EAAe,CAAKx4D,KAAAA,EAAMhiB,KAAAA,GAC1BqwE,EAAcuH,GAAM1gD,EAAY2gD,UAEtC4C,GAAaD,EAAiBnK,GAEvBA,WAGAmJ,GAAkBriD,EAAsB0gD,GACzC,IAAAZ,EAAgB/hD,GAChBgiD,EAAel1D,EACfsmD,EAAetoE,EACfw6E,EAAe,CAAKx4D,KAAAA,EAAMhiB,KAAAA,GAC1Bm3E,EAAyBZ,GAEzB99C,EAAejD,GAAmBxT,EAAMkT,MAAmBiG,IAE3DzyB,EACkB,mBAAfmvE,EAA4BA,EAAW1gD,EAAasB,QAAgB59B,EAE7E+d,EAAA,GAAAoJ,EAAOtZ,QAA8B7N,IAAlB6N,EAASsZ,KAAqBtZ,EAASsZ,KAAOmV,GACjEve,EAAA,GAAAsc,GAAgBxsB,QAA+B7N,IAAnB6N,EAASmP,MAAsBnP,EAASmP,MAAQ4gB,GAC5E7f,EAAA,GAAA5Y,OAAOnF,GACP+d,EAAA,GAAA29D,IAAiB,GACjB5hB,QAAa95D,EAGbw8E,GAA8Br1D,GAE9Bs1D,GAAc,CACZJ,aAAAA,EACAD,cAAAA,EACA3O,aAAAA,EACA6O,uBAAAA,IAQFsD,GAAaD,EAFO,eAKbsB,GAAiBl1C,EAAqBixC,GAC7C1nE,EAAM,oBAEA,IAAA8mE,EAAgB/hD,GAChBgiD,EAAel1D,EACfsmD,EAAetoE,EACfw6E,EAAe,CAAKx4D,KAAAA,EAAMhiB,KAAAA,GAC1Bm3E,EAAyBZ,YAG7Bv0D,EAAO0zD,EAAgB9uC,IACvBhuB,EAAA,GAAAsc,GAAgBM,GAAmBxT,EAAMkT,MAAmBiG,KAC5DviB,EAAA,GAAA5Y,OAAOnF,GACP+d,EAAA,GAAA29D,IAAiB,GACjB5hB,QAAa95D,QACN2iB,OAEL5E,EAAA,GAAAoJ,EAAO0zD,EAAgBv1D,EAAWymB,KAClChuB,EAAA,GAAAsc,GAAgBM,GAAmBxT,EAAMkT,MAAmBiG,KAC5DviB,EAAA,GAAA5Y,EAAO4mC,GACPhuB,EAAA,GAAA29D,IAAiB,GACjB5hB,QAAa95D,QACN28E,GAEP5+D,EAAA,GAAAoJ,OAAOnnB,GACP+d,EAAA,GAAAsc,GAAgBD,GAAmB,CAAGjT,KAAAA,EAAMuT,OAAQ4F,MACpDviB,EAAA,GAAA5Y,EAAO4mC,GACPhuB,EAAA,GAAA29D,IAAiB,GACjB5hB,GACW,KAAT30D,EACI2gB,GAAwB3gB,EAAOwd,EAAc8D,SAAWyB,OAAOvF,SAC/D3iB,GAIC,GAAe,mBAAfg9E,EAAyB,CAC5B,IAAAnvE,EAAWmvE,EAAW71D,EAAMkT,SAElClT,EAAOtZ,GAAYA,EAASsZ,KAAOtZ,EAASsZ,KAAOA,GACnDpJ,EAAA,GAAAsc,GAAgBxsB,GAAYA,EAASmP,MAAQnP,EAASmP,MAAQqd,IAIhEmiD,GAA8Br1D,GAE9Bs1D,GAAc,CACZJ,aAAAA,EACAD,cAAAA,EACA3O,aAAAA,EACA6O,uBAAAA,IAMFsD,GAAaD,EAFO,MAWb,SAAAuB,GAAa98D,EAAgB23C,GAAmB,IAAAsL,EAAS5+D,UAAApI,OAAAoI,QAAAzI,IAAAyI,UAAAzI,IAAAyI,UAAG,GACnE6M,EAAM,SAAQ,CAAI8O,KAAAA,EAAM23C,SAAAA,EAAUsL,UAAAA,SAI9BhtC,GAFA0hC,EACEsL,EACc1sC,GAAmBxT,EAAMkT,GAAejW,EAAMic,IxEzuCtD,SAAiBhG,EAA8BjW,GAC7D,OAAAvL,EAAAA,EACKwhB,CAAAA,EAAAA,OACHC,YAAWzhB,EAAAA,EACNwhB,CAAAA,EAAAA,EAAcC,gBAAWxlB,EAAA,CAAA,EAC3BuP,EAAmBD,IAAQ,KAGlC,CwEmuCwB+8D,CAAiB9mD,GAAejW,GAGlC2X,GAAa1B,GAAejW,IAG1CiW,GAAc7P,YAAcuxC,GvE5uCpB,SAAsBvxC,EAA0BpG,GAC9D,OACEif,GAAelC,GAAa3W,GAAYpG,KACvC+c,GAAa3W,GAAWnqB,OAAS+jB,EAAK/jB,QAAUmgC,GAAkBhW,GAEvE,CuEyuCU42D,CAAsB/mD,GAAc7P,UAAWpG,IAEjD6iB,GAAgB,MAKpB3nB,KAWO,SAAA+hE,GAASC,GAChBhsE,EAAM,WAAU,CAAIgsE,eAAAA,IAEpBvjE,EAAA,GAAA4qD,IAAa,GACb5qD,EAAA,GAAAwvD,IAAc,GAEdpgE,KAAOF,MAAI,WAET8Q,EAAA,GAAA4qD,IAAa,GACb5qD,EAAA,GAAAwvD,GAAc+T,eAITC,GAAoBn9D,EAAgBwV,GAC3CtkB,EAAM,sBAAuB8O,EAAMwV,OAE7BiB,EAAUxW,EAAmBD,QACnCiW,GxE7tCE,SACJlT,EACAkT,EACAQ,EACAjB,GAEA,OAAA/gB,EAAAA,EAAA,CAAA,EACKwhB,GACHG,CAAAA,EAAAA,CAAAA,mBAAkB3hB,EAAAA,KACbwhB,EAAcG,oBAAkB1lB,CAAAA,EAAAA,KAClC+lB,EAAUrB,GAAcoB,GAAmBP,EAAeQ,GAAShxB,OAAO+vB,OAGjF,CwEgtCoB4nD,CAAcr6D,EAAMkT,GAAeQ,EAASjB,IAGrD,SAAA6nD,GAAgBC,GACvBpsE,EAAM,sBAAuBosE,GAE7B3jE,EAAA,GAAAspB,GAAaq6C,GAmMN,SAAAC,GAAeC,GACtB,IAAAt9E,EAAMs9E,EAANt9E,OACAsa,EAAIgjE,EAAJhjE,KACAF,EAAGkjE,EAAHljE,IACAV,EAAK4jE,EAAL5jE,MACAE,EAAM0jE,EAAN1jE,OACAuR,EAASmyD,EAATnyD,UACAE,EAAUiyD,EAAVjyD,WACA+wC,EAAOkhB,EAAPlhB,QAEM+H,ECppDI,SAAAoZ,GAwCb,IAvCC16D,EAAI06D,EAAJ16D,KACAkT,EAAawnD,EAAbxnD,cACA1C,EAAQkqD,EAARlqD,SACA3U,EAAM6+D,EAAN7+D,OACA8+D,EAASD,EAATC,UACAC,EAAWF,EAAXE,YACAC,EAAqBH,EAArBG,sBACA/N,EAAK4N,EAAL5N,MACA9K,EAAM0Y,EAAN1Y,OACA1jC,EAAOo8C,EAAPp8C,QACA2vC,EAAQyM,EAARzM,SACA6M,EAAWJ,EAAXI,YACAC,EAASL,EAATK,UACAC,EAAcN,EAAdM,eACA1L,EAAQoL,EAARpL,SACA2L,EAASP,EAATO,UACAC,EAAaR,EAAbQ,cACApZ,EAAM4Y,EAAN5Y,OACAC,EAAW2Y,EAAX3Y,YAsBM1+C,EAAY6P,EAAc7P,UAE1B8+C,OAAmBtpE,IAATmnB,EACVm7D,IAAiB93D,EACjB+3D,IAAe/3D,GAAYiH,EAAQ0P,GAAa3W,IAChDg4D,EAAah4D,EAAY6Q,EAAMlU,EAAMga,GAAa3W,SAAcxqB,EAChEyiF,EAAgB5xE,MAAMoS,QAAQu/D,GAChC,aACArgE,GAASqgE,GACP,cACA,aAEAx+C,EACJslC,IACC3oC,GAAiBnW,IAAciW,GAAejW,IAAckW,GAAiBlW,IAE1Ek4D,GACH/qD,GACD2xC,GACa,MAAb9+C,GACA2Y,GAAmB3Y,KAClB+3D,IACA1xE,MAAMoS,QAAQoY,EAAMlU,EAAM8W,EAAQkD,GAAa3W,MAE5Cm4D,GAAgBhrD,GAAY2xC,GAAwB,MAAb9+C,GAAqB2Y,GAAmB3Y,GAC/Eo4D,EAAmBD,IAAiBvgE,GAAgBogE,GAEpDK,GAAUlrD,GAAYqM,EACtB8+C,EAAU9+C,EACV++C,GAAYprD,GAAY2qD,EACxBU,GAAgBrrD,GAAY2xC,GAAWtlC,IAAyBu+C,EAChEU,GACHtrD,GACD2xC,GACa,MAAb9+C,IACCmW,GAAiBnW,IAAckW,GAAiBlW,MAChD+3D,EAEGW,EAAcl/C,EACdm/C,EAAsBD,EAAc,cAAgB,UAEpDE,GAA8BzrD,IAAYurD,GAAsBZ,EAChEe,GACH1rD,IAAaurD,EAAcj/C,GAAWzZ,KAAerI,GAASqgE,GAAcF,GACzEgB,GACH3rD,IAAaurD,EAAcj/C,GAAWzZ,KAAe3Z,MAAMoS,QAAQu/D,GAAcF,GAC9EiB,GACH5rD,IAAaurD,EAAcj/C,GAAWzZ,IAAcpI,GAAgBogE,GAAcF,GAE/EpmD,IACS,MAAb1R,IAAqBg4D,IACjBhjD,GACEgjD,EACAnoD,EAAcE,iBACdlW,EAAmB8c,GAAa3W,IAChCxH,GAIR,SAASwgE,EAAsBl7E,GACzB07B,EACW,cAAT17B,GACF85E,EAAU95E,GAGZmuE,EAASnuE,EAEZ,CAED,MAAO,CACL,CACEA,KAAM,MACN2hC,MAAO,CACL,CACE3hC,KAAM,SACN2yD,QAAS,WAAM,OAAA6mB,GACf1qD,EAAAA,KAAMqsD,GACNt+E,KAAM,WACNoyD,MAAO,yCACPn9C,UAAWsoE,GAEb,CACEp6E,KAAM,kBACN0wE,KAAM,CACJ1wE,KAAM,SACN2yD,QAAS,WAAM,OAAA8mB,GAAa,EAC5B3qD,KAAMqsD,GACNt+E,KAAMs9E,EACNlrB,MAAO,6CACPn9C,UAAWuoE,GAEb3kE,MAAO,OACPisB,MAAO,CACL,CACE3hC,KAAM,SACN8uB,KAAMqsD,GACNt+E,KAAMs9E,EACNlrB,MAAO,6CACP0D,QAAS,kBAAM8mB,GACf3nE,EAAAA,UAAWuoE,GAEb,CACEr6E,KAAM,SACN8uB,KAAM8E,EAAgB3E,GAAgBC,GACtCryB,KAAM,iBACNoyD,MAAO,uEACP0D,QAAS,WAAM,OAAA+mB,GAAuB,EACtC5nE,UAAWwoE,OAMrB,CAAEt6E,KAAM,aACR,CACEA,KAAM,MACN2hC,MAAO,CACL,CACE3hC,KAAM,kBACN0wE,KAAM,CACJ1wE,KAAM,SACN2yD,QAAS,WAAA,OAAMgZ,GAAM,EACrB78C,EAAAA,KAAMssD,GACNv+E,KAAM,MACNoyD,MAAO,6DACPn9C,UAAWyoE,GAEb7kE,MAAO,OACPisB,MAAO,CACL,CACE3hC,KAAM,SACN8uB,KAAMssD,GACNv+E,KAAM,gBACNoyD,MAAO,6DACP0D,QAAS,WAAM,OAAAgZ,GAAM,EAAK,EAC1B75D,UAAWyoE,GAEb,CACEv6E,KAAM,SACN8uB,KAAMssD,GACNv+E,KAAM,gBACNoyD,MAAO,4DACP0D,QAAS,WAAM,OAAAgZ,GAAM,EAAM,EAC3B75D,UAAWyoE,KAIjB,CACEv6E,KAAM,kBACN0wE,KAAM,CACJ1wE,KAAM,SACN2yD,QAAS,WAAM,OAAAkO,GAAO,IACtB/xC,KAAMoyC,GACNrkE,KAAM,OACNoyD,MAAO,8DACPn9C,UAAW0oE,GAEb9kE,MAAO,OACPisB,MAAO,CACL,CACE3hC,KAAM,SACN8uB,KAAMoyC,GACNrkE,KAAM,iBACNoyD,MAAO,8DACP0D,QAAS,WAAA,OAAMkO,GAAO,EACtB/uD,EAAAA,UAAW0oE,GAEb,CACEx6E,KAAM,SACN8uB,KAAMoyC,GACNrkE,KAAM,iBACNoyD,MAAO,6DACP0D,QAAS,WAAM,OAAAkO,GAAO,IACtB/uD,UAAW0oE,KAIjB,CACEx6E,KAAM,SACN2yD,QAAS,WAAM,OAAAx1B,GAAS,EACxBrO,KAAMusD,GACNx+E,KAAM,QACNoyD,MAAO,oCACPn9C,UAAW2oE,KAIjB,CAAEz6E,KAAM,aACR,CACEA,KAAM,MACN2hC,MAAO,CACL,CACE3hC,KAAM,SACN2hC,MAAO,CACL,CACE3hC,KAAM,SACN2yD,QAAS,WAAA,OAAMgnB,GACf7qD,EAAAA,KAAMwsD,GACNz+E,KAAM,YACNoyD,MAAO,uCACPn9C,UAAW4oE,GAEb,CACE16E,KAAM,SACN2yD,QAAS,WAAM,OAAAinB,GACf9qD,EAAAA,KAAMysD,GACN1+E,KAAM,UACNoyD,MAAO,4BACPn9C,UAAW6oE,GAEb,CACE36E,KAAM,SACN2yD,QAAS,WAAM,OAAAgO,GAAQ,EACvB7xC,KAAMqyC,GACNtkE,KAAM,OACNoyD,MAAO,gCACPn9C,SAAUud,IAAaqM,GAEzB,CACE17B,KAAM,SACN2yD,QAAS,WAAA,OAAMiO,KACf9xC,KAAMsyC,GACNvkE,KAAM,YACNoyD,MAAO,6DACPn9C,SAAUud,IAAaqM,GAEzB,CACE17B,KAAM,SACN2yD,QAAS,WAAA,OAAMma,KACfh+C,KAAM0sD,GACN3+E,KAAM,SACNoyD,MAAO,oCACPn9C,SAAUud,IAAaqM,KAI7B,CACE17B,KAAM,SACN2hC,MAAO,CACL,CAAE3hC,KAAM,QAASnD,KAAMg+E,GACvB,CACE76E,KAAM,SACN2yD,QAAS,WAAA,OAAMuoB,EAAsB,YAAY,EACjDpsD,KAAM8rD,EAAca,GAAwBC,GAC5C7+E,KAAM,YACNoyD,MAAO4rB,EAAsB,aAC7B/oE,UAAWgpE,GAEb,CACE96E,KAAM,SACN2yD,QAAS,WAAA,OAAMuoB,EAAsB,SACrCpsD,EAAAA,KAAM8rD,EAAca,GAAwBC,GAC5C7+E,KAAM,SACNoyD,MAAO4rB,EAAsB,aAC7B/oE,UAAWipE,GAEb,CACE/6E,KAAM,SACN2yD,QAAS,kBAAMuoB,EAAsB,QAAQ,EAC7CpsD,KAAM8rD,EAAca,GAAwBC,GAC5C7+E,KAAM,QACNoyD,MAAO4rB,EAAsB,SAC7B/oE,UAAWkpE,GAEb,CACEh7E,KAAM,SACN2yD,QAAS,WAAA,OAAMuoB,EAAsB,QACrCpsD,EAAAA,KAAM8rD,EAAca,GAAwBC,GAC5C7+E,KAAM,QACNoyD,MAAO4rB,EAAsB,SAC7B/oE,UAAWmpE,OAMrB,CACEj7E,KAAM,aAER,CACEA,KAAM,MACN2hC,MAAO,CACL,CACE3hC,KAAM,SACN2yD,QAAS,WAAA,OAAMknB,KACf/qD,KAAM6sD,GACN9+E,KAAM,gBACNoyD,MAAO,+DACPn9C,SAAUud,IAAaqM,GAAwBu+C,GAEjD,CACEj6E,KAAM,SACN2yD,QAAS,WAAA,OAAMonB,GAAe,EAC9BjrD,KAAM8sD,GACN/+E,KAAM,eACNoyD,MAAO,8DACPn9C,SAAUud,IAAaqM,GAAwBu+C,KAKzD,CD8zC4C4B,CAA0B,CAChEh9D,KAAAA,EACAkT,cAAAA,GACA1C,SAAAA,EACA3U,OAAAA,EAEA8+D,UAAWzE,GACX0E,YAAazE,GACb0E,sBAAuBxE,GAEvBvJ,MAAOyJ,GACPvU,OAAQ4U,GACRt4C,QAAS04C,GAET/I,SAAUkJ,GACV2D,YAAa1D,GACb2D,UAAW1D,GAEX2D,eAAgBlD,GAChBxI,SAAUmI,GACVyD,cAAejD,GACfgD,UAAWvD,GAEX5V,OAAQgX,GACR/W,YAAakX,KAGTn2C,EAAQ8wC,EAAoBtS,GAE9B,IAAU,IAAVx+B,EAAA,KAYEtkC,EAAO,CACXiZ,KAAAA,EACAF,IAAAA,EACA+Q,UAAAA,EACAE,WAAAA,EACA3R,MAAAA,EACAE,OAAAA,EACA5Z,OAAAA,EACA8W,mBAAmB,EACnBsC,QAAO,WACLy9D,IAAY,EACZ77D,OAIJ67D,IAAY,EAEN,IAAA3qD,EAAUG,EAAkByzD,GAzBvB,CACT9K,IAAK5Y,EACD,0EACA1gE,EACJiqC,MAAAA,EACAquC,eAAc,WAAA,OAAQloD,EAAmBI,KAoBW7qB,IAG/C,SAAAw5E,GAAkB15E,OACrBs+B,GAAmB1J,GAAc7P,eAIjC/kB,IACFA,EAAMU,kBACNV,EAAMM,kBAGJN,GAAwB,gBAAfA,EAAM6C,MAA0B7C,EAAM3C,SAAWotB,EAE5DyxD,GAAe,CACb/iE,KAAOnZ,EAAqB4+E,QAC5B3lE,IAAMjZ,EAAqB8gE,QAC3BvoD,MAAOwD,GACPtD,OAAQqD,GACRm/C,SAAS,eAKLp8D,EAAoB,QAAdggF,EAAGlK,SAAW,IAAAkK,OAAA,EAAXA,EAAa7rB,cAAc,6CACtCn0D,EACFq9E,GAAe,CACbr9E,OAAAA,EACAmrB,UAAW,EACXzR,MAAOwD,GACPtD,OAAQqD,GACRm/C,SAAS,eAILh0C,EAAkB,QAAd63D,EAAGnK,SAAAmK,IAAWA,OAAXA,EAAAA,EAAa53D,wBACtBD,GACFi1D,GAAe,CACbjjE,IAAKgO,EAAKhO,IAAM,EAChBE,KAAM8N,EAAK9N,KAAO,EAClBZ,MAAOwD,GACPtD,OAAQqD,GACRm/C,SAAS,eAmBiB8jB,SAAAA,YAAAA,GAAAtsD,EAAAC,IAAAC,2FAClC9iB,KAAAA,EAAqC,GAArCA,EAAM,oBAAqB+xB,IACtBA,GAAU,CAAAo9C,EAAA15E,oBAAA05E,EAAAhxC,OAAAixC,UAAAA,KAAAA,EAIPtgE,GAJOsgE,EAIYr9C,IAAnBjjB,KAAMkjB,EAAQo9C,EAARp9C,SACdvpB,EAAA,GAAAspB,QAAarnC,GAIT4tB,GADE+2D,GAA4B,QAAXC,EAAAxK,SAAW,IAAAwK,OAAA,EAAXA,EAAansB,cAAc,uBAAwB,OAExEksB,EAAe72D,SAYjB2vD,GARgB,EAEZ5lD,GAAI,UACJzT,KAAMC,EAAmBD,GACzB5iB,MAAO8lC,KAIc,SAAAJ,EAAaC,UAElCnqB,MAAOmjB,GAAgB+G,EAAaC,EAAc/iB,OAKtDu8B,WAAWrhC,IAAK,yBAAAmlE,EAAA/wC,OAAAmxC,GAAAA,uCAoBFvlE,KACdhK,EAAM,SAIF4a,IACFA,EAAe5Q,QACf4Q,EAAetoB,UAmCV,SAAAm/B,GAAe3iB,GACf,gBvEviDT+C,EACAkT,EACAjW,GAGA,IAAM4Z,EAAaC,EAAQ7Z,GACrB0gE,EAAY,CAAC3mD,GAAK/Z,IAElB0H,EAA8BuP,EAAMlU,EAAM6W,GAC1C+mD,EAAiBj5D,EAASmU,GAAmBnU,EAAQuO,EAAeyqD,QAAa9kF,EAEvF,OAAI+kF,EACKxiD,GAAqBvE,EAAWn0B,OAAOk7E,IAAiB,GAExDthD,GAAqBrf,EAEhC,CuEuhDW4gE,CAAuB79D,EAAMkT,GAAejW,GAK5C,SAAA6gE,GAAWx/E,GACdy/E,GACFA,EAAkBpf,OAAOrgE,YAIpB0/E,KACHD,GACFA,EAAkBlf,wsCAxpDrBjoD,EAAA,GAAE6oB,GAAgBre,GAA4B,CAC7CE,wBAAAA,EACAC,wBAAAA,yBAGCpT,EAAM,YAAa+kB,GAAc7P,+BAU3B,SAAsBm+C,MACxByR,KAIDzR,EAAU,CAAAyc,IAAAA,EACNh0C,EAAwDg0C,QAAjDA,EAAGrjE,SAASlL,iBAAiBujE,GAAahpC,gBAAOg0C,IAAAA,EAAAA,EAAK,EACnErnE,EAAA,GAAAq8D,EAAY72E,MAAM8hF,eAAiB,OAAMjL,QACzCA,EAAY72E,MAAMk4C,WAAarK,EAAU3vB,GAAoB,KAAI24D,QACjEA,EAAYhhC,WAAa33B,GAAiB24D,GAC1Cr8D,EAAA,GAAAq8D,EAAY72E,MAAM8hF,eAAiB,GAAEjL,QAErCr8D,EAAA,GAAAq8D,EAAY72E,MAAM8hF,eAAiB,OAAMjL,GACzCr8D,EAAA,GAAAq8D,EAAY72E,MAAMk4C,WAAa,GAAE2+B,QACjCA,EAAYhhC,WAAa33B,GAAiB24D,GAC1Cr8D,EAAA,GAAAq8D,EAAY72E,MAAM8hF,eAAiB,GAAEjL,GAjBtCkL,CAAsB3c,0BAoEtBqT,GAAqBvB,yBAwKf,SAAuBC,GACzBp7C,GAAQjF,GAAc7P,UAAWkwD,KACpCplE,EAAM,yBAA0BolE,IAE5B35C,GAAgB25C,IAA4C,OAAtBA,IACxCzzC,GAAgByzC,IA3KnB6K,CAAuB7K,8CAKvBmB,GAAuB10D,EAAMmyC,EAAWt2C,EAAQu2C,wBAGhDx7C,EAAA,GAAAknD,GrCjUC,SACJxL,GAEA,IAAMlmD,EAAoE,CAAA,EA0B1E,OAvBAkmD,EAAiB36D,SAAQ,SAACo9D,GACxB3oD,EAAI8Q,EAAmB63C,EAAgB93C,OAAS83C,CAClD,IAGAzC,EAAiB36D,SAAQ,SAACo9D,GAGxB,IAFA,IAAIl+B,EAAak+B,EAAgB93C,KAE1B4Z,EAAW39B,OAAS,GAAG,CAC5B29B,EAAaC,EAAQD,GACrB,IAAME,EAA6B7Z,EAAmB2Z,GAEhDE,KAAiB3qB,IACrBA,EAAI2qB,GAAiB,CACnBw/B,cAAc,EACdt5C,KAAM4Z,EACNvX,QAAS,wBACTizC,SAAU/5C,GAAmBs8C,SAGlC,CACH,IAEO1oD,CACT,CqCmS2BiyE,CAAoB/rB,0BAmjD1CyrB,EAAoB9K,E1Cn4DnB,SAAkCqL,GAGtC,IAAIC,EACAC,EAEJ,SAASC,EAAeC,GACtB,OAAOA,EAAO,GACV7lE,GACA6lE,EAAO,GACL5lE,GACAC,EACP,CAED,SAAS4lE,IACP,GAAIL,EAAmB,CAErB,IAAMI,GAAQH,GAAmB,IAAM3lE,GAAuB,KAE9D0lE,EAAkBrsC,WAAaysC,CAChC,CACF,CAED,SAASE,EAAgBC,GAClBL,GAAmBK,IAAUN,IAChCO,IAEA3wE,GAAM,kBAAmB0wE,GACzBN,EAAkBM,EAClBL,EAAkBO,YAAYJ,EAAoB/lE,IAErD,CAED,SAASkmE,IACHN,IACFrwE,GAAM,kBAEN6wE,cAAcR,GACdA,OAAkB3lF,EAClB0lF,OAAkB1lF,EAErB,CAuBD,OA/DAsV,GAAM,0BAA2BmwE,GA+D1B,CACL3f,OAtBF,SAAgBrgE,GACd,GAAIggF,EAAmB,CACrB,IAAM54D,EAAIpnB,EAAM8gE,QAChB6f,EAAwBX,EAAkB94D,wBAAlCjO,EAAG0nE,EAAH1nE,IAAKmR,EAAMu2D,EAANv2D,OAEThD,EAAInO,EAENqnE,GADcH,EAAelnE,EAAMmO,IAE1BA,EAAIgD,EAEbk2D,EADcH,EAAe/4D,EAAIgD,IAGjCo2D,GAEH,CACF,EAQCjgB,UANF,WACEigB,GACD,EAMH,C0C+zDuCI,CAAwBjM,QAAep6E,qEAiBzEoM,GAAO,CACRurB,SAAAA,EACA3U,OAAAA,EACA4jB,cAAAA,GACAg5B,QAAAA,GACA8G,iBAAAA,GACAP,YAAAA,GACAp/B,eAAAA,GACAznB,MAAAA,GACAsY,QAAS6lD,GACThH,SAAUiI,GACV5a,SAAUod,GACVp6C,SAAUG,GACV1B,OAAQ87C,GACR3hB,gBAAiB6hB,GACjB16C,YAAa46C,GACblgB,cAAAA,EACAf,cAAemhB,GACfrc,YAAaA,GAAW,WAAoB,EAC5CQ,OAAQmf,GACRjf,UAAWmf,0BAGV7vE,EAAM,kBAAmBlJ,wCAjsCtBsvE,SAA2B17E,IAATmnB,GACpBw3D,GAAkBx3D,QAGJnnB,IAATmnB,EAAuB,CAAAA,KAAAA,IAAWhiB,KAAMA,GAAQ,kDAvdhD,SAAalE,GACpB8c,EAAA,GAAAssB,GAAeppC,aAGeqlF,GAAA,OAAAjL,GAAA7nE,MAAA/K,KAAAA,UAAA4yE,aAS9Bt9D,EAAA,GAAA4qD,IAAa,GACb5qD,EAAA,GAAAwvD,IAAc,GACdjuD,MAGO,SAA4B9J,GACnCF,EAAM,0BAA2BE,GAEjCyxB,GAAgB1E,GAAqB/sB,EAAM4O,MAAM,IACjDzF,GAASnJ,EAAM4O,UA4dR,SAAY3e,GAAqB,IAAA8gF,EACxC9gF,EAAMM,iBAEA,IAAAygC,EAAmC+/C,QAAtBA,EAAG9gF,EAAM8gC,yBAAaggD,SAAnBA,EAAqB9/C,QAAQ,mBAC7BzmC,IAAlBwmC,GAIJf,GAAO,CACLe,cAAAA,EACArf,KAAAA,EACAqD,UAAW6P,GAAc7P,UACzBmN,SAAAA,EACA3U,OAAAA,EACA4U,QAAS6lD,GACTzI,aAAciM,GACdhM,gBAAAA,0BA0VF6K,GADc,gBA8DdI,IACE3V,SAAQ,oBA8QV2W,GAAY,IAAK,GAAM,eAIvBA,GAAY,IAAK,GAAO,IA6BjB,SAAcz7E,OACf4gC,EAAQtY,GAAkBtoB,GAC1By8B,EAAiBz8B,EAAM4Z,SA8CzB,GA7CJ/J,EAAM,UAAa,CAAA+wB,MAAAA,EAAOt/B,IAAKtB,EAAMsB,MAEvB,WAAVs/B,IAEF5gC,EAAMM,iBACN23E,IAAU,IAEE,iBAAVr3C,IAEF5gC,EAAMM,iBACN23E,IAAU,IAEE,WAAVr3C,IAEF5gC,EAAMM,iBACNg4E,IAAW,IAEC,iBAAV13C,IAEF5gC,EAAMM,iBACNg4E,IAAW,IAIC,WAAV13C,IACF5gC,EAAMM,iBACNw4E,MAEY,WAAVl4C,GAAgC,cAAVA,IACxB5gC,EAAMM,iBACNu4E,MAEY,WAAVj4C,IACF5gC,EAAMM,iBACN24E,GAAa,cAED,WAAVr4C,IACF5gC,EAAMM,iBACNkhC,GvEtzBG1E,GAAqB,IAAI,KuEyzBhB,WAAV8D,GACF84C,GAAkB15E,GAGN,YAAV4gC,GAAiC,kBAAVA,EAAyB,CAClD5gC,EAAMM,qBAEAmjC,EAAe7O,GAAc7P,UAC/ByX,GAAe9a,EAAMkT,GAAe6H,IAAmB7H,GAAc7P,UACrEoY,GAAoBzb,EAAMkT,IAE9B4M,GAAgBiC,GAChBunB,GAAetvB,GAAa+H,IAE1B,GAAU,cAAV7C,GAAmC,oBAAVA,EAA2B,CACtD5gC,EAAMM,qBAEAmjC,EAAe7O,GAAc7P,UvEnxCnC,SACJrD,EACAkT,GACA,IAAA6H,EAAcz5B,UAAApI,OAAA,QAAAL,IAAAyI,UAAA,IAAAA,UAAA,GAER+hB,EAAY6P,EAAc7P,UAChC,IAAKA,EACH,OAAW,KAEb,IAAMqW,EAAYqB,EAAiBf,GAAa3W,GAAakX,GAAWva,EAAMqD,GAIxEg8D,EAAiBpkE,GAAgBiZ,EAAMlU,EAAM0Z,IAC/C9E,GAAa1B,EAAewG,GAC5BxG,EAEEosD,EAAWxmD,GAAmB9Y,EAAMkT,EAAewG,GACnD6lD,EAAgBzmD,GAAmB9Y,EAAMq/D,EAAgB3lD,GAE/D,GAAIqB,EAEF,OAAI1B,GAAkBhW,GACA,OAAbi8D,EAAoBnlD,GAAqBmlD,EAAUA,GAAY,KAGpElmD,GAAiB/V,GACM,OAAlBk8D,EAAyBplD,GAAqBolD,EAAeA,GAAiB,KAG9D,OAAlBA,EACHplD,GAAqBJ,GAAc1W,GAAYk8D,GAC/C,KAGN,GAAInmD,GAAiB/V,GACnB,OAAyB,OAAlBk8D,EAAyBnkD,GAAqBmkD,GAAe,GAAS,KAG/E,GAAIlmD,GAAkBhW,GACpB,OAAoB,OAAbi8D,EAAoBlkD,GAAqBkkD,GAAU,GAAS,KAGrE,GAAI/lD,GAAiBlW,GACnB,OAAoB,OAAbi8D,EAAoBlkD,GAAqBkkD,GAAU,GAAS,KAGrE,GAAIhmD,GAAejW,GAAY,CAC7B,GAAiB,OAAbi8D,GAAyC,IAApBA,EAASpmF,OAChC,OAAW,KAGb,IAAM29B,EAAaC,EAAQwoD,GACrB36D,EAASuP,EAAMlU,EAAM6W,GAC3B,OAAIntB,MAAMoS,QAAQ6I,GAETyW,GAAqBkkD,GAAU,GAE/BjkD,GAAmBikD,GAAU,EAEvC,CAED,OAAI9lD,GAAiBnW,GACM,OAAlBk8D,EACHnkD,GAAqBmkD,GAAe,GACvB,OAAbD,EACElkD,GAAqBkkD,GAAU,GAC/B,KAGG,IACb,CuE6sCUE,CAAiBx/D,EAAMkT,GAAe6H,IAAmB7H,GAAc7P,UACvEoY,GAAoBzb,EAAMkT,IAE9B4M,GAAgBiC,GAChBunB,GAAetvB,GAAa+H,IAE1B,GAAU,cAAV7C,GAAmC,oBAAVA,EAA2B,CACtD5gC,EAAMM,qBAEAmjC,EAAe7O,GAAc7P,UvE3pCzB,SACdrD,EACAkT,GAEoB,IADpB6H,EAAcz5B,UAAApI,OAAAoI,QAAAzI,IAAAyI,UAAAzI,IAAAyI,UAAG,GACjBs3B,IAAat3B,UAAApI,OAAA,QAAAL,IAAAyI,UAAA,KAAAA,UAAA,GAEP+hB,EAAY6P,EAAc7P,UAChC,IAAKA,EACH,OAAW,KAGb,IAAAo8D,EAA4BnkD,GAAqBtb,EAAMkT,EAAe0F,GAA9D2C,EAAKkkD,EAALlkD,MAAO73B,EAAQ+7E,EAAR/7E,SAEf,GAAIq3B,EACF,OAAKvB,GAAiBnW,GAIX,KAHF8W,GAAqB9W,EAAUpG,KAAMoG,EAAUpG,MAM1D,GAAIse,GAAS73B,EACX,OAAOq5B,GAAkBr5B,GAG3B,IAAMmzB,EAAaC,EAAQkD,GAAa3W,IAClCsB,EAASuP,EAAMlU,EAAM6W,GAE3B,OAAI0C,GAAiBlW,IAAc3Z,MAAMoS,QAAQ6I,GACxCwV,GAAqB9W,EAAUpG,KAAMoG,EAAUpG,MAGpDuc,GAAiBnW,KAAe3Z,MAAMoS,QAAQ6I,GACzC0W,GAAmBhY,EAAUqW,WAAW,GAGtC,IACb,CuEunCUgmD,CAAiB1/D,EAAMkT,GAAe6H,GAAiBvK,IACvD0C,GAAc7P,UACdoY,GAAoBzb,EAAMkT,IAE9B4M,GAAgBiC,GAChBunB,GAAetvB,GAAa+H,IAE1B,GAAU,eAAV7C,GAAoC,qBAAVA,EAA4B,CACxD5gC,EAAMM,iBAEA,IAAAmjC,EACJ7O,GAAc7P,gBAAsBxqB,IAATmnB,EvEhoCnB,SACdA,EACAkT,GAEoB,IADpB6H,EAAcz5B,UAAApI,OAAAoI,QAAAzI,IAAAyI,UAAAzI,IAAAyI,UAAG,GACjBs3B,IAAat3B,UAAApI,OAAA,QAAAL,IAAAyI,UAAA,KAAAA,UAAA,GAEP+hB,EAAY6P,EAAc7P,UAChC,IAAKA,EACH,OAAW,KAGb,IAAAs8D,EAAwBrkD,GAAqBtb,EAAMkT,EAAe0F,GAA1D2C,EAAKokD,EAALpkD,MAAO33B,EAAI+7E,EAAJ/7E,KAEf,OAAIm3B,EACGvB,GAAiBnW,GAIX,KAHF8W,GAAqB9W,EAAUpG,KAAMoG,EAAUpG,MAMtDse,GAAS33B,EACJm5B,GAAkBn5B,GAGvB41B,GAAiBnW,GACZ+X,GAAqB/X,EAAUqW,WAAW,GAG5C,IACT,CuEmmCYkmD,CAAkB5/D,EAAMkT,GAAe6H,GAAiBvK,IACxD0C,GAAc7P,UACdoY,GAAoBzb,EAAMkT,IAEhC4M,GAAgBiC,GAChBunB,GAAetvB,GAAa+H,IAG1B,GAAU,UAAV7C,GAAqBhM,GAAc7P,UAAS,IAE1CoW,GAA4BvG,GAAc7P,WAAS,CAC/C,IAAApG,EAAOiW,GAAc7P,UAAUqW,UAC/B/U,EAASuP,EAAMlU,EAAM8W,EAAQ7Z,IAC/BvT,MAAMoS,QAAQ6I,IAEhBmb,GAAgB1E,GAAqBne,GAAM,OAI3Cqc,GAAepG,GAAc7P,aAE/B/kB,EAAMM,iBACNkhC,GAAepuB,EAAAA,EAAA,CAAA,EAAMwhB,GAAc7P,WAAS,CAAA,EAAA,CAAE+Y,MAAM,MAGlD7C,GAAiBrG,GAAc7P,WACjC/kB,EAAMM,iBAGFqc,GADUiZ,EAAMlU,EAAMkT,GAAc7P,UAAUpG,OAGhD88D,GAAa7mD,GAAc7P,UAAUpG,MAAM,GAG3C6iB,GAAepuB,EAAAA,EAAMwhB,CAAAA,EAAAA,GAAc7P,WAAW+Y,CAAAA,EAAAA,CAAAA,MAAM,KAMtD,GAA2B,IADP8C,EAAMlpB,QAAQ,WAAY,IAC9B9c,QAAgBg6B,GAAc7P,iBAGhD/kB,EAAMM,sBACNs5E,GAAsB55E,EAAMsB,KAK5B,GAAU,UAAVs/B,IACC9F,GAAiBlG,GAAc7P,YAAcgW,GAAkBnG,GAAc7P,mBAG9E/kB,EAAMM,sBACNs5E,GAAsB,IAIpB,GAAU,eAAVh5C,GAA0B3F,GAAiBrG,GAAc7P,WAAS,KAC9DhpB,EAAQ65B,EAAMlU,EAAMkT,GAAc7P,UAAUpG,MAE9Cf,GAAM7hB,IAERK,OAAOgc,KAAKqK,OAAO1mB,GAAQ,UAIjB,WAAV6kC,GAAsBhM,GAAc7P,YACtC/kB,EAAMM,iBACNkhC,GAAgB,OAGJ,WAAVZ,IACF5gC,EAAMM,iBACNs7E,IAAS,IAGG,WAAVh7C,IACF5gC,EAAMM,iBACNs7E,IAAS,IAGG,WAAVh7C,IACF5gC,EAAMM,iBACN25E,MAGY,iBAAVr5C,IACF5gC,EAAMM,iBACN85E,OAIK,SAAgBp6E,GACvB6P,EAAM,kBAAmB7P,OAEnB3C,EAAS2C,EAAM3C,OAEhB8mB,GAAkB9mB,EAAQ,WAAcA,EAAOqoB,oBAElD7L,KAEK+a,GAAc7P,gBAAsBxqB,IAATmnB,GAAgC,KAAThiB,QAAwBnF,IAATmF,IA1jCxEmQ,EAAM,+BAEN+kB,GAAaxhB,EAAAA,EAAA,CAAA,EACRwhB,IACH7P,CAAAA,EAAAA,CAAAA,UAAW+X,GAAoB,IAAK,YAorC/B,SAA8B98B,GACrCk8E,GAAe,CACbr9E,OAAQgnB,GAAuB7lB,EAAM3C,OAAuB,UAC5D2sB,UAAW,EACXzR,MAAOwD,GACPtD,OAAQqD,GACRm/C,SAAS,gBAIuB8jB,OAAAA,GAAAhxE,MAAAvN,KAAAwC,UAAA+7E,aAmClClvE,EAAM,qBACNyI,EAAA,GAAAspB,QAAarnC,GACbsf,iBAIAw7D,EAAat7D,GAAKra,OAGX,SAA0B+jC,GACjCjC,GAAgBiC,GAEhB5pB,KACAX,GAASwiB,GAAa+H,KAcf,SAAsBzjC,OACvBuhF,GAAiBl9D,GACrBrkB,EAAM3C,QACL,SAAAU,UAAYA,IAAYqzE,CAAa,IAEpCmQ,GACEjjD,GAAmB1J,GAAc7P,aACnClV,EAAM,4CACN2xB,IAAiB,SAAAzc,GACX,OAAAiW,GAAejW,IAERkW,GAAiBlW,OADdA,CAAAA,EAAAA,OAAW+Y,MAAM,IAItB/Y,KAIPkc,GAAYxW,IACdA,EAAe5Q,QACf4Q,EAAe++B,QAGjB35C,EAAM,yBACF4a,GACFA,EAAe++B,4DAlkDA,IAAAphD,yDAAqBwyB,GAC1C/qB,EAAM,cAGA2xE,EAAkBpuE,EAAAA,EACnBwhB,CAAAA,EAAAA,IACHC,CAAAA,EAAAA,CAAAA,YAAW,CAAA,EACXE,mBAAkB,CAAA,IAGpBzc,EAAA,GAAAsc,GAAgBM,GAAmBxT,EAAM8/D,KAAwBp5E,sGA6pDlDqiB,EAAc3Q,kBASrBD,KACA+/D,GAAsB,iBAGtB//D,KACA+/D,GAAsB,iBAKtB//D,0DAoC0E86D,EAAW76D,2DA7FpFs3D,EAAat3D,wqCE37DpB,SAAU2nE,GAAcpkF,GAC5B,MAsBwB,WAAjB1D,EADSoC,EArBFsB,IAsBgC,OAAVtB,EArB3BsB,EAGE,IAAAqkF,MAAMrkF,EAAQ,CACvBsH,IAAGA,SAACtH,EAAQskF,EAAUC,GAGpB,OAAOH,GAFOI,QAAQl9E,IAAItH,EAAQskF,EAAUC,GAG7C,EAEDpgF,IAAG,WACD,OAAY,CACb,EAEDsgF,eAAc,WACZ,OAAY,CACb,IAIL,IAAkB/lF,CAFlB,qmRC0OiBqP,MAAMoS,QAAQzjB,EAAY,2aAEzB,2LADkCA,EAAY,aAAYA,EAAmB,wJAA3CA,EAAY,4LAyB/BA,EAAe,sBACb,eACT,eACG,iBACE,+KASNysE,QAAA71D,QAAQZ,eACPxX,gBACIA,YACJA,WACDA,UACDA,eACKA,oBACKA,qBACCA,+BAER,wKAvBMwB,EAAe,qjBAgE/BA,EAAY,2EADf6E,GAEKvB,EAAAisB,EAAAzqB,+CADF9E,EAAY,wGA7BIA,EAAc,sBACZ,eACT,eACG,iBACE,+KASNysE,QAAA71D,QAAQZ,eACPxX,gBACIA,YACJA,WACDA,UACDA,eACKA,oBACKA,qBACCA,+BAER,yKAvBMwB,EAAc,8mBApF5BA,EAAwB,IAACA,EAAe,IAAEgoF,YAAW,gGAX3ChoF,EAAyB,uIA4B1BA,EAAU,IAAG+gE,GAAcmE,YAKxCllE,EAAU,KAAAooD,GAAApoD,yBAoBKA,EAAY,IAAG+gE,GAAcmE,aAK1CllE,EAAY,KAAAyX,GAAAzX,4CAmCXA,EAAY,6YAjEwC,0PAyBI,6MAqFlE,sPApHY8H,EAAA9F,MAAAimF,EAAAh2D,EAAQjyB,EAAQ,IAAkC,kBAA9BoxB,GAAkBpxB,EAAQ,sQAuBpDA,EAAK,qQAIuCA,EAAY,8KADAA,EAAY,sIAyF5DA,EAAY,sIAtI9B6E,GA2IKvB,EAAA4kF,EAAApjF,GA1IHzB,GA6HK6kF,EAAAC,GA5HH9kF,GA0CK8kF,EAAAnrB,GAzCH35D,GAEK25D,EAAAnlD,WACLxU,GAGK25D,EAAA7kD,yBAEL9U,GAEK25D,EAAAE,WACL75D,GAMC25D,EAAAl1D,WAEDzE,GAOK25D,EAAAG,GANH95D,GAKK85D,EAAAC,GAJH/5D,GAGQ+5D,EAAAkN,uDAWZjnE,GAEK25D,EAAAK,WACLh6D,GAEA25D,EAAA2B,WAEFt7D,GAgFK8kF,EAAAC,GA/EH/kF,GAuCK+kF,EAAAC,GAtCHhlF,GAOKglF,EAAAC,GANHjlF,GAKKilF,EAAAvrB,GAJH15D,GAGQ05D,EAAAwN,yDAkCdlnE,GAsCK+kF,EAAAG,GArCHllF,GAEKklF,EAAAC,mCAuCXnlF,GAUK6kF,EAAAO,GATHplF,GAQQolF,EAAA7a,oCAjH8B5tE,EAAgB,kBAiBKA,EAAiB,kBAQpCA,EAAkB,kBAmF9CA,EAAe,qOA5HhBA,EAAwB,IAACA,EAAe,IAAEgoF,YAAW,MAAA7vE,EAAAuwE,UAAAC,KAWpDjwE,GAAA,EAAApY,EAAA,IAAA2nF,KAAAA,EAAAh2D,EAAQjyB,EAAQ,IAAkC,kBAA9BoxB,GAAkBpxB,EAAQ,MAAqB8H,EAAA9F,QAAAimF,8CAM3DjoF,EAAU,IAAG+gE,GAAcmE,cAKxCllE,EAAU,gJAYXA,EAAK,oCAQWA,EAAY,IAAG+gE,GAAcmE,cAK1CllE,EAAY,uKAT6BA,EAAY,4MADAA,EAAY,iCAyF5DA,EAAY,4iBA9IlC6E,GAqJKvB,EAAAisB,EAAAzqB,6CArJ+D9E,EAAY,+QAvBrE,SAAA8f,GAAM9b,GACbA,EAAQ8b,+BA5IN8oE,EAEAC,EA3BE/yE,EAAQH,GAAY,+BAEmB6E,EAAlCvW,GAAAA,WAAE6kF,EAAG,mBAAqBzmE,KAAQymE,EAClCnhE,EAAanN,EAAbmN,OACQnN,EAARuwD,SAAAA,OAAQ,IAAAge,EAAA,GAAAA,EAER/gE,EAA4BxN,EAA5BwN,YACAiB,EAAgCzO,EAAhCyO,wBACAC,EAAgC1O,EAAhC0O,wBACA1F,EAAkBhJ,EAAlBgJ,OACA63D,EAAoC7gE,EAApC6gE,gBACAthB,EAA4Bv/C,EAA5Bu/C,iBACAyS,EAA0BhyD,EAA1BgyD,WAEAnV,EAA+B78C,EAA/B68C,eACAC,EAAuB98C,EAAvB88C,gBACAC,EAA4C/8C,EAA5C+8C,sBAEAwK,EAA4BvnD,EAA5BunD,cACA6H,EAAkCpvD,EAAlCovD,aACA2R,EAAgD/gE,EAAhD+gE,oBACAzV,EAAwBtrD,EAAxBsrD,YAEA4D,EAAoBlvD,EAApBkvD,YAOH7qD,EAAUhS,GAAoB,gBAA9BgS,MAEJs5C,GAAa,EAEX6wB,EAAO3+E,GAAAA,OAAMpG,EAAE,KAAAoG,OAAIwa,EAAmBkmD,IACtCvtD,EAAQ6xB,GAAqB25C,IAAO,CAAA,EAGtCz5C,GAAsD,IAAzCD,GAA0BC,WACvCC,GAA0D,IAA3CF,GAA0BE,aAEzCpc,EAAe5V,EAAM4V,cAAY,GACjCU,EACFwjC,IAAoB95C,EAAM85C,iBAAmB95C,EAAMsW,MAC/CtW,EAAMsW,MACNm1D,EAAyB3xB,GAAiB4xB,YACxCN,EACAprE,EAAM4V,cAAY,CAAA,GAEtB+1D,EAAW3rE,EAAM2rE,WAAY,EAE7BC,OAAmC5oF,EACnC6oF,EAAc,CAAc1jF,KAAM,IAE7B,SAAAsjF,EAAyB3xB,GACzB,OAAAD,EAAe/I,MAAM,SAAAz6B,GAAS,OAAAA,EAAK5vB,KAAOqzD,CAAe,KAAKD,EAAe,GA2ChF,IAAAiyB,EAA4Bh9B,aA1BRi9B,EAAkCz1D,GACtD,QAAgBtzB,IAAhB+oF,cACFF,EAAc,CAAK1jF,KAAM,UACzB4Y,EAAA,GAAA6qE,EAAe,sBAKftzE,EAAM,mBACJ,CAAAge,MAAAA,QAGI01D,EAAkBP,EAAyB3xB,GAAiBmyB,aAChEF,EACAz1D,EACAtQ,QAGF6lE,EAAc,CAAK1hE,KAAM6hE,IACzBjrE,EAAA,GAAA6qE,OAAe5oF,SACR2iB,QACPkmE,EAAc,CAAK1jF,KAAM,UACzByjF,EAAe1gE,OAAOvF,O/F7HE,y3B+FyD3B5E,EAAA,GAAEqqE,EAAelB,GAAc7rD,EAAMlU,EAAMojD,0BAE3CxsD,EAAA,GAAEsqE,EAAkBD,EAAY,CAAKjhE,KAAMihE,GAAY,CAAOjjF,KAAM,0BAyEnE2jF,EAA0BV,EAAc90D,+CAMxCub,GAAqB25C,GAAO,CAC1B51D,aAAAA,EACAU,MAAAA,EACAwjC,gBAAAA,EACA6xB,SAAAA,OAGFrzE,EAAM,wBAAyBkzE,EAAS35C,GAAqB25C,uDAxDtD,SAAoBU,GAC3BnrE,EAAA,GAAA6U,EAAes2D,QACf51D,EAAQm1D,EAAyB3xB,GAAiB4xB,YAAYN,EAAcc,IAC5EnrE,EAAA,GAAA4qE,GAAW,GAEXrzE,EAAM,sBAAqB,CAAIsd,aAAAA,EAAcU,MAAAA,EAAOq1D,SAAAA,KAG7C,SAAkBljF,GACzBsY,EAAA,GAAAuV,EAAS7tB,EAAM3C,OAA+BtB,OAC9Cuc,EAAA,GAAA4qE,GAAW,GACXrzE,EAAM,oBAAuB,CAAAge,MAAAA,EAAOq1D,SAAAA,gBAiDhC,QAAiB3oF,IAAjBooF,cACFS,EAAc,CAAK1jF,KAAM,UACzB4Y,EAAA,GAAA6qE,EAAe,sBAKftzE,EAAM,kBAAiB,CAAIge,MAAAA,QACrB01D,EAAkBP,EAAyB3xB,GAAiBmyB,aAChEb,EACA90D,EACAtQ,GAGFkmD,EAAW,EAEPrxC,GAAI,UACJzT,KAAMC,EAAmBkmD,GACzB/oE,MAAOwnF,KAIX3qE,UACOsE,GAGPvM,QAAQZ,MAAMmN,QACdkmE,EAAc,CAAK1jF,KAAM,UACzByjF,EAAe1gE,OAAOvF,iBAKxB5E,EAAA,GAAAgxB,GAAcA,GAGdD,GAA0BC,WAAaA,cAIvChxB,EAAA,GAAAixB,GAAgBA,GAGhBF,GAA0BE,aAAeA,GAOlC,SAA0BioB,GACjC3hD,EAAM,4BAA6B2hD,GACnCl5C,EAAA,EAAA+4C,EAAkBG,GAClBF,EAAsBE,OAEhBkyB,EAA2BV,EAAyB3xB,GAC1D/4C,EAAA,GAAAuV,EAAQ61D,EAAyBT,YAAYN,EAAcx1D,IAC3D7U,EAAA,GAAA4qE,GAAW,eAIPhxB,EACF55C,EAAA,GAAA45C,GAAcA,GAEdt5C,2cClNO+qE,GAAkD,CAAE,09ICiGxB5pF,EAAU,gBAA8B,IAAhBA,EAAgB,aAAhBA,EAAgB,oPAHvE6E,GAKIvB,EAAAy4D,EAAAj3D,GAJFzB,GAAgB04D,EAAA8tB,WAChBxmF,GAEI04D,EAAA+tB,8DADyB9pF,EAAU,2BAAcA,EAAgB,6NAqBtEA,EAAS,6DADZ6E,GAEKvB,EAAAisB,EAAAzqB,uCADF9E,EAAS,0IA9CHA,EAAW,GAAG,mBAAqB,4BAqBvCA,EAAW,KAAMA,EAAU,aAAI+pF,EAAA/pF,EAAU,UAAA,IAAA+pF,OAAA,EAAVA,EAAYlpF,QAAS,QAA2BL,IAArBR,EAAgB,KAAcyX,GAAAzX,2DAa5E,QACJA,EAAU,SACY,IAAjBA,EAAiB,aAAjBA,EAAiB,4EAQhCA,EAAS,IAAAmZ,GAAAnZ,+aAcd,6IAzCgB8H,EAAA9F,MAAAimF,EAAAh2D,EAAQjyB,EAAQ,IAAkC,kBAA9BoxB,GAAkBpxB,EAAQ,oOAwClDiZ,EAAA2B,SAAAsgD,KAAAl7D,MAAeA,EAAU,KAAgB,QAAZgqF,EAAAhqF,EAAY,UAAA,IAAAgqF,OAAA,EAAZA,EAAYnpF,QAAS,KAAKb,EAAgB,gKA1DzF6E,GAgEKvB,EAAAgV,EAAAxT,wBA7DHzB,GA4DKiV,EAAAH,GA3DH9U,GAsCO8U,EAAAs8C,GArCLpxD,GAGUoxD,EAAAw1B,WACV5mF,GAgCOoxD,EAAAwH,GA/BL54D,GAWI44D,EAAAvH,GAVFrxD,GAAYqxD,EAAAC,WACZtxD,GAQIqxD,EAAAE,GAPFvxD,GAMCuxD,EAAA9sD,kCAWLzE,GAUI44D,EAAApH,GATFxxD,GAAiBwxD,EAAAC,WACjBzxD,GAOIwxD,EAAAE,wBAKV1xD,GAMK8U,EAAAT,0BAELrU,GAUK8U,EAAAN,GATHxU,GAQQwU,EAAAoB,oCALIjZ,EAAU,0CAxDkBA,EAAK,oEAClCA,EAAW,GAAG,mBAAqB,gCAiB9B0Y,GAAA,EAAApY,GAAA2nF,KAAAA,EAAAh2D,EAAQjyB,EAAQ,IAAkC,kBAA9BoxB,GAAkBpxB,EAAQ,MAAqB8H,EAAA9F,QAAAimF,gBAI5EjoF,EAAW,KAAMA,EAAU,KAAc,QAAVkqF,EAAAlqF,EAAU,UAAA,IAAAkqF,OAAA,EAAVA,EAAYrpF,QAAS,QAA2BL,IAArBR,EAAgB,8IAe7DA,EAAiB,4CAQhCA,EAAS,+DAaF0Y,GAAA,GAAApY,GAAA46D,KAAAA,KAAAl7D,MAAeA,EAAU,KAAgB,QAAZmqF,EAAAnqF,EAAY,UAAZmqF,IAAYA,OAAZA,EAAAA,EAAYtpF,QAAS,KAAKb,EAAgB,iOA/D9E,SAAA8f,GAAM9b,GACbA,EAAQ8b,yCAxDJhK,EAAQH,GAAY,wBAEf1R,EAAUuW,EAAVvW,GACA0jB,EAAanN,EAAbmN,KACAojD,EAAkBvwD,EAAlBuwD,SACAtB,EAAcjvD,EAAdivD,OAEH5qD,EAAUhS,GAAoB,gBAA9BgS,MAEFmqE,EAAO,GAAA3+E,OAAMpG,EAAE,KAAAoG,OAAIwa,EAAmBkmD,IACtC6d,EAAe/sD,EAAMlU,EAAMojD,GAK3B5oD,GACJngB,MAAO,EACPgwB,MAAO,aAMHo4D,EAAU,CAAIjoE,GAHlBngB,OAAQ,EACRgwB,MAAO,eAILq4D,UAAgBC,EAAGV,GAAgBZ,uBAAhBsB,EAA0BD,iBAC7CE,GAA8CC,QAA1BA,EAAAZ,GAAgBZ,UAAhBwB,IAA0BA,OAA1BA,EAAAA,EAA0BD,oBAAqBpoE,EACnEsoE,OAAgCjqF,0LAfjCozB,EAAQwiC,QAAgC51D,IAAjBooF,EAA6BtkE,GAAeskE,QAAgBpoF,oBACrF+d,EAAA,EAAEmsE,EAAa92D,EAAQA,EAAM7f,IAAIge,SAAgBvxB,qBAmBhD+d,EAAA,GAAAqrE,GAAgBZ,GACd,CAAAqB,iBAAAA,EACAE,kBAAAA,GAAAX,IAGF9zE,EAAM,wBAAyBkzE,EAASY,GAAgBZ,UA1BvD5yB,EAAc/kD,MAAMoS,QAAQmlE,8CA+B3BrqE,EAAA,EAAAksE,OAAYjqF,OAENm/B,GAAqCgrD,QAAhBA,EAAAN,SAAAM,IAAgBA,OAAhBA,EAAAA,EAAkB3oF,SAAmB,QAAd4oF,EAAIF,SAAU,IAAAE,GAAI,QAAJA,EAAVA,EAAa,UAAC,IAAAA,OAAA,EAAdA,EAAiB5oF,QAAK,GACtE2M,EAA6Bk8E,QAApBA,EAAGN,SAAAM,IAAiBA,OAAjBA,EAAAA,EAAmB7oF,MAC/B66B,EAAaiuC,GAASnjD,EAAMojD,EAAUprC,EAAUhxB,GACtD86D,EAAM,CAAG5sC,WAAAA,EAAYkuC,SAAAA,EAAUprC,SAAAA,EAAUhxB,UAAAA,IAEzCkQ,UACOsE,OACPsnE,EAAY/hE,OAAOvF,iCAmCwCknE,EAAgBroF,oBAWvDuoF,EAAiBvoF,iKCnH3BxD,KAEhB,UCMgBssF,GAAW7nF,GAAyB,IAAX8nF,EAAI9hF,UAAApI,OAAA,QAAAL,IAAAyI,UAAAzI,GAAAyI,UAAG,GAAA,IAC9C,GAAIhG,EAAO,GAAM8nF,EACf,OAAO9nF,EAAK+nF,UAAY,KAG1B,IAAMC,EAAKhoF,EAAO8nF,EAClB,GAAIE,EAAK,GAAMF,EACb,OAAOE,EAAGD,QAAQ,GAAK,MAGzB,IAAME,EAAKD,EAAKF,EAChB,GAAIG,EAAK,GAAMH,EACb,OAAOG,EAAGF,QAAQ,GAAK,MAGzB,IAAMG,EAAKD,EAAKH,EAChB,OAAII,EAAK,GAAMJ,EACNI,EAAGH,QAAQ,GAAK,OAGdG,EAAKJ,GACNC,QAAQ,GAAK,KACzB,qUCQM/hB,EAxBOmiB,EAAgB5wE,EAAhB2d,SAAAA,WAAQizD,GAAQA,EAChBC,EAAuB7wE,EAAvB6wE,SACAC,EAAwB9wE,EAAxB8wE,UACA7hB,EAAkBjvD,EAAlBivD,OACAC,EAAuBlvD,EAAvBkvD,YACA6hB,EAA0B/wE,EAA1B+wE,eACAhiB,EAAkB/uD,EAAlB+uD,OACAC,EAAkBhvD,EAAlBgvD,OACAnQ,EAAgB7+C,EAAhB6+C,QACAC,EAAgB9+C,EAAhB8+C,QACAkyB,EAAkBhxE,EAAlBgxE,UACAC,EAAmBjxE,EAAnBixE,WACAC,EAAgBlxE,EAAhBkxE,QACAC,EAAqBnxE,EAArBmxE,aACA/hB,EAAkCpvD,EAAlCovD,aAELgiB,EAAU,CACd9iF,KAAM,SACN8uB,KAAMmyC,GACNhS,MAAO,kBACP7iC,UAAW,aACXumC,QAAS8vB,omBAIVhtE,EAAA,GAAE0qD,EAAgB9wC,GA8DbyzD,EAAU,CAER9iF,KAAM,YA7DNA,KAAM,SACN8uB,KAAMgxC,GACN7Q,MAAO,6DACP7iC,UAAW,aACXumC,QAAS4vB,EACTzwE,SAAUud,IAAaqzD,IAGvB1iF,KAAM,SACN8uB,KAAMixC,GACN9Q,MAAO,sEACP7iC,UAAW,cACXumC,QAAS6vB,EACT1wE,SAAUud,IAAaszD,GAGvB,CAAA3iF,KAAM,cAGNA,KAAM,SACN8uB,KAAMqyC,GACNlS,MAAO,OACP7iC,UAAW,WACXumC,QAASgO,EACT7uD,SAAUud,IAAauzD,IAGvB5iF,KAAM,SACN8uB,KAAMsyC,GACNnS,MAAO,6CACP7iC,UAAW,gBACXumC,QAASiO,EACT9uD,SAAUud,IAAawzD,GAEzBC,EAEE,CAAA9iF,KAAM,cAGNA,KAAM,SACN8uB,KAAMwyC,GACNrS,MAAO,gBACP7iC,UAAW,WACXumC,QAAS8N,EACT3uD,UAAWy+C,IAGXvwD,KAAM,SACN8uB,KAAMyyC,GACNtS,MAAO,sBACP7iC,UAAW,WACXumC,QAAS+N,EACT5uD,UAAW0+C,GAGX,CAAAxwD,KAAM,iCAUX2hC,EAAQm/B,EAAaX,IAAiBA,goCClFN,eAAOjpE,EAAU,uEAAlD6E,GAAwDvB,EAAAisB,EAAAzqB,8CAAhB9E,EAAU,4FAIjB,iBAASA,EAAY,uEAAtD6E,GAA4DvB,EAAAisB,EAAAzqB,8CAAlB9E,EAAY,8FAIrB,oBAAYA,EAAS,SAAC,kFAAvD6E,GAAuEvB,EAAAisB,EAAAzqB,sDAA1B9E,EAAS,uDATnDgnD,OAAexmD,IAAfR,MAAwBooD,GAAApoD,GAIxBs+D,OAAiB99D,IAAjBR,MAA0ByX,GAAAzX,GAI1BknD,OAAc1mD,IAAdR,EAAc,IAAaA,KAAY,GAACmZ,GAAAnZ,0IAT/C6E,GAYKvB,EAAAisB,EAAAzqB,sGAXiBtE,IAAfR,iEAIiBQ,IAAjBR,iEAIcQ,IAAdR,EAAc,IAAaA,KAAY,kJA3BxC6rF,EAGAllE,EAGAmlE,EAGAC,EAGAC,EAdOC,EAAoCzxE,EAApCyxE,+HAGV1tE,EAAA,EAAEstE,EAAiB,QAAdK,EAAGD,SAAW,IAAAC,GAAW,QAAXA,EAAXA,EAAalhE,iBAAS,IAAAkhE,GAAMA,QAANA,EAAtBA,EAAwB1S,YAAxB0S,IAA4BA,OAA5BA,EAAAA,EAA8BtnF,qBAGpC2Z,EAAA,EAAAoI,OAAenmB,IAARqrF,EAA+B,QAAdM,EAAGF,SAAW,IAAAE,GAAK,QAALA,EAAXA,EAAazhF,WAAG,IAAAyhF,OAAA,EAAhBA,EAAkBC,OAAOP,QAAOrrF,mBAG7D+d,EAAA,EAAEutE,OAAsBtrF,IAATmmB,EAAqBA,EAAK0lE,YAAS7rF,kBAGlD+d,EAAA,EAAEwtE,OAAwBvrF,IAATmmB,QAA8BnmB,IAARqrF,EAAoBA,EAAMllE,EAAKrV,KAAO,OAAI9Q,kBAGjF+d,EAAA,EAAEytE,UAASM,EAAGL,SAAW,IAAAK,GAAW,QAAXA,EAAXA,EAAathE,iBAAS,IAAAshE,GAAQ,QAARA,EAAtBA,EAAwBC,cAAxBD,IAA8BA,OAA9BA,EAAAA,EAAgC5uE,QAAQ,SAAA8H,EAAOsF,GACrD,OAAAtF,EAAQsF,EAAM0hE,GAAK1hE,EAAMxZ,OAC/B,kJCjBCm7E,GAAiBC,GAAeC,OAAO,CAC3C,CAAEC,IAAKC,GAAKC,aAAcz2E,MAAO,6BACjC,CAAEu2E,IAAKC,GAAKR,OAAQh2E,MAAO,sCAC3B,CAAEu2E,IAAKC,GAAKE,KAAM12E,MAAO,uCACzB,CAAEu2E,IAAKC,GAAKG,OAAQ32E,MAAO,sCAC3B,CAAEu2E,IAAKC,GAAKI,QAAS52E,MAAO,sCAGjB62E,GAAcC,GAAmBV,IAUxCW,GAAgBX,GAAe1oF,+/NCm8BO,IAAhByO,EAAI,IAAC3R,8FAIjBb,EAAY,cACXA,EAAa,WAChBA,EAAU,gBACLA,EAAe,mBACZA,EAAkB,WAC1BA,EAAU,WACVA,EAAU,eACNA,EAAa,gBACZA,EAAa,aAChBA,EAAa,kBACRA,EAAa,kMAHhBA,EAAa,+BACZA,EAAa,4BAChBA,EAAa,iCACRA,EAAa,icA0F9B6E,GAGKvB,EAAA6U,EAAArT,2EAjFA9E,EAAc,KAAA06E,GAAA16E,MAqCbA,EAAc,KAAAyX,GAAAzX,uIAvCwBA,EAAc,sBAA1D6E,GAAuFvB,EAAAisB,EAAAzqB,gIAA3C9E,EAAc,KAErDA,EAAc,8HAqCbA,EAAc,8SAJfm3D,EAAAzkC,GAAS1yB,EAAQ,KAAA,GAAI8gB,IAA2B,gCA/B3C+6C,mEAEuCivB,GAC3C5pE,GACA,MAAA7W,MAAAA,yEAAAA,OAEyEygF,GACvE9qF,EAAK,IAAAa,OACL,MAAA,eAIA8E,KAAM,cACNoyD,MAAO,yEACP0D,QAASz7D,EAAA,MAGT2F,KAAM,oBACNoyD,MAAO,wEACP0D,QAASz7D,EAAA,MAGT2F,KAAM,SACNoyD,MAAO,sCACP0D,QAASz7D,EAAA,cAGJA,EAAK,6JAGhB6E,GAEKvB,EAAAisB,EAAAzqB,2GA9B0CgmF,GAC3C5pE,GACA,MAAA,MAAA,yEAAA7W,OAEyEygF,GACvE9qF,EAAK,IAAAa,OACL,MAAA,kBAuBH6X,GAAA,KAAApY,EAAA,KAAA62D,KAAAA,EAAAzkC,GAAS1yB,EAAQ,KAAA,GAAI8gB,IAA2B,KAAAlZ,GAAAyxB,EAAA89B,+JAoB7CkF,GAAAr8D,EAAkB,KAAAA,EAAe,IAAA4oB,GAAgB5oB,EAAI,OAftDA,EAAS,IAAAkoD,GAAAloD,KAITA,EAAc,KAAAmoD,GAAAnoD,yEAiCuCA,EAA2B,0MArChFA,EAAS,0HAITA,EAAc,+HAWb,MAAAM,EAAA,KAAA+7D,GAAAr8D,EAAkB,KAAAA,EAAe,IAAA4oB,GAAgB5oB,EAAI,wvBARjD67D,GACG50C,QAAAjnB,MAAeinB,gBACfjnB,EAAa,YACbA,EAAY,YACZA,EAAK,gGAHL,MAAAM,EAAA,KAAAo+D,EAAAz3C,QAAAjnB,MAAeinB,gCACfjnB,EAAa,+OAYlB43B,KAAMgxC,GACNjjE,KAAM,SACNoyD,MAAO,6DACP0D,QAASz7D,EAAA,MAGT43B,KAAMigC,GACNlyD,KAAM,YACNoyD,MAAO,qBACP0D,QAAOz7D,EAAA,cAGFA,EAAK,qHAZV43B,KAAMgxC,GACNjjE,KAAM,SACNoyD,MAAO,6DACP0D,QAASz7D,EAAA,MAGT43B,KAAMigC,GACNlyD,KAAM,YACNoyD,MAAO,qBACP0D,QAAOz7D,EAAA,8JA/FdA,EAAW,IAAA+nD,GAAAslC,GAAArtF,8EAuBWwS,EAAiB,IAACA,EAAI,IAAEA,EAAc,yDAD3DxS,EAAK,MAAA,2IAvBmCA,EAAW,qBAA3D6E,GA+GKvB,EAAAisB,EAAAzqB,wEA9GE9E,EAAW,wKAD8BA,EAAW,iIArThD,SAAAstF,GAAat3E,UAElB1E,KAAM0E,EAAM1E,MAAQ,EACpBk7E,GAAIx2E,EAAMw2E,IAAM,EAChBvlE,QAASjR,EAAMiR,SAAW,GAC1Bq0C,QAAStlD,EAAMslD,QACfpB,SAAUlkD,EAAMkkD,qCA/gBhBqzB,EACAC,EACAC,EACAxB,EArCO9zD,EAAiB3d,EAAjB2d,SACAgjD,EAAoB3gE,EAApB2gE,YACAuS,EAAkBlzE,EAAlBkzE,UACAC,EAAoBnzE,EAApBmzE,YACA1S,EAAwBzgE,EAAxBygE,gBACAC,EAA6C1gE,EAA7C0gE,kBACAlzD,EAA4BxN,EAA5BwN,YACA4lE,EAAepzE,EAAfozE,QACA1kE,EAAgC1O,EAAhC0O,wBACA1F,EAAkBhJ,EAAlBgJ,OACAs2C,EAA2Bt/C,EAA3Bs/C,UACAC,EAA4Bv/C,EAA5Bu/C,iBACAxhC,EAAkB/d,EAAlB+d,SACA+iD,EAA0B9gE,EAA1B8gE,aACAh0C,EAAkB9sB,EAAlB8sB,SACAmlC,EAAgBjyD,EAAhBiyD,QACA/R,EAAgBlgD,EAAhBkgD,QACAC,EAAcngD,EAAdmgD,OACAiP,EAAkCpvD,EAAlCovD,aACA4R,EAAwBhhE,EAAxBghE,YACAC,EAAkCjhE,EAAlCihE,iBAEL3lE,EAAQH,GAAY,uBAEpBk4E,EAAuB,CAC3BtmF,IAAK,QACLxI,IAAK+uF,GACLjsC,MAAOksC,GACPxnF,gBAAgB,GAGZo0E,EAA0B,oBAAXt4E,OACrByT,EAAM,SAAU6kE,GAQZ,IAAAqT,GAAiB,EAEjB/zB,EAAgB,GACdg0B,MAAwBC,GACxBC,MAA0BD,GAC1BE,MAAwBF,GACxBG,MAAyBH,GACzBI,MAAuBJ,GAEzBxmE,EAAmBuzD,EACnBt1E,EAAOwiB,GAAQT,EAASM,EAAaxE,GAerC+qE,EAAkCrlE,EAQtCjd,GAAOysB,EAAAC,IAAAC,MAAA,SAAA41D,IAAA71D,OAAAA,IAAApf,MAAA,SAAAk1E,iBAAAA,EAAAt1D,KAAAs1D,EAAAljF,MAAA,KAAA,EAAA,IACDovE,EAAK,CAAA8T,EAAAljF,oBAAAkjF,EAAAx6C,4BAKPw5C,EAAiBiB,GAAoB,CACnCprF,OAAQiqF,EACRoB,YAAcC,GAAkBjpF,EAAMqoF,GAElC,GADA5mD,EAAc7d,YAAY5jB,GAE9BwyB,SAAAA,EACAnQ,YAAAA,UAEK7E,GAEPvM,QAAQZ,MAAMmN,+CAIlB9W,IAAS,WACHohF,IACF33E,EAAM,6BACN23E,EAAetrF,cAIf,IAAAk3D,GAAU,EACVC,GAAU,EAERuhB,GAAcx4D,KACdy4D,GAAmBz4D,cAETvC,KACV2tE,IACF33E,EAAM,SACN23E,EAAe3tE,SAMf,IAAA67D,IAAY,WAsBAsC,GAAYphD,EAA+BgyD,GACzD/4E,EAAM,cAAe+mB,EAAYgyD,GAE3B,IAAAhS,EAAer5D,EAAOS,MAAMte,GAC5Bm3B,EAAcC,EAAmB8/C,EAAchgD,GAC/C48B,EAAO5vB,EAAgBgzC,EAAchgD,UAK3CiyD,GAJoB,CAClBnpF,KAAM6d,EAAOG,UAAUmZ,EAAa,KAAM9U,IAGP6mE,GAAY,IAG/ClnE,KAAMmV,EACN+/C,aAAAA,EACApjB,KAAAA,EACAC,KAAM78B,YAIDixD,QACPh4E,EAAM,UAEFqiB,SACU,MAIN,IAAA2E,EAActZ,EAAOS,MAAMte,UAKjCmpF,GAJoB,CAClBnpF,KAAM6d,EAAOG,UAAUmZ,EAAa,KAAM9U,KAGP,GAAM,IAEpC,QACA7E,GACPspD,EAAQtpD,UAGE,WAGL4qE,QACPj4E,EAAM,WAEFqiB,eAKI,IAAA2E,EAActZ,EAAOS,MAAMte,UAKjCmpF,IAHEnpF,KAAM6d,EAAOG,UAAUmZ,KAGY,GAAM,IAEpC,QACA3Z,GACPspD,EAAQtpD,UAGE,WAGL4rE,QACPj5E,EAAM,WAEFqiB,MASF22D,GAHE,CAAAnpF,KAAMmgB,EAAWngB,KAGkB,GAAM,GAE3C4Y,EAAA,GAAAywE,GAAantE,IACbtD,EAAA,GAAA0wE,GAAiB,YACV9rE,GACPspD,EAAQtpD,IAmCI,SAAAu9D,GAAkBwO,GAChC,IAAAjrF,EAAEirF,EAAFjrF,GACA8mE,EAAQmkB,EAARnkB,SACArB,EAAWwlB,EAAXxlB,YACAxrD,EAAOgxE,EAAPhxE,YAGQ,IAAAyJ,EAAOnE,EAAOS,MAAMte,GAE1Bg2E,IAAY,EAEZF,EAAgB,CACdx3E,GAAIA,GAAM62E,GACVnzD,KAAAA,EACAojD,SAAUA,GAAQ,GAClBrB,YAAc,SAAA7sC,GACR6sC,EACFA,EAAW,CACT7sC,WAAAA,EACAlV,KAAAA,EACAg5D,gBAAiB5jD,EAAmBpV,EAAMkV,MAG5C/mB,EAAM,cAAe+mB,GACrBohD,GAAYphD,GAAY,KAG5B3e,QAAO,WACLy9D,IAAY,EACZ77D,KACI5B,GACFA,aAICiF,GACPspD,EAAQtpD,aA4FHgsE,GAAarqF,EAAgBF,GACpCkR,EAAM,eAAkB,CAAAhR,OAAAA,EAAQF,KAAAA,IAE5B6oF,GACFA,EAAe/+E,SACb++E,EAAejwE,MAAMtP,OAAM,CACzB8c,UAAS,CAAIlmB,OAAAA,EAAQF,KAAAA,GACrBqsD,gBAAgB,cAMfm+B,GAAkBnpF,EAAmBopF,MAGD,IAAvCA,EAAK7xE,MAAMwN,UAAUuhE,OAAO1rF,OAAY,KACpCiqB,EAAQukE,EAAK7xE,MAAMwN,UAAUuhE,OAAO,GACpC+C,EAAe3pF,EAAKvF,MAAM0qB,EAAMxZ,KAAMwZ,EAAM0hE,IAC9C,GAAiB,MAAjB8C,GAAyC,MAAjBA,EAAoB,CACxC,IAAAC,EAAQC,EAAcvrE,MAAMte,GAC5Bif,EAAO1lB,OAAOyC,KAAK4tF,EAAME,UAAUnhC,MAAM,SAAA1pC,GAAI8qE,IAAAA,EAE1C,OAAa,QAAbA,EADSH,EAAME,SAAS7qE,GAChB5iB,aAAK,IAAA0tF,OAAA,EAAbA,EAAe7D,OAAQ/gE,EAAMxZ,QAEhC+pB,EAAUk0D,EAAME,SAAS7qE,MAE3BA,GAAQyW,GAAWA,EAAQr5B,OAASq5B,EAAQs0D,SAC9C75E,EAAM,mDAAoD8O,EAAMyW,GAGhE8zD,GAFe9zD,EAAQr5B,MAAM6pF,IAAM,EACtBxwD,EAAQs0D,SAAS9D,IAAM,cAOnC+D,KACA,OAAAC,GAAOC,GAAkB,CAAA/lF,MvGthBI,MuGyhB7B,SAAA2kF,GAAoBqB,GAIhB,IAHXzsF,EAAMysF,EAANzsF,OACAqrF,EAAWoB,EAAXpB,YACAx2D,EAAQ43D,EAAR53D,SACAnQ,EAAW+nE,EAAX/nE,YAOAlS,EAAM,2BAA8B,CAAAqiB,SAAAA,EAAUnQ,YAAAA,QAExCxK,EAAQwyE,GAAY7wF,OAAM,CAC9BuL,IAAKikF,EACL3jE,UAAWilE,GAAsB/U,GACjCgV,WAAU,CACRC,GAAOC,GAAI,CAAAC,GAAexC,IAC1BI,EAAkBmC,GAAGR,MACrBU,KACAC,KACAC,KACAC,KACAxU,KACAyU,KACAC,KACAC,KACAZ,GAAYa,wBAAwBT,IAAG,GACvCU,KACA3D,GAAmB4D,GAAyB,CAAAC,UAAU,IACtDC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACApB,GAAOC,GAAE/lF,GAAAA,OAAA4J,EACJu9E,IAAmBv9E,EACnBw9E,IAAax9E,EACby9E,IAAYz9E,EACZ09E,IAAa19E,EACb29E,IAAU39E,EACV49E,IAAgB59E,EAChB69E,MAEL5E,GACA6E,GAAkB,CAAGC,iBAAiB,IACtCC,GAAWC,iBACT,CAAAC,SAAU/C,KAEZ6C,GAAWG,eAAehC,IAAI,SAAAliF,OAC5B+9E,EAAc/9E,EAAOsP,OAEjBtP,EAAOmkF,WACTC,KACSpkF,EAAOqkF,cAGhBC,QAGJC,KACAtnD,GAAM,CACJjsB,KAAK,IAEP+yE,GAAWS,aACXvE,EAAoBiC,GAAGJ,GAAY73D,SAASi4D,GAAGj4D,IAC/Ck2D,EAAmB+B,GAAGJ,GAAYpC,QAAQwC,GAAGxC,IAC7CQ,EAAkBgC,GAAGuC,GAAa3qE,IAClCsmE,EAAiB8B,GAAG6B,GAAWW,MAAK,CAAA,EAAA,CAAOC,KAAMC,kBAIrDrF,MAAqBwE,GAAU,CAC7Bz0E,MAAAA,EACA8O,OAAQhpB,aAUHwvF,KACA,QAAAvF,GACHl2E,iBAAiBk2E,GAAewF,iBAAiB,eAAelqE,SAAS,QAItE,SAAAmqE,GAAsBt2B,GACrB,IAAA93C,EAA4B83C,EAA5B93C,KAAMqC,EAAsBy1C,EAAtBz1C,QAASizC,EAAawC,EAAbxC,SACf+4B,ElGlbI,SAAiBttF,EAAcif,GAC7C,IACE,IAAM2qE,EAAQC,EAAcvrE,MAAMte,GAE5ButF,EAAcruE,EAAmBD,GACjCyW,EAAUk0D,EAAME,SAASyD,GAC/B,GAAI73D,EACF,MAAO,CACLzW,KAAAA,EACA+B,KAAM0U,EAAQ9zB,IAAM8zB,EAAQ9zB,IAAIof,KAAO0U,EAAQr5B,MAAQq5B,EAAQr5B,MAAM2kB,KAAO,EAC5EI,OAAQsU,EAAQ9zB,IAAM8zB,EAAQ9zB,IAAIwf,OAASsU,EAAQr5B,MAAQq5B,EAAQr5B,MAAM+kB,OAAS,EAClFzV,KAAM+pB,EAAQ9zB,IAAM8zB,EAAQ9zB,IAAIskF,IAAMxwD,EAAQr5B,MAAQq5B,EAAQr5B,MAAM6pF,IAAM,EAC1EW,GAAInxD,EAAQ83D,OAAS93D,EAAQ83D,OAAOtH,IAAMxwD,EAAQs0D,SAAWt0D,EAAQs0D,SAAS9D,IAAM,EAGzF,CAAC,MAAO1oE,GACPvM,QAAQZ,MAAMmN,EACf,CAED,MAAO,CACLyB,KAAAA,EACA+B,KAAM,EACNI,OAAQ,EACRzV,KAAM,EACNk7E,GAAI,EAER,CkGwZuC4G,CAAiBhsD,EAAc7d,YAAY5jB,GAAOif,UAGnFA,KAAAA,EACA+B,KAJUssE,EAAJtsE,KAKNI,OALkBksE,EAANlsE,OAMZzV,KANwB2hF,EAAJ3hF,KAOpBk7E,GAP4ByG,EAAFzG,GAQ1BvlE,QAAAA,EACAizC,SAAAA,EACAoB,QAAO,aAIF+3B,GAAiB/4B,EAAwBF,GACxC,IAAAzzC,EAAoC2zC,EAApC3zC,KAAMI,EAA8BuzC,EAA9BvzC,OAAQ/H,EAAsBs7C,EAAtBt7C,SAAUiI,EAAYqzC,EAAZrzC,eAG9BrC,KAAI,GACJ+B,KAAAA,EACAI,OAAAA,EACAzV,KAAM0N,EACNwtE,GAAIxtE,EACJk7C,SAAU/5C,GAAmBnK,MAC7BiR,QAAAA,EACAq0C,QACElB,IAAiBjiC,IAGT5yB,KAAM,cACNyO,iBAAa,OAAA+6E,QAGjB,MAcD,SAAAD,GAAqBwE,EAAqBzE,EAAqB0E,GAChE,IAAAC,EAAUrrE,GAAQmrE,EAAYtrE,EAAaxE,GAC3Ck5D,GAAa58C,GAAQwzD,EAAY5rE,GACjCy4D,EAAkBz4D,EAExB5R,EAAM,uBAAsB,CAAI4mE,UAAAA,EAAWmS,WAAAA,EAAY0E,YAAAA,IAElD9F,IAAoB/Q,GAAc6W,KAIvC7rE,EAAU4rE,EACV/0E,EAAA,GAAA5Y,EAAO6tF,GAEF5E,GAAkBjpF,EAAMqoF,IAG3BP,EAAe/+E,SAAQ,CACrB+kF,QAAO,CACLniF,KAAM,EACNk7E,GAAIiB,EAAejwE,MAAM9S,IAAI7J,OAC7BgE,OAAQuiC,EAAc7d,YAAY5jB,MAKxC+tF,KAEIhX,GAAamS,GACfzO,GAAa14D,EAASy4D,IAkBjB,SAAA8P,GACPjlE,GAEO,OAAAwW,GAAgBxW,GAAa2oE,GAAgBC,SAAS5oE,QAAaxqB,WAO/CqzF,YAAAA,GAAAn7D,EAAAC,IAAAC,2FAC3B9iB,EAAM,oBAIAg+E,KAAW,KAAA,EAAA,IAAA,MAAA,OAAAC,EAAA7/C,OAAA8/C,GAAAA,uCAiBVC,KACH,GAAqBxG,EAArB,CAIE,IAAAyG,EA9ICzG,EAAiBrmD,EAAc1d,cAAc+jE,EAAejwE,MAAM9S,IAAIqf,YAAc,GAgJrF2yD,EAAYwX,IAAmBvuF,KACrCmQ,EAAM,0BAAyB,CAAI4mE,UAAAA,IAC9BA,GAIC,IAAAyD,EAAkBz4D,EACxBnJ,EAAA,GAAA5Y,EAAOuuF,GACPxsE,GAAY/hB,KAAAA,GAEZ+tF,KACAtT,GAAa14D,EAASy4D,GAOtBxyE,KAAOF,KAAK+kF,eA6CCsB,KAAW,OAAAK,GAAAngF,MAAA/K,KAAAA,UAAAkrF,CAAAA,SAAAA,YAAAA,GAAAz7D,EAAAC,IAAAC,0GAGlBjrB,KAAI,KAAA,EAEN8/E,IACIoF,EAAOC,KACbh9E,EAAM,cAAa,CAAI+8E,KAAAA,IAEvBpF,EAAe/+E,SAAQ,CACrB0lF,QAAO,CAAG9F,EAAiB+F,YAAYpC,GAAWW,MAAK,GAAA,CAAOC,KAAAA,0EAK3D,CAAA,SAAAF,GAAa3qE,GACd,IAAAo2D,EAASkW,GAAWlE,GACD,iBAAhBpoE,EAA2B,IAAIusE,OAAOvsE,GAAeA,GAKvD,MAAgB,OAAhBA,GAAwBo2D,GAAW,CAAAA,EAAQoW,aAG3Cd,KACPn1E,EAAA,GAAA86C,EAAUo7B,GAAUhH,EAAejwE,OAAS,GAC5Ce,EAAA,GAAA+6C,EAAUo7B,GAAUjH,EAAejwE,OAAS,GAE5C1H,EAAK,CAAGujD,QAAAA,EAASC,QAAAA,IAlnBnBjtD,IAAS,WACPqB,QAGF6sD,GAAkB,CAChBtuD,QAAAA,GACAI,UAAAA,GACAqf,UAAS,WAAQA,OAAAA,GAAU8hE,EAC3BtmD,EAAAA,SAAQ,kBAASy0C,IAAav3E,SAAS8iC,YAAerb,GAAuB2hE,IAC7E9yB,QAAAA,EACAC,OAAM,WACJjtD,KACAitD,OA+mBE,IAAA23B,GAAmChmC,GACvC2nC,GvGl2BoC,cuGs2B7BvmF,KACP4kF,GAAiC5kF,iBAG1B0yE,GAAa14D,EAAkBy4D,GAClC5nD,GACFA,EAAS7Q,EAASy4D,EAAe,CAC/BriB,cAAeye,KACfvG,YAAa,gBAKVwc,KACPlrD,EAAQjuB,EAAA,CACNvQ,KAAMmX,GAActa,MACjBsmF,EAAYjhE,UAAU2pE,oBAIpB/F,GAAkBjpF,EAAcqoF,GAEhC,QADUroF,GAAOA,EAAK9E,OAASqgB,KAClB8sE,EAGlB,IAAAgB,GAAantE,GAEbotE,GAAoC,cAE/Ba,QACHlB,GAAkBjpF,EAAMqoF,YAItB,IAAAlwB,EAAgBye,KAElB,OAAA1e,GAAoBC,GAGd,CAAAwvB,GAAa+F,GAFgBv1B,EAA7BxD,WAA6BwD,EAAjB1D,gBAKlB2D,GAA0BD,GACrBA,EAAc7D,iBAAiBlmD,IAAIi/E,IAAuBj/E,IAAIu5E,gBAMzD/Q,KACdzmE,EAAM,kBAENpI,KAEM,IAAAowD,EAAgB82B,GACpBxtD,EAAc7d,YAAY5jB,GAC1Bm0D,EACAt2C,EACAu2C,UAGE8D,GAAoBC,SACtBkxB,GAAalxB,EAAc1D,aAAet4C,GvG12Bb,gBuG22B7BmtE,GAAiBnxB,EAAcxD,iBAC/BL,EAAgB,MAEhB17C,EAAA,GAAAywE,GAAantE,IACbtD,EAAA,GAAA0wE,GAAiB,WACjBh1B,GAAmB6D,eAAAA,EAAe7D,mBAAgB,KAGpDnkD,EAAM,gBAECgoD,MAKH82B,GAAuBxY,GAAWpiB,aAE/B66B,KACH5F,IAtdG,SAAuB30B,GAC9BxkD,EAAM,qBAAsBwkD,GAEtB,IAAAw6B,EAAiBzB,GAAiB/4B,GAAY,GAOpD60B,GANoC,MAAvB2F,EAAexjF,KAAewjF,EAAexjF,KAAO,EACjC,MAArBwjF,EAAetI,GAAasI,EAAetI,GAAK,GAO3D1sE,KA2cEi1E,CAAuB9F,QAIrB+F,GAAkB,CACtBp9D,KAAMq9D,GACNtvF,KAAM,UACNoyD,MAAO,mCACP0D,QAASo5B,+5BA3xBRztD,EAAgBre,GAA4B,CAC7CE,yBAAyB,EACzBC,wBAAAA,+BAGC4lE,GAAqB7T,GAAiB,GAAO,oBA6hBvC,SAAuBC,GACzB,GAAA15C,GAAgB05C,GAAhB,KAIClwD,EAAYilE,GAAsB/U,IACpCuS,IAAkBziE,GAAeihE,GAAgBA,EAAYjhE,UAAUkqE,GAAGlqE,KAC5ElV,EAAM,yBAA0BkV,GAGhCyiE,EAAe/+E,SAAQ,CAAGsc,UAAAA,MAtiB3B+6D,CAAuB7K,qBAsmBjB,SAAaphB,GACpBhkD,EAAM,eAAgBgkD,GAEjB2zB,GAILA,EAAe/+E,SAAQ,CACrB0lF,QAASnG,EAAkBoG,YAAYzE,QA7mBxCuF,CAAar7B,oBAinBP,SAAkB9xC,GACrBylE,IACF33E,EAAM,oBAAqBkS,GAE3BylE,EAAe/+E,SAAQ,CACrB0lF,QAAShG,EAAkBiG,YAAY1B,GAAa3qE,OArnBvDotE,CAAkBptE,oBA0nBZ,SAAc4lE,GACjBH,IACF33E,EAAM,gBAAiB83E,GAEvBH,EAAe/+E,SAAQ,CACrB0lF,QAAS/F,EAAmBgG,YAAYrE,GAAYpC,QAAQwC,GAAGxC,OA9nBlEyH,CAAczH,oBAmoBR,SAAez1D,GAClBs1D,IACF33E,EAAM,iBAAkBqiB,GAExBs1D,EAAe/+E,SAAQ,CACrB0lF,QAAO,CAAGjG,EAAoBkG,YAAYrE,GAAY73D,SAASi4D,GAAGj4D,QAvoBrEm9D,CAAen9D,0BAKZo2D,IAAoCrlE,IACtC3K,EAAA,GAAAgwE,EAAkCrlE,GAmjBpCpT,EAAM,kBAAiB,CAAIoT,wBAAAA,IAEvBukE,GACFA,EAAe/+E,SAAQ,CACrB+kF,QAAO,CACLniF,KAAM,EACNk7E,GAAIiB,EAAejwE,MAAM9S,IAAI7J,OAC7BgE,OAAQuiC,EAAc7d,YAAY5jB,mDAoNvC4vF,EACDvG,KAAeltE,IAA2BqW,GAUrC68D,MAPGp9D,KAAMioC,GACNl6D,KAAM,cACNoyD,MAAO,4BACP0D,QAASszB,IAEXiG,4DA7mBI,IAAAQ,MAbNr9D,MAKI,IAAAxQ,EAAOnE,EAAOS,MAAMte,GAE1Bg2E,IAAY,EAEZH,EAAW,CACTv3E,GAAI42E,GACJlzD,KAAAA,EACAojD,SAAQ,GACRtB,QAAM+rB,EAAA98D,EAAAC,IAAAC,2FAAWiE,EAAU44D,EAAV54D,WACf/mB,EAAM,SAAU+mB,GAChBohD,GAAYphD,GAAY,GAAI,KAAA,EAAA,IAAA,MAAA,OAAA64D,EAAAxhD,UAAAyhD,EAAA,kDAE9Bz3E,QAAO,WACLy9D,IAAY,EACZ77D,cAGGqD,GACPspD,EAAQtpD,gBAgDNgV,GAIJuoD,IACE3V,SAAQ,iBAKN0iB,IAEEF,GAAiBA,EAAct0B,cAAc,cAC/C28B,GAAiBnI,GAEjBoI,GAAgBpI,gBAMhBt1D,GAIAs1D,IACFh0B,GAAKg0B,GACL3tE,kBAKEqY,GAIAs1D,IACF/zB,GAAK+zB,GACL3tE,kBAKFvB,EAAA,EAAAyvE,GAAiB,GACjBc,GAAqB7T,GAAiB,GAAM,eAI5CK,EAAat7D,GAAK81E,kBAKlB7B,MAGO,SAA4Bv3B,GACnC5mD,EAAM,0BAA2B4mD,GAEzB,IAAAq5B,EAAa/C,GAAsBt2B,GAAnCprD,EAAIykF,EAAJzkF,KAAMk7E,EAAEuJ,EAAFvJ,GACD,OAATl7E,GAAwB,OAAPk7E,IAOrB2C,GAAa79E,EAAMk7E,GAEnB1sE,6CAxOc,SAAM+c,UACbohD,GAAYphD,GAAY,qBAweJ,OAAAg3D,GAAA7/E,MAAA/K,KAAAA,uEA4Q4CskF,EAAaxtE,OAsE1D,WAAA,OAAAxB,EAAA,EAAAovE,GAAc,EAAK,qDAhGuBH,EAAWztE,QD77BnF0sE,GAAe1oF,MAAQ,SAAC8oF,GAAI,OAAKO,GAAcP,GAAQ,GAAG,4pCEMpD5jB,EA+DAx+B,EA9EOurD,EAA2Bx7E,EAA3Bw7E,mBACA79D,EAAiB3d,EAAjB2d,SACA89D,EAAkBz7E,EAAlB2uD,WAAAA,OAAa,IAAH8sB,GAAQA,EAClB7sB,EAA0B5uD,EAA1B4uD,aACAK,EAAkBjvD,EAAlBivD,OACAC,EAAuBlvD,EAAvBkvD,YACA1I,EAA0CxmD,EAA1CwmD,cACAuI,EAAkB/uD,EAAlB+uD,OACAC,EAAkBhvD,EAAlBgvD,OACAI,EAAkCpvD,EAAlCovD,sBAEFC,IACPtrD,EAAA,EAAA4qD,GAAcA,wcAIf5qD,EAAA,GAAE0qD,EAAgB9wC,EA0DX,CAAA,CAAArvB,KAAM,YAvDNA,KAAM,SACN8uB,KAAMqyC,GACNlS,MAAO,OACP7iC,UAAW,WACXumC,QAASgO,EACT7uD,SAAUud,IAAa69D,IAGvBltF,KAAM,SACN8uB,KAAMsyC,GACNnS,MAAO,6CACP7iC,UAAW,gBACXumC,QAASiO,EACT9uD,SAAUud,IAAa69D,IAGvBltF,KAAM,SACN8uB,KAAMmyC,GACNhS,MAAO,kBACP7iC,UAAW,aACXumC,QAASoO,EACTjvD,UAAWo7E,IAGXltF,KAAM,SACN8uB,KAAMuyC,GACNpS,MAAOt2C,GACPyT,UAAW,kBACXumC,QAASuF,GAGT,CAAAl4D,KAAM,cAGNA,KAAM,SACN8uB,KAAMwyC,GACNrS,MAAO,gBACP7iC,UAAW,WACXumC,QAAS8N,EACT3uD,UAAWwuD,EAAa/P,UAGxBvwD,KAAM,SACN8uB,KAAMyyC,GACNtS,MAAO,sBACP7iC,UAAW,WACXumC,QAAS+N,EACT5uD,UAAWwuD,EAAa9P,SAGxB,CAAAxwD,KAAM,4BAUXyV,EAAA,EAAAksB,EAAQm/B,EAAaX,uVCjChB,QAAAtH,EAAA3hE,KAASwJ,6GAAT,EAAAlJ,GAAAT,GAAA8hE,EAAAA,EAAA3hE,KAASwJ,gMAVT,MAAAm4D,EAAA3hE,KAAS27D,qGAAT,EAAAr7D,GAAAT,GAAA8hE,EAAAA,EAAA3hE,KAAS27D,gIAWmCtsC,EAAA,CAAArvB,KAASwB,OAAjC0X,EAAAlZ,KAASwJ,iGAAe8lB,EAAA3wB,GAAA2wB,EAAArc,GAAAoc,EAAA,CAAAhc,GAAArT,KAASwB,sJAAjC,GAAA,EAAAlB,GAAA4Y,KAAAA,EAAAlZ,KAASwJ,WAAS,+KAAMyJ,GAAAoc,EAAA,CAAAhc,GAAArT,KAASwB,4UAVzDqD,GAMCvB,EAAAisB,EAAAzqB,OADa88D,EAAA3/D,GAAA4/D,EAAA7hE,EAAA,IAAAwG,KAAA,KAAA+oB,EAAAvvB,KAASwB,mCAATqgE,GAAAtiE,GAAAsiE,EAAA3zD,SAAA,EAAA5N,GAAAuhE,EAAA3zD,OAAA1H,KAAA,KAAAxG,KAASwB,2HARtB,MAAA66D,IAAAA,IAAA+B,GAAuBp+D,EAAQ,oEACjB8hE,EAAAtvD,KAASmpD,8bAFvB37D,EAAS,iBAAda,OAAIC,GAAA,0RAACd,EAAS,YAAda,OAAIC,GAAA,EAAA,oHAAJD,OAAIC,EAAAgwB,EAAAjwB,OAAAC,GAAA,mDAAJD,OAAIC,GAAA,2JAnCO8jB,EAAcpK,EAAdoK,KACA5iB,EAAcwY,EAAdxY,MACA4K,EAA0B4N,EAA1B5N,QACA8vB,EAAsBliB,EAAtBkiB,cACA1R,EAA+BxQ,EAA/BwQ,UACA+hB,EAAiDvyB,EAAjDuyB,2BAEFkxC,EAAYphD,EAA+B2gD,UAI3C5wE,EAAQwrB,Q/EiuBH,SAA4ByE,EAAkClV,GAC5E,OAAOkV,EAAWq5D,SAAQ,SAACh5D,GACzB,GAAIK,EAAmBL,GAAY,CACjC,IAAMtY,EAAOG,EAAiBmY,EAAUtY,MACxC,GAAIA,EAAK/jB,OAAS,EAAG,CAInB,IAHA,IAAMs1F,EAA2C,CAACj5D,GAE9CsB,EAAaC,EAAQ7Z,GAClB4Z,EAAW39B,OAAS,IAAM++B,EAASjY,EAAM6W,IAC9C23D,EAAmBC,QAAQ,CACzB/9D,GAAI,MACJzT,KAAMC,EAAmB2Z,GACzBx8B,MAAO,CAAE,IAGXw8B,EAAaC,EAAQD,GAGvB,OAAO23D,CACR,CACF,CAED,OAAOj5D,CACT,GACF,C+EzvB2Bm5D,CAA4Bx5D,EAAYjwB,EAAQwzD,WAAYod,+RAGlFj/D,EAAA,EAAAqwB,GAAahiC,EAAQurB,UAAY+I,GAAiBlW,IAAcuZ,GAAmBvZ,oBAEnFzM,EAAA,EAAAswB,EAAYjiC,EAAQm1D,cAAa,CAClCn9C,KAAAA,EACA5iB,MAAAA,EACAm2B,SAAUvrB,EAAQurB,SAClBuE,cAAAA,EACAkS,UAAAA,EACAprB,OAAQ5W,EAAQ4W,OAChB4jB,cAAex6B,EAAQw6B,cACvBpc,UAAAA,EACA+hB,kBAAAA,EACA3U,QAAS6lD,EACT52C,YAAaz6B,EAAQy6B,YACrBC,SAAU16B,EAAQ06B,SAClBvB,OAAQn5B,EAAQm5B,OAChBwB,eAAgB36B,EAAQ26B,eACxBznB,MAAOlT,EAAQkT,qqCCpBhB4S,GAA+B4jE,QAAvBA,EAACt2F,EAAO,GAAA2jB,UAAU3jB,EAAK,WAAAs2F,IAAAA,EAAAA,EAAK,G1GXA,I0GW2B,wIAL5Ct2F,EAAU,yBACTA,EAAoB,sBACvBA,EAA0B,qBAL9C6E,GASQvB,EAAA2V,EAAAnU,4FADL4tB,GAA+B,UAAtB1yB,EAAO,GAAA2jB,UAAU3jB,EAAK,WAAA,IAAAu2F,EAAAA,EAAK,G1GXA,I0GW2B,KAAA3uF,GAAAwC,EAAAqjC,4BAL5CztC,EAAU,+BACTA,EAAoB,4BACvBA,EAA0B,wEAdjC4kB,EAAcpK,EAAdoK,KACA5iB,EAAcwY,EAAdxY,MACAwhB,EAAkBhJ,EAAlBgJ,OACAgzE,EAAmBh8E,EAAnBg8E,WACAC,EAA6Bj8E,EAA7Bi8E,qBACAC,EAAmCl8E,EAAnCk8E,2BACAC,EAAgCn8E,EAAhCm8E,0UASQ,WAAA,OAAAA,EAAO/xE,y6BC0BV5kB,EAAa,KAAKqgB,GAAc8B,IAAM4+C,GAAc61B,mJADD52F,EAAiB,GAAA,4BAAlF6E,GAEMvB,EAAAkqC,EAAA1oC,4DADQ9E,EAAa,KAAKqgB,GAAc8B,IAAM4+C,GAAc61B,6DADD52F,EAAiB,GAAA,uLAHjF0yB,GAAS1yB,EAAU,G3G9BkB,I2G8BU,GAE7CuX,OAAkB/W,IAAlBR,MAA2BmZ,GAAAnZ,gMALxBA,EAAQ,GAA6DA,EAAU,GAApEA,KAAa,gEAFZA,EAAQ,qBAH9B6E,GAeQvB,EAAA2V,EAAAnU,GARNzB,GAEM4V,EAAAu0B,0DALIxtC,EAAU,6DAIjB0yB,GAAS1yB,EAAU,G3G9BkB,I2G8BU,KAAA4H,GAAA2xB,EAAAs9D,QAE3Br2F,IAAlBR,kIALGA,EAAQ,GAA6DA,EAAU,GAApEA,KAAa,6FAFZA,EAAQ,sIA3BjB4kB,EAAcpK,EAAdoK,KACAqW,EAAiCzgB,EAAjCygB,aACA9C,EAAiB3d,EAAjB2d,SACAsxC,EAA4CjvD,EAA5CivD,oNAGVlrD,EAAA,EAAEu4E,EAAc7kE,EAAQrN,GAAkC,SAA1BwM,GAAkBxM,oBAElDrG,EAAA,EAAEs3C,EACD56B,GAAgB6E,GAAQlb,EAAkB,QAAdmyE,EAAE97D,SAAA87D,IAAYA,OAAZA,EAAAA,EAAcnyE,MAAQqW,EAAa46B,mBAAgBr1D,iBAClF+d,EAAA,EAAEy4E,EAAoBnhC,EAAgB3zC,GAAqB2zC,QAAiBr1D,wBAGvE23B,GAIJsxC,EAAM,CACJ7kD,KAAAA,EACAixC,cAAeA,IAAkBx1C,GAAc8B,IAAM9B,GAAc+B,KAAO/B,GAAc8B,kBC9B1F80E,GACAxqF,0JAaY,SAAA60C,GAAet9C,EAAkBkzF,GAgB/C,OAfKD,KACHxqF,GAAY,IAAI0qF,QAChBF,GAAW,IAAIz3C,gBAAe,SAACwB,GAAWo2C,IACbC,EADaD,EAAAh7D,EACpB4kB,GAAO,IAA3B,IAAAo2C,EAAA/6D,MAAAg7D,EAAAD,EAAAnlF,KAAAqqB,MAA6B,CAAA,IAAlByL,EAAKsvD,EAAAr1F,MACRk1F,EAAWzqF,GAAU7B,IAAIm9B,EAAMzkC,QACjC4zF,GACFA,EAASnvD,EAAMzkC,OAElB,CAAA,CAAA6f,MAAAA,GAAAi0E,EAAAjpF,EAAAgV,EAAA,CAAA,QAAAi0E,EAAAp0F,GACH,CAAA,KAGFyJ,GAAUhF,IAAIzD,EAASkzF,GACvBD,GAASl2C,QAAQ/8C,GAEV,CACL7B,QAAS,WACPsK,GAAS,OAAQzI,GACjBizF,GAASz1C,UAAUx9C,EACpB,EAEL,2tEC2BsB,IAAA89D,EAAAtvD,KAAWA,EAAe,sEATvCxS,EAAY,SAAC,sGAAbA,EAAY,oFAJK,sOAQd,0JAF2B,sHAC0D,gCAAb6E,GAAavB,EAAA3D,EAAAmF,kGAa9EqgE,EAAA/zC,GAAkBpxB,EAAe,KAAA,KACLA,EAAK,IAAA,GAAGs3F,EAAU,IAAVt3F,EAAU,IAAI,QAAU,gFADtEA,EAAM,SAAC,mBAAsC,iCACT,iCAAyC,uJANhF6E,GAOQvB,EAAA2V,EAAAnU,mCADNzB,GAAqF4V,EAAAu0B,wGADpFxtC,EAAM,IAAI,GAAAM,GAAA6kE,KAAAA,EAAA/zC,GAAkBpxB,EAAe,KAAA,KAAA4H,GAAA4xB,EAAA2rC,gBACLnlE,EAAK,IAAA,KAAA4H,GAAAouC,EAAAuhD,GAAG,GAAAj3F,GAAAg3F,KAAAA,EAAU,IAAVt3F,EAAU,IAAI,QAAU,SAAM4H,GAAAwuC,EAAAkhD,oHArB1Et3F,EAAe,GAAAyX,wCAMf,OAAAzX,OAAoBA,EAAQ,GAAAmZ,iCAM5BnZ,EAAgB,iBAArBa,OAAIC,GAAA,qGAdgCd,EAAY,iHA2B/CA,EAAM,SAAC,4bA/Bd6E,GAoCKvB,EAAA85D,EAAAt4D,GAnCHzB,GAAmC+5D,EAAA1lD,WAEnCrU,GA8BK+5D,EAAA9kD,GA7BHjV,GAAwDiV,EAAAT,mBACxDxU,GAYKiV,EAAAH,oGAaL9U,GAEQiV,EAAAW,2BAGV5V,GAAkC+5D,EAAAF,yGA/BMl9D,EAAY,4IAc3CA,EAAgB,YAArBa,OAAIC,GAAA,EAAA,8GAAJD,mBAaCb,EAAM,sGAvDPw3F,EAVO7xF,EAAwB6U,EAAxB7U,KACAgiB,EAAyBnN,EAAzBmN,KACAwQ,EAAiB3d,EAAjB2d,SACA3U,EAAkBhJ,EAAlBgJ,OACAu6D,EAA6CvjE,EAA7CujE,oBACAzC,EAA0B9gE,EAA1B8gE,aACA7f,EAAmBjhD,EAAnBihD,sUAERE,EAASxjC,EAAW,OAAS,yBAG/B5Z,EAAA,EAAEi5E,EAAmB7vE,WxBgdSA,GAA2B,IAAZ8vE,EAAQxuF,UAAApI,eAAAL,IAAAyI,UAAA,GAAAA,UAAA,GAAG,EACnDzH,EAAoB,GAgB1B,OAdA,SAASinB,EAAQzmB,EAAgB4iB,GAC3B6Y,EAAaz7B,IAAU4iB,EAAK/jB,OAAS42F,GACvCv4F,OAAOyC,KAAKK,GAAO1C,SAAQ,SAACiI,GAC1BkhB,EAAQzmB,EAAMuF,GAAMqd,EAAKva,OAAO9C,GAClC,IAGEm2B,EAAY17B,IACdR,EAAM4K,KAAKwY,EAEd,CAED6D,CAAQd,EAAM,IAEPnmB,CACT,CwBjeMk2F,CAAiB/vE,GACdvnB,MAAM,EAAG,IACToL,QAAQ,SAAAoZ,GAAS,OAAAA,EAAK/jB,OAAS,CAAC,uBAEpC0d,EAAA,EAAAo5E,GAAmB1lE,EAAQulE,qBAC3Bj5E,EAAA,EAAAq5E,OAA2Bp3F,IAATmnB,IAAgC,KAAThiB,QAAwBnF,IAATmF,qBAE1D4Y,EAAA,EAAEs5E,EAAeF,EACd,4BACAC,EACE,oBACAn6D,EAAa9V,GACX,YACA+V,EAAY/V,GACV,iBAAgBtd,KAAAA,OACXkZ,GAAUoE,EAAMnE,yBAEtB,SAAWs0E,GACV,OAAAj8D,EAAMlU,EAAMmwE,GAA8Bj3F,cA4B9B,SAAAi3F,GAAA,OAAA/Z,EAAoB+Z,sBAM8Bxc,EAAat7D,GAAK81E,yBA9BxCr6B,syBC3BtCs8B,4HALkCnxF,GAAAqS,EAAA,QAAAm+C,EAAA,uCAAA/sD,OAAArK,EAA+B,GAAA,kBAAAqK,OAAArK,EAC3E,GAAA,MAD4C,2HAHhD6E,GASQvB,EAAA2V,EAAAnU,uFANwC4T,GAAA,EAAApY,GAAA82D,KAAAA,EAAA,uCAAA/sD,OAAArK,EAA+B,GAAAqK,kBAAAA,OAAArK,EAC3E,GAAA,MAD4C,iRARnCwlB,EAAahL,EAAbgL,MACAosD,EAAsBp3D,EAAtBo3D,eACAomB,EAAqBx9E,EAArBw9E,sKASK,OAAAA,o2JC2zDexlF,EAAc,IAAC2vB,WAAa3vB,EAAY,oBAC3BA,EAAuB,IAAC0hE,KAAK1hE,EAAQ,eAC3C,IAAAylF,EAAA9jB,IACvBzrD,OAAOlW,EAAQ,OACO0lF,UAAvB1lF,EAAuB,YAAvB0lF,IAAuBA,OAAvBA,EAAAA,EAAuBlkB,cAEQ,IAAAmkB,EAAcC,QAAdA,EAAA5lF,EAAc,WAAd4lF,IAAcA,GAAdA,EAAc1tD,SAC3Cw5B,GAAqCm0B,QAAZA,EAAA7lF,EAAY,WAAZ6lF,IAAYA,OAAZA,EAAAA,EAAc3tD,SAAU4tD,EAAuB9lF,EAAQ,YAChFhS,8EAcgB,IAAAshE,EAAA,CAAAp5C,OAAOlW,EAAW,OAAAnI,OAAOmI,EAAM,eAC7B,IAAA+lF,EAAA1zE,EAAmBrS,EAAI,qBACzBqpB,EAAMrpB,EAAI,KAAEA,EAAM,eAEhC,IAAA2lF,EAAAj3D,GAAiB1uB,EAAc,IAAAwY,YAC/B6Y,GAAerxB,EAAc,IAAAwY,UAAUpG,KAAMpS,EAAI,qBACK,QAArBgmF,EAAAhmF,EAAqB,YAArBgmF,IAAqBA,OAArBA,EAAAA,EAAuBhtD,QAAQh5B,EAAW,qBACnD2hE,GAAsB3hE,EAAI,KAAEA,EAAwB,mHAhEpD2hE,GAAqB,GAEpB,QAFoBskB,EAE7CjmF,EAAyB,WAAzBimF,IAAyBA,OAAzBA,EAAAA,EAAyBp0F,gJAjD/BrE,EAAa,gBACRA,EAAkB,WACvBA,EAAU,WACVA,EAAU,kBACHA,EAA8B,4yBA6P/C6E,GAGKvB,EAAA6U,EAAArT,0HAhPA9E,EAAkB,IAAA,EA6MbA,YAAuBQ,IAATR,EAAI,KAA2B,KAATA,MAAW,+HApN3C,+IAHd6E,GASOvB,EAAA0uB,EAAAltB,GARLzB,GAOC2uB,EAAAlqB,oEADW9H,EAAW,07BAoNXs7D,QAAAt7D,EAAA,QAGF43B,KAAM6iD,GACN90E,KAAM,kBACNoyD,MAAO,0DACP0D,QAASz7D,EAAA,sNANP,EAAAM,EAAA,KAAAo+D,EAAApD,QAAAt7D,EAAA,QAGF43B,KAAM6iD,GACN90E,KAAM,kBACNoyD,MAAO,0DACP0D,QAASz7D,EAAA,gYA7LHiyB,EAA+B,QAAxBymE,EAAC14F,EAAuB,WAAvB04F,IAAuBA,OAAvBA,EAAAA,EAAyBr0F,wIAhBnCrE,EAAY,YACbA,EAAiB,YACjBA,EAAW,YACXA,EAAiB,mCAyBfA,EAAO,kBAAZa,OAAIC,GAAA,0FAUDd,EAAiB,KAAAmnD,GAAAnnD,GAajBm2B,EAAAhlB,GAAAnR,MAAe+yE,2BAApBlyE,OAAIC,GAAA,sFA6FPd,EAAU,KAAAmoD,GAAAnoD,KA0BVA,EAAc,KAAAooD,GAAApoD,8DAwBuCA,EAA2B,0hBAjJf4G,GAAAguD,EAAA,UAAA+jC,EAAA34F,MAAQa,qDAApDb,EAAc,IAAC4yE,YAAc,wDAyFahsE,GAAAmuD,EAAA,UAAA6jC,EAAA54F,MAAQa,qDAAlDb,EAAc,IAAC8yE,UAAY,iKAnJrDjuE,GAcKvB,EAAAoU,EAAA5S,0BACLD,GAwIKvB,EAAAuU,EAAA/S,GAlIHzB,GAiIOwU,EAAA48C,GAhILpxD,GA+HOoxD,EAAAwH,GA9HL54D,GAiCI44D,EAAAvH,GAhCFrxD,GAYIqxD,EAAAm1B,0GAqBNxmF,GAEI44D,EAAApH,GADFxxD,GAA+EwxD,EAAAD,oEAwFjFvxD,GAEI44D,EAAAjH,GADF3xD,GAA6E2xD,EAAAD,0GAjI/D/0D,EAAoB,oBAC7BA,EAAY,oRAMTiyB,EAA+B4mE,QAAxBA,EAAC74F,EAAuB,eAAA64F,SAAvBA,EAAyBx0F,wKAYlCrE,EAAO,aAAZa,OAAIC,GAAA,EAAA,yGAAJD,OAAIC,EAAAg4F,EAAAj4F,OAAAC,GAAA,eAUDd,EAAiB,6HAWwC0Y,GAAA,KAAApY,EAAA,IAAAq4F,KAAAA,EAAA34F,MAAQa,0DAApDb,EAAc,IAAC4yE,YAAc,6CAE1Cz8C,EAAAhlB,GAAAnR,MAAe+yE,sBAApBlyE,OAAIC,GAAA,EAAA,yGAAJD,OAAIC,EAAAgwB,EAAAjwB,OAAAC,GAAA,cAuFwD4X,GAAA,KAAApY,EAAA,IAAAs4F,KAAAA,EAAA54F,MAAQa,0DAAlDb,EAAc,IAAC8yE,UAAY,MAMhD9yE,EAAU,gIA0BVA,EAAc,0PA9ITa,OAAIC,GAAA,iCAuBND,OAAIC,GAAA,qaA9BKd,EAAe,MAAA+4F,GAAA/4F,oGAAfA,EAAe,iTAEiCxB,uHADnDqG,GAEKvB,EAAAisB,EAAAzqB,8QAOC9E,EAAM,KACEi7B,aAAAj7B,MAAci7B,kCAEpBj7B,EAAc,uIAL1B6E,GAOIvB,EAAAumF,EAAA/kF,kEALM9E,EAAM,MACE,KAAAM,EAAA,KAAA04F,EAAA/9D,aAAAj7B,MAAci7B,8NASrB5pB,MAAMoS,QAAQzjB,EAAI,IAAIA,KAAKa,OAAS,0KAF/CgE,GAMIvB,EAAAumF,EAAA/kF,kEAJOuM,MAAMoS,QAAQzjB,EAAI,IAAIA,KAAKa,OAAS,oRA4BQrC,sSAFlDwB,EAAQ,KAAA,KACJA,EAAe,MAAAgoD,GAAAhoD,kRALtB6E,GAQIvB,EAAAumF,EAAA/kF,6HAJD9E,EAAQ,KAAA,KAAA4H,GAAA2xB,EAAAs9D,GACJ72F,EAAe,mVA4CTgC,WAAUxB,IAAVR,OAAsBA,EAAK,KAAG,iBACtBggC,GACbhgC,EAAK,KACLA,EAAa,IAAC+6B,iBACd/6B,EACA,KAAAA,EAAQ,IAAAwjB,kBAECxjB,EAAU,KAAGA,MAAcgrB,UAAY,uBAC/BhrB,EAAuB,gJARnC,UAAAM,EAAA,KAAA24F,EAAAj3F,WAAUxB,IAAVR,OAAsBA,EAAK,KAAG,qCACtBggC,GACbhgC,EAAK,KACLA,EAAa,IAAC+6B,iBACd/6B,EACA,KAAAA,EAAQ,IAAAwjB,sCAECxjB,EAAU,KAAGA,MAAcgrB,UAAY,2CAC/BhrB,EAAuB,qQAlBnBy2F,sBAAAxkE,EAAQjyB,EAAuB,+CAE9CA,EAAmB,gOAFJ,UAAAM,EAAA,KAAA44F,EAAAzC,sBAAAxkE,EAAQjyB,EAAuB,kPAsBxB,gBAAqBA,EAAe,kIADpE6E,GAEKvB,EAAAisB,EAAAzqB,gPAE4CtG,sSALpC69D,GAAAr8D,MAAYA,EAAU,OAAKukC,GAAmBvkC,MAAcgrB,0EAnCtE,MAAAuzC,IAAAA,IAAA37C,GAAgB5iB,EAAK,sEACU8hE,EAAAtvD,EAAA,KAC9B0xD,GAAyB1xD,EAAsB,KAAEA,EAAO,WACxDhS,WACiC,IAAA+3F,IAAA/lF,EAAA,MACjCtT,OAAOomB,OAAO9S,EAAuB,MAAEioB,MAAM,SAAAgQ,GAC3C,OAAAA,EAAMhQ,MAAM,SAAA5G,GAAS,OAAAA,EAAKjqB,MAAM,GAAA,0DAaJk4D,EAAc,QAAdq3B,EAAA3mF,EAAc,WAAd2mF,IAAcA,GAAdA,EAAczuD,SAC5C4C,GAAuC8rD,QAAfA,EAAC5mF,EAAc,eAAA4mF,SAAdA,EAAc1uD,SAAUl4B,EAAO,WACxDhS,qFAkBIR,EAAe,MAAA06E,GAAA16E,sHA1Cd4G,GAAAkjF,EAAA,YAAAuP,EAAAltE,GAAensB,EAAI,iCACJA,EAAU,uBAHtC6E,GA+CIvB,EAAAwmF,EAAAhlF,iPAPa,UAAAxE,EAAA,KAAA+7D,GAAAr8D,MAAYA,EAAU,OAAKukC,GAAmBvkC,MAAcgrB,kIAIjEhrB,EAAe,8HA1Cd0Y,GAAA,UAAApY,EAAA,IAAA+4F,KAAAA,EAAAltE,GAAensB,EAAI,6EACJA,EAAU,6PA+CtC6E,GAA4BvB,EAAAwmF,EAAAhlF,8DAtExB9E,EAAQ,kBAWPA,EAAO,kBAAZa,OAAIC,GAAA,sFA0DDd,EAAiB,KAAAkoD,oKAtExBrjD,GAyEIvB,EAAAy4D,EAAAj3D,+IAxEI9E,EAAQ,iHAWPA,EAAO,aAAZa,OAAIC,GAAA,EAAA,yGAAJD,OAAIC,EAAAgwB,EAAAjwB,OAAAC,GAAA,YA0DDd,EAAiB,iGA1DpBa,OAAIC,GAAA,iNA2EVmmB,6BAAA5c,OAAAgH,MAAMoS,QAAQzjB,MAAW8nC,UAAY,QAAU,SAAO,sBAIpDlQ,KAAMioC,GACNl6D,KAAM,wBACNoyD,MAAO,mDAKP6D,YAAa57D,EAAA,MAGb2F,KAAM,cACNoyD,MAAO,4CACP0D,QAASz7D,EAAA,mGAhBX,OAAAM,EAAA,KAAAo+D,EAAAz3C,QAAA5c,qBAAAA,OAAAgH,MAAMoS,QAAQzjB,MAAW8nC,UAAY,QAAU,SAAO,gRA0B9CwzB,QAAAt7D,EAAA,QAGF43B,KAAM8nC,GACN/5D,KAAM,KACNoyD,MAAO,+BACP0D,QAASz7D,EAAA,KAGT43B,KAAM6iD,GACN90E,KAAM,0BACNoyD,MAAO,8DACP0D,QAASz7D,EAAA,cAIRA,EAAK,gGAhBJ,EAAAM,EAAA,KAAAo+D,EAAApD,QAAAt7D,EAAA,QAGF43B,KAAM8nC,GACN/5D,KAAM,KACNoyD,MAAO,+BACP0D,QAASz7D,EAAA,KAGT43B,KAAM6iD,GACN90E,KAAM,0BACNoyD,MAAO,8DACP0D,QAASz7D,EAAA,kKA9NpBA,EAAW,IAAAinD,GAAAjnD,gDAeVA,EAAK,MAAA,6JArBUA,EAAW,qBAHlC6E,GAqRKvB,EAAAisB,EAAAzqB,+EAjRW9E,EAAe,oBACjBA,EAAa,wBACTA,EAAiB,6BAG5BA,EAAW,2JANKA,EAAW,4IAr9C5B,IAAAoyE,GAAoB,gCAjIlBt8D,EAAQH,GAAY,wBAClB0I,EAASxR,GAAoB,gBAA7BwR,KACAi7E,EACNzsF,GAAiC,kBAD3BskB,EAAiBmoE,EAAjBnoE,kBAAmBP,EAAkB0oE,EAAlB1oE,mBAErBoqD,EAAOtiB,KACPmiB,EAAcx4D,KACdy4D,EAAmBz4D,KAEnBs4D,EAA0B,oBAAXt4E,OACrByT,EAAM,SAAU6kE,OA0BZvzC,EAMAiwC,EACAuD,EACAlqD,EAqBA/I,EACAhiB,EAtDOwyB,EAAiB3d,EAAjB2d,SACA8iD,EAAwBzgE,EAAxBygE,gBACAC,EAA6C1gE,EAA7C0gE,kBACAC,EAAoB3gE,EAApB2gE,YACAlyD,EAAgCzO,EAAhCyO,wBACAC,EAAgC1O,EAAhC0O,wBACAqwE,EAAuB/+E,EAAvB++E,eACA/1E,EAAkBhJ,EAAlBgJ,OACA63D,EAAoC7gE,EAApC6gE,gBACAvhB,EAA2Bt/C,EAA3Bs/C,UACAC,EAA4Bv/C,EAA5Bu/C,iBACA/xC,EAA4BxN,EAA5BwN,YACAuQ,EAAkB/d,EAAlB+d,SACA+iD,EAA0B9gE,EAA1B8gE,aACAh0C,EAAkB9sB,EAAlB8sB,SACAy6B,EAA4BvnD,EAA5BunD,cACA6H,EAAkCpvD,EAAlCovD,aACA2R,EAAgD/gE,EAAhD+gE,oBACA7gB,EAAgBlgD,EAAhBkgD,QACAC,EAAcngD,EAAdmgD,OACA6gB,GAAwBhhE,EAAxBghE,YACAC,GAAkCjhE,EAAlCihE,iBACAC,GAAoClhE,EAApCkhE,kBAYXnhB,GAAkB,CAChBtuD,QAAAA,GACAI,UAAAA,GACAqf,UAAS,WAAQA,OAAAA,GAAU2rD,EAAa,EACxCnwC,SAAQ,kBAASy0C,IAAav3E,SAAS8iC,YAAerb,GAAuBwrD,EAC7E3c,EAAAA,QAAO,YACM,EACPA,GACFA,KAGJC,OAAM,YACO,EACPA,GACFA,OAOF,IAEA9yB,GAEAgD,GAJAyvB,QAAqC95D,EAKrC2oE,IAAa,EACb4E,IAAc,EAoBcyrB,SAAAA,YAAAA,GAAA9gE,EAAAC,IAAAC,MAAjB,SAAA6gE,EAAkB70E,GAAc,OAAA+T,IAAApf,MAAA,SAAAmgF,GAAAA,cAAAA,EAAAvgE,KAAAugE,EAAAnuF,MAAA,KAAA,EAKvC,YAJNsvB,GAAaxhB,EAAAA,EACRwhB,CAAAA,EAAAA,IACH7P,CAAAA,EAAAA,CAAAA,UAAW,eAEP,EAAA7L,GAASyF,GAAI80E,KAAAA,EAAAA,IAAAA,MAAAA,OAAAA,EAAAxlD,OAAA,GAAAulD,EAAA,4BAYjB,IAMAzD,GANApkB,GAAiB,IACjBpmC,GAAO,GAWPmwC,IAAY,EAIZge,GAAgB,CAAA,EAEhBznB,GAAiB,IACjBt4B,GAAY,EAqCP,SAAAnS,GACPzc,GAKAlV,EAAM,kBAAmBkV,OAEnBy3C,EACiB,mBAAdz3C,EAA2BA,EAAU6P,GAAc7P,YAAc,KAAOA,EAE5E8U,GAAQ2iC,EAAkB5nC,GAAc7P,kBAC3C6P,GAAaxhB,EAAAA,EACRwhB,CAAAA,EAAAA,QACH7P,UAAWy3C,KAGbn7B,EAASm7B,IAIJ,SAAAua,GAA8Br1D,GAChCkT,GAAc7P,gBAAsBxqB,IAATmnB,IAK9BiY,EAASjY,EAAM+Z,GAAc7G,GAAc7P,aAC3C4U,EAASjY,EAAMga,GAAa9G,GAAc7P,cAK5ClV,EAAM,kDAAmD+kB,GAAc7P,gBACvE6P,GAAaxhB,EAAAA,KACRwhB,IAAa,CAAA,EAAA,CAChB7P,UAAW,UAIX,IAAA6P,GAAgBD,KAChBshD,IAAiB,EAsBf,IAOFtvE,GAPEqvE,GAAU9iB,GAAa,CAC3B5gC,SAAW,SAAA/a,GACTe,EAAA,GAAA6qD,GAAe5rD,MAGf4rD,GAAe6S,GAAQ1iB,WAmBlB,SAAAijB,GAAqB90D,GACtB,IAAAkyE,EAAmBjyE,EACnB+0D,EAAY70D,GAAcH,GAC5BA,EAAQ/hB,OAASA,GAChBm6B,GAAQ85D,EAAqBlyE,EAAQC,SAE1C7R,EAAM,0BAAyB,CAAI4mE,UAAAA,IAE9BA,GAKC,IAAAG,EAAel1D,EACfi1D,EAAgB/hD,GAChBozC,EAAetoE,EACfm3E,EAAyBZ,GAE3B,GAAAr0D,GAAcH,OAEdnJ,EAAA,EAAAoJ,EAAO0zD,EAAgB3zD,EAAQ/hB,YAC/BA,EAAO+hB,EAAQ/hB,MACf4Y,EAAA,GAAA29D,IAAiB,GACjB39D,EAAA,GAAA+7C,QAAa95D,SACN2iB,OAEL5E,EAAA,EAAAoJ,EAAO0zD,EAAgBv1D,EAAW4B,EAAQ/hB,aAC1CA,EAAO+hB,EAAQ/hB,MACf4Y,EAAA,GAAA29D,IAAiB,GACjB39D,EAAA,GAAA+7C,QAAa95D,SACN28E,GAEP5+D,EAAA,EAAAoJ,OAAOnnB,QACPmF,EAAO+hB,EAAQ/hB,MACf4Y,EAAA,GAAA29D,IAAiB,QACjB5hB,GACW,KAAT30D,EACI2gB,GAAwB3gB,EAAOwd,EAAc8D,SAAWyB,OAAOvF,SAC/D3iB,aAIVmnB,EAAOD,EAAQC,MACfpJ,EAAA,GAAA5Y,OAAOnF,GACP+d,EAAA,GAAA29D,IAAiB,GACjB39D,EAAA,GAAA+7C,QAAa95D,GAIfw8E,GAA8Br1D,GAhJ1BkT,GAAcI,cAChB1c,EAAA,GAAAsc,GAAaxhB,EAAAA,EAAA,CAAA,EACRwhB,IAAa,CAAA,EAAA,CAChBI,aAAc,QAkJlBgiD,GAAc,CACZJ,aAAAA,EACAD,cAAAA,EACA3O,aAAAA,EACA6O,uBAAAA,KAeK,SAAAG,GAAc4c,GAIC,IAHtBhd,EAAYgd,EAAZhd,aACAD,EAAaid,EAAbjd,cACA3O,EAAY4rB,EAAZ5rB,aACA6O,EAAsB+c,EAAtB/c,4BAOqBt8E,IAAjBq8E,QAA+Cr8E,IAAjBytE,SAKrBztE,IAATmnB,OACmBnnB,IAAjBq8E,EAEFZ,GAAQ3tE,IAAG,CACTmrD,KAAI,CACF8jB,MAAK,EAAKllD,GAAI,UAAWzT,KAAM,GAAI5iB,MAAO66E,IAC1Cr/D,MAAOsmB,GAA4B84C,GACnCj1D,UAAMnnB,EACNmF,KAAMsoE,EACNiO,eAAgBY,GAElBpjB,KAAI,CACF6jB,MAAK,CAAA,CAAKllD,GAAI,UAAWzT,KAAM,GAAI5iB,MAAO2lB,IAC1CnK,MAAOsmB,GAA4BjJ,IACnClT,UAAMnnB,EACNmF,KAAAA,EACAu2E,eAAAA,MAIJD,GAAQ3tE,IAAG,CACTmrD,KAAI,CACF8jB,WAAO/8E,EACPmnB,UAAMnnB,EACNmF,KAAMsoE,EACNzwD,MAAOsmB,GAA4B84C,GACnCV,eAAgBY,GAElBpjB,KAAI,CACF6jB,WAAO/8E,EACPmnB,KAAAA,EACAnK,MAAOsmB,GAA4BjJ,IACnCl1B,KAAAA,EACAu2E,eAAAA,WAKe17E,IAAjBq8E,GACFZ,GAAQ3tE,IAAG,CACTmrD,KAAI,CACF8jB,WAAO/8E,EACPmnB,KAAMk1D,EACNr/D,MAAOsmB,GAA4B84C,GACnCj3E,KAAMsoE,EACNiO,eAAgBY,GAElBpjB,KAAI,CACF6jB,WAAO/8E,EACPmnB,UAAMnnB,EACNmF,KAAAA,EACAu2E,eAAAA,GACA1+D,MAAOsmB,GAA4BjJ,YASzCo/B,GAAgB,GAMdkiB,GAAmBC,GAAWviB,IAE3B,SAAAwiB,GACP10D,EACAmyC,EACAt2C,EACAu2C,GAEAJ,mBAEQ2iB,MAEFA,EAAsBH,GAAiBx0D,EAAMmyC,EAAWt2C,EAAQu2C,SACzD52C,GACPm5D,EAAmB,EAEf13D,KAAI,GACJqC,QAAS,uBAA0B9D,EAAc8D,QACjDizC,SAAU/5C,GAAmBs8C,UAK9B38B,GAAQw8C,EAAqBriB,MAChCnkD,EAAM,4BAA6BwmE,GACnC/9D,EAAA,GAAA07C,GAAmBqiB,OAGtB,SAAAxyE,GAAQ,OAAKgM,EAAKzL,+BAAAA,OAAgCP,SAAQ,aAI/CyyE,YACdzmE,EAAM,YAEFwkD,IAEAA,WAAAA,GACAF,cAAc,IAMlBiiB,GAAuB10D,EAAMmyC,EAAWt2C,EAAQu2C,GACxC9nC,EAAQgoC,IAA2C,KAArB,CAAAA,iBAAAA,cAGxBsjB,GACd1gD,EACA2gD,GAII,GAFJ1nE,EAAM,QAAS+mB,EAAY2gD,QAEdh9E,IAATmnB,EACQ,MAAA,IAAA3b,MAAM,+BAGZ,IAAA6wE,EAAel1D,EACfi1D,EAAgB/hD,GAChBiiD,EAAyBZ,GAGzBziB,EAA0B7vB,GAC9BjiB,EACAkV,GAOI6K,EALU9K,GAAmBjV,EAAMkT,GAAegC,GAK5BlV,KACtB+1D,EAAuBtJ,GAC3Bv5C,GACAgC,EACA2O,IAGIn9B,EACkB,mBAAfmvE,EAA4BA,EAAW91C,EAAag2C,QAAwBl9E,EAErF+d,EAAA,EAAAoJ,EAAOtZ,QAA8B7N,IAAlB6N,EAASsZ,KAAqBtZ,EAASsZ,KAAO+f,GAC3D,IAAAk2C,EACJvvE,QAA+B7N,IAAnB6N,EAASmP,MAAsBnP,EAASmP,MAAQkgE,SAC9Dn/D,EAAA,GAAAsc,GAAgB+iD,GAChBr/D,EAAA,GAAA5Y,OAAOnF,GACP+d,EAAA,GAAA29D,IAAiB,GACjB39D,EAAA,GAAAspB,QAAarnC,GACb+d,EAAA,GAAA+7C,QAAa95D,GAEby7E,GAAQ3tE,IAAG,CACTmrD,KAAI,CACF8jB,MAAO9jB,EACP9xC,UAAMnnB,EACNmF,UAAMnF,EACNgd,MAAOsmB,GAA4B84C,GACnCV,eAAgBY,GAElBpjB,KAAI,CACF6jB,MAAO1gD,EACPlV,UAAMnnB,EACNgd,MAAOsmB,GAA4B85C,GACnCj4E,UAAMnF,EACN07E,eAAAA,OAKFv0D,KAAAA,EACAk1D,aAAAA,EACApjB,KAAAA,EACAC,KAAM78B,YAIDohD,GACPphD,EACA2gD,GAEA1nE,EAAM,cAAe+mB,EAAY2gD,OAE3B2C,EAAe,CAAKx4D,KAAAA,EAAMhiB,KAAAA,GAC1BqwE,EAAcuH,GAAM1gD,EAAY2gD,UAEtC4C,GAAaD,EAAiBnK,GAEvBA,WAGAoK,GAAaD,EAA0BnK,YAGjBx1E,IAAzB2/E,EAAgBx4D,WAAgDnnB,KAA1B2/E,eAAAA,EAAiBx6E,QAOvD4yB,EACE,QAAS/3B,IAATmF,EAEF4yB,EADkB,CAAA5yB,KAAAA,EAAMgiB,UAAMnnB,GACZ2/E,GAChBriB,cAAeye,KACfvG,YAAAA,SAEOruD,QAASnnB,IAATmnB,EAAkB,CAE3B4Q,EADkB,CAAA5yB,UAAMnF,EAAWmnB,KAAAA,GACjBw4D,GAChBriB,cAAeye,KACfvG,YAAAA,KAMC,SAAA8jB,GAAWhY,GAClBhsE,EAAM,aAAcgsE,GAKb,SAAAG,GAAgBC,GACvBpsE,EAAM,sBAAuBosE,GAE7B3jE,EAAA,GAAAspB,GAAaq6C,GAGN,SAAA36C,GAAe3iB,GAChB,IAAApR,EAAQ+O,SAASqC,EAAK,GAAI,IAC1BqiE,EAAQ,CAAIv+D,OAAOlV,EAAQ,IAACnJ,OAAA4J,EAAM2Q,EAAKxkB,MAAM,YAE5Cw/B,EAASjY,EAAMs/D,GAClBlkD,GAAqBkkD,GAAU,GAC/BlkD,GAAqBne,GAAM,YAGjB9E,KACdhK,EAAM,SAIF4a,IACFA,EAAe5Q,QACf4Q,EAAetoB,mBA0CV2xF,KACFl/D,GAAc7P,WACjByc,IAZE/J,EAAY/V,IAAUsK,EAAQtK,IAAUsK,EAAQuZ,SAI3CzI,GAFO,CAAA,KAAG14B,OAAA4J,EAAKu3B,GAAQ,MAEI,IAgDtB,SAAArsB,GAASyF,GAAgB,IAAAo8D,IAAmB/3E,UAAApI,OAAA,QAAAL,IAAAyI,UAAAzI,KAAAyI,aACpD+wF,EAAkB7wB,GAAalnD,GAAoB,EACnD/C,EAAM8zD,GAA0BpuD,EAAM4mB,GAASmuD,GAAkBvnB,IACjE6nB,EAAgB/6E,EAAM06B,GAAYogD,EAAkB5nB,GACpD6O,EAAOta,GAAY/hD,MAEzB9O,EAAM,WAAc,CAAA8O,KAAAA,EAAM1F,IAAAA,EAAK06B,UAAAA,GAAWqnC,KAAAA,KAErCrG,EACI,OAAAvtE,QAAQC,cAGX4zE,EAAetG,EAAYztD,wBAC7B,GAAA8zD,IAASD,EAAmB,KACxBG,EAAWF,EAAK9zD,wBAClB,GAAAg0D,EAAS9wD,OAAS6wD,EAAahiE,KAAOiiE,EAASjiE,IAAMgiE,EAAa7wD,OAE7D,OAAAhjB,QAAQC,UAIb,IAAAmY,GAAU9kB,KAAKC,IAAIo5F,EAAkB,GAAuB9Y,EAAaxiE,OAAS,UAG3E,IAAArR,QADT4zE,EACkB,SAAA3zE,GAClB0tE,EAAKiG,EAAI,CACP11D,UAAWqvD,EACXn1D,OAAAA,EACA3b,S/Gt1BqB,I+Gu1BrBuE,SAAQ,WAEN6rF,GAAmBt1E,GACnBtX,QAKc,SAAAA,GAKR6sF,IAAAA,EAJVnf,EAAKif,EAAa,CAChB1uE,UAAWqvD,EACXn1D,OAAAA,EACA3b,S/Gn2BqB,I+Go2BrBuE,UAAQ8rF,EAAAzhE,EAAAC,IAAAC,MAAA,SAAAwhE,IAAAzhE,OAAAA,IAAApf,MAAA,SAAA8gF,iBAAAA,EAAAlhE,KAAAkhE,EAAA9uF,MAAA8uF,KAAAA,EAAA,OAAAA,EAAA9uF,KAAA,EAEAoC,YAGNusF,GAAmBt1E,GACnBtX,IAAO,KAAA+sF,EAAAA,IAAAA,MAAAA,OAAAA,EAAAnmD,UAAAkmD,EAAA,qDAgCR,SAAAF,GAAmBt1E,OACpBq8D,EAAOta,GAAY/hD,GACpB,GAAAq8D,GAASrG,EAAT,KAICsG,EAAetG,EAAYztD,wBAC3Bg0D,EAAWF,EAAK9zD,wBAElB,GAAAg0D,EAASrzD,MAAQozD,EAAapzD,MAAK,CAC/B,IAAAu4D,EAAOlF,EAASrzD,MAAQozD,EAAapzD,WAC3C8sD,EAAYjhC,YAAc0sC,EAAIzL,GAG5B,GAAAuG,EAAS/hE,KAAO8hE,EAAa9hE,KAAI,CAC7B,IAAAinE,EAAOnF,EAAa9hE,KAAO+hE,EAAS/hE,UAC1Cw7D,EAAYjhC,YAAc0sC,EAAIzL,KAIzB,SAAA3pB,GAAersC,IA7Cf,SAAiBA,MACnBg2D,GAIG,IAAA3H,EAAaC,GAAoBtuD,EAAM4mB,IAAvCynC,SACF/zD,EAAM8zD,GAA0BpuD,EAAM4mB,GAASmuD,GAAkBvnB,IACjE/hD,EAASnR,GAAOy6E,GAAiB1mB,IAAab,IAG9C8O,EAAetG,EAAYztD,wBAC3BslD,EAAc74B,GACd84B,EAAiB94B,GAAYsnC,EAAaxiE,OAH3B0zD,GAKjB,GAAA/hD,EAASqiD,EAAc,KACnB2T,EAAOh2D,EAASqiD,OACtBkI,EAAYhhC,WAAaysC,EAAIzL,GAG3B,GAAA17D,EAAMuzD,EAAW,KACb4T,EAAO5T,EAAcvzD,OAC3B07D,EAAYhhC,WAAaysC,EAAIzL,KAyB/B0f,CAAiB11E,GACjBs1E,GAAmBt1E,GAOL,SAAA+hD,GAAY/hD,GACpB,IAAAmC,EAASykB,GAAQ8iB,MAAM,SAAAvrD,GAAC,OAAK8gC,GAAejf,EAAKxkB,MAAM,GAAI2C,EAAC,IAE5Dw3F,EAAexzE,EAASnC,EAAKxkB,MAAM,EAAG,GAAGiK,OAAO0c,GAAUnC,EAEzD,OAAAg2D,EACHA,EAAY3hB,cAAa5uD,iBAAAA,OAAkB8hB,GAAeouE,GAAY,OACtE,KAGG,SAAApY,GAAeqY,GACtB,IAAA11F,EAAM01F,EAAN11F,OACAsa,EAAIo7E,EAAJp7E,KACAF,EAAGs7E,EAAHt7E,IACAV,EAAKg8E,EAALh8E,MACAE,EAAM87E,EAAN97E,OACAuR,EAASuqE,EAATvqE,UACAE,EAAUqqE,EAAVrqE,WACA+wC,EAAOs5B,EAAPt5B,QAEM+H,EC56Be,SAAAwxB,GACvB,IAAA9yE,EAAI8yE,EAAJ9yE,KACAkT,EAAa4/D,EAAb5/D,cACA1C,EAAQsiE,EAARtiE,SACA3U,EAAMi3E,EAANj3E,OACA++D,EAAWkY,EAAXlY,YACAmY,EAASD,EAATC,UACAlY,EAAqBiY,EAArBjY,sBACA/N,EAAKgmB,EAALhmB,MACA9K,EAAM8wB,EAAN9wB,OACA1jC,EAAOw0D,EAAPx0D,QACA2vC,EAAQ6kB,EAAR7kB,SACAM,EAAcukB,EAAdvkB,eACAI,EAAiBmkB,EAAjBnkB,kBACAE,EAAgBikB,EAAhBjkB,iBACAK,EAAW4jB,EAAX5jB,YAkBM7rD,EAAY6P,EAAc7P,UAE1B8+C,OAAmBtpE,IAATmnB,EACVm7D,IAAiB93D,EACjBg4D,OACKxiF,IAATmnB,GAAsBqD,EAAY6Q,EAAMlU,EAAMga,GAAa3W,SAAcxqB,EAErEgkC,EACJslC,IACC3oC,GAAiBnW,IAAciW,GAAejW,IAAckW,GAAiBlW,IAE1Em4D,GAAgBhrD,GAAY2xC,GAAwB,MAAb9+C,GAAqB2Y,GAAmB3Y,GAC/Eo4D,EAAmBD,IAAiBvgE,GAAgBogE,GAEpDK,GAAUlrD,GAAYqM,EAEtB9H,EACS,MAAb1R,QAAoCxqB,IAAfwiF,GACjBhjD,GACEgjD,EACAnoD,EAAcE,iBACdlW,EAAmB8c,GAAa3W,IAChCxH,GAIR,MAAO,CACL,CAAE1a,KAAM,aACR,CACEA,KAAM,MACN2hC,MAAO,CACL,CACE3hC,KAAM,SACN2hC,MAAO,CACL,CAAE3hC,KAAM,QAASnD,KAAM,eACvB,CACEmD,KAAM,kBACN0wE,KAAM,CACJ1wE,KAAM,SACN2yD,QAAS,WAAA,OAAM8mB,GACf3qD,EAAAA,KAAMqsD,GACNt+E,KAAM,OACNoyD,MAAO,6CACPn9C,UAAWuoE,GAEb3kE,MAAO,OACPisB,MAAO,CACL,CACE3hC,KAAM,SACN8uB,KAAMqsD,GACNt+E,KAAM,OACNoyD,MAAO,6CACP0D,QAAS,WAAM,OAAA8mB,GAAa,EAC5B3nE,UAAWuoE,GAEb,CACEr6E,KAAM,SACN8uB,KAAM8E,EAAgB3E,GAAgBC,GACtCryB,KAAM,iBACNoyD,MAAO,uEACP0D,QAAS,WAAA,OAAM+mB,GACf5nE,EAAAA,UAAWwoE,KAIjB,CACEt6E,KAAM,kBACN0wE,KAAM,CACJ1wE,KAAM,SACN2yD,QAAS,WAAA,OAAMgZ,GAAM,EAAK,EAC1B78C,KAAMssD,GACNv+E,KAAM,MACNoyD,MAAO,6DACPn9C,UAAWyoE,GAEb7kE,MAAO,OACPisB,MAAO,CACL,CACE3hC,KAAM,SACN8uB,KAAMssD,GACNv+E,KAAM,gBACNoyD,MAAO,6DACP0D,QAAS,WAAM,OAAAgZ,GAAM,EACrB75D,EAAAA,SAAUud,IAAaqM,GAEzB,CACE17B,KAAM,SACN8uB,KAAMssD,GACNv+E,KAAM,gBACNoyD,MAAO,4DACP0D,QAAS,WAAM,OAAAgZ,GAAM,EACrB75D,EAAAA,SAAUud,IAAaqM,KAI7B,CACE17B,KAAM,kBACN0wE,KAAM,CACJ1wE,KAAM,SACN2yD,QAAS,WAAA,OAAMkO,GAAO,EAAK,EAC3B/xC,KAAMoyC,GACNrkE,KAAM,OACNoyD,MAAO,8DACPn9C,UAAW4pB,GAEbhmB,MAAO,OACPisB,MAAO,CACL,CACE3hC,KAAM,SACN8uB,KAAMoyC,GACNrkE,KAAM,iBACNoyD,MAAO,8DACP0D,QAAS,WAAM,OAAAkO,GAAO,EACtB/uD,EAAAA,UAAW4pB,GAEb,CACE17B,KAAM,SACN8uB,KAAMoyC,GACNrkE,KAAM,iBACNoyD,MAAO,6DACP0D,QAAS,WAAM,OAAAkO,GAAO,EACtB/uD,EAAAA,UAAW4pB,KAIjB,CACE17B,KAAM,SACN2yD,QAAS,kBAAMx1B,GACfrO,EAAAA,KAAMusD,GACNx+E,KAAM,QACNoyD,MAAO,oCACPn9C,SAAUud,IAAa2qD,GAEzB,CACEh6E,KAAM,SACN2yD,QAAS,WAAM,OAAAma,GAAU,EACzBh+C,KAAM0sD,GACN3+E,KAAM,SACNoyD,MAAO,oCACPn9C,SAAUud,IAAaqM,KAI7B,CACE17B,KAAM,SACN2hC,MAAO,CACL,CAAE3hC,KAAM,QAASnD,KAAM,cACvB,CACEmD,KAAM,SACN2yD,QAAS,WAAA,OAAMi/B,GACf9iE,EAAAA,KAAMqsD,GACNt+E,KAAM,WACNoyD,MAAO,uBACPn9C,SAAUud,IAAa2qD,IAAiBhZ,GAE1C,CACEhhE,KAAM,SACN2yD,QAAS,WAAA,OAAMya,GACft+C,EAAAA,KAAMwsD,GACNz+E,KAAM,gBACNoyD,MAAO,4BACPn9C,SAAUud,IAAa2qD,IAAiBhZ,GAE1C,CACEhhE,KAAM,SACN2yD,QAAS,WAAA,OAAM6a,GAAmB,EAClC1+C,KAAM4sD,GACN7+E,KAAM,gBACNoyD,MAAO,sCACPn9C,SAAUud,IAAa2qD,IAAiBhZ,GAE1C,CACEhhE,KAAM,SACN2yD,QAAS,WAAA,OAAM+a,GACf5+C,EAAAA,KAAM4sD,GACN7+E,KAAM,eACNoyD,MAAO,qCACPn9C,SAAUud,IAAa2qD,IAAiBhZ,GAE1C,CACEhhE,KAAM,SACN2yD,QAAS,WAAA,OAAMob,GACfj/C,EAAAA,KAAM0sD,GACN3+E,KAAM,aACNoyD,MAAO,qBACPn9C,SAAUud,IAAa2qD,IAAiBhZ,OAOtD,CD2sB4C6wB,CAA2B,CACjEhzE,KAAAA,EACAkT,cAAAA,GACA1C,SAAAA,EACA3U,OAAAA,EAEA++D,YAAazE,GACb4c,UAAWE,GACXpY,sBAAuBxE,GAEvBvJ,MAAOyJ,GACPvU,OAAQ4U,GACRt4C,QAAS04C,GAET/I,SAAUkJ,GACV5I,eAAgB2kB,GAChBvkB,kBAAmBwkB,GACnBtkB,iBAAkBukB,GAClBlkB,YAAamkB,KAGTvwD,EAAQ8wC,EAAoBtS,GAE9B,IAAU,IAAVx+B,EAAA,KAeEtkC,EAAO,CACXiZ,KAAAA,EACAF,IAAAA,EACA+Q,UAAAA,EACAE,WAAAA,EACA3R,MAAAA,EACAE,OAAAA,EACA5Z,OAAAA,EACA8W,mBAAmB,EACnBsC,QAAO,WACLy9D,IAAY,EACZ77D,OAIJ67D,IAAY,EAEN,IAAA3qD,EAAUG,EAAkByzD,GA5BvB,CACT9K,IAAK5Y,EACD,0EACA1gE,EACJiqC,MAAAA,EACAquC,eAAc,WACZloD,EAAmBI,GACnBlR,OAqBkD3Z,IAG/C,SAAAw5E,GAAkB15E,OACrBs+B,GAAmB1J,GAAc7P,eAIjC/kB,IACFA,EAAMU,kBACNV,EAAMM,kBAGJN,GAAwB,gBAAfA,EAAM6C,MAA0B7C,EAAM3C,SAAWotB,EAE5DyxD,GAAe,CACb/iE,KAAOnZ,EAAqB4+E,QAC5B3lE,IAAMjZ,EAAqB8gE,QAC3BvoD,MAAOwD,GACPtD,OAAQqD,GACRm/C,SAAS,eAKLp8D,EAAoB,QAAdm2F,EAAGrgB,SAAW,IAAAqgB,OAAA,EAAXA,EAAahiC,cAAc,yCACtCn0D,EACFq9E,GAAe,CACbr9E,OAAAA,EACAmrB,UAAW,EACXzR,MAAOwD,GACPtD,OAAQqD,GACRm/C,SAAS,eAILh0C,EAAkBguE,QAAdA,EAAGtgB,SAAAsgB,IAAWA,OAAXA,EAAAA,EAAa/tE,wBACtBD,GACFi1D,GAAe,CACbjjE,IAAKgO,EAAKhO,IAAM,EAChBE,KAAM8N,EAAK9N,KAAO,EAClBZ,MAAOwD,GACPtD,OAAQqD,GACRm/C,SAAS,YAMV,YAaA4c,SACH3lD,GAAa0C,GAAc7P,WAIzB,IAAApG,EAAO+c,GAAa9G,GAAc7P,WAEpCpI,GADUiZ,EAAMlU,EAAM/C,IAExBm5D,GAAoBn5D,GAEpB6iB,GAAgB1E,GAAqBne,GAAM,cAItCg2E,MACHziE,GAAa0C,GAAc7P,WAM/B+yD,GAFap8C,GAAa9G,GAAc7P,WACnB5qB,MAAM,EAAG,aAIvB49E,KACH,IAAA7lD,GAAa+I,GAAiBrG,GAAc7P,WAA5C,CAIE,IAAApG,EAAOiW,GAAc7P,UAAUpG,KAC/ByW,EAAUxW,EAAmBD,GAC7B5iB,EAAQ65B,EAAMlU,EAAM/C,GACpB8X,GAAiBsD,GAAiBh+B,EAAO64B,GAAcE,iBAAkBM,EAAS7X,GAClFqc,EAAenD,EAAgBhU,OAAO1mB,GAAS8hB,GAAc4E,OAAO1mB,GAAQwhB,GAElF1N,EAAM,4BAA2B,CAAI4mB,cAAAA,EAAe16B,MAAAA,EAAO69B,aAAAA,IAE3Do+C,KAGM5lD,GAAI,UACJzT,KAAMyW,EACNr5B,MAAO69B,KAGV,SAAAnL,EAAGiT,UAEAnqB,MAAOif,GAAiBkL,EAActM,EAASqB,QAMnB,SAAAy+D,YAAAA,GAAAziE,EAAAC,IAAAC,kGACG,GAArC9iB,EAAM,oBAAqB+xB,IACtBA,GAAUuzD,CAAAA,EAAA7vF,oBAAA6vF,EAAAnnD,OAAA,UAAA,KAAA,EAIPrvB,GAJOy2E,EAIYxzD,IAAnBjjB,KAAMkjB,EAAQuzD,EAARvzD,SAIV1Z,GADE+2D,GAA4B,QAAXmW,EAAA1gB,SAAW,IAAA0gB,OAAA,EAAXA,EAAariC,cAAc,uBAAwB,OAExEksB,EAAe72D,SAYjB2vD,GARgB,EAEZ5lD,GAAI,UACJzT,KAAMC,EAAmBD,GACzB5iB,MAAO8lC,KAOXqZ,WAAWrhC,IAAK,wBAAAs7E,EAAAlnD,OAAA,GAAAqnD,uCAGT5c,KACPtgE,EACEugE,UAGKx9D,CAAAA,EAAAA,IACHnF,CAAAA,EAAAA,CAAAA,YAAW,CACTuC,MAAO,WAIT,CAAAN,mBAAe,OAAA4B,IAAK,aAeXo+D,GAASsd,GAAA,OAAAC,GAAAznF,MAAA/K,KAAAA,oBAAAwyF,YAAAA,GAAA/iE,EAAAC,IAAAC,MAAT,SAAA8iE,EAAUtd,UAAezlD,IAAApf,MAAA,SAAAoiF,GAAA,cAAAA,EAAAxiE,KAAAwiE,EAAApwF,aAAA,OAAAowF,EAAApwF,KAAA,EAChCkpE,GAAK,CACT9sD,KAAAA,EACAkT,cAAAA,GACA7S,YAAao2D,EAASp2D,OAAcxnB,EACpC23B,SAAAA,EACA3U,OAAAA,EACA4U,QAAS6lD,sEAIE,CAAA,SAAAM,KAAUqd,OAAAA,GAAA5nF,MAAAvN,KAAAwC,UAAA,CAAA,SAAA2yF,YAAAA,GAAAljE,EAAAC,IAAAC,sGACnBjR,GADoBy2D,IAAMyd,EAAAh7F,eAAAL,IAAAq7F,EAAA,KAAAA,EAAG,QACpBr7F,IAATmnB,EAAkB,CAAAm0E,EAAAvwF,KAAAuwF,EAAAA,KAAAA,CAAAA,OAAAA,EAAA7nD,wBAAA,OAAA6nD,EAAAvwF,KAAA,EAIhBo+D,GAAM,CACVhiD,KAAAA,EACAkT,cAAAA,GACA7S,YAAao2D,EAASp2D,OAAcxnB,EACpCgjB,OAAAA,iFAIKs7D,KACPlJ,GAAQ,CACNjuD,KAAAA,EACAhiB,KAAAA,EACAk1B,cAAAA,GACAi7C,eAAe,EACf39C,SAAAA,EACAI,SAAAA,EACAH,QAAS6lD,cAIJ4c,KACP3kB,GAAc,CAAGvuD,KAAAA,EAAMkT,cAAAA,GAAe2Q,QAAAA,GAASrT,SAAAA,EAAUC,QAAS6lD,cAG3D6c,KACPxkB,GAAiB,CAAG3uD,KAAAA,EAAMkT,cAAAA,GAAe2Q,QAAAA,GAASrT,SAAAA,EAAUC,QAAS6lD,cAG9D8c,KACPvkB,GAAgB,CAAG7uD,KAAAA,EAAMkT,cAAAA,GAAe2Q,QAAAA,GAASrT,SAAAA,EAAUC,QAAS6lD,cAG7D+c,KACPnkB,GAAW,CAAGlvD,KAAAA,EAAMkT,cAAAA,GAAe2Q,QAAAA,GAASrT,SAAAA,EAAUC,QAAS6lD,KAG7B8d,SAAAA,YAAAA,GAAArjE,EAAAC,IAAAC,MAArB,SAAAojE,EAAsBnqE,UAAY8G,IAAApf,MAAA,SAAA0iF,GAAAA,cAAAA,EAAA9iE,KAAA8iE,EAAA1wF,MAAA0wF,KAAAA,SAAAA,EAAA1wF,OACzCqsE,GAAiB,CACrB/lD,KAAAA,EACAulD,cAAc,EACdC,cAAAA,EACA1vD,KAAAA,EACAqD,UAAW6P,GAAc7P,UACzBmN,SAAAA,EACA3U,OAAAA,EACA4U,QAAS6lD,GACT3G,cAAe6H,GACf73C,SAAUG,sEAIL,UAsLA03C,GAAkBriD,EAAsB0gD,GACzC,IAAAZ,EAAgB/hD,GAChBgiD,EAAel1D,EACfsmD,EAAetoE,EACfw6E,EAAe,CAAKx4D,KAAAA,EAAMhiB,KAAAA,GAC1Bm3E,EAAyBZ,GAEzB99C,EAAejD,GAAmBxT,EAAMkT,MAAmBiG,IAE3DzyB,EACkB,mBAAfmvE,EAA4BA,EAAW1gD,EAAasB,QAAgB59B,EAE7E+d,EAAA,EAAAoJ,EAAOtZ,QAA8B7N,IAAlB6N,EAASsZ,KAAqBtZ,EAASsZ,KAAOmV,GACjEve,EAAA,GAAAsc,GAAgBxsB,QAA+B7N,IAAnB6N,EAASmP,MAAsBnP,EAASmP,MAAQ4gB,GAC5E7f,EAAA,GAAA5Y,OAAOnF,GACP+d,EAAA,GAAA29D,IAAiB,GACjB39D,EAAA,GAAA+7C,QAAa95D,GAGbw8E,GAA8Br1D,GAE9Bs1D,GAAc,CACZJ,aAAAA,EACAD,cAAAA,EACA3O,aAAAA,EACA6O,uBAAAA,IAQFsD,GAAaD,EAFO,eAMbsB,GAAiBl1C,EAAqBixC,GAC7C1nE,EAAM,oBAEA,IAAA8mE,EAAgB/hD,GAChBgiD,EAAel1D,EACfsmD,EAAetoE,EACfw6E,EAAe,CAAKx4D,KAAAA,EAAMhiB,KAAAA,GAC1Bm3E,EAAyBZ,WAG7Bv0D,EAAO0zD,EAAgB9uC,IACvBhuB,EAAA,GAAAsc,GAAgBM,GAAmBxT,EAAMkT,MAAmBiG,KAC5DviB,EAAA,GAAA5Y,OAAOnF,GACP+d,EAAA,GAAA29D,IAAiB,GACjB39D,EAAA,GAAA+7C,QAAa95D,SACN2iB,OAEL5E,EAAA,EAAAoJ,EAAO0zD,EAAgBv1D,EAAWymB,KAClChuB,EAAA,GAAAsc,GAAgBM,GAAmBxT,EAAMkT,MAAmBiG,KAC5DviB,EAAA,GAAA5Y,EAAO4mC,GACPhuB,EAAA,GAAA29D,IAAiB,GACjB39D,EAAA,GAAA+7C,QAAa95D,SACN28E,GAEP5+D,EAAA,EAAAoJ,OAAOnnB,GACP+d,EAAA,GAAAsc,GAAgBD,GAAmB,CAAGjT,KAAAA,EAAMuT,OAAQ4F,MACpDviB,EAAA,GAAA5Y,EAAO4mC,GACPhuB,EAAA,GAAA29D,IAAiB,QACjB5hB,GACW,KAAT30D,EACI2gB,GAAwB3gB,EAAOwd,EAAc8D,SAAWyB,OAAOvF,SAC/D3iB,IAIC,GAAe,mBAAfg9E,EAAyB,CAC5B,IAAAnvE,EAAWmvE,EAAW71D,EAAMkT,QAElClT,EAAOtZ,GAAYA,EAASsZ,KAAOtZ,EAASsZ,KAAOA,GACnDpJ,EAAA,GAAAsc,GAAgBxsB,GAAYA,EAASmP,MAAQnP,EAASmP,MAAQqd,IAIhEmiD,GAA8Br1D,GAE9Bs1D,GAAc,CACZJ,aAAAA,EACAD,cAAAA,EACA3O,aAAAA,EACA6O,uBAAAA,IAMFsD,GAAaD,EAFO,MAiDN,SAAAO,GAAmBv6E,GAC7B,QAAS3F,IAATmnB,EAAA,CAII,IAAA1jB,EAA6BkC,EAA7BlC,GAAIylE,EAAyBvjE,EAAzBujE,YAAaxrD,EAAY/X,EAAZ+X,QACnB6sD,EAAW5kE,EAAQ4kE,UAAQ,GAEjC4Q,IAAY,EAEZF,GAAgB,CACdx3E,GAAIA,GAAM62E,EACVnzD,KAAAA,EACAojD,SAAUA,GAAQ,GAClBrB,YAAc,SAAA7sC,GACR6sC,EACFA,EAAW,CACT7sC,WAAAA,EACMlV,KAAAA,EACNg5D,gBAAiB5jD,EAAmBpV,EAAMkV,MAG5C/mB,EAAM,cAAei1D,EAAUluC,GAE/BohD,GAAYphD,KAGhB3e,QAAO,WACLy9D,IAAY,EACZ77D,KACI5B,GACFA,QAMC,SAAA6/D,GAAoBn5D,GAC3B9O,EAAM,sBAAqB,CAAI8O,KAAAA,IAE/B+2D,IAAY,EAGZD,GAAiB,CACfh0D,SACEC,KAAMkU,EAAMlU,EAAM/C,IAEpBA,KAAAA,EACAwT,QAASxrB,GAAQwrB,QACjBla,QAAO,WACLy9D,IAAY,EACZ77D,iBAKG21D,GAAgB9vE,EAAcu5D,GACrC7gD,EACEwgE,IAEEl5E,KAAAA,EACAo5D,QAAU,SAAAp5D,GAAiB,OAAAsgB,GAAiBtgB,GAAO,SAAAyE,GAAC,OAAKwb,GAAexb,EAAGoZ,EAAM,GAAA,EACjFw7C,SAAU74C,GACV+4C,QAAAA,OAGG99C,CAAAA,EAAAA,IACHnF,CAAAA,EAAAA,CAAAA,aACEuC,MAAO,QACPE,OAAQ,SAEVvC,cACEy1B,QAAS,EACTlzB,OAAQ,UAIV,CAAAR,mBAAe,OAAA4B,IAAK,IAgBjB,SAAA+hE,GAASC,GAChBhsE,EAAM,WAAU,CAAIgsE,eAAAA,IAEpBvjE,EAAA,EAAA4qD,IAAa,GACb5qD,EAAA,GAAAwvD,IAAc,GAEdpgE,KAAOF,MAAI,WAET8Q,EAAA,EAAA4qD,IAAa,GACb5qD,EAAA,GAAAwvD,GAAc+T,eAIT5B,SACH/nD,GAIC8jD,GAAQ1iB,WAAWF,aAIlBxlC,EAAOooD,GAAQxiB,UAChB5lC,OAICssD,EAAe,CAAKx4D,KAAAA,EAAMhiB,KAAAA,GAEhC4Y,EAAA,EAAAoJ,EAAOkM,EAAK4lC,KAAK8jB,MAAQxgD,EAAmBpV,EAAMkM,EAAK4lC,KAAK8jB,OAAS1pD,EAAK4lC,KAAK9xC,MAC/EpJ,EAAA,GAAAsc,GAAgBhH,EAAK4lC,KAAKj8C,OAC1Be,EAAA,GAAA5Y,EAAOkuB,EAAK4lC,KAAK9zD,MACjB4Y,EAAA,GAAA29D,GAAiBroD,EAAK4lC,KAAKyiB,gBAC3B39D,EAAA,GAAA+7C,QAAa95D,GAEbsV,EAAM,OAAU,CAAA+d,KAAAA,EAAMlM,KAAAA,IAYtBy4D,GAAaD,EATXtsD,EAAK4lC,KAAK8jB,OAAS1pD,EAAK6lC,KAAK6jB,OAEvB51D,KAAAA,EACAk1D,aAAcsD,EAAgBx4D,KAC9B+xC,KAAM7lC,EAAK4lC,KAAK8jB,MAChB9jB,KAAM5lC,EAAK6lC,KAAK6jB,OAElB,MAINz9D,KACI+a,GAAc7P,WAChB7L,GAASwiB,GAAa9G,GAAc7P,YAAY,cAI3Cq1D,SACHloD,GAIC8jD,GAAQ1iB,WAAWD,aAIlBzlC,EAAOooD,GAAQviB,UAChB7lC,OAICssD,EAAe,CAAKx4D,KAAAA,EAAMhiB,KAAAA,GAEhC4Y,EAAA,EAAAoJ,EAAOkM,EAAK6lC,KAAK6jB,MAAQxgD,EAAmBpV,EAAMkM,EAAK6lC,KAAK6jB,OAAS1pD,EAAK6lC,KAAK/xC,MAC/EpJ,EAAA,GAAAsc,GAAgBhH,EAAK6lC,KAAKl8C,OAC1Be,EAAA,GAAA5Y,EAAOkuB,EAAK6lC,KAAK/zD,MACjB4Y,EAAA,GAAA29D,GAAiBroD,EAAK6lC,KAAKwiB,gBAC3B39D,EAAA,GAAA+7C,QAAa95D,GAEbsV,EAAM,OAAU,CAAA+d,KAAAA,EAAMlM,KAAAA,IAYtBy4D,GAAaD,EATXtsD,EAAK4lC,KAAK8jB,OAAS1pD,EAAK6lC,KAAK6jB,OAEvB51D,KAAAA,EACAk1D,aAAcsD,EAAgBx4D,KAC9B+xC,KAAM7lC,EAAK6lC,KAAK6jB,MAChB9jB,KAAM5lC,EAAK4lC,KAAK8jB,OAElB,MAINz9D,KACI+a,GAAc7P,WAChB7L,GAASwiB,GAAa9G,GAAc7P,YAAY,cAQ3CkxE,GAAgBl4F,EAAkBivE,GACzC10D,EAAA,GAAAo7E,GAAiB1mB,GAAYjvE,EAAQmpB,wBAAwBzO,OAAMi7E,mlCA1iDpEp7E,EAAA,GAAE6oB,EAAgBre,GAA4B,CAC7CE,wBAAAA,EACAC,wBAAAA,wBAsCO,SAAsBigD,MACxByR,GAIC,IAAAn1D,EAAS0jD,EAAalnD,QAC5B24D,EAAYz7D,SAAQ,CAClBD,IAAMX,EAAA,GAAAq8D,EAAYhhC,WAAan0B,EAAMm1D,GACrCx7D,KAAMw7D,EAAYjhC,cAVnBmsC,CAAsB3c,2BAgCtBqT,GAAqBvB,0BAgNf,SAAuBC,GACzBp7C,GAAQjF,GAAc7P,UAAWkwD,KACpCplE,EAAM,yBAA0BolE,IAE5B35C,GAAgB25C,IAA4C,OAAtBA,IACxCzzC,GAAgByzC,IApNnB6K,CAAuB7K,8CAIvB38D,EAAA,GAAAitB,GAAU9N,EAAY/V,G1BtKX,SACdw0E,EACAC,GAEA,IAImCC,EAJ7BC,EAAiB,IAAIz6F,IAAIu6F,EAAgBroF,IAAI8Q,IAC7C03E,EAAgB,IAAI16F,IAAIs6F,EAAWpoF,IAAI8Q,QAGxBy3E,OAArB,IAAAE,EAAAngE,MAAAggE,EAAAG,EAAAvqF,KAAAqqB,MAAqC,CAA1B,IAAAvV,EAAMs1E,EAAAr6F,MACVu6F,EAAcz6F,IAAIilB,IACrBu1E,EAAc,OAAQv1E,EAEzB,oCAGiC01E,MAAbF,GAAa,IAAlC,IAAAG,EAAArgE,MAAAogE,EAAAC,EAAAzqF,KAAAqqB,MAAoC,KAAzBvV,EAAM01E,EAAAz6F,MACVs6F,EAAex6F,IAAIilB,IACtBu1E,EAAehuF,IAAIyY,EAEtB,CAAA,CAAA,MAAA5D,GAAAu5E,EAAAvuF,EAAAgV,EAAA,CAAA,QAAAu5E,EAAA15F,IAED,OAAOiR,EAAIqoF,GAAgBvoF,IAAIgR,EACjC,C0BiJM43E,CAAoBjrB,GAAW/pD,EAAM4xE,EAAgB3nB,IAAiBpmC,iCAIvEwqD,MAAwBruE,GAASsK,EAAQuZ,0BACzCjtB,EAAA,GAAAq+E,EAAoBvrF,MAAMoS,QAAQkE,IAASA,EAAK9mB,OAAS+wE,4CAc3DrzD,EAAA,GAAE4hD,EAAiB8R,GAClBr4B,GACAs4B,GACAvqD,EACAgyE,GACAvnB,GACAjJ,GAAalnD,GAAoB,uBAW7B24D,GACFA,EAAYz7D,SAAQ,CAClBD,IAAK07D,EAAYhhC,UACjBx6B,KAAMw7D,EAAYjhC,yDAqFrB/sC,GAAO,CACRurB,SAAAA,EACA3U,OAAAA,EACA4jB,cAAAA,EACAg5B,0BAAez4C,GACfu/C,mCAAwBrsC,EAAa,EACrC8rC,YAAAA,GACAp/B,eAAAA,GACAznB,MAAAA,GACAsY,QAAS6lD,GACT32C,SAAUG,GACV1B,OAAQ+zD,GACRzyD,YAAa46C,GACblgB,cAAAA,+CA0JCsa,GAAuB10D,EAAMmyC,EAAWt2C,EAAQu2C,6BAChD8iC,EAA0BvpB,GAAsBrZ,GAAkBzuB,oCA8O/D0wC,SAA2B17E,IAATmnB,EAAkB,CAChC,IAAAi1D,EAAgB/hD,GAChBgiD,EAAel1D,EACfsmD,EAAetoE,EACfw6E,EAAe,CAAKx4D,KAAAA,EAAMhiB,KAAAA,GAC1Bm3E,EAAyBZ,GAG/B39D,EAAA,GAAA5Y,OAAOnF,GACP+d,EAAA,GAAA29D,IAAiB,GAEjBc,GAA8Br1D,GAE9Bs1D,GAAc,CACZJ,aAAAA,EACAD,cAAAA,EACA3O,aAAAA,EACA6O,uBAAAA,IAQFsD,GAAaD,EAFO,MAKb,MAAA,CAAAx4D,KAAAA,EAAMhiB,KAAAA,6DAtkBR,SAAalE,GACpB8c,EAAA,GAAAssB,GAAeppC,aAGeq7F,GAAA,OAAAtD,GAAAxlF,MAAAvN,KAAAwC,UAAAuwF,aAS9Bj7E,EAAA,EAAA4qD,IAAa,GACb5qD,EAAA,GAAAwvD,IAAc,GACdjuD,MAyGO,SAAei9E,OAClB5kE,GAIJriB,EAAM,iBAAkBinF,OAGlBpuF,EAAYouF,EAAgBlnC,gBAAkBx1C,GAAc+B,MAAQ,EAAI,EAE9E67D,GADmBnT,GAASnjD,EAFd,GAE8Bo1E,EAAgBn4E,KAAMjW,IACzC,SAAA+lB,EAAGiT,UAExBnqB,MAAKnE,EAAAA,EACAsuB,CAAAA,EAAAA,OACH1M,aAAc8hE,aAuXb,SAAa92F,GACpBsY,EAAA,GAAAq7B,GAAa3zC,EAAM3C,OAAkC,YAG9C,SAAgB2C,OACjB3C,EAAS2C,EAAM3C,OACfshB,EAAOyH,GAAsB/oB,MAC/BshB,EAAI,CAGJ,GAAA2f,GAAmB1J,GAAc7P,YACjC+Z,GAAgBpd,EAAMkT,GAAc7P,UAAWpG,UAKjD6iB,GAAgB1E,GAAqBne,GAAM,IAE3C3e,EAAMM,iBAIHjD,EAAOqoB,mBACV7L,YAqSK,SAA+B7Z,GACtCk8E,GAAe,CACbr9E,OAAQgnB,GAAuB7lB,EAAM3C,OAAuB,UAC5D2sB,UAAW,EACXzR,MAAOwD,GACPtD,OAAQqD,GACRm/C,SAAS,gBAyDuBi6B,OAAAA,GAAAnnF,WAAA/K,UAAA,aA8ClC6M,EAAM,qBACNyI,EAAA,GAAAspB,QAAarnC,GACbsf,iBAIAw7D,EAAat7D,GAAKra,OAsEX,SAAcM,OACf4gC,EAAQtY,GAAkBtoB,GAgD5B,GA/CJ6P,EAAM,UAAa,CAAA+wB,MAAAA,EAAOt/B,IAAKtB,EAAMsB,MAEvB,WAAVs/B,IAEF5gC,EAAMM,iBACN23E,IAAU,IAEE,iBAAVr3C,IAEF5gC,EAAMM,iBACN23E,IAAU,IAEE,WAAVr3C,IAEF5gC,EAAMM,iBACNg4E,IAAW,IAEC,iBAAV13C,IAEF5gC,EAAMM,iBACNg4E,IAAW,IAIC,WAAV13C,GACF5gC,EAAMM,iBAIM,WAAVsgC,GAAgC,cAAVA,IACxB5gC,EAAMM,iBACNu4E,MAEY,WAAVj4C,GACF5gC,EAAMM,iBAGM,WAAVsgC,GACF5gC,EAAMM,iBAKM,WAAVsgC,GACF84C,GAAkB15E,GAGN,cAAV4gC,IACF5gC,EAAMM,iBAENwzF,KAEIl/D,GAAc7P,WAAS,CACnB,IAAA0e,E1B9+BE,SAAqB8B,EAAqBxgB,GACxD,IAAAgyE,EAAkC9pB,GAAoBvxC,GAAa3W,GAAYwgB,GAAvEynC,EAAQ+pB,EAAR/pB,SAAUG,EAAW4pB,EAAX5pB,YAElB,OAAIA,EAAc,EAGTrwC,GADcswC,GADI,CAAEJ,SAAAA,EAAUG,YAAaA,EAAc,GACH5nC,IACnB,GAGrCxgB,CACT,C0Bo+B6BiyE,CAAqBzxD,GAAS3Q,GAAc7P,WACjEyc,GAAgBiC,GAChBunB,GAAetvB,GAAa+H,IAI5B,GAAU,eAAV7C,IACF5gC,EAAMM,iBAENwzF,KAEIl/D,GAAc7P,WAAS,CACnB,IAAA0e,E1B9+BE,SAAiB8B,EAAqBxgB,GACpD,IAAAkyE,EAAkChqB,GAAoBvxC,GAAa3W,GAAYwgB,GAAvEynC,EAAQiqB,EAARjqB,SAAUG,EAAW8pB,EAAX9pB,YAElB,OAAIA,EAAc5nC,EAAQ3qC,OAAS,EAG1BkiC,GADUswC,GADI,CAAEJ,SAAAA,EAAUG,YAAaA,EAAc,GACP5nC,IACf,GAGjCxgB,CACT,C0Bo+B6BmyE,CAAiB3xD,GAAS3Q,GAAc7P,WAC7Dyc,GAAgBiC,GAChBunB,GAAetvB,GAAa+H,IAI5B,GAAU,YAAV7C,IACF5gC,EAAMM,iBAENwzF,KAEIl/D,GAAc7P,WAAS,CACnB,IAAA0e,E1BliCE,SAAkB8B,EAAqBxgB,GACrD,IAAAoyE,EAAkClqB,GAAoBvxC,GAAa3W,GAAYwgB,GAAvEynC,EAAQmqB,EAARnqB,SAAUG,EAAWgqB,EAAXhqB,YAElB,OAAIH,EAAW,EAGNlwC,GADcswC,GADI,CAAEJ,SAAUA,EAAW,EAAGG,YAAAA,GACU5nC,IACnB,GAGrCxgB,CACT,C0BwhC6BqyE,CAAkB7xD,GAAS3Q,GAAc7P,WAC9Dyc,GAAgBiC,GAChBunB,GAAetvB,GAAa+H,IAI5B,GAAU,cAAV7C,IACF5gC,EAAMM,iBAENwzF,KAEIl/D,GAAc7P,WAAS,KACnB0e,W1BjiCZ/hB,EACA6jB,EACAxgB,GAEA,IAAAsyE,EAAkCpqB,GAAoBvxC,GAAa3W,GAAYwgB,GAAvEynC,EAAQqqB,EAARrqB,SAAUG,EAAWkqB,EAAXlqB,YAElB,OAAIH,EAAYtrD,EAAwB9mB,OAAS,EAGxCkiC,GADUswC,GADI,CAAEJ,SAAUA,EAAW,EAAGG,YAAAA,GACM5nC,IACf,GAGjCxgB,CACT,C0BohC6BuyE,CAAc51E,EAAM6jB,GAAS3Q,GAAc7P,WAChEyc,GAAgBiC,GAChBunB,GAAetvB,GAAa+H,IAI5B,GAAU,UAAV7C,GAAqBhM,GAAc7P,WACjCkW,GAAiBrG,GAAc7P,WAAS,CAC1C/kB,EAAMM,iBAEA,IAAAqe,EAAOiW,GAAc7P,UAAUpG,KAEjChC,GADUiZ,EAAMlU,EAAM/C,IAGxBm5D,GAAoBn5D,GAEfuT,GAEHsP,GAAepuB,EAAAA,EAAMwhB,CAAAA,EAAAA,GAAc7P,WAAW+Y,CAAAA,EAAAA,CAAAA,MAAM,KAOxD,GAA2B,IADP8C,EAAMlpB,QAAQ,WAAY,IAC9B9c,QAAgBg6B,GAAc7P,iBAGhD/kB,EAAMM,+BAtI0Bi3F,GAAAzB,GAAA/nF,MAAA/K,KAAAA,UAAA8yF,CAuIhClc,CAAsB55E,EAAMsB,KAI1B,GAAU,eAAVs/B,GAA0B3F,GAAiBrG,GAAc7P,WAAS,KAC9DhpB,EAAQ65B,EAAMlU,EAAMkT,GAAc7P,UAAUpG,MAE9Cf,GAAM7hB,IAERK,OAAOgc,KAAKqK,OAAO1mB,GAAQ,UAIjB,WAAV6kC,GAAsBhM,GAAc7P,YACtC/kB,EAAMM,iBACNkhC,GAAgB,OAGJ,WAAVZ,IACF5gC,EAAMM,iBACNs7E,IAAS,IAGG,WAAVh7C,IACF5gC,EAAMM,iBACNs7E,IAAS,IAGG,WAAVh7C,IACF5gC,EAAMM,iBAEN25E,MAGY,iBAAVr5C,IACF5gC,EAAMM,iBAEN85E,OAIK,SAAYp6E,GAAqBw3F,IAAAA,EACxCx3F,EAAMM,iBAEA,IAAAygC,EAAmCy2D,QAAtBA,EAAGx3F,EAAM8gC,yBAAa02D,SAAnBA,EAAqBx2D,QAAQ,mBAC7BzmC,IAAlBwmC,GAIJf,GAAO,CACLe,cAAAA,EACArf,KAAAA,EACAqD,UAAW6P,GAAc7P,UACzBmN,SAAAA,EACA3U,OAAAA,EACA4U,QAAS6lD,GACTzI,aAAciM,GACdhM,gBAAAA,MAoGK,SAA4Bz/D,GACnCF,EAAM,0BAA2BE,GAEjCyxB,GAAgB1E,GAAqB/sB,EAAM4O,MAAM,IAEjDzF,GAASnJ,EAAM4O,sBAGR,SAAcmmD,GACjB5yC,QAAqB33B,IAATmnB,IAIhBg0D,IAAY,EAEZH,GAAW,CACTv3E,GAAI42E,EACJlzD,KAAAA,EACAojD,SAAAA,EACAtB,OAAW,SAAAi0B,GAAA,IAAA7gE,EAAU6gE,EAAV7gE,WAAY8C,EAAQ+9D,EAAR/9D,SAAUhxB,EAAS+uF,EAAT/uF,UAC/BmH,EAAM,SAAU+mB,EAAYkuC,EAAUprC,EAAUhxB,GAEhDsvE,GAAYphD,GAAa,SAAAnI,EAAGiT,UAExBnqB,MAAKnE,EAAAA,KACAsuB,GAAY,CAAA,EAAA,CACf1M,aAAY,CACVrW,KAAM+a,EACNk2B,eAA8B,IAAflnD,EAAmB0R,GAAc+B,KAAO/B,GAAc8B,YAM/EjE,QAAO,WACLy9D,IAAY,EACZ77D,SA4FJwgE,CADc,gBAKdI,IACE3V,SAAQ,YAqGH,SAAqB/mE,GAC5Bua,EAAA,GAAA2zD,GAAiBluE,EAAQmpB,wBAAwBzO,sJAwClCgS,EAAc3Q,OAyDK,WAAA,OAAAxB,EAAA,GAAAqzD,GAAiBrpD,IAsBd,EAAA,SAAA0qD,EAAAjvE,GAAY,OAAAk4F,GAAgBl4F,EAASivE,wDAzD3D2H,EAAW76D,kBAsNpBD,0DApQGu3D,EAAat3D,2iCE/7CL/f,EAAO,qBACLA,EAAS,0WAoBdA,EAAgB,wBACTA,EAAuB,+NAtB3BA,EAAO,iCACLA,EAAS,uqBAoBdA,EAAgB,oCACTA,EAAuB,+SAlD3BA,EAAO,qBACLA,EAAS,2TAiBdA,EAAgB,wBACTA,EAAuB,+NAnB3BA,EAAO,iCACLA,EAAS,okBAiBdA,EAAgB,oCACTA,EAAuB,+SA5C3BA,EAAO,qBACLA,EAAS,yRAiBdA,EAAgB,uMAlBbA,EAAO,iCACLA,EAAS,6hBAiBdA,EAAgB,+TArB7BA,EAAI,KAAKggB,GAAKra,MAAyB,SAAjB+iB,OAAO1oB,EAAI,UAyB5BA,EAAI,KAAKggB,GAAKy0C,MAAK,4YA3MvBkpC,EACAC,EACAC,EAEAC,EAgCAC,EAaAC,EApFOt2E,EAAgBlN,EAAhBkN,QACAsD,EAAqCxQ,EAArCwQ,UAEAmN,EAAiB3d,EAAjB2d,SACAnQ,EAA4BxN,EAA5BwN,YACA4lE,EAAepzE,EAAfozE,QACAqQ,EAAUzjF,EAAVyjF,KACA9iB,EAAoB3gE,EAApB2gE,YACAC,EAAsB5gE,EAAtB4gE,cACAsS,EAAkBlzE,EAAlBkzE,UACAC,EAAoBnzE,EAApBmzE,YACA1kE,EAAgCzO,EAAhCyO,wBACAC,EAAgC1O,EAAhC0O,wBACAqwE,EAAuB/+E,EAAvB++E,eACA/1E,EAAkBhJ,EAAlBgJ,OACA63D,EAAoC7gE,EAApC6gE,gBACAvhB,EAA2Bt/C,EAA3Bs/C,UACAC,EAA4Bv/C,EAA5Bu/C,iBACAyS,EAA0BhyD,EAA1BgyD,WACA0xB,EAAoB1jF,EAApB0jF,YAEA3lE,EAAkB/d,EAAlB+d,SACA+iD,EAA0B9gE,EAA1B8gE,aACAh0C,EAAkB9sB,EAAlB8sB,SACAy6B,EAA4BvnD,EAA5BunD,cACA+D,EAAwBtrD,EAAxBsrD,YACA8D,EAA0BpvD,EAA1BovD,aACA2R,EAAwC/gE,EAAxC+gE,oBACA9O,EAAgBjyD,EAAhBiyD,QACA/R,EAAgBlgD,EAAhBkgD,QACAC,EAAcngD,EAAdmgD,OACA6gB,EAAwBhhE,EAAxBghE,YACAC,EAAkCjhE,EAAlCihE,iBACAC,EAAoClhE,EAApCkhE,kBAkCLyiB,EAAiB,CACrBr1F,KAAM,aAuIqB,SAAAs1F,WAAAA,EAAA1lE,EAAAC,IAAAC,6EACvBilE,KAAAA,EAAAA,IAAAA,EAAWQ,CAAAA,EAAA9yF,KAAA,EAAA,KAAA,CAAA,OAAA8yF,EAAA9yF,KAAA,EACPsyF,EAAYxvE,UAAO,KAAA,EAAA,IAAA,MAAA,OAAAgwE,EAAAnqD,UAAAoqD,EAAA,w5CArK1BR,EAAa,EAEZh1F,KAAM,SACNnD,KAAM,OACNoyD,4CAAK1tD,OAAwC4zF,EAAI,KAEjD/oE,UACE,8BACC+oE,IAASj+E,GAAKra,MAA6B,SAApBs4F,EAA6B,gBAAkB,IACzExiC,QAAe,WAAA,OAAA6f,EAAat7D,GAAKra,SAGjCmD,KAAM,SACNnD,KAAM,OACNoyD,MAAK1tD,sCAAAA,OAAwC4zF,EAAI,KACjD/oE,UAAW,qBAAuB+oE,IAASj+E,GAAK81E,KAAO,gBAAkB,IACzEr6B,QAAe,WAAA,OAAA6f,EAAat7D,GAAK81E,KAAI,IAGrChtF,KAAM,SACNnD,KAAM,QACNoyD,MAAK,uCAAA1tD,OAAyC4zF,OAC9C/oE,UAAW,6BAA+B+oE,IAASj+E,GAAKy0C,MAAQ,gBAAkB,IAClFgH,QAAe,WAAA,OAAA6f,EAAat7D,GAAKy0C,MAAK,2CASzCl2C,EAAA,GAAEw/E,EAAoB,SAAAtzD,GACf,IAAA8zD,EAAejhC,GAAY7yB,EAAM,IACnCqzD,EAAczzF,OAAOogC,GACrBqzD,EAAczzF,OAAO8zF,EAAmB1zD,GAEtC+zD,EAAuBC,GAAUF,UAGrC30B,EAAa20B,EAAY,CAAIN,KAAAA,EAAMS,MAAOR,EAAa/lE,SAAAA,KAAeqmE,uCAKzEjgF,EAAA,GAAEy/E,EAA2B,SAAAvzD,OAAwBk0D,EAC9CC,EAAgBH,GAAUh0D,GAG9B,eAAAk0D,EAAApjB,EAAoB9wC,EAAK,CAAIwzD,KAAAA,EAAMS,MAAOR,EAAa/lE,SAAAA,EAAUnN,UAAAA,oBAChEmN,GAAmBymE,gFAIR,SAAM/hE,MAChB8gE,SAGKA,EAAYpgB,MAAM1gD,MAGvB+gE,SAGKA,EAAargB,MAAM1gD,MAGxBghE,SACKA,EAAYtgB,MAAM1gD,GAGjB,MAAA,IAAA7wB,MAAK,0CAAA3B,OAA2C4zF,EAAI,OAGhD,SAAO5vF,MACjBsvF,SACKA,EAAYziE,OAAO7sB,GAEhB,MAAA,IAAArC,MAAK,2CAAA3B,OAA4C4zF,EAAI,OAOnD,SAAU93F,MACpB03F,EACFA,EAAYnd,mBAAmBv6E,QACtBw3F,GAAAA,EACTA,EAAYjd,mBAAmBv6E,YACtBy3F,EAGC,MAAA,IAAA5xF,MAAK,8CAAA3B,OAA+C4zF,EAAI,MAFlEL,EAAald,mBAAmBv6E,mBAW9B03F,EACK,OAAAA,EAAYthB,cACVohB,EACF,OAAAA,EAAYphB,cACVqhB,EACF,OAAAA,EAAarhB,WAEV,MAAA,IAAAvwE,MAAK3B,6CAAAA,OAA8C4zF,EAAI,yBAgB/DN,EACKA,EAAYkB,mBAEZn3E,GAIK,SAAS9C,MACnB+4E,SACKA,EAAYx+E,SAASyF,GACnBg5E,GAAAA,SACFA,EAAaz+E,SAASyF,GAGnB,MAAA,IAAA5Y,MAAK,6CAAA3B,OAA8C4zF,EAAI,OAIrD,SAAYr5E,MACtB+4E,SACKA,EAAYh3B,YAAY/hD,GACtBg5E,GAAAA,SACFA,EAAaj3B,YAAY/hD,GAEtB,MAAA,IAAA5Y,MAAK,gDAAA3B,OAAiD4zF,oBAK9DJ,EACFA,EAAY/9E,QACH69E,EACTA,EAAY79E,QACH89E,GACTA,EAAa99E,oBAIY,OAAAs+E,EAAApqF,WAAA/K,UAAA,wDAYhB40F,EAAW99E,2DAyBX69E,EAAY79E,2DA4BZ49E,EAAW59E,+iPCrBf/f,EAAK,+DADR6E,GAEKvB,EAAAisB,EAAAzqB,+CADF9E,EAAK,2FAMM8+F,0DAAe,6FAD7Bj6F,GAEQvB,EAAA2V,EAAAnU,gDAF8C9E,EAAW,kTAOjE6E,GAA0FvB,EAAA2V,EAAAnU,uBAAtC9E,EAAW,8OAF/D6E,GAA0FvB,EAAA2V,EAAAnU,uBAAtC9E,EAAW,iMAnEvCA,EAAK,IAACa,OAAS,OAACwJ,OAAQrK,MAAMa,OAAM,KAAM,sBACpD,UAETb,EAAW,wHAgBVi+F,KAAAj+F,MAAai+F,KACVv2E,QAAA1nB,MAAa0nB,QACXsD,UAAAhrB,MAAagrB,gTAgBX,UACJhrB,EAAW,aACVA,EAAY,iBACRA,EAAgB,aACpBA,EAAqB,kDAGtBxB,UACDA,2GAKWwB,EAAqB,wCAKrCA,EAAK,KAAAooD,GAAApoD,KAMLA,EAAK,IAACa,OAAS,GAAC4W,GAAAzX,0BAKfA,EAAQ,MAAAmZ,mhBAxD0DnZ,EAAe,ySAZ7F6E,GA2EKvB,EAAA25D,EAAAn4D,wBAnEHzB,GAkEK45D,EAAAE,GAjEH95D,GAEK85D,EAAAtlD,WACLxU,GAA4F85D,EAAAr1D,WAE5FzE,GAEK85D,EAAA7kD,WAELjV,GAoCK85D,EAAAD,wBAEL75D,GAiBK85D,EAAAC,0FAzEkEp9D,EAAY,qFAEvDA,EAAK,IAACa,OAAS,OAACwJ,OAAQrK,MAAMa,YAAY,uHAUIb,EAAe,eAAfA,EAAe,cAS/E,SAAAM,EAAA,KAAAy+F,EAAAd,KAAAj+F,MAAai+F,MACV,SAAA39F,EAAA,KAAAy+F,EAAAr3E,QAAA1nB,MAAa0nB,SACX,SAAApnB,EAAA,KAAAy+F,EAAA/zE,UAAAhrB,MAAagrB,6tBAkCrBhrB,EAAK,2DAMLA,EAAK,IAACa,OAAS,6bApEf,SAAAif,GAAM9b,GACbA,EAAQ8b,uCApJNk/E,EACA7mC,EAvCEriD,EAAQH,GAAY,8BAEf+R,EAAgBlN,EAAhBkN,QACA9C,EAAcpK,EAAdoK,KACAwT,EAAgB5d,EAAhB4d,QAEAD,EAAiB3d,EAAjB2d,SACAnQ,EAA4BxN,EAA5BwN,YACA4lE,EAAepzE,EAAfozE,QACAzS,EAAoB3gE,EAApB2gE,YACAC,EAAsB5gE,EAAtB4gE,cACAsS,EAAkBlzE,EAAlBkzE,UACAC,EAAoBnzE,EAApBmzE,YACA1kE,EAAgCzO,EAAhCyO,wBACAC,EAAgC1O,EAAhC0O,wBACAqwE,EAAuB/+E,EAAvB++E,eACA/1E,EAAkBhJ,EAAlBgJ,OACAs2C,EAA2Bt/C,EAA3Bs/C,UACAC,EAA4Bv/C,EAA5Bu/C,iBACAyS,EAA0BhyD,EAA1BgyD,WAEAzK,EAA4BvnD,EAA5BunD,cACA+D,EAAwBtrD,EAAxBsrD,YACA8D,EAA0BpvD,EAA1BovD,aACA2R,EAAwC/gE,EAAxC+gE,oBAEAC,EAAwBhhE,EAAxBghE,YACAC,EAAkCjhE,EAAlCihE,iBAEH58D,EAAUhS,GAAoB,gBAA9BgS,MAYFogF,EAAS,CACbhB,KAAMiB,EAAcx3E,GACpBA,QAAAA,EACAsD,UAAW,KACXm0E,aAAcv6E,GAEZw6E,GAAuBH,GASvBjpF,OAA4BxV,EAEvB,SAAA0+F,EAAcx3E,GACd,OAAAI,GAAcJ,IAAYgW,EAAYhW,EAAQC,MAAQ3H,GAAKy0C,MAAQz0C,GAAK81E,cAGxEuJ,IAAiBC,IAAAA,EAClBt0E,GAAqD,QAAbs0E,EAAA3gE,GAAKygE,UAAQ,IAAAE,OAAA,EAAbA,EAAat0E,YAAa,KACpEuW,GAAgBvW,IAClBg0E,EAAU7/E,SAASwiB,GAAa3W,aA8C3BimD,IACPn7D,EAAM,eAEFspF,EAAMv+F,OAAS,QAEjBu+F,EAAQ3gE,EAAQ2gE,IAChBzxF,KAAOF,KAAK4xF,GAGZ9gF,EAAA,GAAAvI,OAAQxV,IAGRqe,4hCA1ED0gF,EAAe5gE,GAAKygE,IAAUH,0BAChC1gF,EAAA,GAAEihF,EAAeJ,EAAMlJ,SAAS,SAAA14E,GAAK,OAAKA,EAAM2hF,oCAC9C5gF,EAAA,GAAAkhF,EAAmBxtE,EAAQutE,GAAkD,kBAAlCpuE,GAAkBouE,6BAG7DnkB,EAAkBe,GAAW54D,EAAOS,8EAgBrCnO,EAAM,gBAEFqiB,MAKF5Z,EAAA,GAAAvI,OAAQxV,OAEFokB,EAAO26E,EAAaJ,aACpBz3E,EAAU63E,EAAa73E,QACvBmV,EAAU,EAEZxE,GAAI,UACJzT,KAAMC,EAAmBD,GACzB5iB,MAAOkmB,GAAcR,EAASlE,GAAQmE,UAItCy3E,EAAMv+F,OAAS,EAAC,KAEZ6+F,EAAax3E,GADGk3E,EAAMA,EAAMv+F,OAAS,GAAG6mB,QACElE,GAAQmE,KAClDg4E,EAAoB,CACxBh4E,KAAMoV,EAAmB2iE,EAAY7iE,IAKjC+iE,EAAkBvmF,EAAAA,EAAoBwmF,CAAAA,EADxBT,EAAMA,EAAMv+F,OAAS,IAAMo+F,GACUv3E,CAAAA,EAAAA,CAAAA,QAASi4E,IAClEphF,EAAA,GAAA6gF,EAAK/0F,GAAAA,OAAA4J,EAAOmrF,EAAMh/F,MAAM,EAAGg/F,EAAMv+F,OAAS,IAAI++F,CAAAA,KAC9CjyF,KAAOF,KAAK4xF,QAEZjnE,EAAQyE,GAERhe,UAEKsE,QACPnN,EAAQ0S,OAAOvF,mBAqBbg1C,EACF55C,EAAA,GAAA45C,GAAa,GAEb8Y,KAIK,SAAawL,GACpB3mE,EAAM,eAAgB2mE,GAEhB,IAAAr+C,EAAY/kB,EAAAA,KACbkmF,GAAY,CAAA,EAAA,CACf73E,QAAS+0D,IAGXl+D,EAAA,GAAA6gF,EAAK/0F,GAAAA,OAAA4J,EAAOwqB,EAAQ2gE,IAAQhhE,CAAAA,MAGrB,SAAsBsL,GAC7B5zB,EAAM,wBAAyB4zB,GAEzB,IAAAtL,EAAY/kB,EAAAA,EACbkmF,CAAAA,EAAAA,OACHv0E,UAAW0e,IAGbnrB,EAAA,GAAA6gF,EAAK/0F,GAAAA,OAAA4J,EAAOwqB,EAAQ2gE,KAAQhhE,MAGrB,SAAiB0hE,GACxBhqF,EAAM,mBAAoBgqF,GAEpB,IAAA1hE,EAAY/kB,EAAAA,KACbkmF,GAAY,CAAA,EAAA,CACftB,KAAM6B,IAGRvhF,EAAA,GAAA6gF,KAAK/0F,OAAA4J,EAAOwqB,EAAQ2gE,KAAQhhE,MAGrB,SAAY2hE,QACnB/pF,EAAQ+pF,EAASh2E,YACjBnT,QAAQZ,MAAM+pF,aAGcC,GAAG,IAAAt4E,EAAOs4E,EAAPt4E,QAAS9C,EAAIo7E,EAAJp7E,KACxC9O,EAAM,wBAA2B,CAAA4R,QAAAA,EAAS9C,KAAAA,QAEpCq7E,EAAgB,CACpBhC,KAAMiB,EAAcx3E,GACpBA,QAAAA,EACAsD,UAAW,KACXm0E,aAAcv6E,QAEhBw6E,KAAK/0F,OAAA4J,EAAOmrF,GAAK,CAAEa,yFA4BJjB,EAASj/E,yfCtOpBnT,EAAUC,GAAoB,uBAEhBD,EAAQyR,KACPzR,EAAQiS,88BCscN,yBAEH7e,EAAY,iBACRA,EAAU,aACdA,EAAY,kDAGbA,EAAW,WACZA,EAAU,+oCA7BhBA,EAAU,uQADqBA,EAAQ,0CAA/C6E,GAsCKvB,EAAAisB,EAAAzqB,kJArCG9E,EAAU,8GADqBA,EAAQ,kNAF9B,kVALbmb,aAAA+kF,EAAAlgG,0BAAAkgG,EAAsB12F,WACxB+X,gBACQ,wHACFvhB,EAAoB,mHAHxBmb,aAAAglF,EAAAngG,0BAAAmgG,EAAsB32F,4jBAjV1B42F,EACA/hF,EA7CEvI,EAAQH,GAAY,2BAEc6E,EAA7BkN,QAAAA,OAAO,IAAA24E,EAAA,CAAc16F,KAAM,IAAE06F,EAC7BC,EAA4C9lF,EAA5CwQ,UAAAA,OAAwC,IAA/Bs1E,EAA+B,KAAIA,EAE5CC,EAAgB/lF,EAAhB2d,SAAAA,OAAQ,IAAAooE,GAAQA,EAChBC,EAAgChmF,EAAhCwN,YAAAA,OAA+B,IAApBw4E,EAAoB,EAACA,EAChCC,EAAWjmF,EAAXozE,QAAAA,OAAU,IAAH6S,EAAG,EAACA,IACWjmF,EAAtByjF,KAAAA,OAAI,IAAAyC,EAAS1gF,GAAK81E,KAAI4K,EACtBC,EAAkBnmF,EAAlB2gE,YAAAA,OAAc,IAAHwlB,GAAOA,EAClBC,EAAoBpmF,EAApB4gE,cAAAA,OAAa,IAAAwlB,GAAOA,EACpBC,EAAgBrmF,EAAhBkzE,UAAAA,OAAY,IAAHmT,GAAOA,EAChBC,EAAkBtmF,EAAlBmzE,YAAAA,OAAW,IAAAmT,GAAOA,EAClBC,EAA+BvmF,EAA/ByO,wBAAAA,OAA0B,IAAH83E,GAAQA,EAC/BC,EAA+BxmF,EAA/B0O,wBAAAA,OAAuB,IAAA83E,GAAQA,EAC/BC,EAAqBzmF,EAArB++E,eAAAA,OAAiB,IAAH0H,GAAOA,EACrBC,EAAyB1mF,EAAzBgJ,OAAAA,OAAqByE,IAAfi5E,EAAej5E,KAAIi5E,EACzBC,EAAkC3mF,EAAlCs/C,UAAAA,OAAS,IAAAqnC,EAAqB,KAAIA,EAClCC,EAAmC5mF,EAAnCu/C,iBAAAA,OAA+B9xC,IAAfm5E,EAAen5E,KAAIm5E,MACnC50B,WAAAA,OAAU,IAAA60B,EAAA,CACnBp9E,MAAOqN,GACP3N,UAAWyN,MAGFkwE,EAA0D9mF,EAA1D68C,eAAAA,WAAciqC,GAAqBnuE,IAAuBmuE,EAC1DC,EAA8C/mF,EAA9C88C,gBAAAA,OAAe,IAAAiqC,EAAWlqC,EAAe,GAAGpzD,GAAEs9F,EAE9CC,EAAmDhnF,EAAnD+8C,sBAAAA,OAAqB,IAAAiqC,EAA0BhjG,GAAIgjG,EACnDC,EAAyBjnF,EAAzB+d,SAAAA,OAAQ,IAAAkpE,EAAa,KAAIA,EACzBC,EAAgClnF,EAAhC8sB,SAAAA,OAA4B,IAApBo6D,EAAoB,KAAIA,EAChCC,EAA0CnnF,EAA1CunD,cAAAA,QAAa,IAAA4/B,EAAkBjzD,GAAWizD,EAC1CC,GAA0CpnF,EAA1CsrD,YAAAA,YAAW87B,cAA+BA,EAAAA,GAC1CC,GAAiCrnF,EAAjCovD,aAAAA,QAA6BprE,IAAjBqjG,GAAiBrjG,GAAIqjG,GACjCC,GAA+CtnF,EAA/C+gE,oBAAAA,QAAmB,IAAAumB,GAAwBtjG,GAAIsjG,GAC/CC,GAAiCvnF,EAAjC8gE,aAAAA,QAA6B98E,IAAjBujG,GAAiBvjG,GAAIujG,GACjCC,KAAAv1B,QAAAA,QAAO,IAAAu1B,GAAa,SAAA7+E,GAC7BvM,QAAQZ,MAAMmN,GACd8+E,MAAM9+E,EAAI4G,gBAEDm4E,GAAuB1nF,EAAvBkgD,QAAAA,QAAmBl8D,IAAZ0jG,GAAY1jG,GAAI0jG,GACvBC,GAAqB3nF,EAArBmgD,OAAAA,QAAiBn8D,IAAX2jG,GAAW3jG,GAAI2jG,GAE5BC,GAAa//E,KACb6kB,IAAW,EAGXm7D,GAGO,KAgBPC,GAAiB9+E,WAuBI++E,YAAAA,GAAA7pE,EAAAC,IAAAC,MAAH,SAAA4pE,EAAIlP,GAAmBmP,IAAAA,SAAA9pE,IAAApf,MAAAmpF,SAAAC,GAAAA,cAAAA,EAAAxpE,KAAAwpE,EAAAp3F,MAC3CuK,KAAAA,EAEmD,GAFnDA,EAAM,SAEA2sF,EAAeh7E,GAAoB6rE,IACzBqP,CAAAA,EAAAp3F,mBACJ,IAAAS,MAAMy2F,UAIlBlkF,EAAA,GAAA6jF,GAAa//E,MAGb9D,EAAA,EAAAmJ,EAAU4rE,GAAU,KAAA,EAAA,IAAA,MAAA,OAAAqP,EAAAzuD,OAAAsuD,GAAAA,6BAGA,UAAMI,YAAAA,GAAAlqE,EAAAC,IAAAC,MAAN,SAAAiqE,EAAOpmB,OAAuBgmB,EAAA,OAAA9pE,IAAApf,MAAA,SAAAupF,GAAA,cAAAA,EAAA3pE,KAAA2pE,EAAAv3F,MAClDuK,KAAAA,EAGI2sF,GAHJ3sF,EAAM,YAEA2sF,EAAeh7E,GAAoBg1D,IACzBqmB,CAAAA,EAAAv3F,mBACJ,IAAAS,MAAMy2F,UAGM,OAAxBlkF,EAAA,EAAAmJ,EAAU+0D,GAAcqmB,EAAAv3F,KAAA,EAElBoC,KAAI,KAAA,EAAA,IAAA,MAAA,OAAAm1F,EAAA5uD,OAAA2uD,GAAAA,6BAGU,UAAKE,YAAAA,GAAArqE,EAAAC,IAAAC,MAAL,SAAAoqE,EAAMnmE,OAA6Bp7B,EAAA,OAAAk3B,IAAApf,MAAA,SAAA0pF,GAAA,cAAAA,EAAA9pE,KAAA8pE,EAAA13F,MACnDsc,KAAAA,EAAAA,IAAAA,GAAcH,GAAOu7E,CAAAA,EAAA13F,KAAA03F,EAAAA,KAAAA,CAAAA,EAAA9pE,KAAA,MAErBzR,EAAO,CACLC,KAAMnE,EAAOS,MAAMyD,EAAQ/hB,MAC3BA,UAAMnF,0BAGE,sBAAA,MAAA,GAAA,IAAAwL,MAAM,qEAM6B,OAA3CvK,EAAS2+F,EAAkB7iB,MAAM1gD,GAAUomE,EAAA13F,KAAA,GAE3CoC,KAAIs1F,KAAAA,GAAAA,OAAAA,EAAAhvD,OAEHxyC,SAAAA,GAAMwhG,KAAAA,GAAAA,IAAAA,MAAAA,OAAAA,EAAA/uD,OAAA8uD,GAAAA,0CAGO,CAAME,SAAAA,YAAAA,GAAAxqE,EAAAC,IAAAC,MAAN,SAAAuqE,EAAOz5D,GAAwC/Q,OAAAA,IAAApf,MAAA,SAAA6pF,GAAAA,cAAAA,EAAAjqE,KAAAiqE,EAAA73F,MACnEgT,KAAAA,EAAwB,OAAxBA,EAAA,EAAAyM,EAAY0e,GAAY05D,EAAA73F,KAAA,EAElBoC,KAAIy1F,KAAAA,EAAAA,IAAAA,MAAAA,OAAAA,EAAAlvD,OAAA,GAAAivD,EAAA,2BAGU,CAAME,SAAAA,YAAAA,GAAA3qE,EAAAC,IAAAC,MAAN,SAAA0qE,EAAOj1F,GAAmB,OAAAsqB,IAAApf,MAAA,SAAAgqF,GAAAA,cAAAA,EAAApqE,KAAAoqE,EAAAh4F,MAC9C60F,KAAAA,EAAiC,OAAjCA,EAAkBllE,OAAO7sB,GAAQk1F,EAAAh4F,KAAA,EAE3BoC,6BAAI41F,EAAArvD,OAAA,GAAAovD,EAAA,2BAMI,CAuBsB,SAAAE,YAAAA,GAAA9qE,EAAAC,IAAAC,0FACc,OAA5ClR,EAAU04E,EAAkBvB,mBAAgB4E,EAAAl4F,KAAA,EAE5CoC,mBAAI81F,EAAAxvD,OAAA,SAEHvsB,GAAO,KAAA,EAAA,IAAA,MAAA,OAAA+7E,EAAAvvD,OAAA,GAAAwvD,EAAA,6BAGM,CAAQ,SAAAC,YAAAA,GAAAjrE,EAAAC,IAAAC,MAAR,SAAAgrE,EAASh/E,GAAc+T,OAAAA,IAAApf,MAAAsqF,SAAAC,GAAAA,cAAAA,EAAA3qE,KAAA2qE,EAAAv4F,MAAAu4F,KAAAA,EACrC,OADqCA,EAAAv4F,KACrC,EAAA60F,EAAkBjhF,SAASyF,GAAI,KAAA,EAAA,IAAA,MAAA,OAAAk/E,EAAA5vD,OAAA,GAAA0vD,EAAA,2BAGvB,UAIM9jF,KAAK,OAAAikF,GAAA/vF,MAAAvN,KAAAwC,UAAA,CAAA,SAAA86F,YAAAA,GAAArrE,EAAAC,IAAAC,oFACF,OAAvBwnE,EAAkBtgF,QAAKkkF,EAAAz4F,KAAA,EAEjBoC,KAAIq2F,KAAAA,EAAAA,IAAAA,MAAAA,OAAAA,EAAA9vD,OAAA+vD,GAAAA,6BAGU,CAAOC,SAAAA,YAAAA,GAAAxrE,EAAAC,IAAAC,oFACrB,cAAA,EAAAwnE,EAAkB/xE,UAAO,KAAA,EAAA,IAAA,MAAA,OAAA81E,EAAAjwD,OAAAkwD,GAAAA,8BAGA,SAAAC,YAAAA,GAAA3rE,EAAAC,IAAAC,MAAX,SAAA0rE,EAAY9iG,GAA8Bm3B,OAAAA,IAAApf,MAAAgrF,SAAAC,GAAA,cAAAA,EAAArrE,KAAAqrE,EAAAj5F,aAG/C,OAAf9E,KAAKg+F,KAAKjjG,GAAKgjG,EAAAj5F,KAAA,EAEToC,KAAI,KAAA,EAAA,IAAA,MAAA,OAAA62F,EAAAtwD,OAAA,GAAAowD,EAAA79F,KAAA,2BAGU,CAAO,SAAAi+F,YAAAA,GAAAhsE,EAAAC,IAAAC,oFAKrB,OAFNnyB,KAAK8O,WAAQovF,EAAAp5F,KAEP,EAAAoC,KAAIg3F,KAAAA,EAAAA,IAAAA,MAAAA,OAAAA,EAAAzwD,OAAA0wD,GAAAA,mCAiCaC,SAAAA,YAAAA,GAAAnsE,EAAAC,IAAAC,MAAV,SAAAksE,EAAWhF,GAAa,OAAAnnE,IAAApf,MAAA,SAAAwrF,GAAAA,cAAAA,EAAA5rE,KAAA4rE,EAAAx5F,gBACjC0yF,IAAS6B,EAAO,CAAAiF,EAAAx5F,KAAA,EAAA,KAAA,CAAA,OAAAw5F,EAAA9wD,OAAA,UAAA,KAAA,EAIN,OAAd11B,EAAA,EAAA0/E,EAAO6B,GAAOiF,EAAAx5F,KAAA,EAERoC,KAAIo3F,KAAAA,SAAAA,EAAAx5F,OACJuU,KAENw7D,KAAAA,EAAAA,GAAawkB,GAAO,KAAAiF,EAAAA,IAAAA,MAAAA,OAAAA,EAAA7wD,OAAA4wD,GAAAA,6BAGb,CAAA,SAAAttC,GAA0BC,GACjC3hD,EAAM,4BAA6B2hD,GACnCl5C,EAAA,GAAA+4C,EAAkBG,GAClBF,EAAsBE,YAKfgkB,GAAgBupB,GAA2C,IAAxC/gG,EAAE+gG,EAAF/gG,GAAI0jB,EAAIq9E,EAAJr9E,KAAMojD,EAAQi6B,EAARj6B,SAAUrB,EAAWs7B,EAAXt7B,YAAaxrD,EAAO8mF,EAAP9mF,QACvDia,GAIJ9Z,EACE4mF,IAEEhhG,GAAAA,EACA0jB,KAAAA,EACAojD,SAAAA,EACA/iD,YAAAA,EACAiB,wBAAAA,EACAC,wBAAAA,EACA1F,OAAAA,EACA63D,gBAAAA,EACAthB,iBAAAA,EACAyS,WAAAA,EACAnV,eAAAA,EACAC,gBAAAA,EACAC,sBAAuBC,GACvBuK,cAAAA,GACA6H,aAAAA,GACA2R,oBAAAA,GACAzV,YAAAA,GACA4D,YAAAA,GAEFpoD,GAEE,CAAApD,QAAAA,aAMGs9D,GAAW0pB,GAAG,IAAAjhG,EAAEihG,EAAFjhG,GAAI0jB,EAAIu9E,EAAJv9E,KAAMojD,EAAQm6B,EAARn6B,SAAUtB,EAAMy7B,EAANz7B,OAAQvrD,EAAOgnF,EAAPhnF,QAC7Cia,GAIJ9Z,EACE8mF,GAAS,CAEPlhG,GAAAA,EACA0jB,KAAAA,EACAojD,SAAAA,EACAtB,OAAAA,GAEFpoD,GAEE,CAAAnD,QAAAA,+0CA3PCyK,GAAcnF,EAAQ8+E,IAAc,CAGnC,GAFJxsF,EAAM,mCAEFgS,GAAcJ,GAAO,CACjB,IAAA/hB,EAAO28F,GAAe3+E,UAAU+D,EAAQC,UAC9CD,EAAO,CACLC,UAAennB,IAATmF,EAAqB6d,EAAOS,MAAMte,QAAQnF,IAIpD+d,EAAA,GAAA+jF,GAAiB9+E,GAGjBjF,EAAA,GAAA6jF,GAAa//E,8BA5BTogF,EAAeh7E,GAAoBC,GACrC+6E,GACF7rF,QAAQZ,MAAM,UAAYysF,4BAO3BpnB,EAAkBe,GAAW54D,EAAOS,0BAkTrCnO,EAAM,kBAAmBmoF,GAGZ,SAATA,GAEFrnF,QAAQ2gB,KACN,6JA5JG,SAAaklD,EAAyB0D,EAA0BilB,GACvE7mF,EAAA,EAAAmJ,EAAU+0D,GAENlkD,GACFA,EAASkkD,EAAgB0D,EAAiBilB,IAIrC,SAAa3iC,GACpBlkD,EAAA,EAAAyM,EAAYy3C,GAERn7B,GACFA,EAASm3D,GAAUh8B,gBAKrBlkD,EAAA,GAAA2oB,IAAW,GACPwzB,IACFA,iBAKFn8C,EAAA,GAAA2oB,IAAW,GACPyzB,IACFA,eAIqB0qC,GAAA,OAAAR,GAAA7wF,MAAA/K,KAAAA,UAAA47F,QA8EhB,SAAiBS,GAAG,IAAA59E,EAAO49E,EAAP59E,QAAS9C,EAAI0gF,EAAJ1gF,KAAMwT,EAAOktE,EAAPltE,QAASla,EAAOonF,EAAPpnF,QACnDpI,EAAM,oBAAuB,CAAA4R,QAAAA,EAAS9C,KAAAA,SAEtCy9E,GAAoB,CAClB74F,UAAW+J,GAAKgyF,GAAe,CAC7B79E,QAAAA,EACA9C,KAAAA,EACAwT,QAAAA,EAEAD,SAAAA,EACAnQ,YAAAA,EACA4lE,QAAAA,EACAzS,YAAAA,EACAC,cAAAA,EACAsS,UAAAA,EACAC,YAAAA,EACA1kE,wBAAAA,EACAC,wBAAAA,EACAqwE,eAAAA,EACA/1E,OAAAA,EACAs2C,eAAWt5D,EACXu5D,iBAAAA,EACAyS,WAAAA,EACAzK,cAAAA,GACA+D,YAAAA,GACA8D,aAAAA,GACA2R,oBAAAA,GACAC,YAAAA,GACAC,iBAAAA,KAEFhvE,UACE,CAAAyR,QAAAA,qBAKuBsnF,EAAAC,UAC3BD,EAAAnD,UAAoB,IAAAmD,GAAW,QAAXA,EAApBA,EAAsB/4F,iBAASg5F,IAAAD,GAASC,QAATA,EAA/BD,EAAiCtnF,mBAAOunF,GAAxCA,EAAAj/F,KAAAg/F,GACAjnF,EAAA,GAAA8jF,GAAuB,4CAtRhB36E,YAGgBg+E,UAAAnD,GAAAvuF,MAAA/K,KAAAA,YAeH,SAAM08F,GAAA/C,OAAAA,GAAA5uF,MAAA/K,KAAAA,YAaN,SAAK28F,GAAA7C,OAAAA,GAAA/uF,MAAA/K,KAAAA,YAqBL,SAAM48F,GAAA,OAAA3C,GAAAlvF,MAAAvN,KAAAwC,UAAAi6F,EAMN,SAAM4C,GAAA,OAAAzC,GAAArvF,MAAA/K,KAAAA,UAAAo6F,EASZ,SAAUl9F,GACxBi6F,EAAkBnnD,UAAU9yC,eAQrB,OAAAi6F,EAAkB7jB,uBAcW,OAAAinB,GAAAxvF,MAAAvN,KAAAwC,UAAA,EAQhB,SAAQ88F,GAAA,OAAApC,GAAA3vF,MAAAvN,KAAAwC,UAAA,EAId,SAAY2b,UACnBw7E,EAAkBz5B,YAAY/hD,OASjB,WAAOs/E,OAAAA,GAAAlwF,MAAA/K,KAAAA,UAAAi7F,WAII8B,UAAA3B,GAAArwF,MAAAvN,KAAAwC,UAAA,EAQX,WAAO,OAAAy7F,GAAA1wF,MAAAvN,KAAAwC,UAAA,gFAsLRm3F,EAAiBrgF,0vFCtYN0tB,EAAAztC,MAAO2F,KAAI,8CAA1BsgG,EAAA19F,QAAA29F,EAAAlmG,MAAOgC,uCAAtB6C,GAAkDvB,EAAA2iG,EAAAnhG,4BAApB,EAAAxE,GAAAmtC,KAAAA,EAAAztC,MAAO2F,KAAI,KAAAiC,GAAAwC,EAAAqjC,GAA1B,EAAAntC,GAAA4lG,KAAAA,EAAAlmG,MAAOgC,oGADjBhC,EAAO,iBAAZa,OAAIC,GAAA,wIAPmB0kC,GAAcxlC,EAAS,GAAEA,EAAM,MAAA,uBAEnC,IAATA,EAAS,IAAA4N,IAAA,WAAA,OAAA5N,EAAA,IAAAwG,KAAA4B,MADDM,GAAAN,EAAA,eAAA84B,GAAiBlhC,EAAS,sBAFhD6E,GAWQvB,EAAA8E,EAAAtD,yDARM9E,EAAS,IAAA,sDAEVA,EAAY,qBACTmmG,mEAEPnmG,EAAO,YAAZa,OAAIC,GAAA,EAAA,iHAAJD,gDAPuB2kC,GAAcxlC,EAAS,GAAEA,EAAM,MAAA,8CAE5CA,EAAS,UADD0I,GAAAN,EAAA,eAAA84B,GAAiBlhC,EAAS,wEARrC,SAAAmmG,GAAgBlgG,GAEvBA,EAAMU,yCAjCJy/F,EATOxhF,EAAcpK,EAAdoK,KACA5iB,EAAcwY,EAAdxY,MACAwhB,EAAkBhJ,EAAlBgJ,OACA2U,EAAiB3d,EAAjB2d,SACAnN,EAA+BxQ,EAA/BwQ,UACAoN,EAAgB5d,EAAhB4d,QAEAjyB,EAAgDqU,EAAhDrU,QAIPkgG,EAAqBrkG,+RACxBuc,EAAA,EAAE8nF,EAAYrkG,iBAEN,SAAWgpB,GACdA,GACEo7E,GACFA,EAAUtmF,QAKbwmF,CAAWt7E,eAEL,SAAa/kB,GACpBA,EAAMU,kBAEFwxB,GAIJC,EAAO,EAEHC,GAAI,UACJzT,KAAMC,EAAmBD,GACzB5iB,MAAOqkG,yBnI61BR,IACAE,ImIh1BgB9/F,KnIg1BSwyD,cAAc,YmIh1BhCotC,EnIi1BNE,GAAmBA,EAAgBh+F,0EmIh1B9B69F,EAASrmF,4MCrDNymF,GACdC,EACAC,EACA9hF,GAEA,IAAM+hF,EAAgBC,GAAWH,EAAQC,GAAqB,CAAA,EAAI9hF,GAElE,OAAO+hF,EASH,SAAmBF,GACvB,GAAIp1F,MAAMoS,QAAQgjF,EAAa,MAC7B,OAAOA,EAAa,KAGtB,IAAMI,EAAYJ,EAAc,OAAKA,EAAc,OAAKA,EAAc,MACtE,GAAIp1F,MAAMoS,QAAQojF,GAAY,CAC5B,IAAMryE,EAAQqyE,EAAUr7F,QAAO,SAACu8B,GAAU,OAAAA,EAAU,IAAA,IACpD,GAAIvT,EAAM3zB,OAAS,EACjB,OAAO2zB,EAAM,OAEhB,CAED,OAAO,IACT,CAvByBsyE,CAASH,GAAiB,IACnD,CA6BM,SAAUC,GACdG,EACAL,EACA9hF,GAOA,IAN8B,IAA9BoiF,EAAa/9F,UAAApI,OAAA,QAAAL,IAAAyI,UAAAzI,GAAAyI,UAAG89F,GAAAA,EAEV9f,EAAWriE,EAAKxkB,MAAM,EAAGwkB,EAAK/jB,QAC9BqoC,EAAUtkB,EAAK,GAEjBqiF,EAAkB,CAACD,GACvBE,IAAAC,EAAyB,CAACH,EAAcI,MAAOJ,EAAcK,MAAOL,EAAcM,OAAMJ,EAAAC,EAAAtmG,OAAAqmG,IAAE,CAArF,IAAMK,EAAUJ,EAAAD,GACf71F,MAAMoS,QAAQ8jF,KAChBN,EAAkBA,EAAgB58F,OAAOk9F,GAE5C,CAAA,IAEmCC,EAFnCC,EAAArrE,EAEoB6qE,GAAe,IAApC,IAAAQ,EAAAprE,MAAAmrE,EAAAC,EAAAx1F,KAAAqqB,MAAsC,CAGpC,GAAI,SAFJ0qE,EADeQ,EAAAxlG,QAG8C,iBAAvBglG,EAAcU,KAAmB,CAAA,IAAAC,EAC/DrvE,EAAM0uE,EAAcU,KAC1B,GAAIpvE,KAAOouE,EACTM,EAAgBN,EAAkBpuE,OACzBA,KAAAA,EAAIniB,WAAW,MAUf,IAA8B,KAAb,QAAjBwxF,EAAArvE,EAAI9D,MAAM,eAAO,IAAAmzE,OAAA,EAAjBA,EAAmB9mG,QAAc,CAC1C,IAAiD+mG,EAAAjwE,EAAfW,EAAIhtB,MAAM,MAArCu8F,GAAAA,EAASD,EAAEzI,GAAAA,EAAYyI,EAAA,GAC9B,GAAIC,KAAanB,EAAmB,CAClC,IAAMoB,EAAmBpB,EAAkBmB,GACrC/2D,EAAY,CAAE42D,KAAM,KAAKr9F,OAAO80F,IAChC4I,EAAc,GAKpB,OAJAA,EAAY37F,KAAK88B,GACb+9C,EAASpmF,OAAS,GACpBknG,EAAY37F,KAAI4H,MAAhB+zF,EAAW9zF,EAASgzE,IAEf2f,GAAWkB,EAAkBpB,EAAmBqB,EAAaj3D,EACrE,CACC,MAAM9kC,MAAK,+BAAA3B,OAAgCiuB,GAE9C,CACC,MAAMtsB,MAAK,+BAAA3B,OAAgCiuB,GAC5C,CAzBC,IAAM0vE,EAAU1vE,EAAIjS,UAAU,GAAG/a,MAAM,KACvC07F,EAAgBD,EAAc,IACDkB,EADCC,EAAA9rE,EACR4rE,GAAtB,IAAA,IAAAE,EAAA7rE,MAAA4rE,EAAAC,EAAAj2F,KAAAqqB,MAA+B,CAApB,IAAA6rE,EAAOF,EAAAjmG,MAChB,KAAImmG,KAAWnB,GAGb,MAAMh7F,MAAK3B,+BAAAA,OAAgCiuB,IAF3C0uE,EAAgBA,EAAcmB,EAIjC,CAAA,OAAAhlF,GAAA+kF,EAAA/5F,EAAAgV,EAAA+kF,CAAAA,QAAAA,EAAAllG,GACF,CAgBA,CACF,CAID,QAAgBxC,IAAZ0oC,EACF,OAAO89D,EAGT,GACsC,WAApCpnG,EAAOonG,EAActc,aACQ,OAA7Bsc,EAActc,YACdxhD,KAAW89D,EAActc,WAGzB,OAAOkc,GAAWG,EAAgBL,EAAmBzf,EADrD+f,EAAiBA,EAActc,WAA0CxhD,IAI3E,GAC6C,WAA3CtpC,EAAOonG,EAAcoB,oBACe,OAApCpB,EAAcoB,kBAEd,IAAK,IAAMx2E,KAAQo1E,EAAcoB,kBAC/B,GAAIl/D,EAAQ1U,MAAM5C,GAEhB,OAAOg1E,GAAWG,EAAgBL,EAAmBzf,EADrD+f,EAAiBA,EAAcoB,kBAAiDx2E,IAMtF,GAAkD,WAA9ChyB,EAAOonG,EAAcqB,sBAEvB,OAAOzB,GAAWG,EAAgBL,EAAmBzf,EADrD+f,EAAgBA,EAAcqB,sBAIhC,GAAmC,WAA/BzoG,EAAOonG,EAAcv8D,QAA8C,OAAxBu8D,EAAcv8D,MAE3D,OAAOm8D,GAAWG,EAAgBL,EAAmBzf,EADrD+f,EAAgBA,EAAcv8D,MAGjC,CAAA,CAAA,MAAAtnB,GAAAskF,EAAAt5F,EAAAgV,WAAAskF,EAAAzkG,GAED,CAAA,OAAW,IACb,UCxHgBslG,GACd9mG,EACAilG,EACAC,GAEA,IAAM6B,EAAa/B,GAAqBC,EAAQC,EAAmBllG,EAAMojB,MAEzE,GAAI2jF,EAAY,CACd,IAAQvmG,EAAsDR,EAAtDQ,MAAO4iB,EAA+CpjB,EAA/CojB,KAAMoG,EAAyCxpB,EAAzCwpB,UAAWxH,EAA8BhiB,EAA9BgiB,OAAQ2U,EAAsB32B,EAAtB22B,SAAUC,EAAY52B,EAAZ42B,QAE5CjyB,EAAUoiG,EAAWx0F,KAAI,SAACy0F,GAAe,MAAA,CAC7CxmG,MAAOwmG,EACP7iG,KAAM6iG,EACP,IAIKC,EAAmBF,EAAW1/E,SAASrnB,EAAMQ,OAC/CmE,EACA,CAAC,CAAEnE,MAAOA,EAAkB2D,KAAM3D,IAAoBqI,OAAOlE,GAEjE,MAAO,CACL,CACEqD,UAAWk/F,GACXlnG,MAAO,CACLQ,MAAAA,EACA4iB,KAAAA,EACAoG,UAAAA,EACAxH,OAAAA,EACA2U,SAAAA,EACAC,QAAAA,EACAjyB,QAASsiG,IAIhB,CAED,OAAO,IACT,CCtBM,SAAUE,GAAmBxiG,GAEjC,QAAuB3F,IAAnB2F,EAAQsgG,OACV,MAAU,IAAAz6F,MACR,6QASJ,IAAI48F,EAwBN,SAA2BziG,GACzB,IAAQugG,EAAkCvgG,EAAlCugG,kBAAmBmC,EAAe1iG,EAAf0iG,WAErBD,EAAM,IAAIE,GAAOzvF,EAAA,CACrB0vF,WAAW,EACXC,SAAS,EACTC,OAAO,GACJJ,IAGDnC,GACFxnG,OAAOyC,KAAK+kG,GAAmBpnG,SAAQ,SAACg5B,GACtCswE,EAAIM,UAAUxC,EAAkBpuE,GAAgBA,EAClD,IAGF,OAAOswE,CACT,CAzCYO,CAAkBhjG,GAC5B,QAA4B3F,IAAxB2F,EAAQijG,cAIe,KAHzBR,EAAMziG,EAAQijG,YAAYR,IAAQA,GAG1BS,KAAKL,QACX,MAAM,IAAIh9F,MAAM,uDAIpB,IAAMs9F,EAAcV,EAAIW,QAAQpjG,EAAQsgG,QAExC,GAAI6C,EAAY9sC,OACd,MAAM8sC,EAAY9sC,OAAO,GAG3B,OAAgB,SAAS70C,GAIvB,OAHA2hF,EAAY3hF,IACM2hF,EAAY9sC,QAAU,IAEvBzoD,IAAIy1F,IAAiBz1F,KAAI,SAACiC,GAAU,OAuBzD,SAA2B2R,EAAe8hF,GACxC,MAAO,CACL7kF,KAAM2Z,EAAU5W,EAAM8hF,EAASC,cAC/BziF,QAASwiF,EAASxiF,SAAW,gBAC7BizC,SAAU/5C,GAAmBs8C,QAEjC,CA7ByDktC,CAAkBhiF,EAAM3R,EAAM,GACrF,CACF,CAoCA,SAASwzF,GAAgBC,GACvB,GAAyB,SAArBA,EAASxc,SAAsB57E,MAAMoS,QAAQgmF,EAAShD,QAAS,CACjE,IAAImD,EAAQH,EAAShD,OACrB,GAAImD,EAAO,CAGT,IAFAA,EAAQA,EAAM71F,KAAI,SAAC/R,GAAK,OAAKimB,KAAKtE,UAAU3hB,EAAO,KAEzCnB,OAAS,EAAG,CACpB,IAAMgpG,EAAO,CAAC,KAAOD,EAAM/oG,OAAS,GAAK,cACzC+oG,EAAQA,EAAMxpG,MAAM,EAAG,IACjBgM,KAAKy9F,EACZ,CACDJ,EAASxiF,QAAU,8BAAgC2iF,EAAMj+F,KAAK,KAC/D,CACF,CAMD,MAJyB,yBAArB89F,EAASxc,UACXwc,EAASxiF,QAAU,wCAA0CwiF,EAAS/5F,OAAOo6F,oBAGxEL,CACT,CClHA,IAUaM,GAAqC,CAChD9lG,GAAI,SACJsB,KAAM,qBAJP,sZAUD,SAAqBoiB,EAAeyL,GAClC,IAAQ5nB,EAA6B4nB,EAA7B5nB,OAAQmU,EAAqByT,EAArBzT,KAAM0T,EAAeD,EAAfC,WAChBC,EAAa,CAAC,4BAEpB,GAAI9nB,GAAUA,EAAOoZ,MAAQpZ,EAAO+nB,UAAY/nB,EAAOxJ,MAAO,CAG5D,IAAMwxB,EAAiBnpB,eAAAA,OAAkBgoB,GAAuB7mB,EAAOoZ,OAEjE6O,EAAcX,GAAYtnB,EAAOxJ,OACjC0xB,EACmB,iBAAhBD,EAAwB,IAAAppB,OACvBmB,EAAOxJ,MAAK,KAChBkiB,GAAU1Y,EAAOxJ,SAAWkhB,OAAOyQ,cAAcF,GAAYppB,GAAAA,OACxDmB,EAAOxJ,MAAQ,KAClBwJ,EAAOxJ,MAEfsxB,EAAWlnB,KAAI,eAAA/B,OAAgBmpB,EAAiB,KAAAnpB,OAAImB,EAAO+nB,SAAQlpB,KAAAA,OAAIqpB,SACxE,CAEG/T,GAAQA,EAAKiF,MAAQjF,EAAKhR,WAC5B2kB,EAAWlnB,KAAI,iBAAA/B,O/GwDb,SAAuCua,GAC3C,OAAuB,IAAhBA,EAAK/jB,OACR,GACA+jB,EAAK0e,OAAM,SAAC1R,GAAS,OAAAP,GAAmB3O,KAAKkP,IAASO,GAAwBzP,KAAKkP,EAAK,IACtF,IAAMhN,EAAK7Q,IAAIme,IAAyBvmB,KAAK,IAAIgS,QAAQ,MAAO,IAAM,IACtEsK,KAAKtE,UAAUiB,EACvB,C+G7DuBolF,CAA6BrqF,EAAKiF,MAAK,SAAAva,OAAQsV,EAAKhR,UAAS,UAIlF,GAAI0kB,GAAcA,EAAWO,MAG3B,GAAIP,EAAWO,MAAM/yB,OAAS,EAAG,CAE/B,IAAM+yB,EAAQP,EAAWO,MAAM7f,KAAI,SAAC6Q,GAClC,IAAMrf,EAAOo5B,GAAK/Z,IAAS,OAC3B,MAAAva,SAAAA,OAAgB4d,KAAKtE,UAAUpe,GAAK8E,UAAAA,OAASgoB,GAAuBzN,GACtE,IACA0O,EAAWlnB,6BAAI/B,OAAyBupB,EAAMjoB,KAAK,sBACpD,KAAM,CACL,IAAMiZ,EAAOyO,EAAWO,MAAM,GAC9BN,EAAWlnB,KAAI/B,wBAAAA,OAAyBgoB,GAAuBzN,GAAK,OACrE,CAKH,OAFA0O,EAAWlnB,KAAK,kBAEhB,4BAAA/B,OAAmCipB,EAAW3nB,KAAK,IAAG,IACxD,eAEA,SAAsBgc,EAAemM,IAyBrC,SAAkBA,GAAa,IAAAm2E,EAAAC,EAIvBC,EAAuCF,QAA7BA,EAAGn2E,EAAMU,MAAM,0BAAcy1E,SAA1BA,EAA4BppG,OACzCupG,EAAwCF,QAA9BA,EAAGp2E,EAAMU,MAAM,2BAAe01E,SAA3BA,EAA6BrpG,OAEhD,GAAIspG,IAAeC,EACjB,MAAU,IAAAp+F,MAAM,mEAEpB,CAlCEuwE,CAASzoD,GAMT,IAcMC,EAdU,IAAIC,SAClB,IACA,oBAEEF,EAFF,iKAFc,CAYdY,EAEaT,CAAQtM,GACvB,YAAkBnnB,IAAXuzB,EAAuBA,EAAS,IACzC,GCxFA,IAQas2E,GAAuC,CAClDpmG,GAAI,WACJsB,KAAM,WACNyiF,YAXe,wTAYfkB,YAYF,SAAqBvhE,EAAeyL,GAClC,IAAQzT,EAA6ByT,EAA7BzT,KAAMnU,EAAuB4nB,EAAvB5nB,OAAQ6nB,EAAeD,EAAfC,WAClBS,EAAQ,GAEZ,GAAItoB,GAAUA,EAAOoZ,MAAQpZ,EAAO+nB,UAAY/nB,EAAOxJ,MAAO,CAC5D,IAAMsoG,EAAc,CAAC,KAAKjgG,OAAOmB,EAAOoZ,MAClC2lF,EAAe1uE,EAAMlU,EAAM2iF,GAC3B72E,EAAcX,GAAYtnB,EAAOxJ,OACjC0xB,EACoB,iBAAjB62E,GAAP,MAAoC92E,EAAiD,IAAAppB,OAC7EmB,EAAOxJ,MAAK,KAChByxB,EAENK,GACE,MACA02E,GAAyBh/F,EAAOoZ,MAChC,IACApZ,EAAO+nB,SAHP,KAMAG,EANA,IASH,MACCI,GAASziB,MAAMoS,QAAQkE,GAAQ,MAAQ,IAGrChI,GAAQA,EAAKiF,MAAQjF,EAAKhR,YACL,SAAnBgR,EAAKhR,UACPmlB,GAAS,0BAA4B02E,GAAyB7qF,EAAKiF,MAAQ,KAE3EkP,GAAS,kBAAoB02E,GAAyB7qF,EAAKiF,MAAQ,KAIvE,GAAIyO,GAAcA,EAAWO,MAK3B,GAJgC,MAA5BE,EAAMA,EAAMjzB,OAAS,KACvBizB,GAAS,UAGqB,IAA5BT,EAAWO,MAAM/yB,OAAc,CACjC,IAAM+jB,EAAOyO,EAAWO,MAAM,GAE9BE,GACkB,IAAhBlP,EAAK/jB,OACD,GACA,IAAM2pG,GAAyB5lF,EACtC,MAAUyO,EAAWO,MAAM/yB,OAAS,IACnCizB,GACE,KACAT,EAAWO,MACR7f,KAAI,SAAC6Q,GAEJ,OAAO6lF,GADM7lF,EAAKA,EAAK/jB,OAAS,IACH,KAAO2pG,GAAyB5lF,EAC/D,IACCjZ,KAAK,MACR,KAON,OAAOmoB,CACT,EA3EE21D,aAgFF,SAAsB9hE,EAAemM,EAAetQ,GAQlD,IAAMknF,EAAmB/hF,GAAcnF,EAAQyE,MAAQN,EALvD,SAA2BA,GACzB,IAAMhiB,EAAO6d,EAAOG,UAAUgE,GAC9B,YAAgBnnB,IAATmF,EAAqBsiB,KAAKhE,MAAMte,QAAQnF,CAChD,CAE6DmqG,CAAkBhjF,GAEhF,OAAOijF,GAASz/D,OAAOu/D,EAAkB52E,EAC3C,GAIM,SAAU02E,GAAyB5lF,GACvC,GAAoB,IAAhBA,EAAK/jB,OACP,MAAO,IAGT,IAAM0J,EAAMqa,EACT7Q,KAAI,SAAC6d,GACJ,MAAoB,iBAATA,EACF,IAAMA,EAAO,IAEb,IAAM64E,GAAc/hF,OAAOkJ,GAEtC,IACCjmB,KAAK,IAER,MAAkB,MAAXpB,EAAI,GACPA,EAAInK,MAAM,GACVmK,CACN,CAEA,SAASkgG,GAAc74E,GACrB,OAAOA,EAAK4C,MAAM,mBAAqB5C,EAAO3J,KAAKtE,UAAUiO,EAC/D","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,13,14,15,16,31,32,33,53,54,55,56,57,58,59,60,61,62,63]}